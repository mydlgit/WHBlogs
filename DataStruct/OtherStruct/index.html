<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Others - Note</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Note</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">C++ Base <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../c_base/callable.md" class="dropdown-item">callable</a>
</li>
                                    
<li>
    <a href="../../c_base/class.md" class="dropdown-item">class</a>
</li>
                                    
<li>
    <a href="../../c_base/Complementary.md" class="dropdown-item">complementary</a>
</li>
                                    
<li>
    <a href="../../c_base/const.md" class="dropdown-item">const</a>
</li>
                                    
<li>
    <a href="../../c_base/constructor_destructor.md" class="dropdown-item">constructor_destructor</a>
</li>
                                    
<li>
    <a href="../../c_base/container.md" class="dropdown-item">container</a>
</li>
                                    
<li>
    <a href="../../c_base/exception.md" class="dropdown-item">exception</a>
</li>
                                    
<li>
    <a href="../../c_base/function.md" class="dropdown-item">function</a>
</li>
                                    
<li>
    <a href="../../c_base/friend_template.md" class="dropdown-item">friend_template</a>
</li>
                                    
<li>
    <a href="../../c_base/initialization.md" class="dropdown-item">initialization</a>
</li>
                                    
<li>
    <a href="../../c_base/inline.md" class="dropdown-item">inline</a>
</li>
                                    
<li>
    <a href="../../c_base/inherit.md" class="dropdown-item">inherit</a>
</li>
                                    
<li>
    <a href="../../c_base/iterator.md" class="dropdown-item">iterator</a>
</li>
                                    
<li>
    <a href="../../c_base/memory.md" class="dropdown-item">memory</a>
</li>
                                    
<li>
    <a href="../../c_base/new_delete.md" class="dropdown-item">new_delete</a>
</li>
                                    
<li>
    <a href="../../c_base/pointer_reference.md" class="dropdown-item">pointer_reference</a>
</li>
                                    
<li>
    <a href="../../c_base/static.md" class="dropdown-item">static</a>
</li>
                                    
<li>
    <a href="../../c_base/virtual.md" class="dropdown-item">virtual</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">EffectiveCPP <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../EffectiveCPP/rule.md" class="dropdown-item">RULES</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Linux os <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../os/0_index/" class="dropdown-item">home</a>
</li>
                                    
<li>
    <a href="../../os/1_introduction/" class="dropdown-item">1_开始</a>
</li>
                                    
<li>
    <a href="../../os/2_as86/" class="dropdown-item">2_汇编语法</a>
</li>
                                    
<li>
    <a href="../../os/3_80x86_protect_mode/" class="dropdown-item">3_保护模式</a>
</li>
                                    
<li>
    <a href="../../os/4_kernel_struct/" class="dropdown-item">4_内核体系结构</a>
</li>
                                    
<li>
    <a href="../../os/5_os/" class="dropdown-item">5_现代操作系统</a>
</li>
                                    
<li>
    <a href="../../os/7_simple_os/" class="dropdown-item">7_simple_os</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">MySQL <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../MySQL/0_start/" class="dropdown-item">home</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">DataStruct <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Tree/" class="dropdown-item">Tree</a>
</li>
                                    
<li>
    <a href="../Sort/" class="dropdown-item">Sort</a>
</li>
                                    
<li>
    <a href="../Graph/" class="dropdown-item">Graph</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Others</a>
</li>
                                    
<li>
    <a href="../Algorithm/" class="dropdown-item">Algorithm</a>
</li>
                                    
<li>
    <a href="../API/" class="dropdown-item">API</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Network <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Network/home.md" class="dropdown-item">home</a>
</li>
                                    
<li>
    <a href="../../Network/1_application/" class="dropdown-item">application</a>
</li>
                                    
<li>
    <a href="../../Network/2_transport/" class="dropdown-item">transport</a>
</li>
                                    
<li>
    <a href="../../Network/3_network/" class="dropdown-item">network</a>
</li>
                                    
<li>
    <a href="../../Network/4_link/" class="dropdown-item">link</a>
</li>
                                    
<li>
    <a href="../../Network/5_netsafe/" class="dropdown-item">safe</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">interview <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../interview/" class="dropdown-item">面试</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Graph/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Algorithm/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#_1" class="nav-link">其他数据结构以及补充</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">散列</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_3" class="nav-link">堆</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#unionfind-sets" class="nav-link">并查集(union/find sets)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#_4" class="nav-link">补充</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#c11" class="nav-link">C++11中的容器</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#linux" class="nav-link">Linux内核中的数据结构</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="_1">其他数据结构以及补充</h1>
<h2 id="_2">散列</h2>
<p>&emsp;是根据键（Key）而直接访问在内存存储位置的数据结构。它通过计算一个关于键值的函数(散列函数)，将所需查询的数据映射到表中一个位置来访问记录；散列(hashing)是一种以常数平均时间执行插入、删除和查找的技术。<br />
&emsp;如果一个元素插入时与一个已经存在的元素散列到相同的值时，则产生了一个<strong>冲突</strong>，有两种简单的解决方法: 分离链接法和开放定址法。  </p>
<ul>
<li>
<p><strong>分离链接法</strong>: 将散列到同一个值得所有元素保留到一个链表中，新元素一般被插入到链表的前端，因为新近插入的元素最有可能不久被访问。<br />
<img alt="avatar" src="../../images/DataStruct/5.png" /><br />
装填因子: 散列表的元素个数对散列表大小的比值λ。 执行一次查找的评价代价为1+λ/2；分离链接散列法的一般法则是让表的大小与预料的元素个数一致，即λ≈1，当λ超过1时，就扩大散列表的大小。  </p>
</li>
<li>
<p><strong>开放定址法</strong>：采用探测散列表，一种不采用链表的散列表，对于冲突的元素尝试另外的单元(h<sub>i</sub>(x)=(hash(x)+f(i))mod TableSize, f是冲突解决方案)，这种形式的表要比分离链接法需要的表更大，要求λ小于0.5。<br />
&emsp;常见冲突解决包括线性探测法(f是i的线性函数, eg.f(i)=i)、平方探测法和双散列。<br />
&emsp;对于f(i)=i的线性探测，相当于相继探测逐个单元(可以循环)以找到第一个空单元；由于实现简单，具有良好的局部性，在硬件上的标准实现中十分流行; 但某种情况下，冲突造成元素占据的位置形成区块，即一次聚集，导致散列到区块中的任何关键字都需要多次探测单元才能解决冲突。<br />
&emsp;平方探测，f(i)=i^2, 会引起二次聚集(散列到同一位置上的元素将探测相同的备选位置)，装填因子不能大于0.5，即至少有一半为空且表大小为素数才能保证插入元素总能成功。<br />
&emsp;双散列，f(i)=i*hash<sub>2</sub>(i)。  </p>
</li>
</ul>
<p>&emsp;<strong>再散列</strong>(rehash)，即扩大散列表的大小，将旧表中的元素插入到新表中。一般有三种策略：表满一半就rehash；插入失败再rehash；装填因子λ达到特定值就rehash。  </p>
<p>&emsp;完美散列<br />
使用二级散列表代替链表，而二级散列表的大小与散列到其对应的hash值得元素个数N有关，SecondTableSize=Ω(N^2)，二级散列表的元素个数将较主散列表少很多，大部分情况下可以保证至少有1/2概率不存在冲突(即二级表的λ&lt;=0.5)，如果仍然冲突，则直接换用新的散列函数对该二级表中元素重新插入，尝试的期望次数为2。如果所产生的冲突次数大于要求，则主散列表还可以构造多次。  </p>
<p>&emsp;杜鹃散列  <br />
    <pre>
以两个hash table为例：
假设有N个项，我们维护两个分别超过半空的表，且有独立的散列函数，可以把每个项分配到每个表中的一个位置，
杜鹃散列保持不变的是一个项总是会被存储在这两个位置之一。
1、两个位置均为空，则任选一个插入；
2、两个位置中一个为空，则插入到空的那个位置
3、两个位置均不为空，则踢出一个位置后插入，被踢出的对调用该算法，
再执行该算法找其另一个位置，循环直到插入成功。
4、如果被踢出的次数达到一定的阈值，则认为hash表已满，并进行重新哈希rehash。
优点：
最坏情况下常数级的查找和删除时间。
避免了懒惰删除和额外的数据以及并行化的可能性。
缺点：
如果散列值不好，则很容易发生循环，即插入导致永远的在挤走冲突元素，永远都在冲突状态。
不过可以证明，如果λ&lt;0.5，循环的概率是比较小的。<br />
</pre></p>
<p>&emsp;跳房子散列</p>
<pre>
用事先确定的，对计算机底层体系结构而言最优的一个常数，
给探测序列的最大长度加个上界(依旧是线性探测)。这样做可以给出常数级的最坏查询时间，
并且与杜鹃散列一样，查询可以并行化，以同时检查可用位置的有限集。
&emsp;
跳房子散列规则：
a）以最大探测上界MAX_DIST​ = 4为例
b）散列位置hash(x)，则探测位置为 hash(x)+0、hash(x)+1、hash(x)+2、hash(x)+3。
hash(A)=7, hop(7)=1000; //表明当前位置被占；
hash(B)=9, hop(9)=1000;
hash(C)=6, hop(6)=1000;
&emsp;
//发生冲突，D存放到位置8，hop(7)=1100表示7、8被占，hop(8)=0000表示尚未有元素散列值为8
hash(D)=7, hop(7)=1100, hop(8)=0000; 
//发生冲突，且8、9已经被占，E存放到10，hop(8)=0010，表示散列值为8的元素占据10号位置
hash(E)=8, hop(8)=0010, hop(10)=0000;
//继续向下一个位置探测，hop(8)=0011, 散列值为8的元素占据10、11号位置
hash(F)=8, hop(8)=0011, hop(11)=0000;
</pre>

<p><strong>散列用途</strong></p>
<pre>
符号表：跟踪源代码中的变量
适用于图论问题
置换表
在线拼写检验程序
<b>实现高速缓冲存储区</b>
</pre>

<h2 id="_3">堆</h2>
<p>&emsp;这里特指二叉堆，其是一棵完全二叉树，<strong>如果将树中全部节点存按层序遍历存放在数组下标1开始的位置，则位置i上的节点，其左孩子位于数组2i位置上，右孩子则位于2i+1位置上</strong>，因此实际中堆都采用数组来实现。<br />
&emsp;用二叉堆来实现优先队列，在查找一组数中第k个最大/小数时，通过优先队列，进行k次删除返回结果，时间复杂度为O(N+klog N)。  </p>
<ul>
<li>堆序性质：在一个堆中，对于每一个节点X(根节点除外，它没有父亲)，X的父亲的key要小于等于X中的key，因此最小元永远在根节点处。<br />
&emsp;插入和删除的最坏时间复杂度都为O(log N)<br />
<img alt="avatar" src="../../images/DataStruct/7.png" />
<img alt="avatar" src="../../images/DataStruct/8.png" />
&emsp;对一组数进行构堆操作(<font size=2, color='red'>从第h-1层的最右侧节点(i=N/2)开始，依此向右向上遍历节点，执行下滤操作, 整个过程的上界是每个节点到其最长叶节点的路径和，也即全部结点的高度和</font>)，时间复杂度是O(N).<br />
<img alt="avatar" src="../../images/DataStruct/11.png" />
<img alt="avatar" src="../../images/DataStruct/10.png" /></li>
</ul>
<h2 id="unionfind-sets">并查集(union/find sets)</h2>
<p>&emsp;要用于解决一些元素分组的问题。它管理一系列不相交的集合，并支持两种操作：<br />
&emsp;合并（Union）：把两个不相交的集合合并为一个集合;<br />
&emsp;查询（Find）：查询两个元素是否在同一个集合中.<br />
初始化:把每个点所在集合初始化为其自身。通常来说，这个步骤在每次使用该数据结构时只需要执行一次，无论何种实现方式，时间复杂度均为O(N)。  </p>
<pre><code class="language-C">    class DisjSets{
    private:
        std::vector&lt;int&gt; father; //存储每个节点的父节点，初始设为其自身
        std::vector&lt;int&gt; rank; //存储每个节点的估计高度，因为随着路径压缩，树的结构发生改变，高度会发生变化，初始值设为1
    public:
        explicit DisjSets(int numElements): father(numElements), rank(numElements, 1){
            for(int i=0;i&lt;numElements;i++)father[i]=i;
        }

        int find(int x);
        void unionSets(int , int );  
    };

    int DisjSets::find(int x){  //在查询时执行路径压缩，即让沿途的每个节点的父节点都为根节点
        return find(x)==x?x:(father[x]=find(father[x]));
    }

    void DisjSets::unionSets(int elem1, int elem2){
        int root1=find(elem1), root2=find(elem2);
        if(root1==root2)return;
        if(rank[root1] &lt;= rank[root2])
            father[root1] = root2;  //让较深的树的根节点成为浅树的根的父节点，这样不会增加整棵树的高度
        else
            father[root2] = root1;
        //只有rank[root1]与rank[root2]相等时，合并才会增加根节点的高度，且此时是root1被合并到root2
        //因此只有rank[root2]++
        if(rank[root1]==rank[root2] &amp;&amp; root1!=root2)
            rank[root2]++;
    }
</code></pre>
<h1 id="_4">补充</h1>
<h2 id="c11">C++11中的容器</h2>
<ul>
<li>map\set: 通过红黑树实现  </li>
<li>unordered_map\unordered_set通过散列表实现  </li>
<li>根据递归方程估计时间复杂度<br />
<img alt="avatar" src="../../images/DataStruct/21.png" /> </li>
<li>位运算: <br />
&emsp;把一个整数减去1之后再和原来的整数做按位与，得到的结果相当于把整数的二进制表示中最右边的1变成0，而其余位不变。例如: 1100b &amp; 1011b = 1000b <br />
&emsp; n&gt;0, n&amp;=~(n-1); //得到的n除了右侧第一个1之外，都变为0， n=23 = 00..10111b, ~(n-1)=11..01001b,
则n&amp;=~(n-1) = 00..00001b<br />
&emsp; <strong>取余运算对于加减乘除均满足分配律</strong><br />
<img alt="avatar" src="../../images/DataStruct/23.png" /></li>
<li>判断两个浮点数是否相等: 由于存在精度误差，不能使用"=="来判断两个浮点数是否相等；可以判断两个数之间的差值是否小于一个比较小的数，如1e-6或1e-7。  </li>
</ul>
<h2 id="linux">Linux内核中的数据结构</h2>
<ul>
<li>链表: linux内核中的标准链表采用环形双向链表，具体实现为:  </li>
</ul>
<pre><code class="language-C">    struct list_head{
        struct list_head* prev;
        struct list_head* next;
    };
</code></pre>
<p>&emsp;对于其他自定义的结构体，通过添加struct list_head类型的成员，从而获得指向前后元素的指针。并且为了通过链表指针找到父结构中包含的任何变量，linux定义了container_of宏，其可以从结构体成员获取结构体的地址，因为在C语言中，一个给定结构中的变量偏移在编译时地址就被ABI固定下来，这个偏移可以通过offsetof获得。  </p>
<pre><code class="language-C">    #define offsetof(TYPE, MEMBER) ((size_t) &amp;((TYPE *)0)-&gt;MEMBER)

    #define container_of(ptr, type, member) ({                   \
        const typeof( ( (type*)0)-&gt;member )* __mptr=(ptr);       \
        (type*) ( (char*)_mptr - offsetof(type, member) );})     \

    #define list_entry(ptr, type, member)\
        container_of(ptr, type, member)
</code></pre>
<p>&emsp;ptr（type的成员的地址），type（结构体类型），member（成员的名称)；<br />
&emsp;offsetof把0地址强制转化成了TYPE*类型，然后将它的MEMBER成员的地址转化为size_t类型。也就是说如果一个类型为TYPE的结 构体地址从0开始，那么它的MEMBER成员的地址就是MEMBER成员与TYPE类型地址之间的相对偏移量（以char计数的）；<br />
&emsp;container_of定义中第一行通过typeof取得member的类型，然后__mptr是member类型的指向ptr地址的常量指针，这里的主要目的是为了对ptr与member做类型检查,如果用typeof求出来的类型和ptr不一致，那么在赋值操作时，编译器会报错；<br />
&emsp;第二行，在取得了member的地址之后，只要把它减去member相对于结构体的偏移量，就可以得到结构体的地址了。最后，再把这个地址转化成type*，就完成了整个逻辑。<br />
&emsp;依靠list_entry方法，内核提供了创建、操作等管理链表的各种方法，而这些方法并不需知道list_head所嵌入对象的数据结构。  </p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
