{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to WH's Blog Description \u5173\u4e8eC++\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u8ba1\u7b97\u673a\u7f51\u7edc\u3001\u6570\u636e\u7ed3\u6784\u7684\u4e00\u4e9b\u5b66\u4e60\u8bb0\u5f55 For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to WH's Blog"},{"location":"#welcome-to-whs-blog","text":"","title":"Welcome to WH's Blog"},{"location":"#description","text":"\u5173\u4e8eC++\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u8ba1\u7b97\u673a\u7f51\u7edc\u3001\u6570\u636e\u7ed3\u6784\u7684\u4e00\u4e9b\u5b66\u4e60\u8bb0\u5f55 For full documentation visit mkdocs.org .","title":"Description"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"home/","text":"Welcome to WH's Blog Description \u5173\u4e8eC++\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u8ba1\u7b97\u673a\u7f51\u7edc\u3001\u6570\u636e\u7ed3\u6784\u7684\u4e00\u4e9b\u5b66\u4e60\u8bb0\u5f55","title":"Welcome to WH's Blog"},{"location":"home/#welcome-to-whs-blog","text":"","title":"Welcome to WH's Blog"},{"location":"home/#description","text":"\u5173\u4e8eC++\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u8ba1\u7b97\u673a\u7f51\u7edc\u3001\u6570\u636e\u7ed3\u6784\u7684\u4e00\u4e9b\u5b66\u4e60\u8bb0\u5f55","title":"Description"},{"location":"interview/","text":"\u9762\u8bd5\u9898 \u6d77\u91cf\u6570\u636e\u6392\u5e8f\uff0c\u5bfb\u627eTOPK","title":"\u9762\u8bd5"},{"location":"interview/#_1","text":"\u6d77\u91cf\u6570\u636e\u6392\u5e8f\uff0c\u5bfb\u627eTOPK","title":"\u9762\u8bd5\u9898"},{"location":"DataStruct/API/","text":"API C++ string //\u81ea\u8eab\u7279\u6027\u65b9\u9762\u7684API \u3000\u30001\u3001int capacity()\uff1a\u8fd4\u56de\u5f53\u524d\u5bb9\u91cf\u3010\u5373string\u4e2d\u5728\u4e0d\u9700\u8981\u589e\u52a0\u5185\u5b58\u7684\u60c5\u51b5\u4e0b\u8fd8\u53ef\u5b58\u653e\u7684\u5143\u7d20\u4e2a\u6570\u3011\u3002 \u3000\u30002\u3001int max_size()\uff1a\u8fd4\u56destring\u5bf9\u8c61\u4e2d\u53ef\u5b58\u653e\u7684\u6700\u5927\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 \u3000\u30003\u3001int size()\uff1a\u8fd4\u56de\u5f53\u524d\u5b57\u7b26\u4e32\u7684\u5927\u5c0f \u3000\u30004\u3001int length()\uff1a\u8fd4\u56de\u5f53\u524d\u5b57\u7b26\u4e32\u7684\u957f\u5ea6 \u3000\u30005\u3001bool empty()\uff1a\u5224\u65ad\u5f53\u524d\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a \u3000\u30006\u3001void resize(int len, char c)\uff1a\u628a\u5b57\u7b26\u4e32\u5f53\u524d\u5927\u5c0f\u8bbe\u7f6e\u4e3alen\uff0c\u591a\u53bb\u5c11\u8865\uff0c\u5b57\u7b26c\u586b\u5145\u4e0d\u8db3\u7684\u90e8\u5206 //\u5173\u4e8e\u67e5\u627e 1\u3001size_type find ( const string &str, size_type index ) \u3000\u3000\u529f\u80fd\u4ecb\u7ecd\uff1a\u8fd4\u56destr\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u4eceindex\u5f00\u59cb\u67e5\u627e\uff0c\u5982\u679c\u67e5\u627e\u5931\u8d25\uff0c\u5219\u8fd4\u56destring::npos\u3002 \u3000\u3000size_type find( const char *str, size_type index, size_type length )\uff1a \u8fd4\u56destr\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff08\u4eceindex\u5f00\u59cb\u67e5\u627e\uff0c\u957f\u5ea6\u4e3alength\uff09\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5c31\u8fd4\u56destring::npos\u3002 \u3000\u3000size_type find( char ch, size_type index )\uff1a\u8fd4\u56de\u5b57\u7b26ch\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff08\u4eceindex\u5f00\u59cb\u67e5\u627e\uff09\uff0c \u5982\u679c\u6ca1\u627e\u5230\u5c31\u8fd4\u56destring::npos\u3002 \u3000\u3000//\u4ee5\u4e0a\u7684\u67e5\u627e\u529f\u80fd\u90fd\u662f\u6309\u7167\u4ece\u524d\u5f80\u540e\u7684\u987a\u5e8f\u8fdb\u884c\u67e5\u627e\uff0c\u5982\u679c\u60f3\u8981\u6309\u7167\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u67e5\u627e\u7684\u8bdd\uff0c\u53ef\u4ee5\u7528\"rfind\"\u8bed\u53e5\u3002 \u3000\u30002\u3001size_type find_first_of ( const string& str, size_type pos = 0 ) \u3000\u3000\u3000\u529f\u80fd\u4ecb\u7ecd\uff1a\u8fd4\u56destr\u4e2d\u4efb\u610f\u5b57\u7b26\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u4ece\u4f4d\u7f6e0\u5f00\u59cb\u67e5\u627e\u3002 \u3000\u3000\u3000size_type find_first_of ( const char* s, size_type pos, size_t n ) \u3000\u3000\u3000size_type find_first_of ( const char* s, size_type pos = 0 ) \u3000\u3000\u3000size_type find_first_of ( char c, size_type pos = 0 ) \u3000\u30003\u3001find_first_not_of\u529f\u80fd\u4e0efind_first_of()\u51fd\u6570\u7684\u529f\u80fd\u6b63\u597d\u76f8\u53cd\u3002 \u3000\u30004\u3001find_last_of \u3000\u3000\u4e0efind_first_of()\u51fd\u6570\u76f8\u6bd4\u800c\u8a00\uff0c\u5176\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff1afind_last_of()\u662f\u627e\u51fa\u6700\u540e\u4e00\u4e2a\u76f8\u540c\u7684\u4f4d\u7f6e\u3002 \u3000\u30005\u3001find_last_not_of \u4e0efind_last_of()\u529f\u80fd\u51fd\u6570\u6b63\u597d\u76f8\u53cd\u3002 //\u5176\u4ed6\u65b9\u9762\u7684\u51fd\u6570 \u3000\u30001\u3001string &insert(int p,const string &s)\uff1a\u5728p\u4f4d\u7f6e\u63d2\u5165\u5b57\u7b26\u4e32s \u3000\u30002\u3001string &replace(int p, int n,const char *s)\uff1a\u5220\u9664\u4ecep\u5f00\u59cb\u7684n\u4e2a\u5b57\u7b26\uff0c\u7136\u540e\u5728p\u5904\u63d2\u5165\u5b57\u7b26\u4e32s \u3000\u30003\u3001string &erase(int p, int n)\uff1a\u5220\u9664p\u5f00\u59cb\u7684n\u4e2a\u5b57\u7b26\uff0c\u8fd4\u56de\u4fee\u6539\u540e\u7684\u5b57\u7b26\u4e32 \u3000\u30004\u3001string substr(int pos, int n )\uff1a\u8fd4\u56depos\u5f00\u59cb\u7684n\u4e2a\u5b57\u7b26\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 \u3000\u30005\u3001void swap(string &s2)\uff1a\u4ea4\u6362\u5f53\u524d\u5b57\u7b26\u4e32\u4e0es2\u7684\u503c \u3000\u30006\u3001string &append(const char *s)\uff1a\u628a\u5b57\u7b26\u4e32s\u8fde\u63a5\u5230\u5f53\u524d\u5b57\u7b26\u4e32\u7ed3\u5c3e \u3000\u30007\u3001void push_back(char c)\uff1a\u5f53\u524d\u5b57\u7b26\u4e32\u5c3e\u90e8\u52a0\u4e00\u4e2a\u5b57\u7b26c \u3000\u30008\u3001const char *data()\uff1a\u8fd4\u56de\u4e00\u4e2a\u975enull\u7ec8\u6b62\u7684c\u5b57\u7b26\u6570\u7ec4\uff0c \u3000\u30009\u3001const char *c_str()\uff1a\u8fd4\u56de\u4e00\u4e2a\u4ee5null\u7ec8\u6b62\u7684c\u5b57\u7b26\u4e32\uff0c\u5373c_str()\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u6b63\u89c4C\u5b57\u7b26\u4e32\u7684\u6307\u9488, \u5185\u5bb9\u4e0e\u672cstring\u4e32\u76f8\u540c,\u7528\u4e8estring\u8f6cconst char* C string 1\u3001strcpy(char* s1, const char*s2)\uff1a\u590d\u5236\u5b57\u7b26\u4e32s2\u5230s1\u3002 \u3000\u30002\u3001strcat(char* s1, const char* s2)\uff1a\u8fde\u63a5\u5b57\u7b26\u4e32s2\u5230\u5b57\u7b26\u4e32s1\u7684\u672b\u5c3e\u3010\u5982\u679c\u5728\u8fdb\u884c\u8fde\u63a5\u64cd\u4f5c\u4e4b\u540e\uff0c s1\u7684\u957f\u5ea6\u8d85\u8fc7\u7684s1\u7684buffer size\uff0c\u7f16\u8bd1\u4f1a\u51fa\u9519\u3011\u3002 \u3000\u30003\u3001strlen(const char* s1)\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32s1\u7684\u957f\u5ea6\uff08int\uff09\u3002 \u3000\u30004\u3001strcmp(const char* s1, const char* s2)\uff1a\u6bd4\u8f83\u5b57\u7b26\u4e32s1\u548cs2\uff0c\u5982\u679c\u4e8c\u8005\u662f\u76f8\u540c\u7684\uff0c\u8fd4\u56de0\uff1b \u5982\u679cs1 < s2\uff0c\u8fd4\u56de\u503c\u5c0f\u4e8e0\uff1b\u5982\u679cs1 > s2\uff0c\u8fd4\u56de\u503c\u5927\u4e8e0\u3002 \u3000\u30005\u3001strchr(char* s1, int ch)\uff1a\u8fd4\u56de\u4e00\u4e2a\u6307\u9488\uff08char *\uff09\uff0c\u6307\u5411\u7684\u662f\u5728\u5b57\u7b26\u4e32s1\u4e2d\u5b57\u7b26ch\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002 \u3000\u30006\u3001strstr(const char* s1, const char* s2)\uff1a\u8fd4\u56de\u4e00\u4e2a\u6307\u9488\uff08char *\uff09\uff0c\u6307\u5411\u5b57\u7b26\u4e32s1\u4e2d\u5b57\u7b26\u4e32s2\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002","title":"API"},{"location":"DataStruct/API/#api","text":"","title":"API"},{"location":"DataStruct/API/#c-string","text":"//\u81ea\u8eab\u7279\u6027\u65b9\u9762\u7684API \u3000\u30001\u3001int capacity()\uff1a\u8fd4\u56de\u5f53\u524d\u5bb9\u91cf\u3010\u5373string\u4e2d\u5728\u4e0d\u9700\u8981\u589e\u52a0\u5185\u5b58\u7684\u60c5\u51b5\u4e0b\u8fd8\u53ef\u5b58\u653e\u7684\u5143\u7d20\u4e2a\u6570\u3011\u3002 \u3000\u30002\u3001int max_size()\uff1a\u8fd4\u56destring\u5bf9\u8c61\u4e2d\u53ef\u5b58\u653e\u7684\u6700\u5927\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 \u3000\u30003\u3001int size()\uff1a\u8fd4\u56de\u5f53\u524d\u5b57\u7b26\u4e32\u7684\u5927\u5c0f \u3000\u30004\u3001int length()\uff1a\u8fd4\u56de\u5f53\u524d\u5b57\u7b26\u4e32\u7684\u957f\u5ea6 \u3000\u30005\u3001bool empty()\uff1a\u5224\u65ad\u5f53\u524d\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a \u3000\u30006\u3001void resize(int len, char c)\uff1a\u628a\u5b57\u7b26\u4e32\u5f53\u524d\u5927\u5c0f\u8bbe\u7f6e\u4e3alen\uff0c\u591a\u53bb\u5c11\u8865\uff0c\u5b57\u7b26c\u586b\u5145\u4e0d\u8db3\u7684\u90e8\u5206 //\u5173\u4e8e\u67e5\u627e 1\u3001size_type find ( const string &str, size_type index ) \u3000\u3000\u529f\u80fd\u4ecb\u7ecd\uff1a\u8fd4\u56destr\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u4eceindex\u5f00\u59cb\u67e5\u627e\uff0c\u5982\u679c\u67e5\u627e\u5931\u8d25\uff0c\u5219\u8fd4\u56destring::npos\u3002 \u3000\u3000size_type find( const char *str, size_type index, size_type length )\uff1a \u8fd4\u56destr\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff08\u4eceindex\u5f00\u59cb\u67e5\u627e\uff0c\u957f\u5ea6\u4e3alength\uff09\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5c31\u8fd4\u56destring::npos\u3002 \u3000\u3000size_type find( char ch, size_type index )\uff1a\u8fd4\u56de\u5b57\u7b26ch\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff08\u4eceindex\u5f00\u59cb\u67e5\u627e\uff09\uff0c \u5982\u679c\u6ca1\u627e\u5230\u5c31\u8fd4\u56destring::npos\u3002 \u3000\u3000//\u4ee5\u4e0a\u7684\u67e5\u627e\u529f\u80fd\u90fd\u662f\u6309\u7167\u4ece\u524d\u5f80\u540e\u7684\u987a\u5e8f\u8fdb\u884c\u67e5\u627e\uff0c\u5982\u679c\u60f3\u8981\u6309\u7167\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u67e5\u627e\u7684\u8bdd\uff0c\u53ef\u4ee5\u7528\"rfind\"\u8bed\u53e5\u3002 \u3000\u30002\u3001size_type find_first_of ( const string& str, size_type pos = 0 ) \u3000\u3000\u3000\u529f\u80fd\u4ecb\u7ecd\uff1a\u8fd4\u56destr\u4e2d\u4efb\u610f\u5b57\u7b26\u5728\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u4ece\u4f4d\u7f6e0\u5f00\u59cb\u67e5\u627e\u3002 \u3000\u3000\u3000size_type find_first_of ( const char* s, size_type pos, size_t n ) \u3000\u3000\u3000size_type find_first_of ( const char* s, size_type pos = 0 ) \u3000\u3000\u3000size_type find_first_of ( char c, size_type pos = 0 ) \u3000\u30003\u3001find_first_not_of\u529f\u80fd\u4e0efind_first_of()\u51fd\u6570\u7684\u529f\u80fd\u6b63\u597d\u76f8\u53cd\u3002 \u3000\u30004\u3001find_last_of \u3000\u3000\u4e0efind_first_of()\u51fd\u6570\u76f8\u6bd4\u800c\u8a00\uff0c\u5176\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff1afind_last_of()\u662f\u627e\u51fa\u6700\u540e\u4e00\u4e2a\u76f8\u540c\u7684\u4f4d\u7f6e\u3002 \u3000\u30005\u3001find_last_not_of \u4e0efind_last_of()\u529f\u80fd\u51fd\u6570\u6b63\u597d\u76f8\u53cd\u3002 //\u5176\u4ed6\u65b9\u9762\u7684\u51fd\u6570 \u3000\u30001\u3001string &insert(int p,const string &s)\uff1a\u5728p\u4f4d\u7f6e\u63d2\u5165\u5b57\u7b26\u4e32s \u3000\u30002\u3001string &replace(int p, int n,const char *s)\uff1a\u5220\u9664\u4ecep\u5f00\u59cb\u7684n\u4e2a\u5b57\u7b26\uff0c\u7136\u540e\u5728p\u5904\u63d2\u5165\u5b57\u7b26\u4e32s \u3000\u30003\u3001string &erase(int p, int n)\uff1a\u5220\u9664p\u5f00\u59cb\u7684n\u4e2a\u5b57\u7b26\uff0c\u8fd4\u56de\u4fee\u6539\u540e\u7684\u5b57\u7b26\u4e32 \u3000\u30004\u3001string substr(int pos, int n )\uff1a\u8fd4\u56depos\u5f00\u59cb\u7684n\u4e2a\u5b57\u7b26\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 \u3000\u30005\u3001void swap(string &s2)\uff1a\u4ea4\u6362\u5f53\u524d\u5b57\u7b26\u4e32\u4e0es2\u7684\u503c \u3000\u30006\u3001string &append(const char *s)\uff1a\u628a\u5b57\u7b26\u4e32s\u8fde\u63a5\u5230\u5f53\u524d\u5b57\u7b26\u4e32\u7ed3\u5c3e \u3000\u30007\u3001void push_back(char c)\uff1a\u5f53\u524d\u5b57\u7b26\u4e32\u5c3e\u90e8\u52a0\u4e00\u4e2a\u5b57\u7b26c \u3000\u30008\u3001const char *data()\uff1a\u8fd4\u56de\u4e00\u4e2a\u975enull\u7ec8\u6b62\u7684c\u5b57\u7b26\u6570\u7ec4\uff0c \u3000\u30009\u3001const char *c_str()\uff1a\u8fd4\u56de\u4e00\u4e2a\u4ee5null\u7ec8\u6b62\u7684c\u5b57\u7b26\u4e32\uff0c\u5373c_str()\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u6b63\u89c4C\u5b57\u7b26\u4e32\u7684\u6307\u9488, \u5185\u5bb9\u4e0e\u672cstring\u4e32\u76f8\u540c,\u7528\u4e8estring\u8f6cconst char*","title":"C++ string"},{"location":"DataStruct/API/#c-string_1","text":"1\u3001strcpy(char* s1, const char*s2)\uff1a\u590d\u5236\u5b57\u7b26\u4e32s2\u5230s1\u3002 \u3000\u30002\u3001strcat(char* s1, const char* s2)\uff1a\u8fde\u63a5\u5b57\u7b26\u4e32s2\u5230\u5b57\u7b26\u4e32s1\u7684\u672b\u5c3e\u3010\u5982\u679c\u5728\u8fdb\u884c\u8fde\u63a5\u64cd\u4f5c\u4e4b\u540e\uff0c s1\u7684\u957f\u5ea6\u8d85\u8fc7\u7684s1\u7684buffer size\uff0c\u7f16\u8bd1\u4f1a\u51fa\u9519\u3011\u3002 \u3000\u30003\u3001strlen(const char* s1)\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32s1\u7684\u957f\u5ea6\uff08int\uff09\u3002 \u3000\u30004\u3001strcmp(const char* s1, const char* s2)\uff1a\u6bd4\u8f83\u5b57\u7b26\u4e32s1\u548cs2\uff0c\u5982\u679c\u4e8c\u8005\u662f\u76f8\u540c\u7684\uff0c\u8fd4\u56de0\uff1b \u5982\u679cs1 < s2\uff0c\u8fd4\u56de\u503c\u5c0f\u4e8e0\uff1b\u5982\u679cs1 > s2\uff0c\u8fd4\u56de\u503c\u5927\u4e8e0\u3002 \u3000\u30005\u3001strchr(char* s1, int ch)\uff1a\u8fd4\u56de\u4e00\u4e2a\u6307\u9488\uff08char *\uff09\uff0c\u6307\u5411\u7684\u662f\u5728\u5b57\u7b26\u4e32s1\u4e2d\u5b57\u7b26ch\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002 \u3000\u30006\u3001strstr(const char* s1, const char* s2)\uff1a\u8fd4\u56de\u4e00\u4e2a\u6307\u9488\uff08char *\uff09\uff0c\u6307\u5411\u5b57\u7b26\u4e32s1\u4e2d\u5b57\u7b26\u4e32s2\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002","title":"C string"},{"location":"DataStruct/Algorithm/","text":"Algorithm Binary Search //\u4e8c\u5206\u67e5\u627e, vec\u9012\u589e\uff0c int binarySerach(std::vector<int> &vec, int target){ if(vec.size()==0 || target<vec[0] || target>vec[vec.size()-1])return -1; int left=0, right=vec.size()-1; while(left<=right){ int mid=left+(right-left)/2; if(target==vec[mid])return mid; else if(vec[mid] < target) left=mid+1; else if(vec[mid] > target) right=mid-1; } return -1; } // \u4e8c\u5206\u67e5\u627e\uff0c\u5bfb\u627e\u5de6\u4fa7\u8fb9\u754c, \u5373\u6700\u5de6\u8fb9\u7684target int binarySearchLSide(std::vector<int>& vec, int target){ if(vec.size()==0 || target<vec[0] || target>vec[vec.size()-1])return -1; int left=0, right=vec.size()-1; while(left<=right){ int mid=left+(right-left)/2; if(target==vec[mid])right=mid-1; //\u6536\u7f29\u53f3\u4fa7\u8fb9\u754c\uff0c\u9501\u5b9a\u5de6\u4fa7 else if(vec[mid] < target) left=mid+1; else if(vec[mid] > target) right=mid-1; } if(left>=vec.size() || vec[left]!=target) return -1; return left; } // \u4e8c\u5206\u67e5\u627e\uff0c\u5bfb\u627e\u53f3\u4fa7\u8fb9\u754c\uff0c\u5373\u6700\u53f3\u8fb9\u7684target int binarySearchRSide(std::vector<int>& vec, int target){ if(vec.size()==0 || target<vec[0] || target>vec[vec.size()-1])return -1; int left=0, right=vec.size()-1; while(left<=right){ //\u7ed3\u675f\u5faa\u73af\u6761\u4ef6 right=left-1 int mid=left+(right-left)/2; if(target==vec[mid])left=mid+1; //\u6536\u7f29\u5de6\u4fa7\u8fb9\u754c\uff0c\u9501\u5b9a\u53f3\u4fa7 else if(vec[mid] < target) left=mid+1; else if(vec[mid] > target) right=mid-1; } if(right<0 || vec[right]!=target) return -1; else return right; } \u6811\u5f62DP vector<int> num_son; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 vector<vector<int>> sons; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u8282\u70b9 vector<int> w; //\u5b58\u50a8\u5feb\u4e50\u6307\u6570 vector<bool> father; //\u8be5\u8282\u70b9\u662f\u5426\u6709\u7236\u8282\u70b9 void dfs(int root, vector<vector<int>>& dp){ dp[root][1] = w[root]; for(int i=0;i<num_son[root];i++){ int son = sons[root][i]; dfs(son, dp); dp[root][1] += dp[son][0]; dp[root][0] += max(dp[son][0], dp[son][1]); } } int main(){ int N; cin >> N; num_son.resize(N); sons.resize(N); w.resize(N); father.resize(N); vector<vector<int>> dp(N, vector<int>(2)); for(int i=0;i<N;i++)cin >> w[i]; //\u8f93\u5165\u5b50\u8282\u70b9\u548c\u5176\u7236\u8282\u70b9\uff0c0~N-1 for(int i=0;i<N-1;i++){ int x, y; //x\u4e3a\u5b50\u8282\u70b9\uff0cy\u4e3a\u7236\u8282\u70b9 cin>>x>>y; num_son[y]++; sons[y].push_back(x); father[x]=true; } int root=0; while(father[root])root++; dfs(root, dp); cout<<\"result:\"<<max(dp[root][0], dp[root][1])<<endl; return 0; } \u5b9e\u73b0shuffle \u2003\u8981\u53d6\u5f97 [a,b] \u7684\u968f\u673a\u6574\u6570\uff0c\u4f7f\u7528 (rand() % (b-a+1)) + a; \u2003\u8981\u53d6\u5f97 (a,b] \u7684\u968f\u673a\u6574\u6570\uff0c\u4f7f\u7528 (rand() % (b-a)) +a+1; #define randInt(a, b) ((rand()%(b-a+1))+a) //\u4ea7\u751f[a, b]\u4e4b\u95f4\u7684\u968f\u673a\u6574\u6570 int N=20; vector<int> vec(N); for(int i=0;i<N;i++)vec[i]=i; void shuffle(vector<int>& vec){ srand((unsigned)time(NULL)); //\u91c7\u7528\u65f6\u95f4\u4f5c\u4e3a\u968f\u673a\u6570\u79cd\u5b50 for(int i=N-1;i>0;i--){ // i>0\u4e0ei>=0\u6548\u679c\u4e00\u81f4 int j = randInt(0, i); swap(vec[i], vec[j]); } //\u4e0b\u9762\u4ea6\u53ef // for(int i=0;i<N;i++) // i<N\u4e0ei<N-1, \u6548\u679c\u4e00\u81f4\uff0c // { // int j = randInt(i, N-1); // swap(vec[i], vec[j]); // } } \u2003\u5982\u4f55\u9a8c\u8bc1shuffle\u6548\u679c: \u2003\u9996\u5148\u7b97\u6cd5\u4ea7\u751f\u7684\u7ed3\u679c\u5fc5\u987b\u6709N!\u79cd\uff0c\u5176\u6b21\u5bf9\u4e8e\u6bcf\u79cd\u53ef\u80fd\u51fa\u73b0\u7684\u7ed3\u679c\u7684\u6982\u7387\u5fc5\u987b\u76f8\u7b49\u3002 \u2003\u9488\u5bf9\u5e8f\u52170~N-1\uff0c\u6267\u884cM\u6b21(\u59821\u4e07\u6b21\u6216\u5341\u4e07\u6b21)shuffle\u7b97\u6cd5\uff0c\u8bb0\u5f55\u5404\u79cd\u7ed3\u679c\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u5404\u79cd\u7ed3\u679c\u7684\u7684\u51fa\u73b0\u6b21\u6570\u5e94\u63a5\u8fd11/N!\uff0c\u8fd9\u91ccN\u4e00\u822c\u53d6\u4e2a\u6bd4\u8f83\u5c0f\u7684\u6570\uff0c\u59825\u62166; \u2003\u6216\u8005\u8ba9\u6570\u7ec4\u4e2d\u53ea\u6709\u67d0\u4e00\u4f4d\u4e3a1\uff0c\u5176\u4f59\u4f4d\u4e3a0\uff0c\u4f9d\u65e7\u6267\u884cM\u6b21shuffle\u7b97\u6cd5\uff0c\u8bb0\u5f551\u51fa\u73b0\u57280~N-1\u4f4d\u4e0a\u7684\u6b21\u6570\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u51fa\u73b0\u6b21\u6570\u5e94\u8be5\u63a5\u8fd1\u3002 void testShuffle(){ vector<int> vec{1, 0, 0, 0, 0}; int M=10000; vector<int> res(5); for(int i=0;i<M;i++){ shuffle(vec); int j=0; while(vec[j]==0)j++; res[j]++; } for(auto& v:res){ cout<<v<<\" \"; } } \u7ea6\u745f\u592b\u73af //0,1,\u00b7\u00b7\u00b7,n-1\u8fd9n\u4e2a\u6570\u5b57\u6392\u6210\u4e00\u4e2a\u5706\u5708\uff0c //\u4ece\u6570\u5b570\u5f00\u59cb\uff0c\u6bcf\u6b21\u4ece\u8fd9\u4e2a\u5706\u5708\u91cc\u5220\u9664\u7b2cM\u4e2a\u6570\u5b57\uff08\u5220\u9664\u540e\u4ece\u4e0b\u4e00\u4e2a\u6570\u5b57\u5f00\u59cb\u8ba1\u6570\uff09\u3002 //\u8fd9\u91cc\u6253\u5370\u7684\u662f\u5220\u9664\u987a\u5e8f\uff0c\u4e0b\u6807\u57fa1 void Josephus2_1(int M, int N){ int a[N+1]; //\u5b58\u653e\u6307\u9488\uff0ca[i]\u5b58\u653e\u7740\u4e0b\u4e00\u4e2a\u5143\u7d20 int b[N+1]; //\u51fa\u94fe\u987a\u5e8f int i, j, k; for(int i=1;i<N;i++)a[i]=i+1; a[N]=1; //\u5f62\u6210\u95ed\u73af k=1; j=N; for(i=1;i<=N;i++){ while(k<M){ j=a[j]; //\u79fb\u52a8\u6307\u9488 k++; } b[i]=a[j]; a[j] = a[a[j]]; k=1; printf(\"%dout a[%d]=%d\\n\", b[i], j, a[j]); } for(int i=1;i<=N;i++)std::cout<<b[i]<<\" \"; //cout<<b[i]-1, \u53ef\u4ee5\u57fa0 std::cout<<std::endl; } //\u8fd9\u91cc\u4ec5\u6c42\u51fa\u8fd9\u4e2a\u5706\u5708\u91cc\u5269\u4e0b\u7684\u6700\u540e\u4e00\u4e2a\u6570\u5b57 void Josephus3(int M, int N){ int f=0; for(int i=2;i<=N;i++) f = (f+M)%i; std::cout<<f<<std::endl; } \u5341\u8fdb\u5236\u8f6c\u6362 \u2003\u8f97\u8f6c\u76f8\u9664\u6cd5 void trans(int target, int num){ //\u89c4\u5b9a\u8f93\u51fa\u8d1f\u6570\u7684num\u8fdb\u5236\u5f62\u5f0f\u4e3a \u201c-\u201d+abs(target)\u7684num\u8fdb\u5236 stack<int> st; bool neg=false; if(target<0){ target*=-1; neg=true; } do{ st.push(target%num); target /= num; }while(target!=0); if(neg)cout<<\"-\"; while(!st.empty()){ cout<<st.top(); st.pop(); } } \u5feb\u901f\u9009\u62e9\u6cd5 // \u5bfb\u627e\u7b2cK\u5927\u5143\u7d20\uff0c\u4e5f\u53ef\u7528\u4e8e\u8ba1\u7b97TOPK\uff0c class Solution { public: int findKth(vector<int> vec, int n, int k) { // write code here int left=0, right=n-1; k = n-k; // \u8fd9\u91cc\u4fee\u6539 k=k-1; \u5219\u6c42\u5f97\u5c31\u662f\u7b2ck\u5c0f\u7684\u5143\u7d20 int pos=0; while(true){ pos = quickFind(vec, left, right); if(pos==k)break; else if(pos < k)left=pos+1; else right=pos-1; } return vec[pos]; //\u6b64\u65f6\u4f4d\u7f6e>=pos\u7684\u5143\u7d20\uff0c\u5373\u4e3aTOPK\uff0c\u6574\u4e2a\u6570\u7ec4\u662f\u6309\u589e\u5e8f\u8fdb\u884c\u5feb\u6392\u7684 } private: void median3(vector<int>& vec, int left, int right){ int mid = (left+right)/2; if(vec[mid] < vec[left]) swap(vec[mid], vec[left]); if(vec[right] < vec[left])swap(vec[left], vec[right]); if(vec[mid] > vec[right])swap(vec[mid], vec[right]); swap(vec[mid], vec[right-1]); } int quickFind(vector<int>& vec, int left, int right){ if(left==right)return left; else if(left+2<=right){ median3(vec, left, right); int pivot=vec[right-1]; int i=left, j=right-1; while(true){ while(vec[++i] < pivot); while(vec[--j] > pivot); if(i<j)swap(vec[i], vec[j]); else break; } swap(vec[i], vec[right-1]); return i; }else{ if(vec[left]>vec[right]) swap(vec[left], vec[right]); return left; } } }; LRU // \u624b\u52a8\u5b9e\u73b0\u53cc\u5411\u94fe\u8868 struct DNode{ int key, val; DNode* next, *prev; DNode(int k, int v):key(k), val(v), next(nullptr), prev(nullptr){} }; class DoubleList{ //\u9760\u8fd1\u94fe\u8868\u5c3e\u90e8\u7684\u6570\u636e\u8868\u793a\u6700\u8fd1\u4f7f\u7528\u7684 private: DNode* head, *tail; int _size; public: DoubleList():_size(0){ head = new DNode(0, 0); tail = new DNode(0, 0); head->next=tail; tail->prev=head; } void addLast(DNode* x){ x->prev=tail->prev; x->next=tail; tail->prev->next = x; tail->prev=x; _size++; } void remove(DNode* x, bool reuse){ //\u8981\u6c42x\u4e00\u5b9a\u5728\u94fe\u8868\u4e2d x->prev->next=x->next; x->next->prev = x->prev; _size--; if(!reuse) //\u56e0\u4e3ax\u8282\u70b9\u53ef\u80fd\u662f\u88ab\u6c38\u4e45\u5220\u9664\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u88ab\u79fb\u5230\u94fe\u8868\u5c3e delete x; } int removeFirst(){ if(head->next == tail)return 0; int key=head->next->key; remove(head->next, false); return key; } int size() const{return _size;} }; class LRUCache{ private: unordered_map<int, DNode*> umap; DoubleList cache; int cap; //\u6700\u5927\u5bb9\u91cf //\u5c06\u67d0\u4e2akey\u63d0\u5347\u4e3a\u6700\u8fd1\u4f7f\u7528\u7684 void makeRecently(int key){ DNode* x=umap[key]; cache.remove(x, true); cache.addLast(x); } //\u6dfb\u52a0\u6700\u8fd1\u4f7f\u7528\u7684 void addRecently(int key, int val){ DNode *x=new DNode(key, val); cache.addLast(x); umap[key] = x; } //\u5220\u9664\u67d0\u4e2akey void deleteKey(int key){ if(umap.count(key)==0)return; DNode *x=umap[key]; cache.remove(x, false); umap.erase(key); } //\u5220\u9664\u6700\u4e45\u672a\u4f7f\u7528\u7684 void removeLeastRecently(){ umap.erase(cache.removeFirst()); } public: LRUCache(int capacity): cap(capacity){} int get(int key){ if(umap.count(key)==0) return -1; makeRecently(key); //\u5c06\u8be5\u6570\u636e\u63d0\u5347\u4e3a\u6700\u8fd1\u4f7f\u7528 return umap[key]->val; } void put(int key, int val){ if(umap.count(key)){ // deleteKey(key); // addRecently(key, val); umap[key]->val = val; makeRecently(key); return; } if(cache.size() == cap) removeLeastRecently(); addRecently(key, val); } }; // \u501f\u7528list\u5bb9\u5668 typedef list<pair<int,int>>::iterator LPIter; // key-value typedef list<pair<int, int>> LP; class LRUCache{ private: int cap; unordered_map<int, LPIter> umap; LP cache; void makeRecently(int key){ LPIter iter = umap[key]; int value=iter->second; cache.erase(iter); cache.push_back(make_pair(key, value)); } void removeLeastRecently(){ LPIter iter = cache.begin(); umap.erase(iter->first); cache.pop_front(); } public: LRUCache(int capacity):cap(capacity){} int get(int key){ if(umap.count(key)==0)return -1; makeRecently(key); return (*umap[key]).second; } void set(int key, int value){ if(umap.count(key)!=0){ (*umap[key]).second = value; makeRecently(key); }else{ if(cache.size() == cap) removeLeastRecently(); cache.push_back(make_pair(key, value)); umap[key] = --cache.end(); } } }; LFU // \u624b\u52a8\u5b9e\u73b0\u53cc\u5411has\u94fe\u8868 struct DNode2{ int key; DNode2 *next, *prev; DNode2(int k):key(k){} }; class linkHash{ private: unordered_map<int, DNode2*> umap; DNode2 *head, *tail; int _size=0; public: linkHash(){ head = new DNode2(-1); tail=new DNode2(-1); head->next = tail; tail->prev=head; } ~linkHash(){ while(head){ DNode2 *tmp=head->next; delete head; head=tmp; } } void push_back(int key){//\u4ece\u5c3e\u90e8\u63d2\u5165\u6700\u65b0\u8bbf\u95ee\u7684 DNode2* x = new DNode2(key); umap[key]=x; x->prev = tail->prev; x->next = tail; tail->prev->next=x; tail->prev=x; _size++; } void remove(int key){ DNode2 *x=umap[key]; umap.erase(key); x->prev->next = x->next; x->next->prev = x->prev; delete x; _size--; } int removeFront(){//\u8fd4\u56de\u88ab\u5220\u9664\u8282\u70b9\u7684key DNode2 *x=head->next; int key = x->key; remove(key); return key; } int size()const {return _size;} }; class LFUCache { public: LFUCache(int capacity): cap(capacity) {} int get(int key) { if(key2VF.count(key)==0)return -1; increaseFre(key); return key2VF[key].first; } void put(int key, int value) { if(cap==0)return; if(key2VF.count(key)!=0){ key2VF[key].first=value; }else{ if(key2VF.size()==cap) deleteLeastFreqKey(); key2VF[key] = make_pair(value, 0); minFreq = 1; //\u63d2\u5165\u65b0\u8282\u70b9\u540e } increaseFre(key); } private: unordered_map<int, linkHash*> freq2key; // frequency -> list of key order by time unordered_map<int, pair<int, int>> key2VF; // key-> val+fre int cap=10; //\u9ed8\u8ba4\u503c int minFreq; void increaseFre(int key){ int oldFreq = key2VF[key].second++; int newFreq = key2VF[key].second; if(oldFreq!=0){ freq2key[oldFreq]->remove(key); if(freq2key[oldFreq]->size()==0) { freq2key.erase(oldFreq); if(oldFreq==minFreq)minFreq++; } } if(freq2key.count(newFreq)==0) freq2key[newFreq] = new linkHash(); freq2key[newFreq]->push_back(key); } void deleteLeastFreqKey(){ linkHash* x = freq2key[minFreq]; int key = x->removeFront(); if(x->size()==0) freq2key.erase(minFreq); key2VF.erase(key); } }; //\u501f\u52a9list\u5bb9\u5668 typedef list<int>::iterator LI; //key class LFUCache{ private: int cap, minFreq; unordered_map<int, pair<int, int>> key2VF; unordered_map<int, LI> key2iter; unordered_map<int, list<int> > freq2key; void increaseFreq(int key){ int oldFreq = key2VF[key].second++; int newFreq = key2VF[key].second; if(oldFreq!=0){ freq2key[oldFreq].erase(key2iter[key]); if(freq2key[oldFreq].size()==0){ freq2key.erase(oldFreq); if(oldFreq==minFreq)minFreq++; } } if(freq2key.count(newFreq)==0) freq2key[newFreq] = list<int>(); freq2key[newFreq].push_back(key); key2iter[key] = --freq2key[newFreq].end(); } void removeLeastFreqKey(){ int key=freq2key[minFreq].front(); key2iter.erase(key); key2VF.erase(key); freq2key[minFreq].pop_front(); if(freq2key[minFreq].size()==0) freq2key.erase(minFreq); } public: LFUCache(int capacity): cap(capacity){} void set(int key, int value){ if(cap==0)return; if(key2VF.count(key)!=0){ key2VF[key].first = value; }else{ if(key2VF.size() == cap) removeLeastFreqKey(); key2VF[key] = make_pair(value, 0); minFreq=1; } increaseFreq(key); } int get(int key){ if(key2VF.count(key)==0)return -1; increaseFreq(key); return key2VF[key].first; } }; KMP \u2003\u9012\u63a8\u6c42\u89e3next\u6570\u7ec4: \u5df2\u77e5next[j](\u5b50\u4e32P[0, j-1]\u4e2d\u524d\u7f00\u4e0e\u540e\u7f00\u7684\u4ea4\u96c6\u4e2d\u6700\u957f\u5143\u7d20\u957f\u5ea6), \u6c42\u89e3next[j+1]\u65f6\uff0c \u82e5P[next[j]] == P[j]\uff0c\u5219next[j+1]=next[j]+1=k+1; \u5426\u5219\u9700\u8981\u5bfb\u627e\u957f\u5ea6\u66f4\u77ed\u7684\u76f8\u540c\u524d\u7f00\u540e\u7f00, \u5373\u8ba9k=next[k]\uff0c\u8ba9\u65b0\u7684P[k]\u4e0eP[j]\u6bd4\u8f83\uff0c\u5982\u679ck==-1\uff0c\u5219next[j]=0\u3002 void getNext(std::vector<int>& next, string& p){ next[0] = -1; int j=0, k=-1; while(j<p.size()-1){ if(k==-1 || p[j]==p[k]){ j++; k++; next[j] = k; }else k = next[k]; } } int KMP(string& s, string& p){ if(p.size() == 0 || s.size()<p.size())return -1; vector<int> next(p.size()); /* \u4e0b\u6807\u4ece0\u5f00\u59cb: \u524d\u7f00\u5b50\u4e32\uff0c\u5373\u7531p[0, i]\uff080<=i<p.size()-2\uff09\u6784\u6210\u7684\u96c6\u5408 \u540e\u7f00\u5b50\u4e32\uff0c\u5373\u7531p[j, p.size()-1](1<=j<=p.size()-1)\u6784\u6210\u7684\u96c6\u5408 PMT:\u90e8\u5206\u5339\u914d\u8868 PMT[i]\u7684\u542b\u4e49\u662f\u4ee5p[i]\u5b57\u7b26\u7ed3\u5c3e\u7684\u540e\u7f00\u5b50\u4e32\u96c6\u5408\u4e2d\uff0c\u4e0e\u4ee5p[0]\u5b57\u7b26\u5f00\u5934\u7684\u524d\u7f00\u5b50\u4e32\u96c6\u5408\uff0c\u4e24\u8005\u4ea4\u96c6\u7684\u6700\u5927\u503c\uff1b \u5f53\u4e3b\u4e32\u6307\u9488\u6307\u5411i, \u6a21\u5f0f\u4e32\u6307\u5411j\u65f6\u53d1\u751f\u5931\u914d\uff0c\u53ef\u77e5s[i-j, i-1]\u4e0ep[0, j-1]\u662f\u76f8\u7b49\u7684\uff0c \u5219s[i-PMT[j-1], i-1]\u81ea\u7136\u4e0ep[0, PMT[j-1]-1]\u662f\u76f8\u7b49\u7684(\u5206\u522b\u662f\u6a21\u5f0f\u5b50\u4e32p[0, j]\u6709\u6700\u5927\u4ea4\u96c6\u7684\u540e\u7f00\u548c\u524d\u7f00, \u6700\u5927\u4ea4\u96c6\u7684\u957f\u5ea6\u5373\u4e3aPMT[j-1]) \u5219\u6b64\u65f6\u8ba9i\u4fdd\u6301\u4e0d\u53d8\uff0cj\u56de\u9000\u5230PMT[j-1]\u5373\u53ef \u4e3a\u4e86\u65b9\u4fbf\u7f16\u7a0b\uff0c\u91c7\u7528next\u6570\u7ec4\u4ee3\u66ffPMT\uff0c\u5c06PMT\u6570\u7ec4\u53f3\u79fb\u4e00\u4f4d\uff0c\u7b2c\u4e00\u4f4d\u7f6e\u4e3a-1(\u5373\u89c4\u5b9anext[0]=-1)\u5f62\u6210\uff0c \u8fd9\u6837j\u56de\u9000\u5230next[j]\u5373\u53ef */ getNext(next, p); int i=0, j=-1; int sLen = s.size(), pLen = p.size(); while(i<sLen && j<pLen){ if(j==-1 || s[i]==p[j]){ i++; j++; }else j=next[j]; } if(j==pLen)return i-j; else return -1; }","title":"Algorithm"},{"location":"DataStruct/Algorithm/#algorithm","text":"","title":"Algorithm"},{"location":"DataStruct/Algorithm/#binary-search","text":"//\u4e8c\u5206\u67e5\u627e, vec\u9012\u589e\uff0c int binarySerach(std::vector<int> &vec, int target){ if(vec.size()==0 || target<vec[0] || target>vec[vec.size()-1])return -1; int left=0, right=vec.size()-1; while(left<=right){ int mid=left+(right-left)/2; if(target==vec[mid])return mid; else if(vec[mid] < target) left=mid+1; else if(vec[mid] > target) right=mid-1; } return -1; } // \u4e8c\u5206\u67e5\u627e\uff0c\u5bfb\u627e\u5de6\u4fa7\u8fb9\u754c, \u5373\u6700\u5de6\u8fb9\u7684target int binarySearchLSide(std::vector<int>& vec, int target){ if(vec.size()==0 || target<vec[0] || target>vec[vec.size()-1])return -1; int left=0, right=vec.size()-1; while(left<=right){ int mid=left+(right-left)/2; if(target==vec[mid])right=mid-1; //\u6536\u7f29\u53f3\u4fa7\u8fb9\u754c\uff0c\u9501\u5b9a\u5de6\u4fa7 else if(vec[mid] < target) left=mid+1; else if(vec[mid] > target) right=mid-1; } if(left>=vec.size() || vec[left]!=target) return -1; return left; } // \u4e8c\u5206\u67e5\u627e\uff0c\u5bfb\u627e\u53f3\u4fa7\u8fb9\u754c\uff0c\u5373\u6700\u53f3\u8fb9\u7684target int binarySearchRSide(std::vector<int>& vec, int target){ if(vec.size()==0 || target<vec[0] || target>vec[vec.size()-1])return -1; int left=0, right=vec.size()-1; while(left<=right){ //\u7ed3\u675f\u5faa\u73af\u6761\u4ef6 right=left-1 int mid=left+(right-left)/2; if(target==vec[mid])left=mid+1; //\u6536\u7f29\u5de6\u4fa7\u8fb9\u754c\uff0c\u9501\u5b9a\u53f3\u4fa7 else if(vec[mid] < target) left=mid+1; else if(vec[mid] > target) right=mid-1; } if(right<0 || vec[right]!=target) return -1; else return right; }","title":"Binary Search"},{"location":"DataStruct/Algorithm/#dp","text":"vector<int> num_son; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u8282\u70b9\u4e2a\u6570 vector<vector<int>> sons; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u5b50\u8282\u70b9 vector<int> w; //\u5b58\u50a8\u5feb\u4e50\u6307\u6570 vector<bool> father; //\u8be5\u8282\u70b9\u662f\u5426\u6709\u7236\u8282\u70b9 void dfs(int root, vector<vector<int>>& dp){ dp[root][1] = w[root]; for(int i=0;i<num_son[root];i++){ int son = sons[root][i]; dfs(son, dp); dp[root][1] += dp[son][0]; dp[root][0] += max(dp[son][0], dp[son][1]); } } int main(){ int N; cin >> N; num_son.resize(N); sons.resize(N); w.resize(N); father.resize(N); vector<vector<int>> dp(N, vector<int>(2)); for(int i=0;i<N;i++)cin >> w[i]; //\u8f93\u5165\u5b50\u8282\u70b9\u548c\u5176\u7236\u8282\u70b9\uff0c0~N-1 for(int i=0;i<N-1;i++){ int x, y; //x\u4e3a\u5b50\u8282\u70b9\uff0cy\u4e3a\u7236\u8282\u70b9 cin>>x>>y; num_son[y]++; sons[y].push_back(x); father[x]=true; } int root=0; while(father[root])root++; dfs(root, dp); cout<<\"result:\"<<max(dp[root][0], dp[root][1])<<endl; return 0; }","title":"\u6811\u5f62DP"},{"location":"DataStruct/Algorithm/#shuffle","text":"\u8981\u53d6\u5f97 [a,b] \u7684\u968f\u673a\u6574\u6570\uff0c\u4f7f\u7528 (rand() % (b-a+1)) + a; \u2003\u8981\u53d6\u5f97 (a,b] \u7684\u968f\u673a\u6574\u6570\uff0c\u4f7f\u7528 (rand() % (b-a)) +a+1; #define randInt(a, b) ((rand()%(b-a+1))+a) //\u4ea7\u751f[a, b]\u4e4b\u95f4\u7684\u968f\u673a\u6574\u6570 int N=20; vector<int> vec(N); for(int i=0;i<N;i++)vec[i]=i; void shuffle(vector<int>& vec){ srand((unsigned)time(NULL)); //\u91c7\u7528\u65f6\u95f4\u4f5c\u4e3a\u968f\u673a\u6570\u79cd\u5b50 for(int i=N-1;i>0;i--){ // i>0\u4e0ei>=0\u6548\u679c\u4e00\u81f4 int j = randInt(0, i); swap(vec[i], vec[j]); } //\u4e0b\u9762\u4ea6\u53ef // for(int i=0;i<N;i++) // i<N\u4e0ei<N-1, \u6548\u679c\u4e00\u81f4\uff0c // { // int j = randInt(i, N-1); // swap(vec[i], vec[j]); // } } \u2003\u5982\u4f55\u9a8c\u8bc1shuffle\u6548\u679c: \u2003\u9996\u5148\u7b97\u6cd5\u4ea7\u751f\u7684\u7ed3\u679c\u5fc5\u987b\u6709N!\u79cd\uff0c\u5176\u6b21\u5bf9\u4e8e\u6bcf\u79cd\u53ef\u80fd\u51fa\u73b0\u7684\u7ed3\u679c\u7684\u6982\u7387\u5fc5\u987b\u76f8\u7b49\u3002 \u2003\u9488\u5bf9\u5e8f\u52170~N-1\uff0c\u6267\u884cM\u6b21(\u59821\u4e07\u6b21\u6216\u5341\u4e07\u6b21)shuffle\u7b97\u6cd5\uff0c\u8bb0\u5f55\u5404\u79cd\u7ed3\u679c\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u5404\u79cd\u7ed3\u679c\u7684\u7684\u51fa\u73b0\u6b21\u6570\u5e94\u63a5\u8fd11/N!\uff0c\u8fd9\u91ccN\u4e00\u822c\u53d6\u4e2a\u6bd4\u8f83\u5c0f\u7684\u6570\uff0c\u59825\u62166; \u2003\u6216\u8005\u8ba9\u6570\u7ec4\u4e2d\u53ea\u6709\u67d0\u4e00\u4f4d\u4e3a1\uff0c\u5176\u4f59\u4f4d\u4e3a0\uff0c\u4f9d\u65e7\u6267\u884cM\u6b21shuffle\u7b97\u6cd5\uff0c\u8bb0\u5f551\u51fa\u73b0\u57280~N-1\u4f4d\u4e0a\u7684\u6b21\u6570\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u51fa\u73b0\u6b21\u6570\u5e94\u8be5\u63a5\u8fd1\u3002 void testShuffle(){ vector<int> vec{1, 0, 0, 0, 0}; int M=10000; vector<int> res(5); for(int i=0;i<M;i++){ shuffle(vec); int j=0; while(vec[j]==0)j++; res[j]++; } for(auto& v:res){ cout<<v<<\" \"; } }","title":"\u5b9e\u73b0shuffle"},{"location":"DataStruct/Algorithm/#_1","text":"//0,1,\u00b7\u00b7\u00b7,n-1\u8fd9n\u4e2a\u6570\u5b57\u6392\u6210\u4e00\u4e2a\u5706\u5708\uff0c //\u4ece\u6570\u5b570\u5f00\u59cb\uff0c\u6bcf\u6b21\u4ece\u8fd9\u4e2a\u5706\u5708\u91cc\u5220\u9664\u7b2cM\u4e2a\u6570\u5b57\uff08\u5220\u9664\u540e\u4ece\u4e0b\u4e00\u4e2a\u6570\u5b57\u5f00\u59cb\u8ba1\u6570\uff09\u3002 //\u8fd9\u91cc\u6253\u5370\u7684\u662f\u5220\u9664\u987a\u5e8f\uff0c\u4e0b\u6807\u57fa1 void Josephus2_1(int M, int N){ int a[N+1]; //\u5b58\u653e\u6307\u9488\uff0ca[i]\u5b58\u653e\u7740\u4e0b\u4e00\u4e2a\u5143\u7d20 int b[N+1]; //\u51fa\u94fe\u987a\u5e8f int i, j, k; for(int i=1;i<N;i++)a[i]=i+1; a[N]=1; //\u5f62\u6210\u95ed\u73af k=1; j=N; for(i=1;i<=N;i++){ while(k<M){ j=a[j]; //\u79fb\u52a8\u6307\u9488 k++; } b[i]=a[j]; a[j] = a[a[j]]; k=1; printf(\"%dout a[%d]=%d\\n\", b[i], j, a[j]); } for(int i=1;i<=N;i++)std::cout<<b[i]<<\" \"; //cout<<b[i]-1, \u53ef\u4ee5\u57fa0 std::cout<<std::endl; } //\u8fd9\u91cc\u4ec5\u6c42\u51fa\u8fd9\u4e2a\u5706\u5708\u91cc\u5269\u4e0b\u7684\u6700\u540e\u4e00\u4e2a\u6570\u5b57 void Josephus3(int M, int N){ int f=0; for(int i=2;i<=N;i++) f = (f+M)%i; std::cout<<f<<std::endl; }","title":"\u7ea6\u745f\u592b\u73af"},{"location":"DataStruct/Algorithm/#_2","text":"\u8f97\u8f6c\u76f8\u9664\u6cd5 void trans(int target, int num){ //\u89c4\u5b9a\u8f93\u51fa\u8d1f\u6570\u7684num\u8fdb\u5236\u5f62\u5f0f\u4e3a \u201c-\u201d+abs(target)\u7684num\u8fdb\u5236 stack<int> st; bool neg=false; if(target<0){ target*=-1; neg=true; } do{ st.push(target%num); target /= num; }while(target!=0); if(neg)cout<<\"-\"; while(!st.empty()){ cout<<st.top(); st.pop(); } }","title":"\u5341\u8fdb\u5236\u8f6c\u6362"},{"location":"DataStruct/Algorithm/#_3","text":"// \u5bfb\u627e\u7b2cK\u5927\u5143\u7d20\uff0c\u4e5f\u53ef\u7528\u4e8e\u8ba1\u7b97TOPK\uff0c class Solution { public: int findKth(vector<int> vec, int n, int k) { // write code here int left=0, right=n-1; k = n-k; // \u8fd9\u91cc\u4fee\u6539 k=k-1; \u5219\u6c42\u5f97\u5c31\u662f\u7b2ck\u5c0f\u7684\u5143\u7d20 int pos=0; while(true){ pos = quickFind(vec, left, right); if(pos==k)break; else if(pos < k)left=pos+1; else right=pos-1; } return vec[pos]; //\u6b64\u65f6\u4f4d\u7f6e>=pos\u7684\u5143\u7d20\uff0c\u5373\u4e3aTOPK\uff0c\u6574\u4e2a\u6570\u7ec4\u662f\u6309\u589e\u5e8f\u8fdb\u884c\u5feb\u6392\u7684 } private: void median3(vector<int>& vec, int left, int right){ int mid = (left+right)/2; if(vec[mid] < vec[left]) swap(vec[mid], vec[left]); if(vec[right] < vec[left])swap(vec[left], vec[right]); if(vec[mid] > vec[right])swap(vec[mid], vec[right]); swap(vec[mid], vec[right-1]); } int quickFind(vector<int>& vec, int left, int right){ if(left==right)return left; else if(left+2<=right){ median3(vec, left, right); int pivot=vec[right-1]; int i=left, j=right-1; while(true){ while(vec[++i] < pivot); while(vec[--j] > pivot); if(i<j)swap(vec[i], vec[j]); else break; } swap(vec[i], vec[right-1]); return i; }else{ if(vec[left]>vec[right]) swap(vec[left], vec[right]); return left; } } };","title":"\u5feb\u901f\u9009\u62e9\u6cd5"},{"location":"DataStruct/Algorithm/#lru","text":"// \u624b\u52a8\u5b9e\u73b0\u53cc\u5411\u94fe\u8868 struct DNode{ int key, val; DNode* next, *prev; DNode(int k, int v):key(k), val(v), next(nullptr), prev(nullptr){} }; class DoubleList{ //\u9760\u8fd1\u94fe\u8868\u5c3e\u90e8\u7684\u6570\u636e\u8868\u793a\u6700\u8fd1\u4f7f\u7528\u7684 private: DNode* head, *tail; int _size; public: DoubleList():_size(0){ head = new DNode(0, 0); tail = new DNode(0, 0); head->next=tail; tail->prev=head; } void addLast(DNode* x){ x->prev=tail->prev; x->next=tail; tail->prev->next = x; tail->prev=x; _size++; } void remove(DNode* x, bool reuse){ //\u8981\u6c42x\u4e00\u5b9a\u5728\u94fe\u8868\u4e2d x->prev->next=x->next; x->next->prev = x->prev; _size--; if(!reuse) //\u56e0\u4e3ax\u8282\u70b9\u53ef\u80fd\u662f\u88ab\u6c38\u4e45\u5220\u9664\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u88ab\u79fb\u5230\u94fe\u8868\u5c3e delete x; } int removeFirst(){ if(head->next == tail)return 0; int key=head->next->key; remove(head->next, false); return key; } int size() const{return _size;} }; class LRUCache{ private: unordered_map<int, DNode*> umap; DoubleList cache; int cap; //\u6700\u5927\u5bb9\u91cf //\u5c06\u67d0\u4e2akey\u63d0\u5347\u4e3a\u6700\u8fd1\u4f7f\u7528\u7684 void makeRecently(int key){ DNode* x=umap[key]; cache.remove(x, true); cache.addLast(x); } //\u6dfb\u52a0\u6700\u8fd1\u4f7f\u7528\u7684 void addRecently(int key, int val){ DNode *x=new DNode(key, val); cache.addLast(x); umap[key] = x; } //\u5220\u9664\u67d0\u4e2akey void deleteKey(int key){ if(umap.count(key)==0)return; DNode *x=umap[key]; cache.remove(x, false); umap.erase(key); } //\u5220\u9664\u6700\u4e45\u672a\u4f7f\u7528\u7684 void removeLeastRecently(){ umap.erase(cache.removeFirst()); } public: LRUCache(int capacity): cap(capacity){} int get(int key){ if(umap.count(key)==0) return -1; makeRecently(key); //\u5c06\u8be5\u6570\u636e\u63d0\u5347\u4e3a\u6700\u8fd1\u4f7f\u7528 return umap[key]->val; } void put(int key, int val){ if(umap.count(key)){ // deleteKey(key); // addRecently(key, val); umap[key]->val = val; makeRecently(key); return; } if(cache.size() == cap) removeLeastRecently(); addRecently(key, val); } }; // \u501f\u7528list\u5bb9\u5668 typedef list<pair<int,int>>::iterator LPIter; // key-value typedef list<pair<int, int>> LP; class LRUCache{ private: int cap; unordered_map<int, LPIter> umap; LP cache; void makeRecently(int key){ LPIter iter = umap[key]; int value=iter->second; cache.erase(iter); cache.push_back(make_pair(key, value)); } void removeLeastRecently(){ LPIter iter = cache.begin(); umap.erase(iter->first); cache.pop_front(); } public: LRUCache(int capacity):cap(capacity){} int get(int key){ if(umap.count(key)==0)return -1; makeRecently(key); return (*umap[key]).second; } void set(int key, int value){ if(umap.count(key)!=0){ (*umap[key]).second = value; makeRecently(key); }else{ if(cache.size() == cap) removeLeastRecently(); cache.push_back(make_pair(key, value)); umap[key] = --cache.end(); } } };","title":"LRU"},{"location":"DataStruct/Algorithm/#lfu","text":"// \u624b\u52a8\u5b9e\u73b0\u53cc\u5411has\u94fe\u8868 struct DNode2{ int key; DNode2 *next, *prev; DNode2(int k):key(k){} }; class linkHash{ private: unordered_map<int, DNode2*> umap; DNode2 *head, *tail; int _size=0; public: linkHash(){ head = new DNode2(-1); tail=new DNode2(-1); head->next = tail; tail->prev=head; } ~linkHash(){ while(head){ DNode2 *tmp=head->next; delete head; head=tmp; } } void push_back(int key){//\u4ece\u5c3e\u90e8\u63d2\u5165\u6700\u65b0\u8bbf\u95ee\u7684 DNode2* x = new DNode2(key); umap[key]=x; x->prev = tail->prev; x->next = tail; tail->prev->next=x; tail->prev=x; _size++; } void remove(int key){ DNode2 *x=umap[key]; umap.erase(key); x->prev->next = x->next; x->next->prev = x->prev; delete x; _size--; } int removeFront(){//\u8fd4\u56de\u88ab\u5220\u9664\u8282\u70b9\u7684key DNode2 *x=head->next; int key = x->key; remove(key); return key; } int size()const {return _size;} }; class LFUCache { public: LFUCache(int capacity): cap(capacity) {} int get(int key) { if(key2VF.count(key)==0)return -1; increaseFre(key); return key2VF[key].first; } void put(int key, int value) { if(cap==0)return; if(key2VF.count(key)!=0){ key2VF[key].first=value; }else{ if(key2VF.size()==cap) deleteLeastFreqKey(); key2VF[key] = make_pair(value, 0); minFreq = 1; //\u63d2\u5165\u65b0\u8282\u70b9\u540e } increaseFre(key); } private: unordered_map<int, linkHash*> freq2key; // frequency -> list of key order by time unordered_map<int, pair<int, int>> key2VF; // key-> val+fre int cap=10; //\u9ed8\u8ba4\u503c int minFreq; void increaseFre(int key){ int oldFreq = key2VF[key].second++; int newFreq = key2VF[key].second; if(oldFreq!=0){ freq2key[oldFreq]->remove(key); if(freq2key[oldFreq]->size()==0) { freq2key.erase(oldFreq); if(oldFreq==minFreq)minFreq++; } } if(freq2key.count(newFreq)==0) freq2key[newFreq] = new linkHash(); freq2key[newFreq]->push_back(key); } void deleteLeastFreqKey(){ linkHash* x = freq2key[minFreq]; int key = x->removeFront(); if(x->size()==0) freq2key.erase(minFreq); key2VF.erase(key); } }; //\u501f\u52a9list\u5bb9\u5668 typedef list<int>::iterator LI; //key class LFUCache{ private: int cap, minFreq; unordered_map<int, pair<int, int>> key2VF; unordered_map<int, LI> key2iter; unordered_map<int, list<int> > freq2key; void increaseFreq(int key){ int oldFreq = key2VF[key].second++; int newFreq = key2VF[key].second; if(oldFreq!=0){ freq2key[oldFreq].erase(key2iter[key]); if(freq2key[oldFreq].size()==0){ freq2key.erase(oldFreq); if(oldFreq==minFreq)minFreq++; } } if(freq2key.count(newFreq)==0) freq2key[newFreq] = list<int>(); freq2key[newFreq].push_back(key); key2iter[key] = --freq2key[newFreq].end(); } void removeLeastFreqKey(){ int key=freq2key[minFreq].front(); key2iter.erase(key); key2VF.erase(key); freq2key[minFreq].pop_front(); if(freq2key[minFreq].size()==0) freq2key.erase(minFreq); } public: LFUCache(int capacity): cap(capacity){} void set(int key, int value){ if(cap==0)return; if(key2VF.count(key)!=0){ key2VF[key].first = value; }else{ if(key2VF.size() == cap) removeLeastFreqKey(); key2VF[key] = make_pair(value, 0); minFreq=1; } increaseFreq(key); } int get(int key){ if(key2VF.count(key)==0)return -1; increaseFreq(key); return key2VF[key].first; } };","title":"LFU"},{"location":"DataStruct/Algorithm/#kmp","text":"\u9012\u63a8\u6c42\u89e3next\u6570\u7ec4: \u5df2\u77e5next[j](\u5b50\u4e32P[0, j-1]\u4e2d\u524d\u7f00\u4e0e\u540e\u7f00\u7684\u4ea4\u96c6\u4e2d\u6700\u957f\u5143\u7d20\u957f\u5ea6), \u6c42\u89e3next[j+1]\u65f6\uff0c \u82e5P[next[j]] == P[j]\uff0c\u5219next[j+1]=next[j]+1=k+1; \u5426\u5219\u9700\u8981\u5bfb\u627e\u957f\u5ea6\u66f4\u77ed\u7684\u76f8\u540c\u524d\u7f00\u540e\u7f00, \u5373\u8ba9k=next[k]\uff0c\u8ba9\u65b0\u7684P[k]\u4e0eP[j]\u6bd4\u8f83\uff0c\u5982\u679ck==-1\uff0c\u5219next[j]=0\u3002 void getNext(std::vector<int>& next, string& p){ next[0] = -1; int j=0, k=-1; while(j<p.size()-1){ if(k==-1 || p[j]==p[k]){ j++; k++; next[j] = k; }else k = next[k]; } } int KMP(string& s, string& p){ if(p.size() == 0 || s.size()<p.size())return -1; vector<int> next(p.size()); /* \u4e0b\u6807\u4ece0\u5f00\u59cb: \u524d\u7f00\u5b50\u4e32\uff0c\u5373\u7531p[0, i]\uff080<=i<p.size()-2\uff09\u6784\u6210\u7684\u96c6\u5408 \u540e\u7f00\u5b50\u4e32\uff0c\u5373\u7531p[j, p.size()-1](1<=j<=p.size()-1)\u6784\u6210\u7684\u96c6\u5408 PMT:\u90e8\u5206\u5339\u914d\u8868 PMT[i]\u7684\u542b\u4e49\u662f\u4ee5p[i]\u5b57\u7b26\u7ed3\u5c3e\u7684\u540e\u7f00\u5b50\u4e32\u96c6\u5408\u4e2d\uff0c\u4e0e\u4ee5p[0]\u5b57\u7b26\u5f00\u5934\u7684\u524d\u7f00\u5b50\u4e32\u96c6\u5408\uff0c\u4e24\u8005\u4ea4\u96c6\u7684\u6700\u5927\u503c\uff1b \u5f53\u4e3b\u4e32\u6307\u9488\u6307\u5411i, \u6a21\u5f0f\u4e32\u6307\u5411j\u65f6\u53d1\u751f\u5931\u914d\uff0c\u53ef\u77e5s[i-j, i-1]\u4e0ep[0, j-1]\u662f\u76f8\u7b49\u7684\uff0c \u5219s[i-PMT[j-1], i-1]\u81ea\u7136\u4e0ep[0, PMT[j-1]-1]\u662f\u76f8\u7b49\u7684(\u5206\u522b\u662f\u6a21\u5f0f\u5b50\u4e32p[0, j]\u6709\u6700\u5927\u4ea4\u96c6\u7684\u540e\u7f00\u548c\u524d\u7f00, \u6700\u5927\u4ea4\u96c6\u7684\u957f\u5ea6\u5373\u4e3aPMT[j-1]) \u5219\u6b64\u65f6\u8ba9i\u4fdd\u6301\u4e0d\u53d8\uff0cj\u56de\u9000\u5230PMT[j-1]\u5373\u53ef \u4e3a\u4e86\u65b9\u4fbf\u7f16\u7a0b\uff0c\u91c7\u7528next\u6570\u7ec4\u4ee3\u66ffPMT\uff0c\u5c06PMT\u6570\u7ec4\u53f3\u79fb\u4e00\u4f4d\uff0c\u7b2c\u4e00\u4f4d\u7f6e\u4e3a-1(\u5373\u89c4\u5b9anext[0]=-1)\u5f62\u6210\uff0c \u8fd9\u6837j\u56de\u9000\u5230next[j]\u5373\u53ef */ getNext(next, p); int i=0, j=-1; int sLen = s.size(), pLen = p.size(); while(i<sLen && j<pLen){ if(j==-1 || s[i]==p[j]){ i++; j++; }else j=next[j]; } if(j==pLen)return i-j; else return -1; }","title":"KMP"},{"location":"DataStruct/Graph/","text":"\u56fe\u8bba\u7b97\u6cd5 \u5173\u4e8e\u56fe 1\u3001n\u4e2a\u9876\u70b9\u7684\u65e0\u5411\u5b8c\u5168\u56fe\u6709n(n-1)/2\u6761\u8fb9\u3002 \u2003 2\u3001\u5bf9\u4e8e\u65e0\u5411\u56feG(V,E)\uff0c\u5982\u679c\u8fb9\uff08v,v'\uff09\u2208E\uff0c\u5219\u79f0\u9876\u70b9v\u548cv\u2019\u4e92\u4e3a\u90bb\u63a5\u70b9\uff08Adjacent\uff09,\u5373v\u548cv'\u76f8\u5173\u8054\u3002 \u8fb9(v,v')\u4f9d\u9644 (incident) \u4e8e\u9876\u70b9v\u548c v', \u6216\u8005\u8bf4\uff08vv'\uff09\u4e0e\u9876\u70b9v\u548c v'\u76f8\u5173\u8054\u3002 \u9876\u70b9v\u7684\u5ea6(Degree)\u662f\u548cv\u5173\u8054\u7684\u8fb9\u7684\u6570\u76ee\uff0c\u8bb0\u4e3aTD(v)\u3002 \u5728\u65e0\u5411\u5b8c\u5168\u56fe\u4e2d\uff0c\u5404\u9876\u70b9\u7684\u5ea6\u548c\u7b49\u4e8e\u8fb9\u6570\u76842\u500d \u3002 \u2003 3\u3001\u5728\u6709\u5411\u56fe\u4e2d\uff0c\u5982\u679c\u4efb\u610f\u4e24\u4e2a\u9876\u70b9\u4e4b\u95f4\u90fd\u5b58\u5728\u65b9\u5411\u76f8\u53cd\u7684\u4e24\u6761\u5f27\uff0c\u5219\u79f0\u8be5\u56fe\u4e3a\u6709\u5411\u5b8c\u5168\u56fe\u3002 n\u4e2a\u9876\u70b9\u7684\u6709\u5411\u5b8c\u5168\u56fe\u6709n(n-1)\u6761\u8fb9\u3002 \u4ee5\u9876\u70b9v\u4e3a\u7ec8\u70b9\u7684\u8fb9\u7684\u6570\u91cf\u79f0\u4e3av\u7684\u5165\u5ea6\uff08InDegree\uff09,ID(v); \u4ee5\u9876\u70b9v\u4e3a\u8d77\u70b9\u7684\u8fb9\u7684\u6570\u91cf\u79f0\u4e3av\u7684\u51fa\u5ea6\uff08OutDegree\uff09,OD(v); \u9876\u70b9v\u7684\u5ea6 TD(v) = ID(v) + OD(v)\u3002 \u5728\u6709\u5411\u5b8c\u5168\u56fe\u4e2d\uff0c\u5404\u9876\u70b9\u7684\u5165\u5ea6\u548c\u7b49\u4e8e\u51fa\u5ea6\u548c\uff0c\u7b49\u4e8e\u5f27\u7684\u6570\u76ee\u3002 BFS && DFS struct Vertex{ Vertex(std::string str): name(str){} std::list<std::pair<Vertex*, int>> adj; //\u90bb\u63a5\u8868, int\u578b\u53c2\u6570\u4ee3\u8868\u8fb9\u4e0a\u6743\u503c std::string name; bool known=false; //\u5728dijkrstra\u548cprim\u7b97\u6cd5\u4e2d\u6709\u7528 int dist=INT32_MAX; Vertex* prev=nullptr; }; void dfs(Vertex& ver){ std::cout<<ver.name<<\" \"; ver.known=true; for(std::pair<Vertex*, int>& p:ver.adj){ Vertex& v= *(p.first); if(!v.known)//\u8282\u70b9\u5c1a\u672a\u8bbf\u95ee dfs(v); } } void bfs(Vertex* ver){ std::queue<Vertex*> q; ver->known=true; q.push(ver); while(!q.empty()){ Vertex* head=q.front(); std::cout<<head->name<<\" \"; q.pop(); for(auto& p: head->adj){ if(!p.first->known){ p.first->known=true; q.push(p.first); } } } } \u62d3\u6251\u6392\u5e8f \u2003\u5728\u4e00\u4e2a\u8868\u793a\u5de5\u7a0b\u7684\u6709\u5411\u56fe\u4e2d\uff0c\u7528\u9876\u70b9\u8868\u793a\u6d3b\u52a8\uff0c\u7528\u5f27\u8868\u793a\u6d3b\u52a8\u4e4b\u95f4\u7684\u4f18\u5148\u5173\u7cfb\uff0c\u8fd9\u6837\u7684\u6709\u5411\u56fe\u4e3a\u9876\u70b9\u8868\u793a\u6d3b\u52a8\u7684\u7f51\uff0c\u6211\u4eec\u79f0\u4e3a AOV \u7f51(Activity on Vertex Network)\u3002 \u2003\u82e5\u4e00\u4e2a\u7531\u56fe\u4e2d\u6240\u6709\u70b9\u6784\u6210\u7684\u5e8f\u5217A\u6ee1\u8db3\uff1a\u5bf9\u4e8e\u56fe\u4e2d\u7684\u6bcf\u6761\u8fb9(x, y)\uff0cx\u5728A\u4e2d\u90fd\u51fa\u73b0\u5728y\u4e4b\u524d\uff0c\u5219\u79f0A\u662f\u8be5\u56fe\u7684\u4e00\u4e2a\u62d3\u6251\u5e8f\u5217\u3002 AOV\u7f51\u63cf\u8ff0\u4e86\u6d3b\u52a8\u4e4b\u95f4\u7684\u5236\u7ea6\u5173\u7cfb\u3002 \u2003\u62d3\u6251\u6392\u5e8f\uff0c\u5176\u5b9e\u5c31\u662f\u5bf9\u4e00\u4e2a\u6709\u5411\u56fe\u6784\u9020\u62d3\u6251\u5e8f\u5217\u7684\u8fc7\u7a0b\u3002\u6784\u9020\u65f6\u4f1a\u6709\u4e24\u4e2a\u7ed3\u679c\uff0c\u5982\u679c\u6b64\u7f51\u7684\u5168\u90e8\u9876\u70b9\u90fd\u88ab\u8f93\u51fa\uff0c\u5219\u8bf4\u660e\u5b83\u662f\u4e0d\u5b58\u5728\u73af(\u56de\u8def)\u7684 AOV\uff1b \u5982\u679c\u8f93\u51fa\u9876\u70b9\u6570\u5c11\u4e86\uff0c\u8bf4\u660e\u8fd9\u4e2a\u7f51\u5b58\u5728\u73af(\u56de\u8def)\uff0c\u4e0d\u662f AOV\u7f51\u3002 /* \u8f93\u5165: numCourses=4, prerequisites=[[1,0],[2,0],[3,1],[3,2]]*/ // \u57fa\u4e8eDFS class Solution { private: vector<vector<int> > edges; vector<int> ans_stack; vector<int> visited; bool valid=true; void dfs(int u) { visited[u] = 1;//\u6807\u8bb0\u5df2\u7ecf\u8bbf\u95ee for (int v: edges[u]) { if (visited[v] == 0) { dfs(v); if (!valid) { return; } } else if (visited[v] == 1) { //\u9047\u5230\u5df2\u7ecf\u8bbf\u95ee\u7684\u8282\u70b9\uff0c\u8bf4\u660e\u5b58\u5728\u73af valid = false; return; } } visited[u] = 2; //\u8be5\u8282\u70b9\u6b63\u5e38 ans_stack.push_back(u); } public: vector<int> findOrder(int numCourses, vector<vector<int>>& prerequisites) { edges.resize(numCourses); visited.resize(numCourses); for (const auto& info: prerequisites) { edges[info[1]].push_back(info[0]); } for (int i = 0; i < numCourses && valid; ++i) { if (!visited[i]) {//i\u8282\u70b9\u5c1a\u672a\u8bbf\u95ee\uff0c\u8fdb\u5165dfs dfs(i); } } if(ans_stack.size() != numCourses) return {}; reverse(ans_stack.begin(), ans_stack.end()); return ans_stack; } }; //\u57fa\u4e8eBFS class Solution { public: vector<int> findOrder(int numCourses, vector<vector<int>>& prerequisites) { vector<vector<int> > edges(numCourses); vector<int> indegrees(numCourses, 0); for(auto& v:prerequisites){ edges[v[1]].push_back(v[0]); ++indegrees[v[0]]; } queue<int> q; for(int i=0;i<numCourses;i++){ if(indegrees[i]==0) q.push(i); } vector<int> ans; while(!q.empty()){ int node = q.front(); q.pop(); ans.push_back(node); for(auto& adj:edges[node]){ --indegrees[adj]; if(indegrees[adj]==0)q.push(adj); } } if(ans.size()<numCourses)return{};//\u5b58\u5728\u73af return ans; } }; \u6700\u77ed\u8def\u5f84 \u76ee\u524d\uff0c\u8fd8\u4e0d\u5b58\u5728\u627e\u51fa\u9876\u70b9v\u5230\u4efb\u610f\u4e00\u4e2a\u9876\u70b9\u8def\u5f84\u8981\u6bd4\u627e\u51fa\u9876\u70b9v\u5230\u6240\u6709\u9876\u70b9\u8def\u5f84\u66f4\u5feb\u7684\u7b97\u6cd5 Dijkstra\u7b97\u6cd5 \u5bf9\u4e8e\u8d4b\u6743\u56fe\uff0c\u91c7\u7528Djkstra\u7b97\u6cd5(\u8d2a\u5a6a\u7b97\u6cd5\u7684\u4e00\u4e2a\u8303\u4f8b)\u66f4\u4f18\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(E+V^2)=O(V^2);\u4e0d\u9002\u7528\u6743\u503c\u4e3a\u8d1f\uff1b \u82e5\u4f7f\u7528\u6700\u5c0f\u5806\u6765\u5bfb\u627e\u6700\u8fd1\u8282\u70b9\uff0c\u5219\u590d\u6742\u5ea6\u4e3aO(Elog V + Vlog V)=O(Elog V). void printPath(Vertex v){ if(v.prev){ printPath((*v.prev)); std::cout<<\" to \"; } std::cout<<v.name; } void dijkrsta(std::vector<Vertex*>& vertexs, Vertex* start, Vertex* target){ start->dist=0; bool visitedAll = true; while(true){ //\u5bfb\u627e\u672a\u88ab\u6807\u8bb0\u8fc7\u7684\u8ddd\u79bbstart\u6700\u8fd1\u7684\u8282\u70b9, \u53ef\u4ee5\u901a\u8fc7\u6784\u5efa\u6700\u5c0f\u5806\u6765\u8fdb\u884c\u4f18\u5316 //\u7b2c\u4e00\u6b21\u627e\u5230\u7684\u5373\u662fstart\u672c\u8eab int minDist = INT32_MAX, minIndex=0; for(int i=0;i<vertexs.size();i++){ if(!vertexs[i]->known && vertexs[i]->dist<minDist){ minDist=vertexs[i]->dist; minIndex=i; visitedAll=false; } } //\u5168\u90e8\u6807\u8bb0\u8fc7\uff0c\u8df3\u51fa if(visitedAll) break; Vertex* front=vertexs[minIndex]; front->known=true; //\u6807\u8bb0\u8282\u70b9\u5df2\u88ab\u8bbf\u95ee for(auto& pp:front->adj){//\u904d\u5386front\u7684\u672a\u88ab\u8bbf\u95ee\u7684\u90bb\u5c45\u8282\u70b9pp if(!pp.first->known){ int neighbor_cost=pp.second; //front\u5230\u76f8\u90bb\u8282\u70b9\u7684\u8ddd\u79bb if(front->dist+neighbor_cost<pp.first->dist){ //pp.first->dist\u4ee3\u8868\u4e4b\u524d\u7531start\u76f4\u63a5\u5230pp\u7684\u8ddd\u79bb //\u8bf4\u660e\u7ecf\u7531front\u5230\u8fbepp\u8ddd\u79bb\u66f4\u5c0f //\u66f4\u65b0start\u5230pp\u6240\u9700\u7684\u8ddd\u79bb pp.first->dist=front->dist+neighbor_cost; pp.first->prev=front; } } } visitedAll=true; } printPath(*target); } Floyd\u7b97\u6cd5 \u8ba1\u7b97\u4efb\u610f\u4e24\u4e2a\u9876\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8ddd\u79bb\uff0c\u5373\u4f7f\u6743\u503c\u4e3a\u8d1f\u4e5f\u53ef\u3002\u9002\u5408\u7a20\u5bc6\u56fe void floyd(std::vector<std::vector<std::pair<int, int>> >&adjacents){ //adjacents\u5b58\u50a8\u6240\u6709\u8282\u70b9\u7684\u76f8\u90bb\u8282\u70b9\uff0c\u82e5\u6ca1\u6709\uff0c\u5219adjacent[i]={}; //pair<\u76f8\u90bb\u8282\u70b9\uff0c\u8fb9\u7684\u6743\u503c> int numVertexs = adjacents.size(); std::vector<std::vector<int> > edges(numVertexs, std::vector<int>(numVertexs, INT32_MAX/2)); for(int i=0;i<numVertexs;i++){ edges[i][i] = 0; for(auto& p:adjacents[i]){ edges[i][p.first] = p.second; } } for(int k=0;k<numVertexs;k++){ for(int i=0;i<numVertexs;i++){ for(int j=0;j<numVertexs;j++){ edges[i][j] = std::min(edges[i][j], edges[i][k]+edges[k][j]); } } } //edge\u5b58\u50a8\u4e86\u4efb\u610f\u4e24\u4e2a\u9876\u70b9\u95f4\u7684\u6700\u5c0f\u52a0\u6743\u8def\u5f84\u957f\u5ea6 } \u6700\u5c0f\u751f\u6210\u6811 \u2003\u8fde\u901a\u56fe\u7684\u751f\u6210\u6811\uff1a\u662f\u4e00\u4e2a\u6781\u5c0f\u8fde\u901a\u5b50\u56fe\uff0c\u5b83\u542b\u6709\u56fe\u4e2d\u5168\u90e8\u7684n\u4e2a\u9876\u70b9\uff0c\u4f46\u53ea\u6709\u8db3\u4ee5\u6784\u6210\u4e00\u68f5\u6811\u7684n-1\u6761\u8fb9\u3002 \u6b64\u5916\u628a\u6784\u6210\u8fde\u901a\u7f51\u7684\u6700\u5c0f\u4ee3\u4ef7\u751f\u6210\u6811\u79f0\u4e3a\u6700\u5c0f\u751f\u6210\u6811\uff0c\u5373\u5404\u8fb9\u6743\u503c\u548c\u6700\u5c0f\u3002 \u2003\u4e00\u822c\u901a\u8fc7Prim\u548cKruskal\u7b97\u6cd5\u6784\u5efaMinimum Spanning Tree. Prim //Prim\u4e0eDijkstra\u8fc7\u7a0b\u57fa\u672c\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7\u4fee\u6539\u4e86\u66f4\u65b0dist\u7684\u89c4\u5219 //Prim\u662f\u5728\u65e0\u5411\u56fe\u4e0a\u8fd0\u884c\u7684\uff0c\u6240\u4ee5\u6bcf\u4e00\u6761\u8fb9\u90fd\u5b58\u5728\u4e8e\u4e24\u4e2a\u94fe\u8868\u4e2d void Prim(std::vector<Vertex*>& vertexs, Vertex* start){ start->dist=0; bool visitedAll=false; /* \u6b64\u65f6Vertex\u4e2d\u7684dist\u4ee3\u8868\u7531\u6240\u6709konwn=true\u7684\u9876\u70b9\u5230\u8be5\u8282\u70b9\u4e2d\u7684\u6700\u5c0f\u8ddd\u79bb\uff0c \u5177\u6709\u6700\u5c0f\u8ddd\u79bb\u7684\u90a3\u4e2a\u8282\u70b9\u5c31\u662fprev */ while(true){ //\u5bfb\u627e\u672a\u88ab\u6807\u8bb0\u8fc7\u7684\u8ddd\u79bbstart\u6700\u8fd1\u7684\u8282\u70b9 int minDist = INT32_MAX, minIndex=0; for(int i=0;i<vertexs.size();i++){ if(!vertexs[i]->known && vertexs[i]->dist<minDist){ minDist=vertexs[i]->dist; minIndex=i; visitedAll=false; } } //\u5168\u90e8\u6807\u8bb0\u8fc7\uff0c\u8df3\u51fa if(visitedAll) break; Vertex* front=vertexs[minIndex]; front->known=true; for(auto& pp:front->adj){ if(!pp.first->known){ int neighbor_cost=pp.second; if(neighbor_cost<pp.first->dist){ //\u8fd9\u91cc\u4e0eDijkstra\u4e0d\u540c pp.first->dist=front->dist+neighbor_cost; pp.first->prev=front; } } } visitedAll=true; } std::cout<<\"Minimum Spanning Tree:\"<<std::endl; for(auto& v:vertexs){ if(v->prev) std::cout<<\"(\"<<v->prev->name<<\",\"<<v->name<<\")\"<<std::endl; } } Kruskal","title":"Graph"},{"location":"DataStruct/Graph/#_1","text":"","title":"\u56fe\u8bba\u7b97\u6cd5"},{"location":"DataStruct/Graph/#_2","text":"1\u3001n\u4e2a\u9876\u70b9\u7684\u65e0\u5411\u5b8c\u5168\u56fe\u6709n(n-1)/2\u6761\u8fb9\u3002 \u2003 2\u3001\u5bf9\u4e8e\u65e0\u5411\u56feG(V,E)\uff0c\u5982\u679c\u8fb9\uff08v,v'\uff09\u2208E\uff0c\u5219\u79f0\u9876\u70b9v\u548cv\u2019\u4e92\u4e3a\u90bb\u63a5\u70b9\uff08Adjacent\uff09,\u5373v\u548cv'\u76f8\u5173\u8054\u3002 \u8fb9(v,v')\u4f9d\u9644 (incident) \u4e8e\u9876\u70b9v\u548c v', \u6216\u8005\u8bf4\uff08vv'\uff09\u4e0e\u9876\u70b9v\u548c v'\u76f8\u5173\u8054\u3002 \u9876\u70b9v\u7684\u5ea6(Degree)\u662f\u548cv\u5173\u8054\u7684\u8fb9\u7684\u6570\u76ee\uff0c\u8bb0\u4e3aTD(v)\u3002 \u5728\u65e0\u5411\u5b8c\u5168\u56fe\u4e2d\uff0c\u5404\u9876\u70b9\u7684\u5ea6\u548c\u7b49\u4e8e\u8fb9\u6570\u76842\u500d \u3002 \u2003 3\u3001\u5728\u6709\u5411\u56fe\u4e2d\uff0c\u5982\u679c\u4efb\u610f\u4e24\u4e2a\u9876\u70b9\u4e4b\u95f4\u90fd\u5b58\u5728\u65b9\u5411\u76f8\u53cd\u7684\u4e24\u6761\u5f27\uff0c\u5219\u79f0\u8be5\u56fe\u4e3a\u6709\u5411\u5b8c\u5168\u56fe\u3002 n\u4e2a\u9876\u70b9\u7684\u6709\u5411\u5b8c\u5168\u56fe\u6709n(n-1)\u6761\u8fb9\u3002 \u4ee5\u9876\u70b9v\u4e3a\u7ec8\u70b9\u7684\u8fb9\u7684\u6570\u91cf\u79f0\u4e3av\u7684\u5165\u5ea6\uff08InDegree\uff09,ID(v); \u4ee5\u9876\u70b9v\u4e3a\u8d77\u70b9\u7684\u8fb9\u7684\u6570\u91cf\u79f0\u4e3av\u7684\u51fa\u5ea6\uff08OutDegree\uff09,OD(v); \u9876\u70b9v\u7684\u5ea6 TD(v) = ID(v) + OD(v)\u3002 \u5728\u6709\u5411\u5b8c\u5168\u56fe\u4e2d\uff0c\u5404\u9876\u70b9\u7684\u5165\u5ea6\u548c\u7b49\u4e8e\u51fa\u5ea6\u548c\uff0c\u7b49\u4e8e\u5f27\u7684\u6570\u76ee\u3002","title":"\u5173\u4e8e\u56fe"},{"location":"DataStruct/Graph/#bfs-dfs","text":"struct Vertex{ Vertex(std::string str): name(str){} std::list<std::pair<Vertex*, int>> adj; //\u90bb\u63a5\u8868, int\u578b\u53c2\u6570\u4ee3\u8868\u8fb9\u4e0a\u6743\u503c std::string name; bool known=false; //\u5728dijkrstra\u548cprim\u7b97\u6cd5\u4e2d\u6709\u7528 int dist=INT32_MAX; Vertex* prev=nullptr; }; void dfs(Vertex& ver){ std::cout<<ver.name<<\" \"; ver.known=true; for(std::pair<Vertex*, int>& p:ver.adj){ Vertex& v= *(p.first); if(!v.known)//\u8282\u70b9\u5c1a\u672a\u8bbf\u95ee dfs(v); } } void bfs(Vertex* ver){ std::queue<Vertex*> q; ver->known=true; q.push(ver); while(!q.empty()){ Vertex* head=q.front(); std::cout<<head->name<<\" \"; q.pop(); for(auto& p: head->adj){ if(!p.first->known){ p.first->known=true; q.push(p.first); } } } }","title":"BFS &amp;&amp; DFS"},{"location":"DataStruct/Graph/#_3","text":"\u5728\u4e00\u4e2a\u8868\u793a\u5de5\u7a0b\u7684\u6709\u5411\u56fe\u4e2d\uff0c\u7528\u9876\u70b9\u8868\u793a\u6d3b\u52a8\uff0c\u7528\u5f27\u8868\u793a\u6d3b\u52a8\u4e4b\u95f4\u7684\u4f18\u5148\u5173\u7cfb\uff0c\u8fd9\u6837\u7684\u6709\u5411\u56fe\u4e3a\u9876\u70b9\u8868\u793a\u6d3b\u52a8\u7684\u7f51\uff0c\u6211\u4eec\u79f0\u4e3a AOV \u7f51(Activity on Vertex Network)\u3002 \u2003\u82e5\u4e00\u4e2a\u7531\u56fe\u4e2d\u6240\u6709\u70b9\u6784\u6210\u7684\u5e8f\u5217A\u6ee1\u8db3\uff1a\u5bf9\u4e8e\u56fe\u4e2d\u7684\u6bcf\u6761\u8fb9(x, y)\uff0cx\u5728A\u4e2d\u90fd\u51fa\u73b0\u5728y\u4e4b\u524d\uff0c\u5219\u79f0A\u662f\u8be5\u56fe\u7684\u4e00\u4e2a\u62d3\u6251\u5e8f\u5217\u3002 AOV\u7f51\u63cf\u8ff0\u4e86\u6d3b\u52a8\u4e4b\u95f4\u7684\u5236\u7ea6\u5173\u7cfb\u3002 \u2003\u62d3\u6251\u6392\u5e8f\uff0c\u5176\u5b9e\u5c31\u662f\u5bf9\u4e00\u4e2a\u6709\u5411\u56fe\u6784\u9020\u62d3\u6251\u5e8f\u5217\u7684\u8fc7\u7a0b\u3002\u6784\u9020\u65f6\u4f1a\u6709\u4e24\u4e2a\u7ed3\u679c\uff0c\u5982\u679c\u6b64\u7f51\u7684\u5168\u90e8\u9876\u70b9\u90fd\u88ab\u8f93\u51fa\uff0c\u5219\u8bf4\u660e\u5b83\u662f\u4e0d\u5b58\u5728\u73af(\u56de\u8def)\u7684 AOV\uff1b \u5982\u679c\u8f93\u51fa\u9876\u70b9\u6570\u5c11\u4e86\uff0c\u8bf4\u660e\u8fd9\u4e2a\u7f51\u5b58\u5728\u73af(\u56de\u8def)\uff0c\u4e0d\u662f AOV\u7f51\u3002 /* \u8f93\u5165: numCourses=4, prerequisites=[[1,0],[2,0],[3,1],[3,2]]*/ // \u57fa\u4e8eDFS class Solution { private: vector<vector<int> > edges; vector<int> ans_stack; vector<int> visited; bool valid=true; void dfs(int u) { visited[u] = 1;//\u6807\u8bb0\u5df2\u7ecf\u8bbf\u95ee for (int v: edges[u]) { if (visited[v] == 0) { dfs(v); if (!valid) { return; } } else if (visited[v] == 1) { //\u9047\u5230\u5df2\u7ecf\u8bbf\u95ee\u7684\u8282\u70b9\uff0c\u8bf4\u660e\u5b58\u5728\u73af valid = false; return; } } visited[u] = 2; //\u8be5\u8282\u70b9\u6b63\u5e38 ans_stack.push_back(u); } public: vector<int> findOrder(int numCourses, vector<vector<int>>& prerequisites) { edges.resize(numCourses); visited.resize(numCourses); for (const auto& info: prerequisites) { edges[info[1]].push_back(info[0]); } for (int i = 0; i < numCourses && valid; ++i) { if (!visited[i]) {//i\u8282\u70b9\u5c1a\u672a\u8bbf\u95ee\uff0c\u8fdb\u5165dfs dfs(i); } } if(ans_stack.size() != numCourses) return {}; reverse(ans_stack.begin(), ans_stack.end()); return ans_stack; } }; //\u57fa\u4e8eBFS class Solution { public: vector<int> findOrder(int numCourses, vector<vector<int>>& prerequisites) { vector<vector<int> > edges(numCourses); vector<int> indegrees(numCourses, 0); for(auto& v:prerequisites){ edges[v[1]].push_back(v[0]); ++indegrees[v[0]]; } queue<int> q; for(int i=0;i<numCourses;i++){ if(indegrees[i]==0) q.push(i); } vector<int> ans; while(!q.empty()){ int node = q.front(); q.pop(); ans.push_back(node); for(auto& adj:edges[node]){ --indegrees[adj]; if(indegrees[adj]==0)q.push(adj); } } if(ans.size()<numCourses)return{};//\u5b58\u5728\u73af return ans; } };","title":"\u62d3\u6251\u6392\u5e8f"},{"location":"DataStruct/Graph/#_4","text":"\u76ee\u524d\uff0c\u8fd8\u4e0d\u5b58\u5728\u627e\u51fa\u9876\u70b9v\u5230\u4efb\u610f\u4e00\u4e2a\u9876\u70b9\u8def\u5f84\u8981\u6bd4\u627e\u51fa\u9876\u70b9v\u5230\u6240\u6709\u9876\u70b9\u8def\u5f84\u66f4\u5feb\u7684\u7b97\u6cd5 Dijkstra\u7b97\u6cd5 \u5bf9\u4e8e\u8d4b\u6743\u56fe\uff0c\u91c7\u7528Djkstra\u7b97\u6cd5(\u8d2a\u5a6a\u7b97\u6cd5\u7684\u4e00\u4e2a\u8303\u4f8b)\u66f4\u4f18\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(E+V^2)=O(V^2);\u4e0d\u9002\u7528\u6743\u503c\u4e3a\u8d1f\uff1b \u82e5\u4f7f\u7528\u6700\u5c0f\u5806\u6765\u5bfb\u627e\u6700\u8fd1\u8282\u70b9\uff0c\u5219\u590d\u6742\u5ea6\u4e3aO(Elog V + Vlog V)=O(Elog V). void printPath(Vertex v){ if(v.prev){ printPath((*v.prev)); std::cout<<\" to \"; } std::cout<<v.name; } void dijkrsta(std::vector<Vertex*>& vertexs, Vertex* start, Vertex* target){ start->dist=0; bool visitedAll = true; while(true){ //\u5bfb\u627e\u672a\u88ab\u6807\u8bb0\u8fc7\u7684\u8ddd\u79bbstart\u6700\u8fd1\u7684\u8282\u70b9, \u53ef\u4ee5\u901a\u8fc7\u6784\u5efa\u6700\u5c0f\u5806\u6765\u8fdb\u884c\u4f18\u5316 //\u7b2c\u4e00\u6b21\u627e\u5230\u7684\u5373\u662fstart\u672c\u8eab int minDist = INT32_MAX, minIndex=0; for(int i=0;i<vertexs.size();i++){ if(!vertexs[i]->known && vertexs[i]->dist<minDist){ minDist=vertexs[i]->dist; minIndex=i; visitedAll=false; } } //\u5168\u90e8\u6807\u8bb0\u8fc7\uff0c\u8df3\u51fa if(visitedAll) break; Vertex* front=vertexs[minIndex]; front->known=true; //\u6807\u8bb0\u8282\u70b9\u5df2\u88ab\u8bbf\u95ee for(auto& pp:front->adj){//\u904d\u5386front\u7684\u672a\u88ab\u8bbf\u95ee\u7684\u90bb\u5c45\u8282\u70b9pp if(!pp.first->known){ int neighbor_cost=pp.second; //front\u5230\u76f8\u90bb\u8282\u70b9\u7684\u8ddd\u79bb if(front->dist+neighbor_cost<pp.first->dist){ //pp.first->dist\u4ee3\u8868\u4e4b\u524d\u7531start\u76f4\u63a5\u5230pp\u7684\u8ddd\u79bb //\u8bf4\u660e\u7ecf\u7531front\u5230\u8fbepp\u8ddd\u79bb\u66f4\u5c0f //\u66f4\u65b0start\u5230pp\u6240\u9700\u7684\u8ddd\u79bb pp.first->dist=front->dist+neighbor_cost; pp.first->prev=front; } } } visitedAll=true; } printPath(*target); } Floyd\u7b97\u6cd5 \u8ba1\u7b97\u4efb\u610f\u4e24\u4e2a\u9876\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8ddd\u79bb\uff0c\u5373\u4f7f\u6743\u503c\u4e3a\u8d1f\u4e5f\u53ef\u3002\u9002\u5408\u7a20\u5bc6\u56fe void floyd(std::vector<std::vector<std::pair<int, int>> >&adjacents){ //adjacents\u5b58\u50a8\u6240\u6709\u8282\u70b9\u7684\u76f8\u90bb\u8282\u70b9\uff0c\u82e5\u6ca1\u6709\uff0c\u5219adjacent[i]={}; //pair<\u76f8\u90bb\u8282\u70b9\uff0c\u8fb9\u7684\u6743\u503c> int numVertexs = adjacents.size(); std::vector<std::vector<int> > edges(numVertexs, std::vector<int>(numVertexs, INT32_MAX/2)); for(int i=0;i<numVertexs;i++){ edges[i][i] = 0; for(auto& p:adjacents[i]){ edges[i][p.first] = p.second; } } for(int k=0;k<numVertexs;k++){ for(int i=0;i<numVertexs;i++){ for(int j=0;j<numVertexs;j++){ edges[i][j] = std::min(edges[i][j], edges[i][k]+edges[k][j]); } } } //edge\u5b58\u50a8\u4e86\u4efb\u610f\u4e24\u4e2a\u9876\u70b9\u95f4\u7684\u6700\u5c0f\u52a0\u6743\u8def\u5f84\u957f\u5ea6 }","title":"\u6700\u77ed\u8def\u5f84"},{"location":"DataStruct/Graph/#_5","text":"\u8fde\u901a\u56fe\u7684\u751f\u6210\u6811\uff1a\u662f\u4e00\u4e2a\u6781\u5c0f\u8fde\u901a\u5b50\u56fe\uff0c\u5b83\u542b\u6709\u56fe\u4e2d\u5168\u90e8\u7684n\u4e2a\u9876\u70b9\uff0c\u4f46\u53ea\u6709\u8db3\u4ee5\u6784\u6210\u4e00\u68f5\u6811\u7684n-1\u6761\u8fb9\u3002 \u6b64\u5916\u628a\u6784\u6210\u8fde\u901a\u7f51\u7684\u6700\u5c0f\u4ee3\u4ef7\u751f\u6210\u6811\u79f0\u4e3a\u6700\u5c0f\u751f\u6210\u6811\uff0c\u5373\u5404\u8fb9\u6743\u503c\u548c\u6700\u5c0f\u3002 \u2003\u4e00\u822c\u901a\u8fc7Prim\u548cKruskal\u7b97\u6cd5\u6784\u5efaMinimum Spanning Tree. Prim //Prim\u4e0eDijkstra\u8fc7\u7a0b\u57fa\u672c\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7\u4fee\u6539\u4e86\u66f4\u65b0dist\u7684\u89c4\u5219 //Prim\u662f\u5728\u65e0\u5411\u56fe\u4e0a\u8fd0\u884c\u7684\uff0c\u6240\u4ee5\u6bcf\u4e00\u6761\u8fb9\u90fd\u5b58\u5728\u4e8e\u4e24\u4e2a\u94fe\u8868\u4e2d void Prim(std::vector<Vertex*>& vertexs, Vertex* start){ start->dist=0; bool visitedAll=false; /* \u6b64\u65f6Vertex\u4e2d\u7684dist\u4ee3\u8868\u7531\u6240\u6709konwn=true\u7684\u9876\u70b9\u5230\u8be5\u8282\u70b9\u4e2d\u7684\u6700\u5c0f\u8ddd\u79bb\uff0c \u5177\u6709\u6700\u5c0f\u8ddd\u79bb\u7684\u90a3\u4e2a\u8282\u70b9\u5c31\u662fprev */ while(true){ //\u5bfb\u627e\u672a\u88ab\u6807\u8bb0\u8fc7\u7684\u8ddd\u79bbstart\u6700\u8fd1\u7684\u8282\u70b9 int minDist = INT32_MAX, minIndex=0; for(int i=0;i<vertexs.size();i++){ if(!vertexs[i]->known && vertexs[i]->dist<minDist){ minDist=vertexs[i]->dist; minIndex=i; visitedAll=false; } } //\u5168\u90e8\u6807\u8bb0\u8fc7\uff0c\u8df3\u51fa if(visitedAll) break; Vertex* front=vertexs[minIndex]; front->known=true; for(auto& pp:front->adj){ if(!pp.first->known){ int neighbor_cost=pp.second; if(neighbor_cost<pp.first->dist){ //\u8fd9\u91cc\u4e0eDijkstra\u4e0d\u540c pp.first->dist=front->dist+neighbor_cost; pp.first->prev=front; } } } visitedAll=true; } std::cout<<\"Minimum Spanning Tree:\"<<std::endl; for(auto& v:vertexs){ if(v->prev) std::cout<<\"(\"<<v->prev->name<<\",\"<<v->name<<\")\"<<std::endl; } } Kruskal","title":"\u6700\u5c0f\u751f\u6210\u6811"},{"location":"DataStruct/OtherStruct/","text":"\u5176\u4ed6\u6570\u636e\u7ed3\u6784\u4ee5\u53ca\u8865\u5145 \u6563\u5217 \u2003\u662f\u6839\u636e\u952e\uff08Key\uff09\u800c\u76f4\u63a5\u8bbf\u95ee\u5728\u5185\u5b58\u5b58\u50a8\u4f4d\u7f6e\u7684\u6570\u636e\u7ed3\u6784\u3002\u5b83\u901a\u8fc7\u8ba1\u7b97\u4e00\u4e2a\u5173\u4e8e\u952e\u503c\u7684\u51fd\u6570(\u6563\u5217\u51fd\u6570)\uff0c\u5c06\u6240\u9700\u67e5\u8be2\u7684\u6570\u636e\u6620\u5c04\u5230\u8868\u4e2d\u4e00\u4e2a\u4f4d\u7f6e\u6765\u8bbf\u95ee\u8bb0\u5f55\uff1b\u6563\u5217(hashing)\u662f\u4e00\u79cd\u4ee5\u5e38\u6570\u5e73\u5747\u65f6\u95f4\u6267\u884c\u63d2\u5165\u3001\u5220\u9664\u548c\u67e5\u627e\u7684\u6280\u672f\u3002 \u2003\u5982\u679c\u4e00\u4e2a\u5143\u7d20\u63d2\u5165\u65f6\u4e0e\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5143\u7d20\u6563\u5217\u5230\u76f8\u540c\u7684\u503c\u65f6\uff0c\u5219\u4ea7\u751f\u4e86\u4e00\u4e2a \u51b2\u7a81 \uff0c\u6709\u4e24\u79cd\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6cd5: \u5206\u79bb\u94fe\u63a5\u6cd5\u548c\u5f00\u653e\u5b9a\u5740\u6cd5\u3002 \u5206\u79bb\u94fe\u63a5\u6cd5 : \u5c06\u6563\u5217\u5230\u540c\u4e00\u4e2a\u503c\u5f97\u6240\u6709\u5143\u7d20\u4fdd\u7559\u5230\u4e00\u4e2a\u94fe\u8868\u4e2d\uff0c\u65b0\u5143\u7d20\u4e00\u822c\u88ab\u63d2\u5165\u5230\u94fe\u8868\u7684\u524d\u7aef\uff0c\u56e0\u4e3a\u65b0\u8fd1\u63d2\u5165\u7684\u5143\u7d20\u6700\u6709\u53ef\u80fd\u4e0d\u4e45\u88ab\u8bbf\u95ee\u3002 \u88c5\u586b\u56e0\u5b50: \u6563\u5217\u8868\u7684\u5143\u7d20\u4e2a\u6570\u5bf9\u6563\u5217\u8868\u5927\u5c0f\u7684\u6bd4\u503c\u03bb\u3002 \u6267\u884c\u4e00\u6b21\u67e5\u627e\u7684\u8bc4\u4ef7\u4ee3\u4ef7\u4e3a1+\u03bb/2\uff1b\u5206\u79bb\u94fe\u63a5\u6563\u5217\u6cd5\u7684\u4e00\u822c\u6cd5\u5219\u662f\u8ba9\u8868\u7684\u5927\u5c0f\u4e0e\u9884\u6599\u7684\u5143\u7d20\u4e2a\u6570\u4e00\u81f4\uff0c\u5373\u03bb\u22481\uff0c\u5f53\u03bb\u8d85\u8fc71\u65f6\uff0c\u5c31\u6269\u5927\u6563\u5217\u8868\u7684\u5927\u5c0f\u3002 \u5f00\u653e\u5b9a\u5740\u6cd5 \uff1a\u91c7\u7528\u63a2\u6d4b\u6563\u5217\u8868\uff0c\u4e00\u79cd\u4e0d\u91c7\u7528\u94fe\u8868\u7684\u6563\u5217\u8868\uff0c\u5bf9\u4e8e\u51b2\u7a81\u7684\u5143\u7d20\u5c1d\u8bd5\u53e6\u5916\u7684\u5355\u5143(h i (x)=(hash(x)+f(i))mod TableSize, f\u662f\u51b2\u7a81\u89e3\u51b3\u65b9\u6848)\uff0c\u8fd9\u79cd\u5f62\u5f0f\u7684\u8868\u8981\u6bd4\u5206\u79bb\u94fe\u63a5\u6cd5\u9700\u8981\u7684\u8868\u66f4\u5927\uff0c\u8981\u6c42\u03bb\u5c0f\u4e8e0.5\u3002 \u2003\u5e38\u89c1\u51b2\u7a81\u89e3\u51b3\u5305\u62ec\u7ebf\u6027\u63a2\u6d4b\u6cd5(f\u662fi\u7684\u7ebf\u6027\u51fd\u6570, eg.f(i)=i)\u3001\u5e73\u65b9\u63a2\u6d4b\u6cd5\u548c\u53cc\u6563\u5217\u3002 \u2003\u5bf9\u4e8ef(i)=i\u7684\u7ebf\u6027\u63a2\u6d4b\uff0c\u76f8\u5f53\u4e8e\u76f8\u7ee7\u63a2\u6d4b\u9010\u4e2a\u5355\u5143(\u53ef\u4ee5\u5faa\u73af)\u4ee5\u627e\u5230\u7b2c\u4e00\u4e2a\u7a7a\u5355\u5143\uff1b\u7531\u4e8e\u5b9e\u73b0\u7b80\u5355\uff0c\u5177\u6709\u826f\u597d\u7684\u5c40\u90e8\u6027\uff0c\u5728\u786c\u4ef6\u4e0a\u7684\u6807\u51c6\u5b9e\u73b0\u4e2d\u5341\u5206\u6d41\u884c; \u4f46\u67d0\u79cd\u60c5\u51b5\u4e0b\uff0c\u51b2\u7a81\u9020\u6210\u5143\u7d20\u5360\u636e\u7684\u4f4d\u7f6e\u5f62\u6210\u533a\u5757\uff0c\u5373\u4e00\u6b21\u805a\u96c6\uff0c\u5bfc\u81f4\u6563\u5217\u5230\u533a\u5757\u4e2d\u7684\u4efb\u4f55\u5173\u952e\u5b57\u90fd\u9700\u8981\u591a\u6b21\u63a2\u6d4b\u5355\u5143\u624d\u80fd\u89e3\u51b3\u51b2\u7a81\u3002 \u2003\u5e73\u65b9\u63a2\u6d4b\uff0cf(i)=i^2, \u4f1a\u5f15\u8d77\u4e8c\u6b21\u805a\u96c6(\u6563\u5217\u5230\u540c\u4e00\u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\u5c06\u63a2\u6d4b\u76f8\u540c\u7684\u5907\u9009\u4f4d\u7f6e)\uff0c\u88c5\u586b\u56e0\u5b50\u4e0d\u80fd\u5927\u4e8e0.5\uff0c\u5373\u81f3\u5c11\u6709\u4e00\u534a\u4e3a\u7a7a\u4e14\u8868\u5927\u5c0f\u4e3a\u7d20\u6570\u624d\u80fd\u4fdd\u8bc1\u63d2\u5165\u5143\u7d20\u603b\u80fd\u6210\u529f\u3002 \u2003\u53cc\u6563\u5217\uff0cf(i)=i*hash 2 (i)\u3002 \u2003 \u518d\u6563\u5217 (rehash)\uff0c\u5373\u6269\u5927\u6563\u5217\u8868\u7684\u5927\u5c0f\uff0c\u5c06\u65e7\u8868\u4e2d\u7684\u5143\u7d20\u63d2\u5165\u5230\u65b0\u8868\u4e2d\u3002\u4e00\u822c\u6709\u4e09\u79cd\u7b56\u7565\uff1a\u8868\u6ee1\u4e00\u534a\u5c31rehash\uff1b\u63d2\u5165\u5931\u8d25\u518drehash\uff1b\u88c5\u586b\u56e0\u5b50\u03bb\u8fbe\u5230\u7279\u5b9a\u503c\u5c31rehash\u3002 \u2003\u5b8c\u7f8e\u6563\u5217 \u4f7f\u7528\u4e8c\u7ea7\u6563\u5217\u8868\u4ee3\u66ff\u94fe\u8868\uff0c\u800c\u4e8c\u7ea7\u6563\u5217\u8868\u7684\u5927\u5c0f\u4e0e\u6563\u5217\u5230\u5176\u5bf9\u5e94\u7684hash\u503c\u5f97\u5143\u7d20\u4e2a\u6570N\u6709\u5173\uff0cSecondTableSize=\u03a9(N^2)\uff0c\u4e8c\u7ea7\u6563\u5217\u8868\u7684\u5143\u7d20\u4e2a\u6570\u5c06\u8f83\u4e3b\u6563\u5217\u8868\u5c11\u5f88\u591a\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fdd\u8bc1\u81f3\u5c11\u67091/2\u6982\u7387\u4e0d\u5b58\u5728\u51b2\u7a81(\u5373\u4e8c\u7ea7\u8868\u7684\u03bb<=0.5)\uff0c\u5982\u679c\u4ecd\u7136\u51b2\u7a81\uff0c\u5219\u76f4\u63a5\u6362\u7528\u65b0\u7684\u6563\u5217\u51fd\u6570\u5bf9\u8be5\u4e8c\u7ea7\u8868\u4e2d\u5143\u7d20\u91cd\u65b0\u63d2\u5165\uff0c\u5c1d\u8bd5\u7684\u671f\u671b\u6b21\u6570\u4e3a2\u3002\u5982\u679c\u6240\u4ea7\u751f\u7684\u51b2\u7a81\u6b21\u6570\u5927\u4e8e\u8981\u6c42\uff0c\u5219\u4e3b\u6563\u5217\u8868\u8fd8\u53ef\u4ee5\u6784\u9020\u591a\u6b21\u3002 \u2003\u675c\u9e43\u6563\u5217 \u4ee5\u4e24\u4e2ahash table\u4e3a\u4f8b\uff1a \u5047\u8bbe\u6709N\u4e2a\u9879\uff0c\u6211\u4eec\u7ef4\u62a4\u4e24\u4e2a\u5206\u522b\u8d85\u8fc7\u534a\u7a7a\u7684\u8868\uff0c\u4e14\u6709\u72ec\u7acb\u7684\u6563\u5217\u51fd\u6570\uff0c\u53ef\u4ee5\u628a\u6bcf\u4e2a\u9879\u5206\u914d\u5230\u6bcf\u4e2a\u8868\u4e2d\u7684\u4e00\u4e2a\u4f4d\u7f6e\uff0c \u675c\u9e43\u6563\u5217\u4fdd\u6301\u4e0d\u53d8\u7684\u662f\u4e00\u4e2a\u9879\u603b\u662f\u4f1a\u88ab\u5b58\u50a8\u5728\u8fd9\u4e24\u4e2a\u4f4d\u7f6e\u4e4b\u4e00\u3002 1\u3001\u4e24\u4e2a\u4f4d\u7f6e\u5747\u4e3a\u7a7a\uff0c\u5219\u4efb\u9009\u4e00\u4e2a\u63d2\u5165\uff1b 2\u3001\u4e24\u4e2a\u4f4d\u7f6e\u4e2d\u4e00\u4e2a\u4e3a\u7a7a\uff0c\u5219\u63d2\u5165\u5230\u7a7a\u7684\u90a3\u4e2a\u4f4d\u7f6e 3\u3001\u4e24\u4e2a\u4f4d\u7f6e\u5747\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8e22\u51fa\u4e00\u4e2a\u4f4d\u7f6e\u540e\u63d2\u5165\uff0c\u88ab\u8e22\u51fa\u7684\u5bf9\u8c03\u7528\u8be5\u7b97\u6cd5\uff0c \u518d\u6267\u884c\u8be5\u7b97\u6cd5\u627e\u5176\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5faa\u73af\u76f4\u5230\u63d2\u5165\u6210\u529f\u3002 4\u3001\u5982\u679c\u88ab\u8e22\u51fa\u7684\u6b21\u6570\u8fbe\u5230\u4e00\u5b9a\u7684\u9608\u503c\uff0c\u5219\u8ba4\u4e3ahash\u8868\u5df2\u6ee1\uff0c\u5e76\u8fdb\u884c\u91cd\u65b0\u54c8\u5e0crehash\u3002 \u4f18\u70b9\uff1a \u6700\u574f\u60c5\u51b5\u4e0b\u5e38\u6570\u7ea7\u7684\u67e5\u627e\u548c\u5220\u9664\u65f6\u95f4\u3002 \u907f\u514d\u4e86\u61d2\u60f0\u5220\u9664\u548c\u989d\u5916\u7684\u6570\u636e\u4ee5\u53ca\u5e76\u884c\u5316\u7684\u53ef\u80fd\u6027\u3002 \u7f3a\u70b9\uff1a \u5982\u679c\u6563\u5217\u503c\u4e0d\u597d\uff0c\u5219\u5f88\u5bb9\u6613\u53d1\u751f\u5faa\u73af\uff0c\u5373\u63d2\u5165\u5bfc\u81f4\u6c38\u8fdc\u7684\u5728\u6324\u8d70\u51b2\u7a81\u5143\u7d20\uff0c\u6c38\u8fdc\u90fd\u5728\u51b2\u7a81\u72b6\u6001\u3002 \u4e0d\u8fc7\u53ef\u4ee5\u8bc1\u660e\uff0c\u5982\u679c\u03bb<0.5\uff0c\u5faa\u73af\u7684\u6982\u7387\u662f\u6bd4\u8f83\u5c0f\u7684\u3002 \u2003\u8df3\u623f\u5b50\u6563\u5217 \u7528\u4e8b\u5148\u786e\u5b9a\u7684\uff0c\u5bf9\u8ba1\u7b97\u673a\u5e95\u5c42\u4f53\u7cfb\u7ed3\u6784\u800c\u8a00\u6700\u4f18\u7684\u4e00\u4e2a\u5e38\u6570\uff0c \u7ed9\u63a2\u6d4b\u5e8f\u5217\u7684\u6700\u5927\u957f\u5ea6\u52a0\u4e2a\u4e0a\u754c(\u4f9d\u65e7\u662f\u7ebf\u6027\u63a2\u6d4b)\u3002\u8fd9\u6837\u505a\u53ef\u4ee5\u7ed9\u51fa\u5e38\u6570\u7ea7\u7684\u6700\u574f\u67e5\u8be2\u65f6\u95f4\uff0c \u5e76\u4e14\u4e0e\u675c\u9e43\u6563\u5217\u4e00\u6837\uff0c\u67e5\u8be2\u53ef\u4ee5\u5e76\u884c\u5316\uff0c\u4ee5\u540c\u65f6\u68c0\u67e5\u53ef\u7528\u4f4d\u7f6e\u7684\u6709\u9650\u96c6\u3002 \u2003 \u8df3\u623f\u5b50\u6563\u5217\u89c4\u5219\uff1a a\uff09\u4ee5\u6700\u5927\u63a2\u6d4b\u4e0a\u754cMAX_DIST\u200b = 4\u4e3a\u4f8b b\uff09\u6563\u5217\u4f4d\u7f6ehash(x)\uff0c\u5219\u63a2\u6d4b\u4f4d\u7f6e\u4e3a hash(x)+0\u3001hash(x)+1\u3001hash(x)+2\u3001hash(x)+3\u3002 hash(A)=7, hop(7)=1000; //\u8868\u660e\u5f53\u524d\u4f4d\u7f6e\u88ab\u5360\uff1b hash(B)=9, hop(9)=1000; hash(C)=6, hop(6)=1000; \u2003 //\u53d1\u751f\u51b2\u7a81\uff0cD\u5b58\u653e\u5230\u4f4d\u7f6e8\uff0chop(7)=1100\u8868\u793a7\u30018\u88ab\u5360\uff0chop(8)=0000\u8868\u793a\u5c1a\u672a\u6709\u5143\u7d20\u6563\u5217\u503c\u4e3a8 hash(D)=7, hop(7)=1100, hop(8)=0000; //\u53d1\u751f\u51b2\u7a81\uff0c\u4e148\u30019\u5df2\u7ecf\u88ab\u5360\uff0cE\u5b58\u653e\u523010\uff0chop(8)=0010\uff0c\u8868\u793a\u6563\u5217\u503c\u4e3a8\u7684\u5143\u7d20\u5360\u636e10\u53f7\u4f4d\u7f6e hash(E)=8, hop(8)=0010, hop(10)=0000; //\u7ee7\u7eed\u5411\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u63a2\u6d4b\uff0chop(8)=0011, \u6563\u5217\u503c\u4e3a8\u7684\u5143\u7d20\u5360\u636e10\u300111\u53f7\u4f4d\u7f6e hash(F)=8, hop(8)=0011, hop(11)=0000; \u6563\u5217\u7528\u9014 \u7b26\u53f7\u8868\uff1a\u8ddf\u8e2a\u6e90\u4ee3\u7801\u4e2d\u7684\u53d8\u91cf \u9002\u7528\u4e8e\u56fe\u8bba\u95ee\u9898 \u7f6e\u6362\u8868 \u5728\u7ebf\u62fc\u5199\u68c0\u9a8c\u7a0b\u5e8f \u5b9e\u73b0\u9ad8\u901f\u7f13\u51b2\u5b58\u50a8\u533a \u5806 \u2003\u8fd9\u91cc\u7279\u6307\u4e8c\u53c9\u5806\uff0c\u5176\u662f\u4e00\u68f5\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c \u5982\u679c\u5c06\u6811\u4e2d\u5168\u90e8\u8282\u70b9\u5b58\u6309\u5c42\u5e8f\u904d\u5386\u5b58\u653e\u5728\u6570\u7ec4\u4e0b\u68071\u5f00\u59cb\u7684\u4f4d\u7f6e\uff0c\u5219\u4f4d\u7f6ei\u4e0a\u7684\u8282\u70b9\uff0c\u5176\u5de6\u5b69\u5b50\u4f4d\u4e8e\u6570\u7ec42i\u4f4d\u7f6e\u4e0a\uff0c\u53f3\u5b69\u5b50\u5219\u4f4d\u4e8e2i+1\u4f4d\u7f6e\u4e0a \uff0c\u56e0\u6b64\u5b9e\u9645\u4e2d\u5806\u90fd\u91c7\u7528\u6570\u7ec4\u6765\u5b9e\u73b0\u3002 \u2003\u7528\u4e8c\u53c9\u5806\u6765\u5b9e\u73b0\u4f18\u5148\u961f\u5217\uff0c\u5728\u67e5\u627e\u4e00\u7ec4\u6570\u4e2d\u7b2ck\u4e2a\u6700\u5927/\u5c0f\u6570\u65f6\uff0c\u901a\u8fc7\u4f18\u5148\u961f\u5217\uff0c\u8fdb\u884ck\u6b21\u5220\u9664\u8fd4\u56de\u7ed3\u679c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(N+klog N)\u3002 \u5806\u5e8f\u6027\u8d28\uff1a\u5728\u4e00\u4e2a\u5806\u4e2d\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8282\u70b9X(\u6839\u8282\u70b9\u9664\u5916\uff0c\u5b83\u6ca1\u6709\u7236\u4eb2)\uff0cX\u7684\u7236\u4eb2\u7684key\u8981\u5c0f\u4e8e\u7b49\u4e8eX\u4e2d\u7684key\uff0c\u56e0\u6b64\u6700\u5c0f\u5143\u6c38\u8fdc\u5728\u6839\u8282\u70b9\u5904\u3002 \u2003\u63d2\u5165\u548c\u5220\u9664\u7684\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u4e3aO(log N) \u2003\u5bf9\u4e00\u7ec4\u6570\u8fdb\u884c\u6784\u5806\u64cd\u4f5c( \u4ece\u7b2ch-1\u5c42\u7684\u6700\u53f3\u4fa7\u8282\u70b9(i=N/2)\u5f00\u59cb\uff0c\u4f9d\u6b64\u5411\u53f3\u5411\u4e0a\u904d\u5386\u8282\u70b9\uff0c\u6267\u884c\u4e0b\u6ee4\u64cd\u4f5c, \u6574\u4e2a\u8fc7\u7a0b\u7684\u4e0a\u754c\u662f\u6bcf\u4e2a\u8282\u70b9\u5230\u5176\u6700\u957f\u53f6\u8282\u70b9\u7684\u8def\u5f84\u548c\uff0c\u4e5f\u5373\u5168\u90e8\u7ed3\u70b9\u7684\u9ad8\u5ea6\u548c )\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(N). \u5e76\u67e5\u96c6(union/find sets) \u2003\u8981\u7528\u4e8e\u89e3\u51b3\u4e00\u4e9b\u5143\u7d20\u5206\u7ec4\u7684\u95ee\u9898\u3002\u5b83\u7ba1\u7406\u4e00\u7cfb\u5217\u4e0d\u76f8\u4ea4\u7684\u96c6\u5408\uff0c\u5e76\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a \u2003\u5408\u5e76\uff08Union\uff09\uff1a\u628a\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u96c6\u5408\u5408\u5e76\u4e3a\u4e00\u4e2a\u96c6\u5408; \u2003\u67e5\u8be2\uff08Find\uff09\uff1a\u67e5\u8be2\u4e24\u4e2a\u5143\u7d20\u662f\u5426\u5728\u540c\u4e00\u4e2a\u96c6\u5408\u4e2d. \u521d\u59cb\u5316:\u628a\u6bcf\u4e2a\u70b9\u6240\u5728\u96c6\u5408\u521d\u59cb\u5316\u4e3a\u5176\u81ea\u8eab\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6b65\u9aa4\u5728\u6bcf\u6b21\u4f7f\u7528\u8be5\u6570\u636e\u7ed3\u6784\u65f6\u53ea\u9700\u8981\u6267\u884c\u4e00\u6b21\uff0c\u65e0\u8bba\u4f55\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u4e3aO(N)\u3002 class DisjSets{ private: std::vector<int> father; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\uff0c\u521d\u59cb\u8bbe\u4e3a\u5176\u81ea\u8eab std::vector<int> rank; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u4f30\u8ba1\u9ad8\u5ea6\uff0c\u56e0\u4e3a\u968f\u7740\u8def\u5f84\u538b\u7f29\uff0c\u6811\u7684\u7ed3\u6784\u53d1\u751f\u6539\u53d8\uff0c\u9ad8\u5ea6\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u521d\u59cb\u503c\u8bbe\u4e3a1 public: explicit DisjSets(int numElements): father(numElements), rank(numElements, 1){ for(int i=0;i<numElements;i++)father[i]=i; } int find(int x); void unionSets(int , int ); }; int DisjSets::find(int x){ //\u5728\u67e5\u8be2\u65f6\u6267\u884c\u8def\u5f84\u538b\u7f29\uff0c\u5373\u8ba9\u6cbf\u9014\u7684\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u90fd\u4e3a\u6839\u8282\u70b9 return find(x)==x?x:(father[x]=find(father[x])); } void DisjSets::unionSets(int elem1, int elem2){ int root1=find(elem1), root2=find(elem2); if(root1==root2)return; if(rank[root1] <= rank[root2]) father[root1] = root2; //\u8ba9\u8f83\u6df1\u7684\u6811\u7684\u6839\u8282\u70b9\u6210\u4e3a\u6d45\u6811\u7684\u6839\u7684\u7236\u8282\u70b9\uff0c\u8fd9\u6837\u4e0d\u4f1a\u589e\u52a0\u6574\u68f5\u6811\u7684\u9ad8\u5ea6 else father[root2] = root1; //\u53ea\u6709rank[root1]\u4e0erank[root2]\u76f8\u7b49\u65f6\uff0c\u5408\u5e76\u624d\u4f1a\u589e\u52a0\u6839\u8282\u70b9\u7684\u9ad8\u5ea6\uff0c\u4e14\u6b64\u65f6\u662froot1\u88ab\u5408\u5e76\u5230root2 //\u56e0\u6b64\u53ea\u6709rank[root2]++ if(rank[root1]==rank[root2] && root1!=root2) rank[root2]++; } \u8865\u5145 C++11\u4e2d\u7684\u5bb9\u5668 map\\set: \u901a\u8fc7\u7ea2\u9ed1\u6811\u5b9e\u73b0 unordered_map\\unordered_set\u901a\u8fc7\u6563\u5217\u8868\u5b9e\u73b0 \u6839\u636e\u9012\u5f52\u65b9\u7a0b\u4f30\u8ba1\u65f6\u95f4\u590d\u6742\u5ea6 \u4f4d\u8fd0\u7b97: \u2003\u628a\u4e00\u4e2a\u6574\u6570\u51cf\u53bb1\u4e4b\u540e\u518d\u548c\u539f\u6765\u7684\u6574\u6570\u505a\u6309\u4f4d\u4e0e\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u76f8\u5f53\u4e8e\u628a\u6574\u6570\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\u6700\u53f3\u8fb9\u76841\u53d8\u62100\uff0c\u800c\u5176\u4f59\u4f4d\u4e0d\u53d8\u3002\u4f8b\u5982: 1100b & 1011b = 1000b \u2003 n>0, n&=~(n-1); //\u5f97\u5230\u7684n\u9664\u4e86\u53f3\u4fa7\u7b2c\u4e00\u4e2a1\u4e4b\u5916\uff0c\u90fd\u53d8\u4e3a0\uff0c n=23 = 00..10111b, ~(n-1)=11..01001b, \u5219n&=~(n-1) = 00..00001b \u2003 \u53d6\u4f59\u8fd0\u7b97\u5bf9\u4e8e\u52a0\u51cf\u4e58\u9664\u5747\u6ee1\u8db3\u5206\u914d\u5f8b \u5224\u65ad\u4e24\u4e2a\u6d6e\u70b9\u6570\u662f\u5426\u76f8\u7b49: \u7531\u4e8e\u5b58\u5728\u7cbe\u5ea6\u8bef\u5dee\uff0c\u4e0d\u80fd\u4f7f\u7528\"==\"\u6765\u5224\u65ad\u4e24\u4e2a\u6d6e\u70b9\u6570\u662f\u5426\u76f8\u7b49\uff1b\u53ef\u4ee5\u5224\u65ad\u4e24\u4e2a\u6570\u4e4b\u95f4\u7684\u5dee\u503c\u662f\u5426\u5c0f\u4e8e\u4e00\u4e2a\u6bd4\u8f83\u5c0f\u7684\u6570\uff0c\u59821e-6\u62161e-7\u3002 Linux\u5185\u6838\u4e2d\u7684\u6570\u636e\u7ed3\u6784 \u94fe\u8868: linux\u5185\u6838\u4e2d\u7684\u6807\u51c6\u94fe\u8868\u91c7\u7528\u73af\u5f62\u53cc\u5411\u94fe\u8868\uff0c\u5177\u4f53\u5b9e\u73b0\u4e3a: struct list_head{ struct list_head* prev; struct list_head* next; }; \u2003\u5bf9\u4e8e\u5176\u4ed6\u81ea\u5b9a\u4e49\u7684\u7ed3\u6784\u4f53\uff0c\u901a\u8fc7\u6dfb\u52a0struct list_head\u7c7b\u578b\u7684\u6210\u5458\uff0c\u4ece\u800c\u83b7\u5f97\u6307\u5411\u524d\u540e\u5143\u7d20\u7684\u6307\u9488\u3002\u5e76\u4e14\u4e3a\u4e86\u901a\u8fc7\u94fe\u8868\u6307\u9488\u627e\u5230\u7236\u7ed3\u6784\u4e2d\u5305\u542b\u7684\u4efb\u4f55\u53d8\u91cf\uff0clinux\u5b9a\u4e49\u4e86container_of\u5b8f\uff0c\u5176\u53ef\u4ee5\u4ece\u7ed3\u6784\u4f53\u6210\u5458\u83b7\u53d6\u7ed3\u6784\u4f53\u7684\u5730\u5740\uff0c\u56e0\u4e3a\u5728C\u8bed\u8a00\u4e2d\uff0c\u4e00\u4e2a\u7ed9\u5b9a\u7ed3\u6784\u4e2d\u7684\u53d8\u91cf\u504f\u79fb\u5728\u7f16\u8bd1\u65f6\u5730\u5740\u5c31\u88abABI\u56fa\u5b9a\u4e0b\u6765\uff0c\u8fd9\u4e2a\u504f\u79fb\u53ef\u4ee5\u901a\u8fc7offsetof\u83b7\u5f97\u3002 #define offsetof(TYPE, MEMBER) ((size_t) &((TYPE *)0)->MEMBER) #define container_of(ptr, type, member) ({ \\ const typeof( ( (type*)0)->member )* __mptr=(ptr); \\ (type*) ( (char*)_mptr - offsetof(type, member) );}) \\ #define list_entry(ptr, type, member)\\ container_of(ptr, type, member) \u2003ptr\uff08type\u7684\u6210\u5458\u7684\u5730\u5740\uff09\uff0ctype\uff08\u7ed3\u6784\u4f53\u7c7b\u578b\uff09\uff0cmember\uff08\u6210\u5458\u7684\u540d\u79f0)\uff1b \u2003offsetof\u628a0\u5730\u5740\u5f3a\u5236\u8f6c\u5316\u6210\u4e86TYPE*\u7c7b\u578b\uff0c\u7136\u540e\u5c06\u5b83\u7684MEMBER\u6210\u5458\u7684\u5730\u5740\u8f6c\u5316\u4e3asize_t\u7c7b\u578b\u3002\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u4e00\u4e2a\u7c7b\u578b\u4e3aTYPE\u7684\u7ed3 \u6784\u4f53\u5730\u5740\u4ece0\u5f00\u59cb\uff0c\u90a3\u4e48\u5b83\u7684MEMBER\u6210\u5458\u7684\u5730\u5740\u5c31\u662fMEMBER\u6210\u5458\u4e0eTYPE\u7c7b\u578b\u5730\u5740\u4e4b\u95f4\u7684\u76f8\u5bf9\u504f\u79fb\u91cf\uff08\u4ee5char\u8ba1\u6570\u7684\uff09\uff1b \u2003container_of\u5b9a\u4e49\u4e2d\u7b2c\u4e00\u884c\u901a\u8fc7typeof\u53d6\u5f97member\u7684\u7c7b\u578b\uff0c\u7136\u540e__mptr\u662fmember\u7c7b\u578b\u7684\u6307\u5411ptr\u5730\u5740\u7684\u5e38\u91cf\u6307\u9488\uff0c\u8fd9\u91cc\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u5bf9ptr\u4e0emember\u505a\u7c7b\u578b\u68c0\u67e5,\u5982\u679c\u7528typeof\u6c42\u51fa\u6765\u7684\u7c7b\u578b\u548cptr\u4e0d\u4e00\u81f4\uff0c\u90a3\u4e48\u5728\u8d4b\u503c\u64cd\u4f5c\u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519\uff1b \u2003\u7b2c\u4e8c\u884c\uff0c\u5728\u53d6\u5f97\u4e86member\u7684\u5730\u5740\u4e4b\u540e\uff0c\u53ea\u8981\u628a\u5b83\u51cf\u53bbmember\u76f8\u5bf9\u4e8e\u7ed3\u6784\u4f53\u7684\u504f\u79fb\u91cf\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7ed3\u6784\u4f53\u7684\u5730\u5740\u4e86\u3002\u6700\u540e\uff0c\u518d\u628a\u8fd9\u4e2a\u5730\u5740\u8f6c\u5316\u6210type*\uff0c\u5c31\u5b8c\u6210\u4e86\u6574\u4e2a\u903b\u8f91\u3002 \u2003\u4f9d\u9760list_entry\u65b9\u6cd5\uff0c\u5185\u6838\u63d0\u4f9b\u4e86\u521b\u5efa\u3001\u64cd\u4f5c\u7b49\u7ba1\u7406\u94fe\u8868\u7684\u5404\u79cd\u65b9\u6cd5\uff0c\u800c\u8fd9\u4e9b\u65b9\u6cd5\u5e76\u4e0d\u9700\u77e5\u9053list_head\u6240\u5d4c\u5165\u5bf9\u8c61\u7684\u6570\u636e\u7ed3\u6784\u3002","title":"Others"},{"location":"DataStruct/OtherStruct/#_1","text":"","title":"\u5176\u4ed6\u6570\u636e\u7ed3\u6784\u4ee5\u53ca\u8865\u5145"},{"location":"DataStruct/OtherStruct/#_2","text":"\u662f\u6839\u636e\u952e\uff08Key\uff09\u800c\u76f4\u63a5\u8bbf\u95ee\u5728\u5185\u5b58\u5b58\u50a8\u4f4d\u7f6e\u7684\u6570\u636e\u7ed3\u6784\u3002\u5b83\u901a\u8fc7\u8ba1\u7b97\u4e00\u4e2a\u5173\u4e8e\u952e\u503c\u7684\u51fd\u6570(\u6563\u5217\u51fd\u6570)\uff0c\u5c06\u6240\u9700\u67e5\u8be2\u7684\u6570\u636e\u6620\u5c04\u5230\u8868\u4e2d\u4e00\u4e2a\u4f4d\u7f6e\u6765\u8bbf\u95ee\u8bb0\u5f55\uff1b\u6563\u5217(hashing)\u662f\u4e00\u79cd\u4ee5\u5e38\u6570\u5e73\u5747\u65f6\u95f4\u6267\u884c\u63d2\u5165\u3001\u5220\u9664\u548c\u67e5\u627e\u7684\u6280\u672f\u3002 \u2003\u5982\u679c\u4e00\u4e2a\u5143\u7d20\u63d2\u5165\u65f6\u4e0e\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5143\u7d20\u6563\u5217\u5230\u76f8\u540c\u7684\u503c\u65f6\uff0c\u5219\u4ea7\u751f\u4e86\u4e00\u4e2a \u51b2\u7a81 \uff0c\u6709\u4e24\u79cd\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6cd5: \u5206\u79bb\u94fe\u63a5\u6cd5\u548c\u5f00\u653e\u5b9a\u5740\u6cd5\u3002 \u5206\u79bb\u94fe\u63a5\u6cd5 : \u5c06\u6563\u5217\u5230\u540c\u4e00\u4e2a\u503c\u5f97\u6240\u6709\u5143\u7d20\u4fdd\u7559\u5230\u4e00\u4e2a\u94fe\u8868\u4e2d\uff0c\u65b0\u5143\u7d20\u4e00\u822c\u88ab\u63d2\u5165\u5230\u94fe\u8868\u7684\u524d\u7aef\uff0c\u56e0\u4e3a\u65b0\u8fd1\u63d2\u5165\u7684\u5143\u7d20\u6700\u6709\u53ef\u80fd\u4e0d\u4e45\u88ab\u8bbf\u95ee\u3002 \u88c5\u586b\u56e0\u5b50: \u6563\u5217\u8868\u7684\u5143\u7d20\u4e2a\u6570\u5bf9\u6563\u5217\u8868\u5927\u5c0f\u7684\u6bd4\u503c\u03bb\u3002 \u6267\u884c\u4e00\u6b21\u67e5\u627e\u7684\u8bc4\u4ef7\u4ee3\u4ef7\u4e3a1+\u03bb/2\uff1b\u5206\u79bb\u94fe\u63a5\u6563\u5217\u6cd5\u7684\u4e00\u822c\u6cd5\u5219\u662f\u8ba9\u8868\u7684\u5927\u5c0f\u4e0e\u9884\u6599\u7684\u5143\u7d20\u4e2a\u6570\u4e00\u81f4\uff0c\u5373\u03bb\u22481\uff0c\u5f53\u03bb\u8d85\u8fc71\u65f6\uff0c\u5c31\u6269\u5927\u6563\u5217\u8868\u7684\u5927\u5c0f\u3002 \u5f00\u653e\u5b9a\u5740\u6cd5 \uff1a\u91c7\u7528\u63a2\u6d4b\u6563\u5217\u8868\uff0c\u4e00\u79cd\u4e0d\u91c7\u7528\u94fe\u8868\u7684\u6563\u5217\u8868\uff0c\u5bf9\u4e8e\u51b2\u7a81\u7684\u5143\u7d20\u5c1d\u8bd5\u53e6\u5916\u7684\u5355\u5143(h i (x)=(hash(x)+f(i))mod TableSize, f\u662f\u51b2\u7a81\u89e3\u51b3\u65b9\u6848)\uff0c\u8fd9\u79cd\u5f62\u5f0f\u7684\u8868\u8981\u6bd4\u5206\u79bb\u94fe\u63a5\u6cd5\u9700\u8981\u7684\u8868\u66f4\u5927\uff0c\u8981\u6c42\u03bb\u5c0f\u4e8e0.5\u3002 \u2003\u5e38\u89c1\u51b2\u7a81\u89e3\u51b3\u5305\u62ec\u7ebf\u6027\u63a2\u6d4b\u6cd5(f\u662fi\u7684\u7ebf\u6027\u51fd\u6570, eg.f(i)=i)\u3001\u5e73\u65b9\u63a2\u6d4b\u6cd5\u548c\u53cc\u6563\u5217\u3002 \u2003\u5bf9\u4e8ef(i)=i\u7684\u7ebf\u6027\u63a2\u6d4b\uff0c\u76f8\u5f53\u4e8e\u76f8\u7ee7\u63a2\u6d4b\u9010\u4e2a\u5355\u5143(\u53ef\u4ee5\u5faa\u73af)\u4ee5\u627e\u5230\u7b2c\u4e00\u4e2a\u7a7a\u5355\u5143\uff1b\u7531\u4e8e\u5b9e\u73b0\u7b80\u5355\uff0c\u5177\u6709\u826f\u597d\u7684\u5c40\u90e8\u6027\uff0c\u5728\u786c\u4ef6\u4e0a\u7684\u6807\u51c6\u5b9e\u73b0\u4e2d\u5341\u5206\u6d41\u884c; \u4f46\u67d0\u79cd\u60c5\u51b5\u4e0b\uff0c\u51b2\u7a81\u9020\u6210\u5143\u7d20\u5360\u636e\u7684\u4f4d\u7f6e\u5f62\u6210\u533a\u5757\uff0c\u5373\u4e00\u6b21\u805a\u96c6\uff0c\u5bfc\u81f4\u6563\u5217\u5230\u533a\u5757\u4e2d\u7684\u4efb\u4f55\u5173\u952e\u5b57\u90fd\u9700\u8981\u591a\u6b21\u63a2\u6d4b\u5355\u5143\u624d\u80fd\u89e3\u51b3\u51b2\u7a81\u3002 \u2003\u5e73\u65b9\u63a2\u6d4b\uff0cf(i)=i^2, \u4f1a\u5f15\u8d77\u4e8c\u6b21\u805a\u96c6(\u6563\u5217\u5230\u540c\u4e00\u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\u5c06\u63a2\u6d4b\u76f8\u540c\u7684\u5907\u9009\u4f4d\u7f6e)\uff0c\u88c5\u586b\u56e0\u5b50\u4e0d\u80fd\u5927\u4e8e0.5\uff0c\u5373\u81f3\u5c11\u6709\u4e00\u534a\u4e3a\u7a7a\u4e14\u8868\u5927\u5c0f\u4e3a\u7d20\u6570\u624d\u80fd\u4fdd\u8bc1\u63d2\u5165\u5143\u7d20\u603b\u80fd\u6210\u529f\u3002 \u2003\u53cc\u6563\u5217\uff0cf(i)=i*hash 2 (i)\u3002 \u2003 \u518d\u6563\u5217 (rehash)\uff0c\u5373\u6269\u5927\u6563\u5217\u8868\u7684\u5927\u5c0f\uff0c\u5c06\u65e7\u8868\u4e2d\u7684\u5143\u7d20\u63d2\u5165\u5230\u65b0\u8868\u4e2d\u3002\u4e00\u822c\u6709\u4e09\u79cd\u7b56\u7565\uff1a\u8868\u6ee1\u4e00\u534a\u5c31rehash\uff1b\u63d2\u5165\u5931\u8d25\u518drehash\uff1b\u88c5\u586b\u56e0\u5b50\u03bb\u8fbe\u5230\u7279\u5b9a\u503c\u5c31rehash\u3002 \u2003\u5b8c\u7f8e\u6563\u5217 \u4f7f\u7528\u4e8c\u7ea7\u6563\u5217\u8868\u4ee3\u66ff\u94fe\u8868\uff0c\u800c\u4e8c\u7ea7\u6563\u5217\u8868\u7684\u5927\u5c0f\u4e0e\u6563\u5217\u5230\u5176\u5bf9\u5e94\u7684hash\u503c\u5f97\u5143\u7d20\u4e2a\u6570N\u6709\u5173\uff0cSecondTableSize=\u03a9(N^2)\uff0c\u4e8c\u7ea7\u6563\u5217\u8868\u7684\u5143\u7d20\u4e2a\u6570\u5c06\u8f83\u4e3b\u6563\u5217\u8868\u5c11\u5f88\u591a\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fdd\u8bc1\u81f3\u5c11\u67091/2\u6982\u7387\u4e0d\u5b58\u5728\u51b2\u7a81(\u5373\u4e8c\u7ea7\u8868\u7684\u03bb<=0.5)\uff0c\u5982\u679c\u4ecd\u7136\u51b2\u7a81\uff0c\u5219\u76f4\u63a5\u6362\u7528\u65b0\u7684\u6563\u5217\u51fd\u6570\u5bf9\u8be5\u4e8c\u7ea7\u8868\u4e2d\u5143\u7d20\u91cd\u65b0\u63d2\u5165\uff0c\u5c1d\u8bd5\u7684\u671f\u671b\u6b21\u6570\u4e3a2\u3002\u5982\u679c\u6240\u4ea7\u751f\u7684\u51b2\u7a81\u6b21\u6570\u5927\u4e8e\u8981\u6c42\uff0c\u5219\u4e3b\u6563\u5217\u8868\u8fd8\u53ef\u4ee5\u6784\u9020\u591a\u6b21\u3002 \u2003\u675c\u9e43\u6563\u5217 \u4ee5\u4e24\u4e2ahash table\u4e3a\u4f8b\uff1a \u5047\u8bbe\u6709N\u4e2a\u9879\uff0c\u6211\u4eec\u7ef4\u62a4\u4e24\u4e2a\u5206\u522b\u8d85\u8fc7\u534a\u7a7a\u7684\u8868\uff0c\u4e14\u6709\u72ec\u7acb\u7684\u6563\u5217\u51fd\u6570\uff0c\u53ef\u4ee5\u628a\u6bcf\u4e2a\u9879\u5206\u914d\u5230\u6bcf\u4e2a\u8868\u4e2d\u7684\u4e00\u4e2a\u4f4d\u7f6e\uff0c \u675c\u9e43\u6563\u5217\u4fdd\u6301\u4e0d\u53d8\u7684\u662f\u4e00\u4e2a\u9879\u603b\u662f\u4f1a\u88ab\u5b58\u50a8\u5728\u8fd9\u4e24\u4e2a\u4f4d\u7f6e\u4e4b\u4e00\u3002 1\u3001\u4e24\u4e2a\u4f4d\u7f6e\u5747\u4e3a\u7a7a\uff0c\u5219\u4efb\u9009\u4e00\u4e2a\u63d2\u5165\uff1b 2\u3001\u4e24\u4e2a\u4f4d\u7f6e\u4e2d\u4e00\u4e2a\u4e3a\u7a7a\uff0c\u5219\u63d2\u5165\u5230\u7a7a\u7684\u90a3\u4e2a\u4f4d\u7f6e 3\u3001\u4e24\u4e2a\u4f4d\u7f6e\u5747\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8e22\u51fa\u4e00\u4e2a\u4f4d\u7f6e\u540e\u63d2\u5165\uff0c\u88ab\u8e22\u51fa\u7684\u5bf9\u8c03\u7528\u8be5\u7b97\u6cd5\uff0c \u518d\u6267\u884c\u8be5\u7b97\u6cd5\u627e\u5176\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5faa\u73af\u76f4\u5230\u63d2\u5165\u6210\u529f\u3002 4\u3001\u5982\u679c\u88ab\u8e22\u51fa\u7684\u6b21\u6570\u8fbe\u5230\u4e00\u5b9a\u7684\u9608\u503c\uff0c\u5219\u8ba4\u4e3ahash\u8868\u5df2\u6ee1\uff0c\u5e76\u8fdb\u884c\u91cd\u65b0\u54c8\u5e0crehash\u3002 \u4f18\u70b9\uff1a \u6700\u574f\u60c5\u51b5\u4e0b\u5e38\u6570\u7ea7\u7684\u67e5\u627e\u548c\u5220\u9664\u65f6\u95f4\u3002 \u907f\u514d\u4e86\u61d2\u60f0\u5220\u9664\u548c\u989d\u5916\u7684\u6570\u636e\u4ee5\u53ca\u5e76\u884c\u5316\u7684\u53ef\u80fd\u6027\u3002 \u7f3a\u70b9\uff1a \u5982\u679c\u6563\u5217\u503c\u4e0d\u597d\uff0c\u5219\u5f88\u5bb9\u6613\u53d1\u751f\u5faa\u73af\uff0c\u5373\u63d2\u5165\u5bfc\u81f4\u6c38\u8fdc\u7684\u5728\u6324\u8d70\u51b2\u7a81\u5143\u7d20\uff0c\u6c38\u8fdc\u90fd\u5728\u51b2\u7a81\u72b6\u6001\u3002 \u4e0d\u8fc7\u53ef\u4ee5\u8bc1\u660e\uff0c\u5982\u679c\u03bb<0.5\uff0c\u5faa\u73af\u7684\u6982\u7387\u662f\u6bd4\u8f83\u5c0f\u7684\u3002 \u2003\u8df3\u623f\u5b50\u6563\u5217 \u7528\u4e8b\u5148\u786e\u5b9a\u7684\uff0c\u5bf9\u8ba1\u7b97\u673a\u5e95\u5c42\u4f53\u7cfb\u7ed3\u6784\u800c\u8a00\u6700\u4f18\u7684\u4e00\u4e2a\u5e38\u6570\uff0c \u7ed9\u63a2\u6d4b\u5e8f\u5217\u7684\u6700\u5927\u957f\u5ea6\u52a0\u4e2a\u4e0a\u754c(\u4f9d\u65e7\u662f\u7ebf\u6027\u63a2\u6d4b)\u3002\u8fd9\u6837\u505a\u53ef\u4ee5\u7ed9\u51fa\u5e38\u6570\u7ea7\u7684\u6700\u574f\u67e5\u8be2\u65f6\u95f4\uff0c \u5e76\u4e14\u4e0e\u675c\u9e43\u6563\u5217\u4e00\u6837\uff0c\u67e5\u8be2\u53ef\u4ee5\u5e76\u884c\u5316\uff0c\u4ee5\u540c\u65f6\u68c0\u67e5\u53ef\u7528\u4f4d\u7f6e\u7684\u6709\u9650\u96c6\u3002 \u2003 \u8df3\u623f\u5b50\u6563\u5217\u89c4\u5219\uff1a a\uff09\u4ee5\u6700\u5927\u63a2\u6d4b\u4e0a\u754cMAX_DIST\u200b = 4\u4e3a\u4f8b b\uff09\u6563\u5217\u4f4d\u7f6ehash(x)\uff0c\u5219\u63a2\u6d4b\u4f4d\u7f6e\u4e3a hash(x)+0\u3001hash(x)+1\u3001hash(x)+2\u3001hash(x)+3\u3002 hash(A)=7, hop(7)=1000; //\u8868\u660e\u5f53\u524d\u4f4d\u7f6e\u88ab\u5360\uff1b hash(B)=9, hop(9)=1000; hash(C)=6, hop(6)=1000; \u2003 //\u53d1\u751f\u51b2\u7a81\uff0cD\u5b58\u653e\u5230\u4f4d\u7f6e8\uff0chop(7)=1100\u8868\u793a7\u30018\u88ab\u5360\uff0chop(8)=0000\u8868\u793a\u5c1a\u672a\u6709\u5143\u7d20\u6563\u5217\u503c\u4e3a8 hash(D)=7, hop(7)=1100, hop(8)=0000; //\u53d1\u751f\u51b2\u7a81\uff0c\u4e148\u30019\u5df2\u7ecf\u88ab\u5360\uff0cE\u5b58\u653e\u523010\uff0chop(8)=0010\uff0c\u8868\u793a\u6563\u5217\u503c\u4e3a8\u7684\u5143\u7d20\u5360\u636e10\u53f7\u4f4d\u7f6e hash(E)=8, hop(8)=0010, hop(10)=0000; //\u7ee7\u7eed\u5411\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u63a2\u6d4b\uff0chop(8)=0011, \u6563\u5217\u503c\u4e3a8\u7684\u5143\u7d20\u5360\u636e10\u300111\u53f7\u4f4d\u7f6e hash(F)=8, hop(8)=0011, hop(11)=0000; \u6563\u5217\u7528\u9014 \u7b26\u53f7\u8868\uff1a\u8ddf\u8e2a\u6e90\u4ee3\u7801\u4e2d\u7684\u53d8\u91cf \u9002\u7528\u4e8e\u56fe\u8bba\u95ee\u9898 \u7f6e\u6362\u8868 \u5728\u7ebf\u62fc\u5199\u68c0\u9a8c\u7a0b\u5e8f \u5b9e\u73b0\u9ad8\u901f\u7f13\u51b2\u5b58\u50a8\u533a","title":"\u6563\u5217"},{"location":"DataStruct/OtherStruct/#_3","text":"\u8fd9\u91cc\u7279\u6307\u4e8c\u53c9\u5806\uff0c\u5176\u662f\u4e00\u68f5\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c \u5982\u679c\u5c06\u6811\u4e2d\u5168\u90e8\u8282\u70b9\u5b58\u6309\u5c42\u5e8f\u904d\u5386\u5b58\u653e\u5728\u6570\u7ec4\u4e0b\u68071\u5f00\u59cb\u7684\u4f4d\u7f6e\uff0c\u5219\u4f4d\u7f6ei\u4e0a\u7684\u8282\u70b9\uff0c\u5176\u5de6\u5b69\u5b50\u4f4d\u4e8e\u6570\u7ec42i\u4f4d\u7f6e\u4e0a\uff0c\u53f3\u5b69\u5b50\u5219\u4f4d\u4e8e2i+1\u4f4d\u7f6e\u4e0a \uff0c\u56e0\u6b64\u5b9e\u9645\u4e2d\u5806\u90fd\u91c7\u7528\u6570\u7ec4\u6765\u5b9e\u73b0\u3002 \u2003\u7528\u4e8c\u53c9\u5806\u6765\u5b9e\u73b0\u4f18\u5148\u961f\u5217\uff0c\u5728\u67e5\u627e\u4e00\u7ec4\u6570\u4e2d\u7b2ck\u4e2a\u6700\u5927/\u5c0f\u6570\u65f6\uff0c\u901a\u8fc7\u4f18\u5148\u961f\u5217\uff0c\u8fdb\u884ck\u6b21\u5220\u9664\u8fd4\u56de\u7ed3\u679c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(N+klog N)\u3002 \u5806\u5e8f\u6027\u8d28\uff1a\u5728\u4e00\u4e2a\u5806\u4e2d\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8282\u70b9X(\u6839\u8282\u70b9\u9664\u5916\uff0c\u5b83\u6ca1\u6709\u7236\u4eb2)\uff0cX\u7684\u7236\u4eb2\u7684key\u8981\u5c0f\u4e8e\u7b49\u4e8eX\u4e2d\u7684key\uff0c\u56e0\u6b64\u6700\u5c0f\u5143\u6c38\u8fdc\u5728\u6839\u8282\u70b9\u5904\u3002 \u2003\u63d2\u5165\u548c\u5220\u9664\u7684\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u4e3aO(log N) \u2003\u5bf9\u4e00\u7ec4\u6570\u8fdb\u884c\u6784\u5806\u64cd\u4f5c( \u4ece\u7b2ch-1\u5c42\u7684\u6700\u53f3\u4fa7\u8282\u70b9(i=N/2)\u5f00\u59cb\uff0c\u4f9d\u6b64\u5411\u53f3\u5411\u4e0a\u904d\u5386\u8282\u70b9\uff0c\u6267\u884c\u4e0b\u6ee4\u64cd\u4f5c, \u6574\u4e2a\u8fc7\u7a0b\u7684\u4e0a\u754c\u662f\u6bcf\u4e2a\u8282\u70b9\u5230\u5176\u6700\u957f\u53f6\u8282\u70b9\u7684\u8def\u5f84\u548c\uff0c\u4e5f\u5373\u5168\u90e8\u7ed3\u70b9\u7684\u9ad8\u5ea6\u548c )\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(N).","title":"\u5806"},{"location":"DataStruct/OtherStruct/#unionfind-sets","text":"\u8981\u7528\u4e8e\u89e3\u51b3\u4e00\u4e9b\u5143\u7d20\u5206\u7ec4\u7684\u95ee\u9898\u3002\u5b83\u7ba1\u7406\u4e00\u7cfb\u5217\u4e0d\u76f8\u4ea4\u7684\u96c6\u5408\uff0c\u5e76\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a \u2003\u5408\u5e76\uff08Union\uff09\uff1a\u628a\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u96c6\u5408\u5408\u5e76\u4e3a\u4e00\u4e2a\u96c6\u5408; \u2003\u67e5\u8be2\uff08Find\uff09\uff1a\u67e5\u8be2\u4e24\u4e2a\u5143\u7d20\u662f\u5426\u5728\u540c\u4e00\u4e2a\u96c6\u5408\u4e2d. \u521d\u59cb\u5316:\u628a\u6bcf\u4e2a\u70b9\u6240\u5728\u96c6\u5408\u521d\u59cb\u5316\u4e3a\u5176\u81ea\u8eab\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u8fd9\u4e2a\u6b65\u9aa4\u5728\u6bcf\u6b21\u4f7f\u7528\u8be5\u6570\u636e\u7ed3\u6784\u65f6\u53ea\u9700\u8981\u6267\u884c\u4e00\u6b21\uff0c\u65e0\u8bba\u4f55\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u4e3aO(N)\u3002 class DisjSets{ private: std::vector<int> father; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\uff0c\u521d\u59cb\u8bbe\u4e3a\u5176\u81ea\u8eab std::vector<int> rank; //\u5b58\u50a8\u6bcf\u4e2a\u8282\u70b9\u7684\u4f30\u8ba1\u9ad8\u5ea6\uff0c\u56e0\u4e3a\u968f\u7740\u8def\u5f84\u538b\u7f29\uff0c\u6811\u7684\u7ed3\u6784\u53d1\u751f\u6539\u53d8\uff0c\u9ad8\u5ea6\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u521d\u59cb\u503c\u8bbe\u4e3a1 public: explicit DisjSets(int numElements): father(numElements), rank(numElements, 1){ for(int i=0;i<numElements;i++)father[i]=i; } int find(int x); void unionSets(int , int ); }; int DisjSets::find(int x){ //\u5728\u67e5\u8be2\u65f6\u6267\u884c\u8def\u5f84\u538b\u7f29\uff0c\u5373\u8ba9\u6cbf\u9014\u7684\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u90fd\u4e3a\u6839\u8282\u70b9 return find(x)==x?x:(father[x]=find(father[x])); } void DisjSets::unionSets(int elem1, int elem2){ int root1=find(elem1), root2=find(elem2); if(root1==root2)return; if(rank[root1] <= rank[root2]) father[root1] = root2; //\u8ba9\u8f83\u6df1\u7684\u6811\u7684\u6839\u8282\u70b9\u6210\u4e3a\u6d45\u6811\u7684\u6839\u7684\u7236\u8282\u70b9\uff0c\u8fd9\u6837\u4e0d\u4f1a\u589e\u52a0\u6574\u68f5\u6811\u7684\u9ad8\u5ea6 else father[root2] = root1; //\u53ea\u6709rank[root1]\u4e0erank[root2]\u76f8\u7b49\u65f6\uff0c\u5408\u5e76\u624d\u4f1a\u589e\u52a0\u6839\u8282\u70b9\u7684\u9ad8\u5ea6\uff0c\u4e14\u6b64\u65f6\u662froot1\u88ab\u5408\u5e76\u5230root2 //\u56e0\u6b64\u53ea\u6709rank[root2]++ if(rank[root1]==rank[root2] && root1!=root2) rank[root2]++; }","title":"\u5e76\u67e5\u96c6(union/find sets)"},{"location":"DataStruct/OtherStruct/#_4","text":"","title":"\u8865\u5145"},{"location":"DataStruct/OtherStruct/#c11","text":"map\\set: \u901a\u8fc7\u7ea2\u9ed1\u6811\u5b9e\u73b0 unordered_map\\unordered_set\u901a\u8fc7\u6563\u5217\u8868\u5b9e\u73b0 \u6839\u636e\u9012\u5f52\u65b9\u7a0b\u4f30\u8ba1\u65f6\u95f4\u590d\u6742\u5ea6 \u4f4d\u8fd0\u7b97: \u2003\u628a\u4e00\u4e2a\u6574\u6570\u51cf\u53bb1\u4e4b\u540e\u518d\u548c\u539f\u6765\u7684\u6574\u6570\u505a\u6309\u4f4d\u4e0e\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u76f8\u5f53\u4e8e\u628a\u6574\u6570\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\u6700\u53f3\u8fb9\u76841\u53d8\u62100\uff0c\u800c\u5176\u4f59\u4f4d\u4e0d\u53d8\u3002\u4f8b\u5982: 1100b & 1011b = 1000b \u2003 n>0, n&=~(n-1); //\u5f97\u5230\u7684n\u9664\u4e86\u53f3\u4fa7\u7b2c\u4e00\u4e2a1\u4e4b\u5916\uff0c\u90fd\u53d8\u4e3a0\uff0c n=23 = 00..10111b, ~(n-1)=11..01001b, \u5219n&=~(n-1) = 00..00001b \u2003 \u53d6\u4f59\u8fd0\u7b97\u5bf9\u4e8e\u52a0\u51cf\u4e58\u9664\u5747\u6ee1\u8db3\u5206\u914d\u5f8b \u5224\u65ad\u4e24\u4e2a\u6d6e\u70b9\u6570\u662f\u5426\u76f8\u7b49: \u7531\u4e8e\u5b58\u5728\u7cbe\u5ea6\u8bef\u5dee\uff0c\u4e0d\u80fd\u4f7f\u7528\"==\"\u6765\u5224\u65ad\u4e24\u4e2a\u6d6e\u70b9\u6570\u662f\u5426\u76f8\u7b49\uff1b\u53ef\u4ee5\u5224\u65ad\u4e24\u4e2a\u6570\u4e4b\u95f4\u7684\u5dee\u503c\u662f\u5426\u5c0f\u4e8e\u4e00\u4e2a\u6bd4\u8f83\u5c0f\u7684\u6570\uff0c\u59821e-6\u62161e-7\u3002","title":"C++11\u4e2d\u7684\u5bb9\u5668"},{"location":"DataStruct/OtherStruct/#linux","text":"\u94fe\u8868: linux\u5185\u6838\u4e2d\u7684\u6807\u51c6\u94fe\u8868\u91c7\u7528\u73af\u5f62\u53cc\u5411\u94fe\u8868\uff0c\u5177\u4f53\u5b9e\u73b0\u4e3a: struct list_head{ struct list_head* prev; struct list_head* next; }; \u2003\u5bf9\u4e8e\u5176\u4ed6\u81ea\u5b9a\u4e49\u7684\u7ed3\u6784\u4f53\uff0c\u901a\u8fc7\u6dfb\u52a0struct list_head\u7c7b\u578b\u7684\u6210\u5458\uff0c\u4ece\u800c\u83b7\u5f97\u6307\u5411\u524d\u540e\u5143\u7d20\u7684\u6307\u9488\u3002\u5e76\u4e14\u4e3a\u4e86\u901a\u8fc7\u94fe\u8868\u6307\u9488\u627e\u5230\u7236\u7ed3\u6784\u4e2d\u5305\u542b\u7684\u4efb\u4f55\u53d8\u91cf\uff0clinux\u5b9a\u4e49\u4e86container_of\u5b8f\uff0c\u5176\u53ef\u4ee5\u4ece\u7ed3\u6784\u4f53\u6210\u5458\u83b7\u53d6\u7ed3\u6784\u4f53\u7684\u5730\u5740\uff0c\u56e0\u4e3a\u5728C\u8bed\u8a00\u4e2d\uff0c\u4e00\u4e2a\u7ed9\u5b9a\u7ed3\u6784\u4e2d\u7684\u53d8\u91cf\u504f\u79fb\u5728\u7f16\u8bd1\u65f6\u5730\u5740\u5c31\u88abABI\u56fa\u5b9a\u4e0b\u6765\uff0c\u8fd9\u4e2a\u504f\u79fb\u53ef\u4ee5\u901a\u8fc7offsetof\u83b7\u5f97\u3002 #define offsetof(TYPE, MEMBER) ((size_t) &((TYPE *)0)->MEMBER) #define container_of(ptr, type, member) ({ \\ const typeof( ( (type*)0)->member )* __mptr=(ptr); \\ (type*) ( (char*)_mptr - offsetof(type, member) );}) \\ #define list_entry(ptr, type, member)\\ container_of(ptr, type, member) \u2003ptr\uff08type\u7684\u6210\u5458\u7684\u5730\u5740\uff09\uff0ctype\uff08\u7ed3\u6784\u4f53\u7c7b\u578b\uff09\uff0cmember\uff08\u6210\u5458\u7684\u540d\u79f0)\uff1b \u2003offsetof\u628a0\u5730\u5740\u5f3a\u5236\u8f6c\u5316\u6210\u4e86TYPE*\u7c7b\u578b\uff0c\u7136\u540e\u5c06\u5b83\u7684MEMBER\u6210\u5458\u7684\u5730\u5740\u8f6c\u5316\u4e3asize_t\u7c7b\u578b\u3002\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u4e00\u4e2a\u7c7b\u578b\u4e3aTYPE\u7684\u7ed3 \u6784\u4f53\u5730\u5740\u4ece0\u5f00\u59cb\uff0c\u90a3\u4e48\u5b83\u7684MEMBER\u6210\u5458\u7684\u5730\u5740\u5c31\u662fMEMBER\u6210\u5458\u4e0eTYPE\u7c7b\u578b\u5730\u5740\u4e4b\u95f4\u7684\u76f8\u5bf9\u504f\u79fb\u91cf\uff08\u4ee5char\u8ba1\u6570\u7684\uff09\uff1b \u2003container_of\u5b9a\u4e49\u4e2d\u7b2c\u4e00\u884c\u901a\u8fc7typeof\u53d6\u5f97member\u7684\u7c7b\u578b\uff0c\u7136\u540e__mptr\u662fmember\u7c7b\u578b\u7684\u6307\u5411ptr\u5730\u5740\u7684\u5e38\u91cf\u6307\u9488\uff0c\u8fd9\u91cc\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u5bf9ptr\u4e0emember\u505a\u7c7b\u578b\u68c0\u67e5,\u5982\u679c\u7528typeof\u6c42\u51fa\u6765\u7684\u7c7b\u578b\u548cptr\u4e0d\u4e00\u81f4\uff0c\u90a3\u4e48\u5728\u8d4b\u503c\u64cd\u4f5c\u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519\uff1b \u2003\u7b2c\u4e8c\u884c\uff0c\u5728\u53d6\u5f97\u4e86member\u7684\u5730\u5740\u4e4b\u540e\uff0c\u53ea\u8981\u628a\u5b83\u51cf\u53bbmember\u76f8\u5bf9\u4e8e\u7ed3\u6784\u4f53\u7684\u504f\u79fb\u91cf\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7ed3\u6784\u4f53\u7684\u5730\u5740\u4e86\u3002\u6700\u540e\uff0c\u518d\u628a\u8fd9\u4e2a\u5730\u5740\u8f6c\u5316\u6210type*\uff0c\u5c31\u5b8c\u6210\u4e86\u6574\u4e2a\u903b\u8f91\u3002 \u2003\u4f9d\u9760list_entry\u65b9\u6cd5\uff0c\u5185\u6838\u63d0\u4f9b\u4e86\u521b\u5efa\u3001\u64cd\u4f5c\u7b49\u7ba1\u7406\u94fe\u8868\u7684\u5404\u79cd\u65b9\u6cd5\uff0c\u800c\u8fd9\u4e9b\u65b9\u6cd5\u5e76\u4e0d\u9700\u77e5\u9053list_head\u6240\u5d4c\u5165\u5bf9\u8c61\u7684\u6570\u636e\u7ed3\u6784\u3002","title":"Linux\u5185\u6838\u4e2d\u7684\u6570\u636e\u7ed3\u6784"},{"location":"DataStruct/Sort/","text":"\u6392\u5e8f \u7a33\u5b9a\u6392\u5e8f\u7b97\u6cd5 \u2003\u4fdd\u8bc1\u5728\u6392\u5e8f\u4e4b\u524d\uff0c2\u4e2a\u76f8\u7b49\u7684\u6570\u5176\u5728\u5e8f\u5217\u7684\u524d\u540e\u4f4d\u7f6e\u987a\u5e8f\u548c\u6392\u5e8f\u4e4b\u540e\u5b83\u4eec\u4e24\u4e2a\u7684\u524d\u540e\u4f4d\u7f6e\u987a\u5e8f\u76f8\u540c\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5982\u679cAi = Aj\uff0cAi\u539f\u6765\u5728\u4f4d\u7f6e\u524d\uff0c\u6392\u5e8f\u540eAi\u8fd8\u662f\u8981\u5728Aj\u4f4d\u7f6e\u524d\u3002 \u2003 \u5806\u6392\u5e8f\u3001\u5feb\u901f\u6392\u5e8f\u3001\u5e0c\u5c14\u6392\u5e8f\u3001\u9009\u62e9\u6392\u5e8f\u662f\u4e0d\u7a33\u5b9a\u7684\u6392\u5e8f\u7b97\u6cd5\uff0c\u800c\u57fa\u6570\u6392\u5e8f\u3001\u5192\u6ce1\u6392\u5e8f\u3001\u63d2\u5165\u6392\u5e8f\u3001\u5f52\u5e76\u6392\u5e8f\u662f\u7a33\u5b9a\u7684\u6392\u5e8f\u7b97\u6cd5\u3002 \u2003\u8981\u6392\u5e8f\u7684\u5185\u5bb9\u662f\u4e00\u4e2a\u590d\u6742\u5bf9\u8c61\u7684\u591a\u4e2a\u6570\u5b57\u5c5e\u6027\uff0c\u4e14\u5176\u539f\u672c\u7684\u521d\u59cb\u987a\u5e8f\u5b58\u5728\u610f\u4e49\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u5728\u4e8c\u6b21\u6392\u5e8f\u7684\u57fa\u7840\u4e0a\u4fdd\u6301\u539f\u6709\u6392\u5e8f\u7684\u610f\u4e49\uff0c\u624d\u9700\u8981\u4f7f\u7528\u5230\u7a33\u5b9a\u6027\u7684\u7b97\u6cd5 \u4e5d\u79cd\u6392\u5e8f 1\u3001\u9009\u62e9\u6392\u5e8f void selection_sort(std::vector<int>& vec){ for(int i=0;i<vec.size();i++){ int minIndex=i; for(int j=i+1;j<vec.size();j++){ if(vec[j]<vec[minIndex])minIndex=j; } std::swap(vec[i], vec[minIndex]); } } 2\u3001\u5192\u6ce1\u6392\u5e8f void maopao_sort(std::vector<int>& vec){ for(int i=0;i<vec.size()-1;i++){ for(int j=0;j<vec.size()-1-i;j++){ if(vec[j]>vec[j+1]) std::swap(vec[j], vec[j+1]); } } } 3\u3001\u63d2\u5165\u6392\u5e8f void insertion_sort(std::vector<int>& vec){ for(int i=1;i<vec.size();i++){ int tmp=std::move(vec[i]); int j=i; for(;j>0&&vec[j-1]>tmp;--j){ vec[j]=std::move(vec[j-1]); //\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u907f\u514d\u4e2d\u95f4\u8fc7\u7a0b\u7684\u76f8\u4e92\u4ea4\u6362 } vec[j]=std::move(tmp); } } //\u5bf9\u6570\u7ec4\u8303\u56f4\u5185\u7684\u5143\u7d20\u8fdb\u884c\u63d2\u5165\u6392\u5e8f void inside_insertion_sort(std::vector<int>& vec, int left, int right){ for(int i=left+1;i<right+1;i++){ int tmp=std::move(vec[i]); int j=i; for(;j>=left+1&&vec[j-1]>tmp;--j){ vec[j]=std::move(vec[j-1]); //\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u907f\u514d\u4e2d\u95f4\u8fc7\u7a0b\u7684\u76f8\u4e92\u4ea4\u6362 } vec[j]=std::move(tmp); } } \u7b80\u5355\u6392\u5e8f\u7b97\u6cd5\u7684\u4e0b\u754c : \u2003N\u4e2a\u4e92\u5f02\u5143\u7d20\u7684\u6570\u7ec4\u5176\u548c\u81ea\u8eab\u9006\u5e8f\u540e\u6570\u7ec4\uff0c\u4e24\u4e2a\u6570\u7ec4\u4e2d\u5b58\u5728\u7684\u9006\u5e8f\u5bf9\u7684\u6570\u91cf\u548c\u662fC 2 N =N(N-1)/2\uff0c\u6545N\u4e2a\u4e92\u5f02\u5143\u7d20\u7684\u6570\u7ec4\u4e2d\u5b58\u5728\u7684\u5e73\u5747\u9006\u5e8f\u5bf9\u6570\u662fN(N-1)/4\u3002 \u2003\u5728\u7b80\u5355\u6392\u5e8f\u7b97\u6cd5\u4e2d(\u4e0a\u8ff0\u4e09\u4e2a)\uff0c\u4ea4\u6362\u4e00\u5bf9\u9006\u5e8f\u6570\uff0c\u53ef\u4ee5\u6d88\u9664\u4e00\u5bf9\u9006\u5e8f\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u7b97\u6cd5\u4e2d\u8fd8\u6709O(N)\u9879\u5de5\u4f5c\uff0c\u56e0\u6b64\u6574\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u4e3aO(N+I)\uff0cI\u4e3a\u9006\u5e8f\u5bf9\u7684\u6570\u91cf\uff0c\u53ef\u77e5\uff0c\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u4e0b\u754c\u4e3a\u03a9(N+N(N-1)/4) = O(N^2)\u3002 \u2003\u4e3a\u4e86\u4f7f\u5f97\u6392\u5e8f\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u964d\u4f4e\u5230\u4e8c\u6b21\u4e00\u4e0b\uff0c\u5c31\u610f\u5473\u7740\u6bcf\u6b21\u4ea4\u6362\u5220\u9664\u4e0d\u6b62\u4e00\u4e2a\u9006\u5e8f 4\u3001\u5e0c\u5c14\u6392\u5e8f(\u7f29\u51cf\u589e\u91cf\u6392\u5e8f) \u5e0c\u5c14\u6392\u5e8f\u4e2d\u5bf9\u4e8e\u589e\u91cf\u5e8f\u5217\u7684\u9009\u62e9\u5341\u5206\u91cd\u8981\uff0c\u76f4\u63a5\u5f71\u54cd\u5230\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u4e0b\u9762\u9009\u62e9\u7684\u589e\u91cf\u5e8f\u5217\u4e3a{N/2,(N/2)/2, ..., 1}(\u5e0c\u5c14\u589e\u91cf)\uff0c\u5176\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u4f9d\u7136\u4e3aO(n 2 )\uff0c\u4e00\u4e9b\u7ecf\u8fc7\u4f18\u5316\u7684\u589e\u91cf\u5e8f\u5217\u5982Hibbard\u7ecf\u8fc7\u590d\u6742\u8bc1\u660e\u53ef\u4f7f\u5f97\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(N 3/2 )\u3002 void shell_sort(std::vector<int>& vec){ for(int gap=vec.size()/2; gap>0;gap/=2){ for(int i=gap;i<vec.size();i++){ // \u4e0b\u9762\u548c\u63d2\u5165\u6392\u5e8f\u8fc7\u7a0b\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7\u4ea4\u6362\u7684\u5143\u7d20\u95f4\u9694\u4e3agap int temp=std::move(vec[i]); int j=i; for(;j>=gap && temp<vec[j-gap];j-=gap){ vec[j] = std::move(vec[j-gap]); } vec[j]=std::move(temp); } } } 5\u3001\u5806\u6392\u5e8f \u2003\u5efa\u7acbN\u4e2a\u5143\u7d20\u7684\u4e8c\u53c9\u5806\uff0c\u82b1\u8d39O(N)\u65f6\u95f4\uff1b\u7136\u540e\u6267\u884cN\u6b21deleteMin\u64cd\u4f5c\uff0c\u6700\u5c0f\u7684\u5143\u7d20\u79bb\u5f00\u5806(\u5b9e\u9645\u4e0a\u662f\u79fb\u52a8\u5230\u5b58\u50a8\u5806\u7684\u6570\u7ec4\u6700\u540e\u7684\u4f4d\u7f6e)\uff0c\u5219N\u6b21\u5220\u9664\u540e\uff0c\u6570\u7ec4\u4e2d\u5143\u7d20\u6309\u9012\u51cf\u7684\u987a\u5e8f\u5b58\u50a8\uff0c\u6bcf\u6b21\u5220\u9664\u8017\u65f6O(log N), \u5219\u7b97\u6cd5\u8017\u65f6\u4e3aO(N+Nlog N)=O(Nlog N). \u2003\u5982\u679c\u6784\u5efa\u7684\u5806\u662f\u6700\u5927\u5806\uff0c\u5219\u6700\u540e\u5f97\u5230\u7684\u6570\u7ec4\u5143\u7d20\u6b63\u597d\u6309\u589e\u5e8f\u5b58\u50a8\u3002 # define leftchild(i) (2*i+1) //i\u4f4d\u7f6e\u7684\u8282\u70b9\u7684\u5de6\u513f\u5b50\u4e0b\u6807\uff0c\u56e0\u4e3a\u6570\u7ec4\u662f\u4ece0\u5f00\u59cb\u5b58\u50a8\u7684 template<typename comparable> // i:\u4e0b\u6ee4\u4f4d\u7f6e\uff0cn: \u5806\u7684\u903b\u8f91\u5927\u5c0f void percDown(std::vector<comparable>& vec, int i, int n){ int child; comparable tmp; for(tmp=std::move(vec[i]); leftchild(i)<n;i=child){ child = leftchild(i); if(child!=n-1 && vec[child]<vec[child+1]) child++; if(tmp<vec[child]) vec[i]=std::move(vec[child]); //\u7a7a\u7a74\u4e0b\u6ee4 else break; } vec[i]=std::move(tmp); } void heap_sort(std::vector<int>& vec){ //\u6784\u5efa\u6700\u5927\u5806 for(int i=vec.size()/2 - 1; i>=0; i--)// i<=len/2-1, \u5219\u5176\u5de6\u5b69\u5b50\u4e0b\u6807<=len-1, \u7b49\u4e8e\u8bf4\u660ei\u8282\u70b9\u6ca1\u6709\u53f3\u5b69\u5b50 percDown(vec, i, vec.size()); // \u5220\u9664 for(int j=vec.size()-1;j>0;--j){ std::swap(vec[0], vec[j]); percDown(vec, 0, j); } } 6\u3001\u5f52\u5e76\u6392\u5e8f, \u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(Nlog N) \u2003\u5f52\u5e76\u6392\u5e8f\u7684\u6bd4\u8f83\u6b21\u6570\u662f\u6700\u5c11\u7684\uff0c\u4f46\u5176\u9700\u8981\u989d\u5916\u7684\u5185\u5b58\u6765\u5b58\u50a8\u4e34\u65f6\u6570\u7ec4\uff0c\u5e76\u4e14\u8017\u8d39\u7ebf\u6027\u65f6\u95f4\uff0c\u5728\u4e24\u8005\u4e4b\u95f4\u590d\u5236\u5143\u7d20\u3002 void merge(std::vector<int>& a, std::vector<int>& tmpArr, int leftPos, int rightPos, int rightEnd){ int leftEnd = rightPos-1; int tmpPos=leftPos; int numElements = rightEnd-leftPos+1; while(leftPos<=leftEnd && rightPos<=rightEnd){ if(a[leftPos]<=a[rightPos]) tmpArr[tmpPos++]=std::move(a[leftPos++]); else tmpArr[tmpPos++] = std::move(a[rightPos++]); } while(leftPos<=leftEnd) tmpArr[tmpPos++]=std::move(a[leftPos++]); while(rightPos<=rightEnd) tmpArr[tmpPos++]=std::move(a[rightPos++]); //\u5c06\u6392\u5e8f\u540e\u7684\u4e34\u65f6\u6570\u7ec4\u590d\u5236\u56de\u539f\u6570\u7ec4 for(int i=0;i<numElements;++i, --rightEnd){ a[rightEnd] = std::move(tmpArr[rightEnd]); } } void mergeSort(std::vector<int>& a, std::vector<int>& tmpArr, int left, int right){ if(left<right){ int mid=(left+right)/2; mergeSort(a, tmpArr, left, mid); mergeSort(a, tmpArr, mid+1, right); merge(a, tmpArr, left, mid+1, right); } } //\u7b80\u6d01\u5199\u6cd5\uff0c\u63a8\u8350 void mergeSort2(vector<int>& nums, vector<int>& tmpArr, int left, int right){ if(left>=right)return; int mid=(left+right)/2; mergeSort(nums, tmpArr, left, mid); mergeSort(nums, tmpArr, mid+1, right); for(int p=left;p<=right;p++){ tmpArr[p]=nums[p]; } int i=left, j=mid+1; //i,j\u5206\u522b\u662f\u5de6\u53f3\u6570\u7ec4\u9996\u5143\u7d20\u7684\u4e0b\u6807 for(int k=left; k<=right;k++){ if(j==right+1 || tmpArr[i]<=tmpArr[j]) nums[k]=std::move(tmpArr[i++]); else nums[k]=std::move(tmpArr[j++]); // i==mid+1 || tmpArr[j]<tmpArr[i] } } void merge_sort(std::vector<int>& a){ std::vector<int> tmpArr(a.size()); mergeSort(a, tmpArr, 0, a.size()-1); } 7\u3001\u5feb\u901f\u6392\u5e8f, \u65f6\u95f4\u590d\u6742\u5ea6O(Nlog N) \u2003\u9488\u5bf9\u53ef\u80fd\u51fa\u73b0\u7684\u9884\u6392\u5e8f\u7684\u6570\u636e\u6216\u5305\u542b\u4e00\u5927\u6bb5\u6392\u5e8f\u6570\u636e\uff0c\u56fa\u5b9a\u7b2c\u4e00\u4e2a\u6216\u4e2d\u95f4\u5143\u7d20\u4f5c\u4e3a\u67a2\u7ebd\u5143\u53ef\u80fd\u4f1a\u5bf9\u6392\u5e8f\u65f6\u95f4\u9020\u6210\u4e25\u91cd\u4f24\u5bb3\uff0c\u56e0\u4e3a\u6b64\u65f6\u67a2\u7ebd\u5143\u65e0\u6cd5\u5f88\u597d\u7684\u5c06\u6570\u7ec4\u5206\u5272\u6210\u5747\u5300\u7684\u4e24\u90e8\u5206;\u968f\u673a\u9009\u53d6\u5219\u9700\u8981\u501f\u52a9\u968f\u673a\u6570\u53d1\u751f\u5668\uff0c\u5e26\u6765\u989d\u5916\u5f00\u9500\uff1b\u8fd9\u91cc\u91c7\u7528\u4e09\u5143\u4e2d\u503c\u6cd5\u9009\u53d6\u67a2\u7ebd\uff0c\u5373\u5f00\u59cb\u3001\u4e2d\u95f4\u3001\u672b\u5c3e\u4e09\u4e2a\u5143\u7d20\u7684\u4e2d\u503c\u4f5c\u4e3a\u67a2\u7ebd\u5143\u3002 //\u5feb\u901f\u6392\u5e8f \u7b80\u6613\u7248 void simple_quick_sort(std::vector<int>& vec){ if(vec.size()>1){ std::vector<int> smaller, same, larger; auto pivot = vec[vec.size()/2]; for(auto &v:vec){ if(v<pivot)smaller.push_back(v); else if(v>pivot) larger.push_back(v); else same.push_back(v); } simple_quick_sort(smaller); simple_quick_sort(larger); std::move(begin(smaller), end(smaller), begin(vec)); std::move(begin(same), end(same), begin(vec)+smaller.size()); std::move(begin(larger), end(larger), end(vec)-larger.size()); } } // \u5feb\u901f\u6392\u5e8f void median3(std::vector<int>& a, int left, int right){ /*\u4e09\u6570\u4e2d\u503c\u5206\u5272\uff1a\u6d88\u9664\u8f93\u5165\u6570\u636e\u9884\u5148\u6392\u5e8f\u7684\u574f\u60c5\u5f62*/ int center = (left+right)/2; //\u4e0b\u9762\u7684\u987a\u5e8f\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u80fd\u968f\u610f\u8c03\u6362\u987a\u5e8f\uff0c\u5148\u786e\u4fddleft\u4f4d\u7f6e\u4e0a\u5143\u7d20\u6700\u5c0f\uff0c\u518d\u786e\u4fdd\u4e2d\u95f4\u4f4d\u7f6e\u5143\u7d20\u6b21\u5c0f if(a[center]<a[left]) std::swap(a[center], a[left]); if(a[right] < a[left]) std::swap(a[right], a[left]); if(a[right]<a[center]) std::swap(a[center], a[right]); //\u5c06pivot\u7f6e\u4e8eright-1\u5904 std::swap(a[center], a[right-1]); } //\u91c7\u7528median3\u786e\u5b9apivot void _partition1(std::vector<int>& a, int left, int right){ if(left+2<=right){ median3(a, left, right); const int pivot= a[right-1]; //\u7ecf\u8fc7\u4e09\u6570\u4e2d\u503c\u5206\u5272\u540e\uff0c\u9009\u62e9\u5012\u6570\u7b2c\u4e8c\u4e2a\u6570\u4e3apivot //\u5f00\u59cb\u5206\u5272 int i=left, j=right-1; for(;;){ while(a[++i]<pivot); while(a[--j]>pivot); if(i<j){ std::swap(a[i], a[j]); //\u6b64\u65f6i\u4f9d\u65e7\u5728j\u5de6\u4fa7\uff0ca[i]>=pivot, a[j]<=pivot, \u4ea4\u6362\u4e24\u8005 }else break; // i\u5df2\u7ecf\u79fb\u52a8\u5230j\u53f3\u4fa7\uff0c\u8df3\u51fa\u5faa\u73af } //\u6b64\u65f6 pos<i\u7684\u5143\u7d20\u5747\u5c0f\u4e8e\u7b49\u4e8epivot, pos>j\u7684\u5143\u7d20\u5747\u5927\u4e8e\u7b49\u4e8epivot\uff0c //i\u4e24\u4fa7\u7684\u5143\u7d20\u5e76\u975e\u4e00\u5b9a\u6709\u5e8f\u7684\uff0c\u53ea\u662f\u5747\u5c0f\u4e8e\u7b49\u4e8e\u6216\u5927\u4e8e\u7b49\u4e8epivot //\u518d\u5c06pivot\u4ece\u4f4d\u7f6eright-1\u6362\u5230i, \u518d\u5bf9i\u4e24\u4fa7\u7684\u5143\u7d20\u505a\u9012\u5f52\u8c03\u7528 std::swap(a[i], a[right-1]); _partition1(a, left, i-1); _partition1(a, i+1, right); }else{ //\u6570\u7ec4\u5143\u7d20\u5c0f\u4e8e5\uff0c \u91c7\u7528\u63d2\u5165\u6392\u5e8f // inside_insertion_sort(a, left, right); //\u6570\u7ec4\u5143\u7d20\u7b49\u4e8e2\uff0c\u76f4\u63a5\u5224\u65ad\u4e24\u8005 if(a[left]>a[right]) std::swap(a[left], a[right]); } } //\u56fa\u5b9aright\u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\u4e3apivot void _partition2(std::vector<int>& vec, int left, int right){ if(left>=right)return; int pivot=vec[right]; int i=left, j=right; while(i<j){ while(i<j && vec[i]<=pivot)i++; while(i<j && vec[j]>=pivot)j--; if(i<j){ swap(vec[i], vec[j]); } } swap(vec[i], vec[right]); _partition2(vec, left, i-1); _partition2(vec, i+1, right); } void quick_sort(std::vector<int>& vec){ std::cout<<\"median3:\\n\"; _partition1(vec, 0, vec.size()-1); // std::cout<<\"fix right:\" // _partition2(vec, 0, vec.size()-1); } \u7ebf\u6027\u65f6\u95f4\u6392\u5e8f 8\u3001\u6876\u6392\u5e8f\uff0c \u5f53\u9700\u8981\u6392\u5e8f\u7684\u6570\u8303\u56f4\u8fc7\u5927\u65f6\uff0c\u5c06\u9700\u8981\u975e\u5e38\u5927\u7684\u989d\u5916\u7a7a\u95f4\u5f00\u9500 \u57fa\u6570\u6392\u5e8f \u2003\u5bf9\u6570\u5b57\u578b\u6216\u5b57\u7b26\u578b\u7684\u5355\u5173\u952e\u5b57\uff0c\u53ef\u4ee5\u770b\u4f5c\u7531\u591a\u4e2a\u6570\u4f4d\u6216\u591a\u4e2a\u5b57\u7b26\u6784\u6210\u7684\u591a\u5173\u952e\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6570\u5b57\u6216\u5b57\u7b26\u53ef\u80fd\u7684\u53d6\u503c\u4e2a\u6570\u79f0\u4e3a\u57fa\u6570\u3002\u4f8b\u59820~999\u7684\u6570\u5b57\uff0c\u5171\u67093\u4f4d\uff0c\u6bcf\u4f4d\u4e0a\u670910\u79cd\u53ef\u80fd\u3002\u5728\u6309\u7b2ck\u4f4d\u6392\u5e8f\u65f6\uff0c\u843d\u5728\u540c\u4e00\u4e2a\u6876\u4e2d\u7684\u5143\u7d20\uff0c\u662f\u6309\u7167\u7b2ck-1\u4f4d\u6392\u5e8f\u7684\u3002 \u2003 \u65f6\u95f4\u590d\u6742\u5ea6O(d*N) , d\u4ee3\u8868\u6700\u5927\u5143\u7d20\u7684\u4f4d\u6570\u3002 \u2003\u9488\u5bf9\u6b63\u8d1f\u6df7\u5408\u7684\u6570\u636e\uff0c\u9700\u8981\u5206\u79bb\u6210\u4e24\u4e2a\u6570\u7ec4\u5206\u522b\u6392\u5e8f; \u800c\u4e14\u4e0d\u9002\u7528\u6d6e\u70b9\u6570\u6392\u5e8f\uff0c\u4e00\u822c\u7528\u4f5c\u6574\u6570\u6216\u8005\u5b57\u7b26\u4e32\u6392\u5e8f(\u91c7\u7528\u6bcf\u4e2a\u5b57\u7b26\u5bf9\u5e94\u7684ascii\u7801) //num\u4ee3\u8868vec\u4e2d\u6240\u6709\u6570\u5b57\u6700\u5927\u6709\u51e0\u4f4d void inside_radix_sort(std::vector<int>& vec, int num){ std::vector<int>* buckets= new std::vector<int>[10]; for(int i=0;i<num;i++){ for(auto &v:vec){ int j=i; auto copy=v; int tmp; while(j-- >= 0){ tmp=copy%10; copy = (copy-tmp)/10; } tmp = tmp<0?-1*tmp:tmp; //\u7b2ck\u4f4d\u6570\uff0c tmp\u53d6\u503c\u8303\u56f40\u52309 buckets[tmp].push_back(v); } int k=0; for(int p=0;p<10;p++){ for(auto& v:buckets[p]){ vec[k++]=v; } buckets[p].clear(); } } delete[] buckets; } void inside_radix_sort2(std::vector<int>& vec){ std::vector<int> odd; //\u5947\u6570 std::vector<int> even; //\u5076\u6570 for(int i=0;i<32;i++){ //\u5c06\u6574\u6570\u770b\u621032\u4f4d\u7684\u4e8c\u8fdb\u5236 for(auto &v:vec){ if((v>>i & 1)==0) even.push_back(v); else odd.push_back(v); } int j=0; for(auto& v:even) vec[j++]=v; for(auto& v:odd) vec[j++]=v; even.clear(); odd.clear(); } } /*binary:true, \u4ee3\u8868\u5c06\u6bcf\u4e2a\u6574\u6570\u770b\u621032\u4f4d\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u8fd9\u6837\u5c31\u65e0\u9700\u8ba1\u7b97\u6700\u5927\u5143\u7d20\u7684\u4f4d\u6570\u4e86; radix_sort\u662f\u4e3b\u51fd\u6570\uff0c\u5c06\u6570\u7ec4\u4e2d\u7684\u6b63\u8d1f\u6570\u5206\u79bb */ void radix_sort(std::vector<int>& vec, bool binary=false){ std::vector<int> negative, positive; int minNeg=0, maxPos=0; for(auto& v:vec){ if(v<0){ minNeg=v<minNeg?v:minNeg; negative.push_back(v); }else{ maxPos=v>maxPos?v:maxPos; positive.push_back(v); } } int k=0; if(!binary){ minNeg*=-1; int numNeg=0, numPos=0; while(minNeg){ minNeg/=10; numNeg++; } while(maxPos){ maxPos/=10; numPos++; } inside_radix_sort(negative, numNeg); inside_radix_sort(positive, numPos); for(int i=negative.size()-1; i>=0;i--){ vec[k++]=negative[i]; } }else{ inside_radix_sort2(negative); inside_radix_sort2(positive); for(auto& v:negative) vec[k++]=v; } for(auto& v:positive) vec[k++]=v; } \u8ba1\u6570\u57fa\u6570\u6392\u5e8f \u2003\u57fa\u6570\u6392\u5e8f\u7684\u53e6\u4e00\u79cd\u5b9e\u73b0\uff0c\u907f\u514d\u4e86\u4f7f\u7528\u989d\u5916\u7684vector< vector< int > >\u6765\u8868\u793a\u6876, \u4ec5\u9700\u8981\u8868\u793a\u6bcf\u4e2a\u57fa\u6570\u6570\u91cf\u7684count\u6570\u7ec4\uff0c\u548c\u6876\u4e2d\u5143\u7d20\u5728\u4e2d\u95f4\u8fc7\u7a0b\u6392\u5e8f\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6eoffset, \u8fdb\u4e00\u6b65\u4f18\u5316\uff0c\u8fd8\u53ef\u4ee5\u540c\u65f6\u7528count\u6765\u8ba1\u7b97\u5f97\u5230offset\u3002 void inside_counting_radix_sort(std::vector<int>& vec, int num){ for(int i=0;i<num;i++){ int mod = 1, j=i; while(j-->0)mod*=10; // std::vector<int> count(10, 0), offset(10, 0); // for(int k=0;k<vec.size();k++){ // int tmp=(vec[k]/mod)%10; // tmp = tmp>=0?tmp:-1*tmp; //\u6c42\u7b2ci\u4f4d\u4e0a\u6570\u5b57\u4e3a\u591a\u5c11 // count[tmp]++; // } /*offset[k]\u4ee3\u8868\u7b2c\u4e00\u4e2a\u4f4d\u6570\u4e3ak\u7684\u5143\u7d20\u5728\u65b0\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6epos\uff0c\u6bcf\u6b21\u5b89\u6392\u6876\u4e2d\u4e00\u4e2a\u5143\u7d20\u540e\uff0c\u8ba9pos\u503c\u81ea\u589e\uff0c \u8fd9\u6837\u6876\u4e2d\u4e0b\u4e00\u4e2a\u5143\u7d20\u7684\u4f4d\u7f6e\u5c31\u4f1a\u9012\u589e\u5230\u4e0b\u4e00\u4f4d*/ // for(int m=1;m<10;m++) // offset[m]=offset[m-1]+count[m-1]; // std::vector<int> copyVec=vec; // for(int n=0;n<copyVec.size();n++){ // int bit = (copyVec[n]/mod)%10; // bit=bit<0?-1*bit:bit; // vec[offset[bit]++]=copyVec[n]; //offset[bit]++ \u8868\u793a\u6876\u4e2d\u4e0b\u4e00\u4e2a\u5143\u7d20\u7684\u4f4d\u7f6e\u5411\u540e\u79fb\u52a8\u4e00\u4f4d // } /*\u901a\u8fc7\u590d\u7528count\u6765\u907f\u514doffset, count[k+1]\u8868\u793a\u4f4d\u6570\u4e3ak\u7684\u4e2a\u6570\uff0c \u4ece\u5c0f\u5230\u5927\u626b\u63cf\uff0ccoutn[k]+=count[k-1]\uff0c \u5f97\u5230\u7684count\u524d10\u4f4d\u6b63\u597d\u5c31\u662f\u4e4b\u524d\u7684offset*/ std::vector<int> count(11, 0); for(int k=0;k<vec.size();k++){ int tmp=(vec[k]/mod)%10; tmp = tmp>=0?tmp:-1*tmp; //\u6c42\u7b2ci\u4f4d\u4e0a\u6570\u5b57\u4e3a\u591a\u5c11 count[tmp+1]++; } for(int m=1;m<11;m++) count[m]+=count[m-1]; std::vector<int> copyVec=vec; for(int n=0;n<copyVec.size();n++){ int bit = (copyVec[n]/mod)%10; bit=bit<0?-1*bit:bit; vec[count[bit]++]=copyVec[n]; } } } void count_radix_sort(std::vector<int>& vec){ std::vector<int> negative, positive; int minNeg=0, maxPos=0; for(auto& v:vec){ if(v<0){ minNeg=v<minNeg?v:minNeg; negative.push_back(v); }else{ maxPos=v>maxPos?v:maxPos; positive.push_back(v); } } minNeg*=-1; int numNeg=0, numPos=0; while(minNeg){ minNeg/=10; numNeg++; } while(maxPos){ maxPos/=10; numPos++; } inside_counting_radix_sort(negative, numNeg); inside_counting_radix_sort(positive, numPos); int k=0; for(int i=negative.size()-1; i>=0;i--){ vec[k++]=negative[i]; } for(auto& v:positive) vec[k++]=v; }","title":"Sort"},{"location":"DataStruct/Sort/#_1","text":"","title":"\u6392\u5e8f"},{"location":"DataStruct/Sort/#_2","text":"\u4fdd\u8bc1\u5728\u6392\u5e8f\u4e4b\u524d\uff0c2\u4e2a\u76f8\u7b49\u7684\u6570\u5176\u5728\u5e8f\u5217\u7684\u524d\u540e\u4f4d\u7f6e\u987a\u5e8f\u548c\u6392\u5e8f\u4e4b\u540e\u5b83\u4eec\u4e24\u4e2a\u7684\u524d\u540e\u4f4d\u7f6e\u987a\u5e8f\u76f8\u540c\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5982\u679cAi = Aj\uff0cAi\u539f\u6765\u5728\u4f4d\u7f6e\u524d\uff0c\u6392\u5e8f\u540eAi\u8fd8\u662f\u8981\u5728Aj\u4f4d\u7f6e\u524d\u3002 \u2003 \u5806\u6392\u5e8f\u3001\u5feb\u901f\u6392\u5e8f\u3001\u5e0c\u5c14\u6392\u5e8f\u3001\u9009\u62e9\u6392\u5e8f\u662f\u4e0d\u7a33\u5b9a\u7684\u6392\u5e8f\u7b97\u6cd5\uff0c\u800c\u57fa\u6570\u6392\u5e8f\u3001\u5192\u6ce1\u6392\u5e8f\u3001\u63d2\u5165\u6392\u5e8f\u3001\u5f52\u5e76\u6392\u5e8f\u662f\u7a33\u5b9a\u7684\u6392\u5e8f\u7b97\u6cd5\u3002 \u2003\u8981\u6392\u5e8f\u7684\u5185\u5bb9\u662f\u4e00\u4e2a\u590d\u6742\u5bf9\u8c61\u7684\u591a\u4e2a\u6570\u5b57\u5c5e\u6027\uff0c\u4e14\u5176\u539f\u672c\u7684\u521d\u59cb\u987a\u5e8f\u5b58\u5728\u610f\u4e49\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u5728\u4e8c\u6b21\u6392\u5e8f\u7684\u57fa\u7840\u4e0a\u4fdd\u6301\u539f\u6709\u6392\u5e8f\u7684\u610f\u4e49\uff0c\u624d\u9700\u8981\u4f7f\u7528\u5230\u7a33\u5b9a\u6027\u7684\u7b97\u6cd5","title":"\u7a33\u5b9a\u6392\u5e8f\u7b97\u6cd5"},{"location":"DataStruct/Sort/#_3","text":"1\u3001\u9009\u62e9\u6392\u5e8f void selection_sort(std::vector<int>& vec){ for(int i=0;i<vec.size();i++){ int minIndex=i; for(int j=i+1;j<vec.size();j++){ if(vec[j]<vec[minIndex])minIndex=j; } std::swap(vec[i], vec[minIndex]); } } 2\u3001\u5192\u6ce1\u6392\u5e8f void maopao_sort(std::vector<int>& vec){ for(int i=0;i<vec.size()-1;i++){ for(int j=0;j<vec.size()-1-i;j++){ if(vec[j]>vec[j+1]) std::swap(vec[j], vec[j+1]); } } } 3\u3001\u63d2\u5165\u6392\u5e8f void insertion_sort(std::vector<int>& vec){ for(int i=1;i<vec.size();i++){ int tmp=std::move(vec[i]); int j=i; for(;j>0&&vec[j-1]>tmp;--j){ vec[j]=std::move(vec[j-1]); //\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u907f\u514d\u4e2d\u95f4\u8fc7\u7a0b\u7684\u76f8\u4e92\u4ea4\u6362 } vec[j]=std::move(tmp); } } //\u5bf9\u6570\u7ec4\u8303\u56f4\u5185\u7684\u5143\u7d20\u8fdb\u884c\u63d2\u5165\u6392\u5e8f void inside_insertion_sort(std::vector<int>& vec, int left, int right){ for(int i=left+1;i<right+1;i++){ int tmp=std::move(vec[i]); int j=i; for(;j>=left+1&&vec[j-1]>tmp;--j){ vec[j]=std::move(vec[j-1]); //\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u907f\u514d\u4e2d\u95f4\u8fc7\u7a0b\u7684\u76f8\u4e92\u4ea4\u6362 } vec[j]=std::move(tmp); } } \u7b80\u5355\u6392\u5e8f\u7b97\u6cd5\u7684\u4e0b\u754c : \u2003N\u4e2a\u4e92\u5f02\u5143\u7d20\u7684\u6570\u7ec4\u5176\u548c\u81ea\u8eab\u9006\u5e8f\u540e\u6570\u7ec4\uff0c\u4e24\u4e2a\u6570\u7ec4\u4e2d\u5b58\u5728\u7684\u9006\u5e8f\u5bf9\u7684\u6570\u91cf\u548c\u662fC 2 N =N(N-1)/2\uff0c\u6545N\u4e2a\u4e92\u5f02\u5143\u7d20\u7684\u6570\u7ec4\u4e2d\u5b58\u5728\u7684\u5e73\u5747\u9006\u5e8f\u5bf9\u6570\u662fN(N-1)/4\u3002 \u2003\u5728\u7b80\u5355\u6392\u5e8f\u7b97\u6cd5\u4e2d(\u4e0a\u8ff0\u4e09\u4e2a)\uff0c\u4ea4\u6362\u4e00\u5bf9\u9006\u5e8f\u6570\uff0c\u53ef\u4ee5\u6d88\u9664\u4e00\u5bf9\u9006\u5e8f\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u7b97\u6cd5\u4e2d\u8fd8\u6709O(N)\u9879\u5de5\u4f5c\uff0c\u56e0\u6b64\u6574\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u4e3aO(N+I)\uff0cI\u4e3a\u9006\u5e8f\u5bf9\u7684\u6570\u91cf\uff0c\u53ef\u77e5\uff0c\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u4e0b\u754c\u4e3a\u03a9(N+N(N-1)/4) = O(N^2)\u3002 \u2003\u4e3a\u4e86\u4f7f\u5f97\u6392\u5e8f\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u964d\u4f4e\u5230\u4e8c\u6b21\u4e00\u4e0b\uff0c\u5c31\u610f\u5473\u7740\u6bcf\u6b21\u4ea4\u6362\u5220\u9664\u4e0d\u6b62\u4e00\u4e2a\u9006\u5e8f 4\u3001\u5e0c\u5c14\u6392\u5e8f(\u7f29\u51cf\u589e\u91cf\u6392\u5e8f) \u5e0c\u5c14\u6392\u5e8f\u4e2d\u5bf9\u4e8e\u589e\u91cf\u5e8f\u5217\u7684\u9009\u62e9\u5341\u5206\u91cd\u8981\uff0c\u76f4\u63a5\u5f71\u54cd\u5230\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u4e0b\u9762\u9009\u62e9\u7684\u589e\u91cf\u5e8f\u5217\u4e3a{N/2,(N/2)/2, ..., 1}(\u5e0c\u5c14\u589e\u91cf)\uff0c\u5176\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u4f9d\u7136\u4e3aO(n 2 )\uff0c\u4e00\u4e9b\u7ecf\u8fc7\u4f18\u5316\u7684\u589e\u91cf\u5e8f\u5217\u5982Hibbard\u7ecf\u8fc7\u590d\u6742\u8bc1\u660e\u53ef\u4f7f\u5f97\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(N 3/2 )\u3002 void shell_sort(std::vector<int>& vec){ for(int gap=vec.size()/2; gap>0;gap/=2){ for(int i=gap;i<vec.size();i++){ // \u4e0b\u9762\u548c\u63d2\u5165\u6392\u5e8f\u8fc7\u7a0b\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7\u4ea4\u6362\u7684\u5143\u7d20\u95f4\u9694\u4e3agap int temp=std::move(vec[i]); int j=i; for(;j>=gap && temp<vec[j-gap];j-=gap){ vec[j] = std::move(vec[j-gap]); } vec[j]=std::move(temp); } } } 5\u3001\u5806\u6392\u5e8f \u2003\u5efa\u7acbN\u4e2a\u5143\u7d20\u7684\u4e8c\u53c9\u5806\uff0c\u82b1\u8d39O(N)\u65f6\u95f4\uff1b\u7136\u540e\u6267\u884cN\u6b21deleteMin\u64cd\u4f5c\uff0c\u6700\u5c0f\u7684\u5143\u7d20\u79bb\u5f00\u5806(\u5b9e\u9645\u4e0a\u662f\u79fb\u52a8\u5230\u5b58\u50a8\u5806\u7684\u6570\u7ec4\u6700\u540e\u7684\u4f4d\u7f6e)\uff0c\u5219N\u6b21\u5220\u9664\u540e\uff0c\u6570\u7ec4\u4e2d\u5143\u7d20\u6309\u9012\u51cf\u7684\u987a\u5e8f\u5b58\u50a8\uff0c\u6bcf\u6b21\u5220\u9664\u8017\u65f6O(log N), \u5219\u7b97\u6cd5\u8017\u65f6\u4e3aO(N+Nlog N)=O(Nlog N). \u2003\u5982\u679c\u6784\u5efa\u7684\u5806\u662f\u6700\u5927\u5806\uff0c\u5219\u6700\u540e\u5f97\u5230\u7684\u6570\u7ec4\u5143\u7d20\u6b63\u597d\u6309\u589e\u5e8f\u5b58\u50a8\u3002 # define leftchild(i) (2*i+1) //i\u4f4d\u7f6e\u7684\u8282\u70b9\u7684\u5de6\u513f\u5b50\u4e0b\u6807\uff0c\u56e0\u4e3a\u6570\u7ec4\u662f\u4ece0\u5f00\u59cb\u5b58\u50a8\u7684 template<typename comparable> // i:\u4e0b\u6ee4\u4f4d\u7f6e\uff0cn: \u5806\u7684\u903b\u8f91\u5927\u5c0f void percDown(std::vector<comparable>& vec, int i, int n){ int child; comparable tmp; for(tmp=std::move(vec[i]); leftchild(i)<n;i=child){ child = leftchild(i); if(child!=n-1 && vec[child]<vec[child+1]) child++; if(tmp<vec[child]) vec[i]=std::move(vec[child]); //\u7a7a\u7a74\u4e0b\u6ee4 else break; } vec[i]=std::move(tmp); } void heap_sort(std::vector<int>& vec){ //\u6784\u5efa\u6700\u5927\u5806 for(int i=vec.size()/2 - 1; i>=0; i--)// i<=len/2-1, \u5219\u5176\u5de6\u5b69\u5b50\u4e0b\u6807<=len-1, \u7b49\u4e8e\u8bf4\u660ei\u8282\u70b9\u6ca1\u6709\u53f3\u5b69\u5b50 percDown(vec, i, vec.size()); // \u5220\u9664 for(int j=vec.size()-1;j>0;--j){ std::swap(vec[0], vec[j]); percDown(vec, 0, j); } } 6\u3001\u5f52\u5e76\u6392\u5e8f, \u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(Nlog N) \u2003\u5f52\u5e76\u6392\u5e8f\u7684\u6bd4\u8f83\u6b21\u6570\u662f\u6700\u5c11\u7684\uff0c\u4f46\u5176\u9700\u8981\u989d\u5916\u7684\u5185\u5b58\u6765\u5b58\u50a8\u4e34\u65f6\u6570\u7ec4\uff0c\u5e76\u4e14\u8017\u8d39\u7ebf\u6027\u65f6\u95f4\uff0c\u5728\u4e24\u8005\u4e4b\u95f4\u590d\u5236\u5143\u7d20\u3002 void merge(std::vector<int>& a, std::vector<int>& tmpArr, int leftPos, int rightPos, int rightEnd){ int leftEnd = rightPos-1; int tmpPos=leftPos; int numElements = rightEnd-leftPos+1; while(leftPos<=leftEnd && rightPos<=rightEnd){ if(a[leftPos]<=a[rightPos]) tmpArr[tmpPos++]=std::move(a[leftPos++]); else tmpArr[tmpPos++] = std::move(a[rightPos++]); } while(leftPos<=leftEnd) tmpArr[tmpPos++]=std::move(a[leftPos++]); while(rightPos<=rightEnd) tmpArr[tmpPos++]=std::move(a[rightPos++]); //\u5c06\u6392\u5e8f\u540e\u7684\u4e34\u65f6\u6570\u7ec4\u590d\u5236\u56de\u539f\u6570\u7ec4 for(int i=0;i<numElements;++i, --rightEnd){ a[rightEnd] = std::move(tmpArr[rightEnd]); } } void mergeSort(std::vector<int>& a, std::vector<int>& tmpArr, int left, int right){ if(left<right){ int mid=(left+right)/2; mergeSort(a, tmpArr, left, mid); mergeSort(a, tmpArr, mid+1, right); merge(a, tmpArr, left, mid+1, right); } } //\u7b80\u6d01\u5199\u6cd5\uff0c\u63a8\u8350 void mergeSort2(vector<int>& nums, vector<int>& tmpArr, int left, int right){ if(left>=right)return; int mid=(left+right)/2; mergeSort(nums, tmpArr, left, mid); mergeSort(nums, tmpArr, mid+1, right); for(int p=left;p<=right;p++){ tmpArr[p]=nums[p]; } int i=left, j=mid+1; //i,j\u5206\u522b\u662f\u5de6\u53f3\u6570\u7ec4\u9996\u5143\u7d20\u7684\u4e0b\u6807 for(int k=left; k<=right;k++){ if(j==right+1 || tmpArr[i]<=tmpArr[j]) nums[k]=std::move(tmpArr[i++]); else nums[k]=std::move(tmpArr[j++]); // i==mid+1 || tmpArr[j]<tmpArr[i] } } void merge_sort(std::vector<int>& a){ std::vector<int> tmpArr(a.size()); mergeSort(a, tmpArr, 0, a.size()-1); } 7\u3001\u5feb\u901f\u6392\u5e8f, \u65f6\u95f4\u590d\u6742\u5ea6O(Nlog N) \u2003\u9488\u5bf9\u53ef\u80fd\u51fa\u73b0\u7684\u9884\u6392\u5e8f\u7684\u6570\u636e\u6216\u5305\u542b\u4e00\u5927\u6bb5\u6392\u5e8f\u6570\u636e\uff0c\u56fa\u5b9a\u7b2c\u4e00\u4e2a\u6216\u4e2d\u95f4\u5143\u7d20\u4f5c\u4e3a\u67a2\u7ebd\u5143\u53ef\u80fd\u4f1a\u5bf9\u6392\u5e8f\u65f6\u95f4\u9020\u6210\u4e25\u91cd\u4f24\u5bb3\uff0c\u56e0\u4e3a\u6b64\u65f6\u67a2\u7ebd\u5143\u65e0\u6cd5\u5f88\u597d\u7684\u5c06\u6570\u7ec4\u5206\u5272\u6210\u5747\u5300\u7684\u4e24\u90e8\u5206;\u968f\u673a\u9009\u53d6\u5219\u9700\u8981\u501f\u52a9\u968f\u673a\u6570\u53d1\u751f\u5668\uff0c\u5e26\u6765\u989d\u5916\u5f00\u9500\uff1b\u8fd9\u91cc\u91c7\u7528\u4e09\u5143\u4e2d\u503c\u6cd5\u9009\u53d6\u67a2\u7ebd\uff0c\u5373\u5f00\u59cb\u3001\u4e2d\u95f4\u3001\u672b\u5c3e\u4e09\u4e2a\u5143\u7d20\u7684\u4e2d\u503c\u4f5c\u4e3a\u67a2\u7ebd\u5143\u3002 //\u5feb\u901f\u6392\u5e8f \u7b80\u6613\u7248 void simple_quick_sort(std::vector<int>& vec){ if(vec.size()>1){ std::vector<int> smaller, same, larger; auto pivot = vec[vec.size()/2]; for(auto &v:vec){ if(v<pivot)smaller.push_back(v); else if(v>pivot) larger.push_back(v); else same.push_back(v); } simple_quick_sort(smaller); simple_quick_sort(larger); std::move(begin(smaller), end(smaller), begin(vec)); std::move(begin(same), end(same), begin(vec)+smaller.size()); std::move(begin(larger), end(larger), end(vec)-larger.size()); } } // \u5feb\u901f\u6392\u5e8f void median3(std::vector<int>& a, int left, int right){ /*\u4e09\u6570\u4e2d\u503c\u5206\u5272\uff1a\u6d88\u9664\u8f93\u5165\u6570\u636e\u9884\u5148\u6392\u5e8f\u7684\u574f\u60c5\u5f62*/ int center = (left+right)/2; //\u4e0b\u9762\u7684\u987a\u5e8f\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u80fd\u968f\u610f\u8c03\u6362\u987a\u5e8f\uff0c\u5148\u786e\u4fddleft\u4f4d\u7f6e\u4e0a\u5143\u7d20\u6700\u5c0f\uff0c\u518d\u786e\u4fdd\u4e2d\u95f4\u4f4d\u7f6e\u5143\u7d20\u6b21\u5c0f if(a[center]<a[left]) std::swap(a[center], a[left]); if(a[right] < a[left]) std::swap(a[right], a[left]); if(a[right]<a[center]) std::swap(a[center], a[right]); //\u5c06pivot\u7f6e\u4e8eright-1\u5904 std::swap(a[center], a[right-1]); } //\u91c7\u7528median3\u786e\u5b9apivot void _partition1(std::vector<int>& a, int left, int right){ if(left+2<=right){ median3(a, left, right); const int pivot= a[right-1]; //\u7ecf\u8fc7\u4e09\u6570\u4e2d\u503c\u5206\u5272\u540e\uff0c\u9009\u62e9\u5012\u6570\u7b2c\u4e8c\u4e2a\u6570\u4e3apivot //\u5f00\u59cb\u5206\u5272 int i=left, j=right-1; for(;;){ while(a[++i]<pivot); while(a[--j]>pivot); if(i<j){ std::swap(a[i], a[j]); //\u6b64\u65f6i\u4f9d\u65e7\u5728j\u5de6\u4fa7\uff0ca[i]>=pivot, a[j]<=pivot, \u4ea4\u6362\u4e24\u8005 }else break; // i\u5df2\u7ecf\u79fb\u52a8\u5230j\u53f3\u4fa7\uff0c\u8df3\u51fa\u5faa\u73af } //\u6b64\u65f6 pos<i\u7684\u5143\u7d20\u5747\u5c0f\u4e8e\u7b49\u4e8epivot, pos>j\u7684\u5143\u7d20\u5747\u5927\u4e8e\u7b49\u4e8epivot\uff0c //i\u4e24\u4fa7\u7684\u5143\u7d20\u5e76\u975e\u4e00\u5b9a\u6709\u5e8f\u7684\uff0c\u53ea\u662f\u5747\u5c0f\u4e8e\u7b49\u4e8e\u6216\u5927\u4e8e\u7b49\u4e8epivot //\u518d\u5c06pivot\u4ece\u4f4d\u7f6eright-1\u6362\u5230i, \u518d\u5bf9i\u4e24\u4fa7\u7684\u5143\u7d20\u505a\u9012\u5f52\u8c03\u7528 std::swap(a[i], a[right-1]); _partition1(a, left, i-1); _partition1(a, i+1, right); }else{ //\u6570\u7ec4\u5143\u7d20\u5c0f\u4e8e5\uff0c \u91c7\u7528\u63d2\u5165\u6392\u5e8f // inside_insertion_sort(a, left, right); //\u6570\u7ec4\u5143\u7d20\u7b49\u4e8e2\uff0c\u76f4\u63a5\u5224\u65ad\u4e24\u8005 if(a[left]>a[right]) std::swap(a[left], a[right]); } } //\u56fa\u5b9aright\u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\u4e3apivot void _partition2(std::vector<int>& vec, int left, int right){ if(left>=right)return; int pivot=vec[right]; int i=left, j=right; while(i<j){ while(i<j && vec[i]<=pivot)i++; while(i<j && vec[j]>=pivot)j--; if(i<j){ swap(vec[i], vec[j]); } } swap(vec[i], vec[right]); _partition2(vec, left, i-1); _partition2(vec, i+1, right); } void quick_sort(std::vector<int>& vec){ std::cout<<\"median3:\\n\"; _partition1(vec, 0, vec.size()-1); // std::cout<<\"fix right:\" // _partition2(vec, 0, vec.size()-1); }","title":"\u4e5d\u79cd\u6392\u5e8f"},{"location":"DataStruct/Sort/#_4","text":"8\u3001\u6876\u6392\u5e8f\uff0c \u5f53\u9700\u8981\u6392\u5e8f\u7684\u6570\u8303\u56f4\u8fc7\u5927\u65f6\uff0c\u5c06\u9700\u8981\u975e\u5e38\u5927\u7684\u989d\u5916\u7a7a\u95f4\u5f00\u9500 \u57fa\u6570\u6392\u5e8f \u2003\u5bf9\u6570\u5b57\u578b\u6216\u5b57\u7b26\u578b\u7684\u5355\u5173\u952e\u5b57\uff0c\u53ef\u4ee5\u770b\u4f5c\u7531\u591a\u4e2a\u6570\u4f4d\u6216\u591a\u4e2a\u5b57\u7b26\u6784\u6210\u7684\u591a\u5173\u952e\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6570\u5b57\u6216\u5b57\u7b26\u53ef\u80fd\u7684\u53d6\u503c\u4e2a\u6570\u79f0\u4e3a\u57fa\u6570\u3002\u4f8b\u59820~999\u7684\u6570\u5b57\uff0c\u5171\u67093\u4f4d\uff0c\u6bcf\u4f4d\u4e0a\u670910\u79cd\u53ef\u80fd\u3002\u5728\u6309\u7b2ck\u4f4d\u6392\u5e8f\u65f6\uff0c\u843d\u5728\u540c\u4e00\u4e2a\u6876\u4e2d\u7684\u5143\u7d20\uff0c\u662f\u6309\u7167\u7b2ck-1\u4f4d\u6392\u5e8f\u7684\u3002 \u2003 \u65f6\u95f4\u590d\u6742\u5ea6O(d*N) , d\u4ee3\u8868\u6700\u5927\u5143\u7d20\u7684\u4f4d\u6570\u3002 \u2003\u9488\u5bf9\u6b63\u8d1f\u6df7\u5408\u7684\u6570\u636e\uff0c\u9700\u8981\u5206\u79bb\u6210\u4e24\u4e2a\u6570\u7ec4\u5206\u522b\u6392\u5e8f; \u800c\u4e14\u4e0d\u9002\u7528\u6d6e\u70b9\u6570\u6392\u5e8f\uff0c\u4e00\u822c\u7528\u4f5c\u6574\u6570\u6216\u8005\u5b57\u7b26\u4e32\u6392\u5e8f(\u91c7\u7528\u6bcf\u4e2a\u5b57\u7b26\u5bf9\u5e94\u7684ascii\u7801) //num\u4ee3\u8868vec\u4e2d\u6240\u6709\u6570\u5b57\u6700\u5927\u6709\u51e0\u4f4d void inside_radix_sort(std::vector<int>& vec, int num){ std::vector<int>* buckets= new std::vector<int>[10]; for(int i=0;i<num;i++){ for(auto &v:vec){ int j=i; auto copy=v; int tmp; while(j-- >= 0){ tmp=copy%10; copy = (copy-tmp)/10; } tmp = tmp<0?-1*tmp:tmp; //\u7b2ck\u4f4d\u6570\uff0c tmp\u53d6\u503c\u8303\u56f40\u52309 buckets[tmp].push_back(v); } int k=0; for(int p=0;p<10;p++){ for(auto& v:buckets[p]){ vec[k++]=v; } buckets[p].clear(); } } delete[] buckets; } void inside_radix_sort2(std::vector<int>& vec){ std::vector<int> odd; //\u5947\u6570 std::vector<int> even; //\u5076\u6570 for(int i=0;i<32;i++){ //\u5c06\u6574\u6570\u770b\u621032\u4f4d\u7684\u4e8c\u8fdb\u5236 for(auto &v:vec){ if((v>>i & 1)==0) even.push_back(v); else odd.push_back(v); } int j=0; for(auto& v:even) vec[j++]=v; for(auto& v:odd) vec[j++]=v; even.clear(); odd.clear(); } } /*binary:true, \u4ee3\u8868\u5c06\u6bcf\u4e2a\u6574\u6570\u770b\u621032\u4f4d\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u8fd9\u6837\u5c31\u65e0\u9700\u8ba1\u7b97\u6700\u5927\u5143\u7d20\u7684\u4f4d\u6570\u4e86; radix_sort\u662f\u4e3b\u51fd\u6570\uff0c\u5c06\u6570\u7ec4\u4e2d\u7684\u6b63\u8d1f\u6570\u5206\u79bb */ void radix_sort(std::vector<int>& vec, bool binary=false){ std::vector<int> negative, positive; int minNeg=0, maxPos=0; for(auto& v:vec){ if(v<0){ minNeg=v<minNeg?v:minNeg; negative.push_back(v); }else{ maxPos=v>maxPos?v:maxPos; positive.push_back(v); } } int k=0; if(!binary){ minNeg*=-1; int numNeg=0, numPos=0; while(minNeg){ minNeg/=10; numNeg++; } while(maxPos){ maxPos/=10; numPos++; } inside_radix_sort(negative, numNeg); inside_radix_sort(positive, numPos); for(int i=negative.size()-1; i>=0;i--){ vec[k++]=negative[i]; } }else{ inside_radix_sort2(negative); inside_radix_sort2(positive); for(auto& v:negative) vec[k++]=v; } for(auto& v:positive) vec[k++]=v; } \u8ba1\u6570\u57fa\u6570\u6392\u5e8f \u2003\u57fa\u6570\u6392\u5e8f\u7684\u53e6\u4e00\u79cd\u5b9e\u73b0\uff0c\u907f\u514d\u4e86\u4f7f\u7528\u989d\u5916\u7684vector< vector< int > >\u6765\u8868\u793a\u6876, \u4ec5\u9700\u8981\u8868\u793a\u6bcf\u4e2a\u57fa\u6570\u6570\u91cf\u7684count\u6570\u7ec4\uff0c\u548c\u6876\u4e2d\u5143\u7d20\u5728\u4e2d\u95f4\u8fc7\u7a0b\u6392\u5e8f\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6eoffset, \u8fdb\u4e00\u6b65\u4f18\u5316\uff0c\u8fd8\u53ef\u4ee5\u540c\u65f6\u7528count\u6765\u8ba1\u7b97\u5f97\u5230offset\u3002 void inside_counting_radix_sort(std::vector<int>& vec, int num){ for(int i=0;i<num;i++){ int mod = 1, j=i; while(j-->0)mod*=10; // std::vector<int> count(10, 0), offset(10, 0); // for(int k=0;k<vec.size();k++){ // int tmp=(vec[k]/mod)%10; // tmp = tmp>=0?tmp:-1*tmp; //\u6c42\u7b2ci\u4f4d\u4e0a\u6570\u5b57\u4e3a\u591a\u5c11 // count[tmp]++; // } /*offset[k]\u4ee3\u8868\u7b2c\u4e00\u4e2a\u4f4d\u6570\u4e3ak\u7684\u5143\u7d20\u5728\u65b0\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6epos\uff0c\u6bcf\u6b21\u5b89\u6392\u6876\u4e2d\u4e00\u4e2a\u5143\u7d20\u540e\uff0c\u8ba9pos\u503c\u81ea\u589e\uff0c \u8fd9\u6837\u6876\u4e2d\u4e0b\u4e00\u4e2a\u5143\u7d20\u7684\u4f4d\u7f6e\u5c31\u4f1a\u9012\u589e\u5230\u4e0b\u4e00\u4f4d*/ // for(int m=1;m<10;m++) // offset[m]=offset[m-1]+count[m-1]; // std::vector<int> copyVec=vec; // for(int n=0;n<copyVec.size();n++){ // int bit = (copyVec[n]/mod)%10; // bit=bit<0?-1*bit:bit; // vec[offset[bit]++]=copyVec[n]; //offset[bit]++ \u8868\u793a\u6876\u4e2d\u4e0b\u4e00\u4e2a\u5143\u7d20\u7684\u4f4d\u7f6e\u5411\u540e\u79fb\u52a8\u4e00\u4f4d // } /*\u901a\u8fc7\u590d\u7528count\u6765\u907f\u514doffset, count[k+1]\u8868\u793a\u4f4d\u6570\u4e3ak\u7684\u4e2a\u6570\uff0c \u4ece\u5c0f\u5230\u5927\u626b\u63cf\uff0ccoutn[k]+=count[k-1]\uff0c \u5f97\u5230\u7684count\u524d10\u4f4d\u6b63\u597d\u5c31\u662f\u4e4b\u524d\u7684offset*/ std::vector<int> count(11, 0); for(int k=0;k<vec.size();k++){ int tmp=(vec[k]/mod)%10; tmp = tmp>=0?tmp:-1*tmp; //\u6c42\u7b2ci\u4f4d\u4e0a\u6570\u5b57\u4e3a\u591a\u5c11 count[tmp+1]++; } for(int m=1;m<11;m++) count[m]+=count[m-1]; std::vector<int> copyVec=vec; for(int n=0;n<copyVec.size();n++){ int bit = (copyVec[n]/mod)%10; bit=bit<0?-1*bit:bit; vec[count[bit]++]=copyVec[n]; } } } void count_radix_sort(std::vector<int>& vec){ std::vector<int> negative, positive; int minNeg=0, maxPos=0; for(auto& v:vec){ if(v<0){ minNeg=v<minNeg?v:minNeg; negative.push_back(v); }else{ maxPos=v>maxPos?v:maxPos; positive.push_back(v); } } minNeg*=-1; int numNeg=0, numPos=0; while(minNeg){ minNeg/=10; numNeg++; } while(maxPos){ maxPos/=10; numPos++; } inside_counting_radix_sort(negative, numNeg); inside_counting_radix_sort(positive, numPos); int k=0; for(int i=negative.size()-1; i>=0;i--){ vec[k++]=negative[i]; } for(auto& v:positive) vec[k++]=v; }","title":"\u7ebf\u6027\u65f6\u95f4\u6392\u5e8f"},{"location":"DataStruct/Tree/","text":"\u6570\u636e\u7ed3\u6784 \u6811-\u57fa\u672c\u6982\u5ff5 \u8282\u70b9\u6df1\u5ea6: \u4ece\u6839\u8282\u70b9\u5230\u8be5\u8282\u70b9\u7684\u552f\u4e00\u8def\u5f84\u7684\u957f\u5ea6 \u8282\u70b9\u9ad8\uff1a\u8be5\u8282\u70b9\u5230\u4e00\u4e2a\u53f6\u8282\u70b9\u7684\u6700\u957f\u8def\u5f84\u7684\u957f\u5ea6 \u6811\u7684\u6df1\u5ea6\u7b49\u4e8e\u6811\u7684\u9ad8\u5ea6\uff0c\u662f\u6839\u8282\u70b9\u5230\u5176\u6700\u6df1\u6811\u53f6\u7684\u957f\u5ea6 \u6ee1\u4e8c\u53c9\u6811\uff1a\u9664\u6700\u540e\u4e00\u5c42\u65e0\u4efb\u4f55\u5b50\u8282\u70b9\u5916\uff0c\u6bcf\u4e00\u5c42\u4e0a\u7684\u6240\u6709\u7ed3\u70b9\u90fd\u6709\u4e24\u4e2a\u5b50\u7ed3\u70b9\u7684\u4e8c\u53c9\u6811\u3002\u9ad8\u5ea6\u4e3ah,\u5219\u8282\u70b9\u6570N=2 h+1 -1; h=O(log N) \u5b8c\u5168\u4e8c\u53c9\u6811\uff1a\u4e00\u68f5\u6df1\u5ea6\u4e3ak\u7684\u6709n\u4e2a\u7ed3\u70b9\u7684\u4e8c\u53c9\u6811\uff0c\u5bf9\u6811\u4e2d\u7684\u7ed3\u70b9\u6309\u4ece\u4e0a\u81f3\u4e0b\u3001\u4ece\u5de6\u5230\u53f3\u7684\u987a\u5e8f\u8fdb\u884c\u7f16\u53f7\uff0c\u5982\u679c\u7f16\u53f7\u4e3ai\uff081\u2264i\u2264n\uff09\u7684\u7ed3\u70b9\u4e0e\u6ee1\u4e8c\u53c9\u6811\u4e2d\u7f16\u53f7\u4e3ai\u7684\u7ed3\u70b9\u5728\u4e8c\u53c9\u6811\u4e2d\u7684\u4f4d\u7f6e\u76f8\u540c\uff0c\u5219\u8fd9\u68f5\u4e8c\u53c9\u6811\u79f0\u4e3a\u5b8c\u5168\u4e8c\u53c9\u6811\u3002 \u2003\u9ad8\u5ea6h\u7684\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c\u8282\u70b9\u65702 h <=N<=2 h+1 -1\u3002 \u4e8c\u53c9\u67e5\u627e\u6811: \u4efb\u4f55\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\u7684key\u503c\u90fd\u5c0f\u4e8e\u5f53\u524d\u8282\u70b9\u7684key\uff0c\u800c\u53f3\u5b50\u8282\u70b9\u7684key\u90fd\u5927\u4e8e\u5f53\u524d\u8282\u70b9\u7684key(\u8fd9\u91cckey\u5373\u662f\u7d22\u5f15)\uff1b\u4e8c\u53c9\u67e5\u627e\u6811\u7684\u5e73\u5747\u9ad8\u5ea6\u4e3aO(log N), N\u4e3a\u8282\u70b9\u4e2a\u6570\uff1b\u4f46\u5982\u679c\u5bf9\u5411\u4e00\u68f5\u6811\u8f93\u5165\u9884\u5148\u6392\u5e8f\u7684\u6570\u636e\uff0c\u6b64\u65f6\u4e8c\u53c9\u67e5\u627e\u6811\u4f1a\u9000\u5316\u6210\u5355\u5411\u94fe\u8868\uff0c\u67e5\u627e\u65f6\u95f4\u590d\u6742\u5ea6\u5c06\u53d8\u6210O(N)\u3002\u6545\u5f15\u51fa\u5e73\u8861\u4e8c\u53c9\u6811\u3002 \u4e8c\u53c9\u6811\u7684\u524d\u3001\u4e2d\u3001\u540e\u5e8f\u904d\u5386\u90fd\u53ef\u4ee5\u901a\u8fc7\u6808\u6765\u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(N), \u7a7a\u95f4\u590d\u6742\u5ea6O(N); \u82e5\u91c7\u7528\u9012\u5f52\u8c03\u7528\uff0c\u989d\u5916\u7684\u9700\u8981\u51fd\u6570\u6808\u7a7a\u95f4O(N); \u91c7\u7528Morris\u904d\u5386\uff0c\u53ef\u4ee5\u5c06\u7a7a\u95f4\u590d\u6742\u5ea6\u964d\u5230O(1) \u3002 0\u3001 \u8bb0\u4f5c\u5f53\u524d\u8282\u70b9\u4e3acur\u3002 1\u3001 1_1. \u5982\u679ccur\u65e0\u5de6\u5b69\u5b50\uff0ccur=cur.right, \u76f4\u63a5\u5230\u7b2c3\u6b65 1_2. \u5982\u679ccur\u6709\u5de6\u5b69\u5b50\uff0c\u627e\u5230cur\u5de6\u5b50\u6811\u4e0a\u6700\u53f3\u7684\u8282\u70b9\uff0c\u8bb0\u4e3amostright 2\u3001 2_1. if(mostright.right==NULL), then mostright.right=cur, cur=cur.left 2_2. if(mostright.right==cur), then mostright.right=NULL, cur=cur.right \u2003 3\u3001 \u91cd\u590d1\u30012\u76f4\u81f3cur\u4e3a\u7a7a 4\u3001 \u8fd4\u56de\u7ed3\u679c \u2003 \u524d\u5e8f\u904d\u5386:\u57281_1\u6b65,\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u540e\uff0ccur=cur.right; \u4ee5\u53ca\u57282_1\u6b65, \u5148\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u4e2d, then cur=cur.left \u4e2d\u5e8f\u904d\u5386:\u57281_1\u6b65,\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u540e\uff0ccur=cur.right; \u4ee5\u53ca\u57282_2\u6b65, \u5148\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u4e2d, then cur=cur.right \u540e\u5e8f\u904d\u5386:\u57282_2\u8fd9\u4e00\u6b65,\u5c06\u4ececur\u7684\u5de6\u8282\u70b9\u5230mostright\u8282\u70b9\u8def\u5f84\u4e0a\u7684\u6240\u6709\u8282\u70b9\u5012\u5e8f\u6dfb\u52a0\u7684\u7ed3\u679c\u4e2d(\u901a\u8fc7\u4e0b\u9762\u7684addPaths\u51fd\u6570); \u57284\u6b65, \u7ed3\u675f\u5faa\u73af\u540e\uff0c\u6b64\u65f6\u53ea\u5269\u4e0b\u6700\u53f3\u4fa7\u4e00\u6761\u8def\u5f84\u4e0a\u7684\u6240\u6709\u8282\u70b9(\u5305\u62ec\u6839\u8282\u70b9)\u5c1a\u672a\u6dfb\u52a0\u5230\u7ed3\u679c\u4e2d\u3002 \u603b\u7ed3: \u53ef\u4ee5\u770b\u51fa\u4e09\u79cd\u904d\u5386\uff0c\u5728morris\u7b97\u6cd5\u4e0b\uff0c\u6709\u76f8\u540c\u7684\u7ed3\u6784\uff0c \u533a\u522b\u5728\u4e8e\u6dfb\u52a0\u7ed3\u679c\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u540e\u5e8f\u904d\u5386\u4f7f\u9700\u8981\u989d\u5916\u7684\u51fd\u6570\u6765\u5012\u5e8f\u6dfb\u52a0\u7ed3\u679c \u800c\u5c42\u5e8f\u904d\u5386\u9700\u8981\u901a\u8fc7\u961f\u5217\u5b9e\u73b0\u3002 #include<vector> #include<stack> #include<queue> struct TreeNode { int val; TreeNode* left; TreeNode* right; TreeNode() : val(0), left(nullptr), right(nullptr) {} TreeNode(int x) : val(x), left(nullptr), right(nullptr) {} TreeNode(int x, TreeNode* left, TreeNode* right) : val(x), left(left), right(right) {} }; class solution{ public: //\u524d\u5e8f\u904d\u5386 std::vector<int> preorderTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; while(root || !st.empty()){ while(root){ ans.push_back(root->val); st.push(root); root=root->left; } root = st.top()->right; st.pop(); } return ans; } //\u4e2d\u5e8f\u904d\u5386 std::vector<int> inorderTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; while(root || !st.empty()){ while(root){ st.push(root); root=root->left; } root=st.top(); st.pop(); ans.push_back(root->val); root=root->right; } return ans; } //\u540e\u5e8f\u904d\u5386, \u9664\u53bb\u9012\u5f52\uff0c\u63d0\u4f9b\u4e864\u79cd\u65b9\u6cd5\uff0c\u524d\u4e09\u79cd\u90fd\u9700\u8981O(N)\u7684\u7a7a\u95f4\u590d\u6742\u5ea6, morris\u53ea\u9700O(1)\u7a7a\u95f4\u590d\u6742\u5ea6 std::vector<int> postorderTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; st.push(root); TreeNode* cur; while(!st.empty()){ cur=st.top();st.pop(); if(cur){ st.push(cur->left); st.push(cur->right); ans.push_back(cur->val); //\u8bbf\u95ee\u987a\u5e8f: \u6839\u3001\u53f3\u3001\u5de6\uff0c\u5bf9\u7ed3\u679c\u9006\u5e8f } } std::reverse(ans.begin(), ans.end()); return ans; } std::vector<int> postorderTraversal2(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<std::pair<TreeNode*, bool>> st; st.push(std::make_pair(root, false)); std::pair<TreeNode*, bool>* cur; while (!st.empty()) { cur = &st.top(); if(cur->second){//bool=true, \u8bf4\u660e\u662f\u5b50\u8282\u70b9\u5df2\u7ecf\u8bbf\u95ee\u4e86 ans.push_back(cur->first->val); st.pop(); }else{ //bool=false, \u8bf4\u660e\u5f53\u524d\u8282\u70b9\u7684\u5b50\u8282\u70b9\u5c1a\u672a\u8bbf\u95ee\uff0c\u5c06\u53f3\u5b69\u5b50\u548c\u5de6\u5b69\u5b50\u5148\u540e\u5165\u6808 cur->second=true; if(cur->first->right) st.push(std::make_pair(cur->first->right, false)); if(cur->first->left) st.push(std::make_pair(cur->first->left, false)); } } return ans; } std::vector<int> postorderTraversal3(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; TreeNode* prev; while(root || !st.empty()){ while(root){ st.push(root); root=root->left; } root = st.top(); if(!root->right || root->right==prev){ ans.push_back(root->val); prev=root; st.pop(); root=nullptr; }else root=root->right; } return ans; } //morros\u524d\u5e8f\u904d\u5386 std::vector<int> preorderTraversal2(TreeNode* root){ if(!root)return {}; std::vector<int> ans; TreeNode* cur=root, *next=nullptr; while (cur) { next=cur->left; if(next){ while(next->right && next->right!=cur) next=next->right; if(!next->right){ next->right=cur; ans.push_back(cur->val); cur=cur->left; }else{ next->right=nullptr; cur=cur->right; } }else { ans.push_back(cur->val); cur=cur->right; } } return ans; } //moris\u4e2d\u5e8f\u904d\u5386 std::vector<int> inorderTranversal2(TreeNode* root){ if(!root)return {}; std::vector<int> ans; TreeNode *cur=root, *next=nullptr; while(cur){ next=cur->left; if(next){ while (next->right && next->right!=cur) next=next->right; if(!next->right){ next->right=cur; cur=cur->left; }else{ next->right=nullptr; ans.push_back(cur->val); cur=cur->right; } }else{ ans.push_back(cur->val); cur=cur->right; } } return ans; } //morris\u540e\u5e8f\u904d\u5386 void addPath(vector<int> &vec, TreeNode *node) { int count = 0; while (node != nullptr) { ++count; vec.emplace_back(node->val); node = node->right; } reverse(vec.end() - count, vec.end()); } std::vector<int> postorderTraversal4(TreeNode* root){ if(!root)return {}; std::vector<int> ans; TreeNode *cur=root, *next=nullptr; while(cur){ next=cur->left; if(next){ while (next->right && next->right!=cur) next=next->right; if(!next->right){ next->right=cur; cur=cur->left; }else{ next->right=nullptr; addPath(ans, cur->left); cur=cur->right; } }else cur=cur->right; } addPath(ans, root); return ans; } //\u5c42\u5e8f\u904d\u5386 std::vector<int> LayerTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::queue<TreeNode*> qu; qu.push(root); while(!qu.empty()){ root=qu.front(); qu.pop(); ans.push_back(root->val); if(root->left)qu.push(root->left); if(root->right)qu.push(root->right); } return ans; } //\u7b2c\u4e8c\u79cd\u5f62\u5f0f\u7684\u5c42\u5e8f\u904d\u5386\uff0c\u53ea\u662f\u8fd4\u56de\u5f62\u5f0f\u4e0d\u540c std::vector<std::vector<int>> MulLayerTraversal(TreeNode* root){ if(!root)return {}; std::vector<std::vector<int>> ans; std::queue<TreeNode*> qu; qu.push(root); while(!qu.empty()){ int len=qu.size(); std::vector<int> tmp(len); for(int i=0;i<len;i++){ root=qu.front(); qu.pop(); tmp[i]=root->val; if(root->left)qu.push(root->left); if(root->right)qu.push(root->right); } ans.push_back(tmp); } return ans; } }; AVL\u6811 \u2003 \u5e73\u8861\u4e8c\u53c9\u6811 \uff0c\u5177\u6709\u4e8c\u53c9\u67e5\u627e\u6811\u5168\u90e8\u7279\u6027\uff0c\u4f46 \u6bcf\u4e2a\u8282\u70b9\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u7684\u9ad8\u5ea6\u6700\u591a\u5dee1\u7684\u4e8c\u53c9\u67e5\u627e\u6811 ( \u7a7a\u6811\u9ad8\u5ea6\u5b9a\u4e49\u4e3a-1 )\u3002 \u2003\u5728\u9ad8\u5ea6\u4e3ah\u7684AVL\u6811\u4e2d\uff0c\u6700\u5c11\u8282\u70b9\u6570S(h)=S(h-1)+S(h-2)+1\u5f97\u5230\u3002(S(0)=1, S(1)=2) \u2003\u5bf9\u4e8eN\u4e2a\u8282\u70b9\u7684AVL\u6811\uff0c\u6700\u574f\u67e5\u627e\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u4e3aO(log N), \u4f46\u7531\u4e8e\u63d2\u5165\u6216\u5220\u9664\u8282\u70b9\u4f1a\u7834\u574f\u5e73\u8861\u6027\uff0c\u56e0\u6b64\u9700\u8981\u901a\u8fc7 \u65cb\u8f6c \u6765\u6062\u590d\u6811\u7684\u5e73\u8861\u6027\u3002\u5728\u9891\u7e41\u63d2\u5165\u548c\u5220\u9664\u573a\u666f\u4e0b\uff0c\u65cb\u8f6c\u662f\u5341\u5206\u8017\u65f6\u7684\uff0c\u56e0\u6b64\u53c8\u5f15\u51fa \u7ea2\u9ed1\u6811 \u3002 \u65cb\u8f6c\uff1a \u5728\u4e00\u6b21\u63d2\u5165\u4e4b\u548c\uff0c\u53ea\u6709\u90a3\u4e9b\u4ece\u63d2\u5165\u70b9\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u7684\u8282\u70b9\u7684\u5e73\u8861\u53ef\u80fd\u4f1a\u88ab\u6539\u53d8\uff0c\u56e0\u4e3a\u53ea\u6709\u8fd9\u4e9b\u8282\u70b9\u7684\u5b50\u6811\u53ef\u80fd\u53d1\u751f\u53d8\u5316\u3002 \u6cbf\u63d2\u5165\u8282\u70b9\u4e0a\u884c\uff0c\u5c06\u6bcf\u4e00\u4e2a\u5fc5\u987b\u91cd\u65b0\u5e73\u8861\u7684\u8282\u70b9 \u53eb\u505a\u03b1\uff0c\u7531\u4e8e\u4efb\u610f\u8282\u70b9\u6700\u591a\u6709\u4e24\u4e2a\u513f\u5b50\uff0c\u53ef\u77e5\u5176\u4e24\u9897\u5b50\u6811\u7684\u9ad8\u5ea6\u4e00\u5b9a\u76f8\u5dee2\u3002 \u4e0d\u5e73\u8861\u53ef\u80fd\u67094\u79cd\u60c5\u51b5\uff1a \\1. \u5bf9\u03b1\u7684\u5de6\u513f\u5b50\u7684\u5de6\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u5de6-\u5de6)\uff1b \\2. \u5bf9\u03b1\u7684\u5de6\u513f\u5b50\u7684\u53f3\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u5de6-\u53f3)\uff1b \\3. \u5bf9\u03b1\u7684\u53f3\u513f\u5b50\u7684\u5de6\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u53f3-\u5de6)\uff1b \\4. \u5bf9\u03b1\u7684\u53f3\u513f\u5b50\u7684\u53f3\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u53f3-\u53f3)\uff1b \u60c5\u51b51\u548c4\uff0c2\u548c3\u5404\u81ea\u6210\u955c\u50cf \u5de6-\u5de6\u548c\u53f3-\u53f3\u53ef\u4ee5\u901a\u8fc7\u5355\u65cb\u8f6c\u6765\u5b8c\u6210\u8c03\u6574\uff0c\u5de6-\u53f3\u548c\u53f3-\u5de6\u5219\u9700\u901a\u8fc7\u53cc\u65cb\u8f6c\u6765\u8c03\u6574\u3002 1\u3001\u5de6-\u5de6\u578b\uff1a\u505a\u53f3\u65cb\u3002 2\u3001\u53f3-\u53f3\u578b\uff1a\u505a\u5de6\u65cb\u3002 3\u3001\u5de6-\u53f3\u578b\uff1a\u5148\u505a\u5de6\u65cb\uff0c\u540e\u505a\u53f3\u65cb\u3002 4\u3001\u53f3-\u5de6\u578b\uff1a\u5148\u505a\u53f3\u65cb\uff0c\u518d\u505a\u5de6\u65cb\u3002 \u53f3\u65cb: \u4ee5\u03b1\u7684\u5de6\u5b50\u8282\u70b9\u4ee3\u66ff\u5176\u4f4d\u7f6e\uff0c\u03b1\u6210\u4e3a\u65b0\u4f4d\u7f6e\u7684\u7684\u53f3\u8282\u70b9\uff0c\u539f\u5de6\u5b50\u8282\u70b9\u7684\u53f3\u5b50\u8282\u70b9\u6210\u4e3a\u03b1\u7684\u5de6\u5b50\u8282\u70b9\u3002 \u5de6\u65cb\uff1a\u4ee5\u03b1\u7684\u53f3\u5b50\u8282\u70b9\u4ee3\u66ff\u5176\u4f4d\u7f6e\uff0c\u03b1\u6210\u4e3a\u65b0\u4f4d\u7f6e\u7684\u7684\u5de6\u8282\u70b9\uff0c\u539f\u53f3\u5b50\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\u6210\u4e3a\u03b1\u7684\u53f3\u5b50\u8282\u70b9\u3002 \u5bf9\u4e8e\u5de6-\u53f3\u578b\uff0c\u5148\u5bf9\u03b1\u7684\u5de6\u8282\u70b9\u505a\u5de6\u65cb\uff0c\u7136\u540e\u518d\u5bf9\u03b1\u505a\u53f3\u65cb\uff1b \u5bf9\u4e8e\u53f3-\u5de6\u578b\uff0c\u73b0\u5bf9\u03b1\u7684\u53f3\u8282\u70b9\u505a\u53f3\u65cb\uff0c\u7136\u540e\u518d\u5bf9\u03b1\u505a\u5de6\u65cb B\u6811(B-Tree) \u2003\u5bf9\u4e8e\u6d77\u91cf\u6570\u636e\u53ea\u80fd\u5b58\u50a8\u5728\u78c1\u76d8\u4e2d\uff0c\u800c\u8bfb\u53d6\u78c1\u76d8\u901f\u5ea6\u8fdc\u5c0f\u4e8e\u8bfb\u53d6\u5185\u5b58\u901f\u5ea6\uff0c\u4e14\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u662f\u6309\u7167\u5757\u8fdb\u884c\u8bfb\u53d6\uff0c\u800c\u975e\u4e00\u6761\u4e00\u6761\u8bfb\u53d6\u3002\u5982\u679c\u91c7\u7528\u6811\u8fd9\u79cd\u7ed3\u6784\u4f5c\u4e3a\u6570\u636e\u7d22\u5f15\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5219\u6bcf\u6b21\u67e5\u627e\u6570\u636e\uff0c\u5373\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u8282\u70b9(\u4e5f\u5373\u4e00\u4e2a\u78c1\u76d8\u5757)\uff1b\u4f46\u65e0\u8bba\u662f\u4e8c\u53c9\u67e5\u627e\u6811\u8fd8\u662fAVL\u6811\uff0c\u5176\u6bcf\u4e2a\u8282\u70b9\u4ec5\u5b58\u50a8\u4e00\u5bf9key-value\uff0c\u56e0\u6b64\u6d77\u91cf\u6570\u636e\u4f1a\u9020\u6210\u975e\u5e38\u591a\u7684\u8282\u70b9\u6570\uff0c\u67e5\u627e\u6548\u7387\u4e5f\u5c06\u53d8\u5f97\u4f4e\u6548\u3002 \u2003\u800c\u9636\u6570\u4e3aM\u7684B\u6811\u662f\u4e00\u68f5M\u53c9\u6811\uff0c \u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u5b58\u50a8\u66f4\u591a\u5bf9key-value\uff0c\u4e14\u6bcf\u4e2a\u8282\u70b9\u4e5f\u5c06\u6709\u66f4\u591a\u7684\u5b50\u8282\u70b9\uff0c\u6574\u68f5\u6811\u7684\u9ad8\u5ea6\u5c06\u53d8\u5f97\u5f88\u4f4e( \u6700\u5c0f\u9ad8\u5ea6\u4e3aO(log M N), N\u4e3a\u8282\u70b9\u4e2a\u6570 )\uff0c\u67e5\u627e\u8282\u70b9(\u8bfb\u53d6\u78c1\u76d8)\u7684\u6b21\u6570\u4e5f\u5c06\u51cf\u5c11\u3002 B\u6811\u7684\u5177\u4f53\u5b9a\u4e49\u4e3a: 1\u3001\u6bcf\u4e2a\u8282\u70b9\u90fd\u5b58\u6709\u7d22\u5f15\u548c\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u5bf9\u5e94\u7684key\u548cvalue\u3002 2\u3001\u6839\u8282\u70b9\u5173\u952e\u5b57\u4e2a\u6570\u4e3a[1, M-1], \u5219\u5176\u5b50\u8282\u70b9\u4e2a\u6570\u4e3a[2, M]\u3002 3\u3001\u975e\u6839\u8282\u70b9\u5173\u952e\u5b57\u4e2a\u6570[M/2, M-1]\uff0c\u3002 4\u3001\u6bcf\u4e2a\u8282\u70b9\u4e2d\u7684\u5173\u952e\u5b57\u90fd\u6309\u7167\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u6392\u5217\uff0c\u6bcf\u4e2a\u5173\u952e\u5b57\u7684\u5de6\u5b50\u6811\u4e2d\u7684\u6240\u6709\u5173\u952e\u5b57\u90fd\u5c0f\u4e8e\u5b83\uff0c \u800c\u53f3\u5b50\u6811\u4e2d\u7684\u6240\u6709\u5173\u952e\u5b57\u90fd\u5927\u4e8e\u5b83\u3002 5\u3001\u6240\u6709\u53f6\u5b50\u8282\u70b9\u90fd\u4f4d\u4e8e\u540c\u4e00\u5c42\uff0c\u6216\u8005\u8bf4\u6839\u8282\u70b9\u5230\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u7684\u957f\u5ea6\u90fd\u76f8\u540c\u3002 B\u6811\u63d2\u5165 \uff1a\u5224\u65ad\u5f53\u524d\u7ed3\u70b9key\u7684\u4e2a\u6570\u662f\u5426\u5c0f\u4e8e\u7b49\u4e8eM-1\uff0c\u5982\u679c\u6ee1\u8db3\uff0c\u76f4\u63a5\u63d2\u5165\u5373\u53ef\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\uff0c\u8282\u70b9\u7684\u4e2d\u95f4\u7684key\u5c06\u8fd9\u4e2a\u8282\u70b9\u5206\u4e3a\u5de6\u53f3\u4e24\u90e8\u5206\uff0c\u4e2d\u95f4\u7684\u8282\u70b9\u653e\u5230\u7236\u8282\u70b9\u4e2d\u5373\u53ef B+\u6811 \uff1a \u5176\u4e0eB\u6811\u7684\u4e3b\u8981\u533a\u522b\u4e3a\uff1a B+\u6811\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u8282\u70b9\uff1a\u5185\u90e8\u7ed3\u70b9\uff08\u4e5f\u79f0\u7d22\u5f15\u7ed3\u70b9\uff09\u548c\u53f6\u5b50\u7ed3\u70b9\u3002\u5185\u90e8\u8282\u70b9\u5c31\u662f\u975e\u53f6\u5b50\u8282\u70b9\uff0c\u5185\u90e8\u8282\u70b9\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u53ea\u5b58\u50a8\u7d22\u5f15\uff0c\u6570\u636e\u90fd\u5b58\u50a8\u5728\u53f6\u5b50\u8282\u70b9\u3002B\u6811\u7684\u53f6\u5b50\u8282\u70b9\u4e0d\u4ec5\u5b58\u50a8key\uff0c\u4e5f\u5b58\u50a8value\uff1bB+\u6811\u8fd9\u6837\u505a\u7684\u539f\u56e0\u662f\uff0c\u6570\u636e\u5e93\u4e2d\u9875\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\uff0c\u5982\u679c\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u5185\u90e8\u975e\u53f6\u5b50\u8282\u70b9\u5c31\u53ef\u4ee5\u5b58\u50a8\u66f4\u591a\u7684key\uff0c\u5219\u6574\u68f5\u6811\u7684\u9636\u6570\u5c31\u4f1a\u66f4\u5927\uff0c\u800c\u6811\u7684\u9ad8\u5ea6\u5c31\u4f1a\u51cf\u5c11\uff0c\u8bfb\u53d6\u78c1\u76d8\u7684\u6b21\u6570\u4e5f\u5c31\u51cf\u5c11\uff0c\u67e5\u627e\u6548\u7387\u5c31\u63d0\u9ad8\u4e86\u3002 \u5185\u90e8\u7ed3\u70b9\u4e2d\u7684key\u90fd\u6309\u7167\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u6392\u5217\uff0c\u5bf9\u4e8e\u5185\u90e8\u7ed3\u70b9\u4e2d\u7684\u4e00\u4e2akey\uff0c\u5de6\u6811\u4e2d\u7684\u6240\u6709key\u90fd\u5c0f\u4e8e\u5b83\uff0c\u53f3\u5b50\u6811\u4e2d\u7684key\u90fd\u5927\u4e8e\u7b49\u4e8e\u5b83\u3002\u53f6\u5b50\u7ed3\u70b9\u4e2d\u7684\u8bb0\u5f55\u4e5f\u6309\u7167key\u7684\u5927\u5c0f\u6392\u5217\u3002 \u53f6\u5b50\u7ed3\u70b9(\u78c1\u76d8\u9875)\u4e4b\u95f4\u901a\u8fc7\u53cc\u5411\u94fe\u8868\u8fde\u63a5,\u800c\u53f6\u5b50\u8282\u70b9\u4e2d\u7684\u6570\u636e\u4f9d\u636ekey\u503c\u5927\u5c0f,\u901a\u8fc7\u5355\u5411\u94fe\u8868\u4ece\u5c0f\u5230\u5927\u987a\u5e8f\u8fde\u63a5\u3002 \u7236\u8282\u70b9\u5b58\u6709\u53f3\u5b69\u5b50\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u7d22\u5f15\u3002 \u7ea2\u9ed1\u6811 \u2003\u7ea2\u9ed1\u6811\u662f\u4e00\u79cd\u81ea\u5e73\u8861\u6216\u8005\u534a\u5e73\u8861\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u5b83\u653e\u5f03\u4e86\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u7edd\u5bf9\u5e73\u8861\uff0c\u6362\u6765\u4e86\u8f83\u4e3a\u7b80\u5355\u7684\u53ef\u7ef4\u62a4\u6027\uff0c\u4f7f\u5f97\u4e8c\u53c9\u641c\u7d22\u6811\u63d2\u5165\u65b0\u6570\u636e\uff0c\u4ee5\u53ca\u641c\u7d22\u6570\u636e\u65f6\uff0c\u90fd\u5177\u6709\u4e0d\u9519\u7684\u641c\u7d22\u6027\u80fd\u3002 \u5177\u4f53\u5c5e\u6027\u5982\u4e0b: 0 \u6240\u6709\u8282\u70b9\u8981\u4e48\u662f\u7ea2\u8272\uff0c\u8981\u4e48\u662f\u9ed1\u8272 1 \u6839\u8282\u70b9\u5fc5\u987b\u662f\u9ed1\u8272 2 \u53f6\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272\u7684( \u8fd9\u91cc\u7684\u53f6\u5b50\u8282\u70b9\u6307\u7684\u662fnull\u8282\u70b9\uff0c\u4f8b\u5982\u8282\u70b9a\u6ca1\u6709\u5de6\u5b69\u5b50\uff0c\u5219\u5176\u5de6\u5b69\u5b50\u53ef\u4ee5\u89c6\u4e3aNull Leaf Node, \u4e3a\u9ed1\u8272 ) 3 \u53f6\u5b50\u8282\u70b9\u4e0d\u5305\u542b\u6570\u636e 4 \u6240\u6709\u975e\u53f6\u5b50\u8282\u70b9\u90fd\u6709\u4e24\u4e2a\u5b50\u8282\u70b9 5 \u7ea2\u8272\u8282\u70b9\u7684\u4e24\u4e2a\u5b50\u8282\u70b9\u5fc5\u987b\u662f\u9ed1\u8272\uff08\u4e0d\u80fd\u6709\u8fde\u7eed\u7684\u7ea2\u8272\u8282\u70b9\uff09 6* \u4e00\u4e2a\u8282\u70b9\u5230\u5176\u6240\u6709\u53f6\u5b50\u8282\u70b9\u7684\u8def\u5f84\u90fd\u5305\u542b\u540c\u6837\u6570\u76ee\u7684\u9ed1\u8272\u8282\u70b9 \u2003\u7531\u5c5e\u60275\u30016\u77e5\uff0c\u6811\u4e2d\u6700\u957f\u8def\u5f84\u662f\u7ea2\u9ed1\u8282\u70b9\u4ea4\u66ff\u8def\u5f84\uff0c\u6700\u77ed\u8def\u5f84\u662f\u5177\u6709\u76f8\u540c\u6570\u76ee\u9ed1\u8272\u8282\u70b9\u7684\u2014\u2014\u53ea\u5305\u542b\u9ed1\u8272\u8282\u70b9\u7684\u8def\u5f84\uff0c\u56e0\u6b64 \u6839\u8282\u70b9\u5230\u53f6\u5b50\u8282\u70b9\u7684\u6700\u957f\u8def\u5f84\u4e0d\u4f1a\u8d85\u8fc7\u6700\u77ed\u8def\u5f84\u76842\u500d\u3002 \u2003\u5e76\u4e14\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u8bc1\u660e \u9ad8\u5ea6\u4e3ah\u7684\u7ea2\u9ed1\u6811\uff0c\u8282\u70b9\u4e2a\u6570\u81f3\u5c11\u4e3a2 h/2 -1\u4e2a \u3002 Trie(\u5b57\u5178\u6811/\u524d\u7f00\u6811) \u2003\u7528\u4e8e\u7edf\u8ba1\u548c\u6392\u5e8f\u5927\u91cf\u7684\u5b57\u7b26\u4e32\uff08\u4f46\u4e0d\u4ec5\u9650\u4e8e\u5b57\u7b26\u4e32\uff09\uff0c\u6240\u4ee5\u7ecf\u5e38\u88ab\u641c\u7d22\u5f15\u64ce\u7cfb\u7edf\u7528\u4e8e\u6587\u672c\u8bcd\u9891\u7edf\u8ba1\u3002\u5b83\u7684\u4f18\u70b9\u662f\uff1a\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u65e0\u8c13\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\u3002 \u2003Trie\u7684\u6838\u5fc3\u601d\u60f3\u662f\u7a7a\u95f4\u6362\u65f6\u95f4\u3002\u5229\u7528\u5b57\u7b26\u4e32\u7684\u516c\u5171\u524d\u7f00\u6765\u964d\u4f4e\u67e5\u8be2\u65f6\u95f4\u7684\u5f00\u9500\u4ee5\u8fbe\u5230\u63d0\u9ad8\u6548\u7387\u7684\u76ee\u7684\u3002 \u2003\u524d\u7f00\u6811\u76843\u4e2a\u57fa\u672c\u6027\u8d28\uff1a\u6839\u8282\u70b9\u4e0d\u5305\u542b\u5b57\u7b26\uff0c\u9664\u6839\u8282\u70b9\u5916\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u53ea\u5305\u542b\u4e00\u4e2a\u5b57\u7b26; \u4ece\u6839\u8282\u70b9\u5230\u67d0\u4e00\u8282\u70b9\uff0c\u8def\u5f84\u4e0a\u7ecf\u8fc7\u7684\u5b57\u7b26\u8fde\u63a5\u8d77\u6765\uff0c\u4e3a\u8be5\u8282\u70b9\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32; \u6bcf\u4e2a\u8282\u70b9\u7684\u6240\u6709\u5b50\u8282\u70b9\u5305\u542b\u7684\u5b57\u7b26\u90fd\u4e0d\u76f8\u540c\u3002 \u2003 \u5b57\u5178\u6811\u7684\u67e5\u8be2\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(logL)\uff0cL\u662f\u5b57\u7b26\u4e32\u7684\u957f\u5ea6 \u2003\u652f\u6301\u52a8\u6001\u67e5\u8be2\uff0c\u5373\u4e0d\u9700\u8981\u7b49\u5f85\u5b57\u7b26\u4e32\u8f93\u5165\u5b8c\u6bd5\u5373\u53ef\u8fdb\u884c\u5339\u914d\uff0c\u53ef\u7528\u4e8e\u5173\u952e\u5b57\u8054\u60f3","title":"Tree"},{"location":"DataStruct/Tree/#_1","text":"","title":"\u6570\u636e\u7ed3\u6784"},{"location":"DataStruct/Tree/#-","text":"\u8282\u70b9\u6df1\u5ea6: \u4ece\u6839\u8282\u70b9\u5230\u8be5\u8282\u70b9\u7684\u552f\u4e00\u8def\u5f84\u7684\u957f\u5ea6 \u8282\u70b9\u9ad8\uff1a\u8be5\u8282\u70b9\u5230\u4e00\u4e2a\u53f6\u8282\u70b9\u7684\u6700\u957f\u8def\u5f84\u7684\u957f\u5ea6 \u6811\u7684\u6df1\u5ea6\u7b49\u4e8e\u6811\u7684\u9ad8\u5ea6\uff0c\u662f\u6839\u8282\u70b9\u5230\u5176\u6700\u6df1\u6811\u53f6\u7684\u957f\u5ea6 \u6ee1\u4e8c\u53c9\u6811\uff1a\u9664\u6700\u540e\u4e00\u5c42\u65e0\u4efb\u4f55\u5b50\u8282\u70b9\u5916\uff0c\u6bcf\u4e00\u5c42\u4e0a\u7684\u6240\u6709\u7ed3\u70b9\u90fd\u6709\u4e24\u4e2a\u5b50\u7ed3\u70b9\u7684\u4e8c\u53c9\u6811\u3002\u9ad8\u5ea6\u4e3ah,\u5219\u8282\u70b9\u6570N=2 h+1 -1; h=O(log N) \u5b8c\u5168\u4e8c\u53c9\u6811\uff1a\u4e00\u68f5\u6df1\u5ea6\u4e3ak\u7684\u6709n\u4e2a\u7ed3\u70b9\u7684\u4e8c\u53c9\u6811\uff0c\u5bf9\u6811\u4e2d\u7684\u7ed3\u70b9\u6309\u4ece\u4e0a\u81f3\u4e0b\u3001\u4ece\u5de6\u5230\u53f3\u7684\u987a\u5e8f\u8fdb\u884c\u7f16\u53f7\uff0c\u5982\u679c\u7f16\u53f7\u4e3ai\uff081\u2264i\u2264n\uff09\u7684\u7ed3\u70b9\u4e0e\u6ee1\u4e8c\u53c9\u6811\u4e2d\u7f16\u53f7\u4e3ai\u7684\u7ed3\u70b9\u5728\u4e8c\u53c9\u6811\u4e2d\u7684\u4f4d\u7f6e\u76f8\u540c\uff0c\u5219\u8fd9\u68f5\u4e8c\u53c9\u6811\u79f0\u4e3a\u5b8c\u5168\u4e8c\u53c9\u6811\u3002 \u2003\u9ad8\u5ea6h\u7684\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c\u8282\u70b9\u65702 h <=N<=2 h+1 -1\u3002 \u4e8c\u53c9\u67e5\u627e\u6811: \u4efb\u4f55\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\u7684key\u503c\u90fd\u5c0f\u4e8e\u5f53\u524d\u8282\u70b9\u7684key\uff0c\u800c\u53f3\u5b50\u8282\u70b9\u7684key\u90fd\u5927\u4e8e\u5f53\u524d\u8282\u70b9\u7684key(\u8fd9\u91cckey\u5373\u662f\u7d22\u5f15)\uff1b\u4e8c\u53c9\u67e5\u627e\u6811\u7684\u5e73\u5747\u9ad8\u5ea6\u4e3aO(log N), N\u4e3a\u8282\u70b9\u4e2a\u6570\uff1b\u4f46\u5982\u679c\u5bf9\u5411\u4e00\u68f5\u6811\u8f93\u5165\u9884\u5148\u6392\u5e8f\u7684\u6570\u636e\uff0c\u6b64\u65f6\u4e8c\u53c9\u67e5\u627e\u6811\u4f1a\u9000\u5316\u6210\u5355\u5411\u94fe\u8868\uff0c\u67e5\u627e\u65f6\u95f4\u590d\u6742\u5ea6\u5c06\u53d8\u6210O(N)\u3002\u6545\u5f15\u51fa\u5e73\u8861\u4e8c\u53c9\u6811\u3002 \u4e8c\u53c9\u6811\u7684\u524d\u3001\u4e2d\u3001\u540e\u5e8f\u904d\u5386\u90fd\u53ef\u4ee5\u901a\u8fc7\u6808\u6765\u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(N), \u7a7a\u95f4\u590d\u6742\u5ea6O(N); \u82e5\u91c7\u7528\u9012\u5f52\u8c03\u7528\uff0c\u989d\u5916\u7684\u9700\u8981\u51fd\u6570\u6808\u7a7a\u95f4O(N); \u91c7\u7528Morris\u904d\u5386\uff0c\u53ef\u4ee5\u5c06\u7a7a\u95f4\u590d\u6742\u5ea6\u964d\u5230O(1) \u3002 0\u3001 \u8bb0\u4f5c\u5f53\u524d\u8282\u70b9\u4e3acur\u3002 1\u3001 1_1. \u5982\u679ccur\u65e0\u5de6\u5b69\u5b50\uff0ccur=cur.right, \u76f4\u63a5\u5230\u7b2c3\u6b65 1_2. \u5982\u679ccur\u6709\u5de6\u5b69\u5b50\uff0c\u627e\u5230cur\u5de6\u5b50\u6811\u4e0a\u6700\u53f3\u7684\u8282\u70b9\uff0c\u8bb0\u4e3amostright 2\u3001 2_1. if(mostright.right==NULL), then mostright.right=cur, cur=cur.left 2_2. if(mostright.right==cur), then mostright.right=NULL, cur=cur.right \u2003 3\u3001 \u91cd\u590d1\u30012\u76f4\u81f3cur\u4e3a\u7a7a 4\u3001 \u8fd4\u56de\u7ed3\u679c \u2003 \u524d\u5e8f\u904d\u5386:\u57281_1\u6b65,\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u540e\uff0ccur=cur.right; \u4ee5\u53ca\u57282_1\u6b65, \u5148\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u4e2d, then cur=cur.left \u4e2d\u5e8f\u904d\u5386:\u57281_1\u6b65,\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u540e\uff0ccur=cur.right; \u4ee5\u53ca\u57282_2\u6b65, \u5148\u628acur\u52a0\u5165\u5230\u7ed3\u679c\u4e2d, then cur=cur.right \u540e\u5e8f\u904d\u5386:\u57282_2\u8fd9\u4e00\u6b65,\u5c06\u4ececur\u7684\u5de6\u8282\u70b9\u5230mostright\u8282\u70b9\u8def\u5f84\u4e0a\u7684\u6240\u6709\u8282\u70b9\u5012\u5e8f\u6dfb\u52a0\u7684\u7ed3\u679c\u4e2d(\u901a\u8fc7\u4e0b\u9762\u7684addPaths\u51fd\u6570); \u57284\u6b65, \u7ed3\u675f\u5faa\u73af\u540e\uff0c\u6b64\u65f6\u53ea\u5269\u4e0b\u6700\u53f3\u4fa7\u4e00\u6761\u8def\u5f84\u4e0a\u7684\u6240\u6709\u8282\u70b9(\u5305\u62ec\u6839\u8282\u70b9)\u5c1a\u672a\u6dfb\u52a0\u5230\u7ed3\u679c\u4e2d\u3002 \u603b\u7ed3: \u53ef\u4ee5\u770b\u51fa\u4e09\u79cd\u904d\u5386\uff0c\u5728morris\u7b97\u6cd5\u4e0b\uff0c\u6709\u76f8\u540c\u7684\u7ed3\u6784\uff0c \u533a\u522b\u5728\u4e8e\u6dfb\u52a0\u7ed3\u679c\u7684\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u540e\u5e8f\u904d\u5386\u4f7f\u9700\u8981\u989d\u5916\u7684\u51fd\u6570\u6765\u5012\u5e8f\u6dfb\u52a0\u7ed3\u679c \u800c\u5c42\u5e8f\u904d\u5386\u9700\u8981\u901a\u8fc7\u961f\u5217\u5b9e\u73b0\u3002 #include<vector> #include<stack> #include<queue> struct TreeNode { int val; TreeNode* left; TreeNode* right; TreeNode() : val(0), left(nullptr), right(nullptr) {} TreeNode(int x) : val(x), left(nullptr), right(nullptr) {} TreeNode(int x, TreeNode* left, TreeNode* right) : val(x), left(left), right(right) {} }; class solution{ public: //\u524d\u5e8f\u904d\u5386 std::vector<int> preorderTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; while(root || !st.empty()){ while(root){ ans.push_back(root->val); st.push(root); root=root->left; } root = st.top()->right; st.pop(); } return ans; } //\u4e2d\u5e8f\u904d\u5386 std::vector<int> inorderTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; while(root || !st.empty()){ while(root){ st.push(root); root=root->left; } root=st.top(); st.pop(); ans.push_back(root->val); root=root->right; } return ans; } //\u540e\u5e8f\u904d\u5386, \u9664\u53bb\u9012\u5f52\uff0c\u63d0\u4f9b\u4e864\u79cd\u65b9\u6cd5\uff0c\u524d\u4e09\u79cd\u90fd\u9700\u8981O(N)\u7684\u7a7a\u95f4\u590d\u6742\u5ea6, morris\u53ea\u9700O(1)\u7a7a\u95f4\u590d\u6742\u5ea6 std::vector<int> postorderTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; st.push(root); TreeNode* cur; while(!st.empty()){ cur=st.top();st.pop(); if(cur){ st.push(cur->left); st.push(cur->right); ans.push_back(cur->val); //\u8bbf\u95ee\u987a\u5e8f: \u6839\u3001\u53f3\u3001\u5de6\uff0c\u5bf9\u7ed3\u679c\u9006\u5e8f } } std::reverse(ans.begin(), ans.end()); return ans; } std::vector<int> postorderTraversal2(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<std::pair<TreeNode*, bool>> st; st.push(std::make_pair(root, false)); std::pair<TreeNode*, bool>* cur; while (!st.empty()) { cur = &st.top(); if(cur->second){//bool=true, \u8bf4\u660e\u662f\u5b50\u8282\u70b9\u5df2\u7ecf\u8bbf\u95ee\u4e86 ans.push_back(cur->first->val); st.pop(); }else{ //bool=false, \u8bf4\u660e\u5f53\u524d\u8282\u70b9\u7684\u5b50\u8282\u70b9\u5c1a\u672a\u8bbf\u95ee\uff0c\u5c06\u53f3\u5b69\u5b50\u548c\u5de6\u5b69\u5b50\u5148\u540e\u5165\u6808 cur->second=true; if(cur->first->right) st.push(std::make_pair(cur->first->right, false)); if(cur->first->left) st.push(std::make_pair(cur->first->left, false)); } } return ans; } std::vector<int> postorderTraversal3(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::stack<TreeNode*> st; TreeNode* prev; while(root || !st.empty()){ while(root){ st.push(root); root=root->left; } root = st.top(); if(!root->right || root->right==prev){ ans.push_back(root->val); prev=root; st.pop(); root=nullptr; }else root=root->right; } return ans; } //morros\u524d\u5e8f\u904d\u5386 std::vector<int> preorderTraversal2(TreeNode* root){ if(!root)return {}; std::vector<int> ans; TreeNode* cur=root, *next=nullptr; while (cur) { next=cur->left; if(next){ while(next->right && next->right!=cur) next=next->right; if(!next->right){ next->right=cur; ans.push_back(cur->val); cur=cur->left; }else{ next->right=nullptr; cur=cur->right; } }else { ans.push_back(cur->val); cur=cur->right; } } return ans; } //moris\u4e2d\u5e8f\u904d\u5386 std::vector<int> inorderTranversal2(TreeNode* root){ if(!root)return {}; std::vector<int> ans; TreeNode *cur=root, *next=nullptr; while(cur){ next=cur->left; if(next){ while (next->right && next->right!=cur) next=next->right; if(!next->right){ next->right=cur; cur=cur->left; }else{ next->right=nullptr; ans.push_back(cur->val); cur=cur->right; } }else{ ans.push_back(cur->val); cur=cur->right; } } return ans; } //morris\u540e\u5e8f\u904d\u5386 void addPath(vector<int> &vec, TreeNode *node) { int count = 0; while (node != nullptr) { ++count; vec.emplace_back(node->val); node = node->right; } reverse(vec.end() - count, vec.end()); } std::vector<int> postorderTraversal4(TreeNode* root){ if(!root)return {}; std::vector<int> ans; TreeNode *cur=root, *next=nullptr; while(cur){ next=cur->left; if(next){ while (next->right && next->right!=cur) next=next->right; if(!next->right){ next->right=cur; cur=cur->left; }else{ next->right=nullptr; addPath(ans, cur->left); cur=cur->right; } }else cur=cur->right; } addPath(ans, root); return ans; } //\u5c42\u5e8f\u904d\u5386 std::vector<int> LayerTraversal(TreeNode* root){ if(!root)return {}; std::vector<int> ans; std::queue<TreeNode*> qu; qu.push(root); while(!qu.empty()){ root=qu.front(); qu.pop(); ans.push_back(root->val); if(root->left)qu.push(root->left); if(root->right)qu.push(root->right); } return ans; } //\u7b2c\u4e8c\u79cd\u5f62\u5f0f\u7684\u5c42\u5e8f\u904d\u5386\uff0c\u53ea\u662f\u8fd4\u56de\u5f62\u5f0f\u4e0d\u540c std::vector<std::vector<int>> MulLayerTraversal(TreeNode* root){ if(!root)return {}; std::vector<std::vector<int>> ans; std::queue<TreeNode*> qu; qu.push(root); while(!qu.empty()){ int len=qu.size(); std::vector<int> tmp(len); for(int i=0;i<len;i++){ root=qu.front(); qu.pop(); tmp[i]=root->val; if(root->left)qu.push(root->left); if(root->right)qu.push(root->right); } ans.push_back(tmp); } return ans; } };","title":"\u6811-\u57fa\u672c\u6982\u5ff5"},{"location":"DataStruct/Tree/#avl","text":"\u5e73\u8861\u4e8c\u53c9\u6811 \uff0c\u5177\u6709\u4e8c\u53c9\u67e5\u627e\u6811\u5168\u90e8\u7279\u6027\uff0c\u4f46 \u6bcf\u4e2a\u8282\u70b9\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u7684\u9ad8\u5ea6\u6700\u591a\u5dee1\u7684\u4e8c\u53c9\u67e5\u627e\u6811 ( \u7a7a\u6811\u9ad8\u5ea6\u5b9a\u4e49\u4e3a-1 )\u3002 \u2003\u5728\u9ad8\u5ea6\u4e3ah\u7684AVL\u6811\u4e2d\uff0c\u6700\u5c11\u8282\u70b9\u6570S(h)=S(h-1)+S(h-2)+1\u5f97\u5230\u3002(S(0)=1, S(1)=2) \u2003\u5bf9\u4e8eN\u4e2a\u8282\u70b9\u7684AVL\u6811\uff0c\u6700\u574f\u67e5\u627e\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u4e3aO(log N), \u4f46\u7531\u4e8e\u63d2\u5165\u6216\u5220\u9664\u8282\u70b9\u4f1a\u7834\u574f\u5e73\u8861\u6027\uff0c\u56e0\u6b64\u9700\u8981\u901a\u8fc7 \u65cb\u8f6c \u6765\u6062\u590d\u6811\u7684\u5e73\u8861\u6027\u3002\u5728\u9891\u7e41\u63d2\u5165\u548c\u5220\u9664\u573a\u666f\u4e0b\uff0c\u65cb\u8f6c\u662f\u5341\u5206\u8017\u65f6\u7684\uff0c\u56e0\u6b64\u53c8\u5f15\u51fa \u7ea2\u9ed1\u6811 \u3002 \u65cb\u8f6c\uff1a \u5728\u4e00\u6b21\u63d2\u5165\u4e4b\u548c\uff0c\u53ea\u6709\u90a3\u4e9b\u4ece\u63d2\u5165\u70b9\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u7684\u8282\u70b9\u7684\u5e73\u8861\u53ef\u80fd\u4f1a\u88ab\u6539\u53d8\uff0c\u56e0\u4e3a\u53ea\u6709\u8fd9\u4e9b\u8282\u70b9\u7684\u5b50\u6811\u53ef\u80fd\u53d1\u751f\u53d8\u5316\u3002 \u6cbf\u63d2\u5165\u8282\u70b9\u4e0a\u884c\uff0c\u5c06\u6bcf\u4e00\u4e2a\u5fc5\u987b\u91cd\u65b0\u5e73\u8861\u7684\u8282\u70b9 \u53eb\u505a\u03b1\uff0c\u7531\u4e8e\u4efb\u610f\u8282\u70b9\u6700\u591a\u6709\u4e24\u4e2a\u513f\u5b50\uff0c\u53ef\u77e5\u5176\u4e24\u9897\u5b50\u6811\u7684\u9ad8\u5ea6\u4e00\u5b9a\u76f8\u5dee2\u3002 \u4e0d\u5e73\u8861\u53ef\u80fd\u67094\u79cd\u60c5\u51b5\uff1a \\1. \u5bf9\u03b1\u7684\u5de6\u513f\u5b50\u7684\u5de6\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u5de6-\u5de6)\uff1b \\2. \u5bf9\u03b1\u7684\u5de6\u513f\u5b50\u7684\u53f3\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u5de6-\u53f3)\uff1b \\3. \u5bf9\u03b1\u7684\u53f3\u513f\u5b50\u7684\u5de6\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u53f3-\u5de6)\uff1b \\4. \u5bf9\u03b1\u7684\u53f3\u513f\u5b50\u7684\u53f3\u5b50\u6811\u8fdb\u884c\u4e00\u6b21\u63d2\u5165(\u53f3-\u53f3)\uff1b \u60c5\u51b51\u548c4\uff0c2\u548c3\u5404\u81ea\u6210\u955c\u50cf \u5de6-\u5de6\u548c\u53f3-\u53f3\u53ef\u4ee5\u901a\u8fc7\u5355\u65cb\u8f6c\u6765\u5b8c\u6210\u8c03\u6574\uff0c\u5de6-\u53f3\u548c\u53f3-\u5de6\u5219\u9700\u901a\u8fc7\u53cc\u65cb\u8f6c\u6765\u8c03\u6574\u3002 1\u3001\u5de6-\u5de6\u578b\uff1a\u505a\u53f3\u65cb\u3002 2\u3001\u53f3-\u53f3\u578b\uff1a\u505a\u5de6\u65cb\u3002 3\u3001\u5de6-\u53f3\u578b\uff1a\u5148\u505a\u5de6\u65cb\uff0c\u540e\u505a\u53f3\u65cb\u3002 4\u3001\u53f3-\u5de6\u578b\uff1a\u5148\u505a\u53f3\u65cb\uff0c\u518d\u505a\u5de6\u65cb\u3002 \u53f3\u65cb: \u4ee5\u03b1\u7684\u5de6\u5b50\u8282\u70b9\u4ee3\u66ff\u5176\u4f4d\u7f6e\uff0c\u03b1\u6210\u4e3a\u65b0\u4f4d\u7f6e\u7684\u7684\u53f3\u8282\u70b9\uff0c\u539f\u5de6\u5b50\u8282\u70b9\u7684\u53f3\u5b50\u8282\u70b9\u6210\u4e3a\u03b1\u7684\u5de6\u5b50\u8282\u70b9\u3002 \u5de6\u65cb\uff1a\u4ee5\u03b1\u7684\u53f3\u5b50\u8282\u70b9\u4ee3\u66ff\u5176\u4f4d\u7f6e\uff0c\u03b1\u6210\u4e3a\u65b0\u4f4d\u7f6e\u7684\u7684\u5de6\u8282\u70b9\uff0c\u539f\u53f3\u5b50\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\u6210\u4e3a\u03b1\u7684\u53f3\u5b50\u8282\u70b9\u3002 \u5bf9\u4e8e\u5de6-\u53f3\u578b\uff0c\u5148\u5bf9\u03b1\u7684\u5de6\u8282\u70b9\u505a\u5de6\u65cb\uff0c\u7136\u540e\u518d\u5bf9\u03b1\u505a\u53f3\u65cb\uff1b \u5bf9\u4e8e\u53f3-\u5de6\u578b\uff0c\u73b0\u5bf9\u03b1\u7684\u53f3\u8282\u70b9\u505a\u53f3\u65cb\uff0c\u7136\u540e\u518d\u5bf9\u03b1\u505a\u5de6\u65cb","title":"AVL\u6811"},{"location":"DataStruct/Tree/#bb-tree","text":"\u5bf9\u4e8e\u6d77\u91cf\u6570\u636e\u53ea\u80fd\u5b58\u50a8\u5728\u78c1\u76d8\u4e2d\uff0c\u800c\u8bfb\u53d6\u78c1\u76d8\u901f\u5ea6\u8fdc\u5c0f\u4e8e\u8bfb\u53d6\u5185\u5b58\u901f\u5ea6\uff0c\u4e14\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u662f\u6309\u7167\u5757\u8fdb\u884c\u8bfb\u53d6\uff0c\u800c\u975e\u4e00\u6761\u4e00\u6761\u8bfb\u53d6\u3002\u5982\u679c\u91c7\u7528\u6811\u8fd9\u79cd\u7ed3\u6784\u4f5c\u4e3a\u6570\u636e\u7d22\u5f15\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5219\u6bcf\u6b21\u67e5\u627e\u6570\u636e\uff0c\u5373\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u8282\u70b9(\u4e5f\u5373\u4e00\u4e2a\u78c1\u76d8\u5757)\uff1b\u4f46\u65e0\u8bba\u662f\u4e8c\u53c9\u67e5\u627e\u6811\u8fd8\u662fAVL\u6811\uff0c\u5176\u6bcf\u4e2a\u8282\u70b9\u4ec5\u5b58\u50a8\u4e00\u5bf9key-value\uff0c\u56e0\u6b64\u6d77\u91cf\u6570\u636e\u4f1a\u9020\u6210\u975e\u5e38\u591a\u7684\u8282\u70b9\u6570\uff0c\u67e5\u627e\u6548\u7387\u4e5f\u5c06\u53d8\u5f97\u4f4e\u6548\u3002 \u2003\u800c\u9636\u6570\u4e3aM\u7684B\u6811\u662f\u4e00\u68f5M\u53c9\u6811\uff0c \u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u5b58\u50a8\u66f4\u591a\u5bf9key-value\uff0c\u4e14\u6bcf\u4e2a\u8282\u70b9\u4e5f\u5c06\u6709\u66f4\u591a\u7684\u5b50\u8282\u70b9\uff0c\u6574\u68f5\u6811\u7684\u9ad8\u5ea6\u5c06\u53d8\u5f97\u5f88\u4f4e( \u6700\u5c0f\u9ad8\u5ea6\u4e3aO(log M N), N\u4e3a\u8282\u70b9\u4e2a\u6570 )\uff0c\u67e5\u627e\u8282\u70b9(\u8bfb\u53d6\u78c1\u76d8)\u7684\u6b21\u6570\u4e5f\u5c06\u51cf\u5c11\u3002 B\u6811\u7684\u5177\u4f53\u5b9a\u4e49\u4e3a: 1\u3001\u6bcf\u4e2a\u8282\u70b9\u90fd\u5b58\u6709\u7d22\u5f15\u548c\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u5bf9\u5e94\u7684key\u548cvalue\u3002 2\u3001\u6839\u8282\u70b9\u5173\u952e\u5b57\u4e2a\u6570\u4e3a[1, M-1], \u5219\u5176\u5b50\u8282\u70b9\u4e2a\u6570\u4e3a[2, M]\u3002 3\u3001\u975e\u6839\u8282\u70b9\u5173\u952e\u5b57\u4e2a\u6570[M/2, M-1]\uff0c\u3002 4\u3001\u6bcf\u4e2a\u8282\u70b9\u4e2d\u7684\u5173\u952e\u5b57\u90fd\u6309\u7167\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u6392\u5217\uff0c\u6bcf\u4e2a\u5173\u952e\u5b57\u7684\u5de6\u5b50\u6811\u4e2d\u7684\u6240\u6709\u5173\u952e\u5b57\u90fd\u5c0f\u4e8e\u5b83\uff0c \u800c\u53f3\u5b50\u6811\u4e2d\u7684\u6240\u6709\u5173\u952e\u5b57\u90fd\u5927\u4e8e\u5b83\u3002 5\u3001\u6240\u6709\u53f6\u5b50\u8282\u70b9\u90fd\u4f4d\u4e8e\u540c\u4e00\u5c42\uff0c\u6216\u8005\u8bf4\u6839\u8282\u70b9\u5230\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u7684\u957f\u5ea6\u90fd\u76f8\u540c\u3002 B\u6811\u63d2\u5165 \uff1a\u5224\u65ad\u5f53\u524d\u7ed3\u70b9key\u7684\u4e2a\u6570\u662f\u5426\u5c0f\u4e8e\u7b49\u4e8eM-1\uff0c\u5982\u679c\u6ee1\u8db3\uff0c\u76f4\u63a5\u63d2\u5165\u5373\u53ef\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\uff0c\u8282\u70b9\u7684\u4e2d\u95f4\u7684key\u5c06\u8fd9\u4e2a\u8282\u70b9\u5206\u4e3a\u5de6\u53f3\u4e24\u90e8\u5206\uff0c\u4e2d\u95f4\u7684\u8282\u70b9\u653e\u5230\u7236\u8282\u70b9\u4e2d\u5373\u53ef B+\u6811 \uff1a \u5176\u4e0eB\u6811\u7684\u4e3b\u8981\u533a\u522b\u4e3a\uff1a B+\u6811\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u8282\u70b9\uff1a\u5185\u90e8\u7ed3\u70b9\uff08\u4e5f\u79f0\u7d22\u5f15\u7ed3\u70b9\uff09\u548c\u53f6\u5b50\u7ed3\u70b9\u3002\u5185\u90e8\u8282\u70b9\u5c31\u662f\u975e\u53f6\u5b50\u8282\u70b9\uff0c\u5185\u90e8\u8282\u70b9\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u53ea\u5b58\u50a8\u7d22\u5f15\uff0c\u6570\u636e\u90fd\u5b58\u50a8\u5728\u53f6\u5b50\u8282\u70b9\u3002B\u6811\u7684\u53f6\u5b50\u8282\u70b9\u4e0d\u4ec5\u5b58\u50a8key\uff0c\u4e5f\u5b58\u50a8value\uff1bB+\u6811\u8fd9\u6837\u505a\u7684\u539f\u56e0\u662f\uff0c\u6570\u636e\u5e93\u4e2d\u9875\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\uff0c\u5982\u679c\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u5185\u90e8\u975e\u53f6\u5b50\u8282\u70b9\u5c31\u53ef\u4ee5\u5b58\u50a8\u66f4\u591a\u7684key\uff0c\u5219\u6574\u68f5\u6811\u7684\u9636\u6570\u5c31\u4f1a\u66f4\u5927\uff0c\u800c\u6811\u7684\u9ad8\u5ea6\u5c31\u4f1a\u51cf\u5c11\uff0c\u8bfb\u53d6\u78c1\u76d8\u7684\u6b21\u6570\u4e5f\u5c31\u51cf\u5c11\uff0c\u67e5\u627e\u6548\u7387\u5c31\u63d0\u9ad8\u4e86\u3002 \u5185\u90e8\u7ed3\u70b9\u4e2d\u7684key\u90fd\u6309\u7167\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u6392\u5217\uff0c\u5bf9\u4e8e\u5185\u90e8\u7ed3\u70b9\u4e2d\u7684\u4e00\u4e2akey\uff0c\u5de6\u6811\u4e2d\u7684\u6240\u6709key\u90fd\u5c0f\u4e8e\u5b83\uff0c\u53f3\u5b50\u6811\u4e2d\u7684key\u90fd\u5927\u4e8e\u7b49\u4e8e\u5b83\u3002\u53f6\u5b50\u7ed3\u70b9\u4e2d\u7684\u8bb0\u5f55\u4e5f\u6309\u7167key\u7684\u5927\u5c0f\u6392\u5217\u3002 \u53f6\u5b50\u7ed3\u70b9(\u78c1\u76d8\u9875)\u4e4b\u95f4\u901a\u8fc7\u53cc\u5411\u94fe\u8868\u8fde\u63a5,\u800c\u53f6\u5b50\u8282\u70b9\u4e2d\u7684\u6570\u636e\u4f9d\u636ekey\u503c\u5927\u5c0f,\u901a\u8fc7\u5355\u5411\u94fe\u8868\u4ece\u5c0f\u5230\u5927\u987a\u5e8f\u8fde\u63a5\u3002 \u7236\u8282\u70b9\u5b58\u6709\u53f3\u5b69\u5b50\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u7d22\u5f15\u3002","title":"B\u6811(B-Tree)"},{"location":"DataStruct/Tree/#_2","text":"\u7ea2\u9ed1\u6811\u662f\u4e00\u79cd\u81ea\u5e73\u8861\u6216\u8005\u534a\u5e73\u8861\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u5b83\u653e\u5f03\u4e86\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u7edd\u5bf9\u5e73\u8861\uff0c\u6362\u6765\u4e86\u8f83\u4e3a\u7b80\u5355\u7684\u53ef\u7ef4\u62a4\u6027\uff0c\u4f7f\u5f97\u4e8c\u53c9\u641c\u7d22\u6811\u63d2\u5165\u65b0\u6570\u636e\uff0c\u4ee5\u53ca\u641c\u7d22\u6570\u636e\u65f6\uff0c\u90fd\u5177\u6709\u4e0d\u9519\u7684\u641c\u7d22\u6027\u80fd\u3002 \u5177\u4f53\u5c5e\u6027\u5982\u4e0b: 0 \u6240\u6709\u8282\u70b9\u8981\u4e48\u662f\u7ea2\u8272\uff0c\u8981\u4e48\u662f\u9ed1\u8272 1 \u6839\u8282\u70b9\u5fc5\u987b\u662f\u9ed1\u8272 2 \u53f6\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272\u7684( \u8fd9\u91cc\u7684\u53f6\u5b50\u8282\u70b9\u6307\u7684\u662fnull\u8282\u70b9\uff0c\u4f8b\u5982\u8282\u70b9a\u6ca1\u6709\u5de6\u5b69\u5b50\uff0c\u5219\u5176\u5de6\u5b69\u5b50\u53ef\u4ee5\u89c6\u4e3aNull Leaf Node, \u4e3a\u9ed1\u8272 ) 3 \u53f6\u5b50\u8282\u70b9\u4e0d\u5305\u542b\u6570\u636e 4 \u6240\u6709\u975e\u53f6\u5b50\u8282\u70b9\u90fd\u6709\u4e24\u4e2a\u5b50\u8282\u70b9 5 \u7ea2\u8272\u8282\u70b9\u7684\u4e24\u4e2a\u5b50\u8282\u70b9\u5fc5\u987b\u662f\u9ed1\u8272\uff08\u4e0d\u80fd\u6709\u8fde\u7eed\u7684\u7ea2\u8272\u8282\u70b9\uff09 6* \u4e00\u4e2a\u8282\u70b9\u5230\u5176\u6240\u6709\u53f6\u5b50\u8282\u70b9\u7684\u8def\u5f84\u90fd\u5305\u542b\u540c\u6837\u6570\u76ee\u7684\u9ed1\u8272\u8282\u70b9 \u2003\u7531\u5c5e\u60275\u30016\u77e5\uff0c\u6811\u4e2d\u6700\u957f\u8def\u5f84\u662f\u7ea2\u9ed1\u8282\u70b9\u4ea4\u66ff\u8def\u5f84\uff0c\u6700\u77ed\u8def\u5f84\u662f\u5177\u6709\u76f8\u540c\u6570\u76ee\u9ed1\u8272\u8282\u70b9\u7684\u2014\u2014\u53ea\u5305\u542b\u9ed1\u8272\u8282\u70b9\u7684\u8def\u5f84\uff0c\u56e0\u6b64 \u6839\u8282\u70b9\u5230\u53f6\u5b50\u8282\u70b9\u7684\u6700\u957f\u8def\u5f84\u4e0d\u4f1a\u8d85\u8fc7\u6700\u77ed\u8def\u5f84\u76842\u500d\u3002 \u2003\u5e76\u4e14\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u8bc1\u660e \u9ad8\u5ea6\u4e3ah\u7684\u7ea2\u9ed1\u6811\uff0c\u8282\u70b9\u4e2a\u6570\u81f3\u5c11\u4e3a2 h/2 -1\u4e2a \u3002","title":"\u7ea2\u9ed1\u6811"},{"location":"DataStruct/Tree/#trie","text":"\u7528\u4e8e\u7edf\u8ba1\u548c\u6392\u5e8f\u5927\u91cf\u7684\u5b57\u7b26\u4e32\uff08\u4f46\u4e0d\u4ec5\u9650\u4e8e\u5b57\u7b26\u4e32\uff09\uff0c\u6240\u4ee5\u7ecf\u5e38\u88ab\u641c\u7d22\u5f15\u64ce\u7cfb\u7edf\u7528\u4e8e\u6587\u672c\u8bcd\u9891\u7edf\u8ba1\u3002\u5b83\u7684\u4f18\u70b9\u662f\uff1a\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u65e0\u8c13\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\u3002 \u2003Trie\u7684\u6838\u5fc3\u601d\u60f3\u662f\u7a7a\u95f4\u6362\u65f6\u95f4\u3002\u5229\u7528\u5b57\u7b26\u4e32\u7684\u516c\u5171\u524d\u7f00\u6765\u964d\u4f4e\u67e5\u8be2\u65f6\u95f4\u7684\u5f00\u9500\u4ee5\u8fbe\u5230\u63d0\u9ad8\u6548\u7387\u7684\u76ee\u7684\u3002 \u2003\u524d\u7f00\u6811\u76843\u4e2a\u57fa\u672c\u6027\u8d28\uff1a\u6839\u8282\u70b9\u4e0d\u5305\u542b\u5b57\u7b26\uff0c\u9664\u6839\u8282\u70b9\u5916\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u53ea\u5305\u542b\u4e00\u4e2a\u5b57\u7b26; \u4ece\u6839\u8282\u70b9\u5230\u67d0\u4e00\u8282\u70b9\uff0c\u8def\u5f84\u4e0a\u7ecf\u8fc7\u7684\u5b57\u7b26\u8fde\u63a5\u8d77\u6765\uff0c\u4e3a\u8be5\u8282\u70b9\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32; \u6bcf\u4e2a\u8282\u70b9\u7684\u6240\u6709\u5b50\u8282\u70b9\u5305\u542b\u7684\u5b57\u7b26\u90fd\u4e0d\u76f8\u540c\u3002 \u2003 \u5b57\u5178\u6811\u7684\u67e5\u8be2\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(logL)\uff0cL\u662f\u5b57\u7b26\u4e32\u7684\u957f\u5ea6 \u2003\u652f\u6301\u52a8\u6001\u67e5\u8be2\uff0c\u5373\u4e0d\u9700\u8981\u7b49\u5f85\u5b57\u7b26\u4e32\u8f93\u5165\u5b8c\u6bd5\u5373\u53ef\u8fdb\u884c\u5339\u914d\uff0c\u53ef\u7528\u4e8e\u5173\u952e\u5b57\u8054\u60f3","title":"Trie(\u5b57\u5178\u6811/\u524d\u7f00\u6811)"},{"location":"EffectiveCPP/rule/","text":"\u6761\u6b3e base 1\u3001View C++ as a federations of lanuages 2\u3001Prefer consts, enums and inlines to #define \u5bf9\u4e8e\u5355\u7eaf\u5e38\u91cf\u5bf9\u8c61\uff0c\u6700\u540e\u4ee5const\u5bf9\u8c61\u6216enums\u66ff\u6362#define \u5bf9\u4e8e\u5f62\u4f3c\u51fd\u6570\u7684\u5b8f\uff0c\u6700\u597d\u7528inline\u51fd\u6570\u66ff\u6362#define 3\u3001Use const whenever possible \u2003\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u503c\uff0c\u907f\u514d\u8bf8\u5982\"a*b=c\"\u8fd9\u79cd\u539f\u610f\u662f\u5224\u65ad\u76f8\u7b49\uff0c\u800c\u9519\u5199\u6210\u8d4b\u503c\u7684\u64cd\u4f5c\uff0c\u8fd9\u79cd\u9519\u8bef\u5728\u7f16\u8bd1\u5668\u5c31\u4f1a\u68c0\u6d4b\u51fa\u6765\u3002 \u2003\u67d0\u4e9b\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u5f15\u7528\uff0c\u4e00\u6765\u53ef\u4ee5\u63d0\u4f9b\u4f20\u9012\u6548\u7387\uff0c\u4e8c\u6765\u53ef\u4ee5\u907f\u514d\u901a\u8fc7\u8fd4\u56de\u7684\u5f15\u7528\u4fee\u6539\u5b9e\u9645\u7684\u5bf9\u8c61\u3002 4\u3001Make sure that objects are initialized before they're used. 1>. \u624b\u5de5\u521d\u59cb\u5316\u5185\u7f6e\u578bnon-member\u5bf9\u8c61\u3002 2>. \u4f7f\u7528\u6210\u5458\u521d\u59cb\u5316\u5217\u8868\u6765\u521d\u59cb\u5316\u5bf9\u8c61\u6240\u6709\u6210\u5206\u3002 3>. \u7531\u4e8eC++ \u5bf9\u4e8e\u201c\u5b9a\u4e49\u5728\u4e0d\u540c\u7f16\u8bd1\u5355\u5143\u5185\u7684non-local static\u5bf9\u8c61\u201d\u7684\u521d\u59cb\u5316\u6b21\u5e8f\u5e76\u65e0\u660e\u786e\u5b9a\u4e49 \uff0c \u56e0\u6b64\u53ef\u4ee5\u5c06non-local static\u5bf9\u8c61\u7684\u58f0\u660e\u653e\u7f6e\u5728\u51fd\u6570\u5185\uff0c\u8fd9\u6837\u5176\u5c31\u53d8\u6210\u4e86local static\u5bf9\u8c61\uff0c \u800c\u8be5\u51fd\u6570\u53c8\u8fd4\u56de\u8be5\u5bf9\u8c61\u7684reference\u3002\u56e0\u4e3aC++\u4fdd\u8bc1, \u51fd\u6570\u5185\u7684local static\u5bf9\u8c61\u4f1a\u5728\u201c\u8be5\u51fd\u6570\u8c03\u7528\u671f\u95f4\uff0c\u9996\u6b21\u9047\u5230\u8be5\u5bf9\u8c61\u4e4b\u5b9a\u4e49\u5f0f\u201d\u65f6\u88ab\u521d\u59cb\u5316 \u3002 \u901a\u8fc7\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u83b7\u5f97\u4e00\u4e2a\u6307\u5411\u5df2\u7ecf\u521d\u59cb\u5316\u7684\u5bf9\u8c61\u7684reference\u3002 ctor\\dtor\\assignment 5\u3001\u4e86\u89e3C++\u9ed8\u9ed8\u7f16\u5199\u5e76\u8c03\u7528\u4e86\u54ea\u4e9b\u51fd\u6570 \u2003\u4e00\u822c\u60c5\u51b5\uff0c\u7f16\u8bd1\u5668\u53ef\u4ee5\u4e3aclass\u521b\u5efa\u9ed8\u8ba4constructor\u3001copy-constructor\u3001copy-assignment\u4ee5\u53cadestructor\uff0c \u4f46\u5f53class\u5185\u542b\u6709reference/pointer/const\u6210\u5458\uff0c\u4ee5\u53cabase classes\u5c06copy-assignment\u8bbe\u7f6e\u4e3aprivate\u65f6\uff0c\u65e0\u6cd5\u521b\u5efa\u9ed8\u8ba4copy-assignment\u3002 6\u3001\u82e5\u4e0d\u60f3\u4f7f\u7528\u7f16\u8bd1\u5668\u81ea\u52a8\u751f\u6210\u7684\u6784\u9020\u51fd\u6570\uff0c\u5c31\u5e94\u8be5\u660e\u786e\u62d2\u7edd \u2003\u4f7f\u7528=delete\uff1b\u6216\u8005\u5c06\u5176\u58f0\u660e\u4e3aprivate, \u4e0d\u8fc7\u8fd9\u6837\u5176member\u548cfriend\u4ecd\u7136\u80fd\u8bbf\u95ee\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2abase class\uff0c\u5728\u5176\u4e2d\u5c06\u8fd9\u4e9b\u51fd\u6570\u58f0\u660e\u4e3aprivate\uff0c\u8ba9\u4f60\u7684\u7c7b\u7ee7\u627f\u8fd9\u4e2abase class\uff0c\u5219\u51fa\u73b0\u8bd5\u56fe\u8bbf\u95ee\u8fd9\u4e9b\u51fd\u6570\u65f6\uff0c\u4f1a\u5728\u7f16\u8bd1\u5668\u4ef6\u62a5\u9519\u3002 7\u3001\u4e3a\u591a\u6001\u57fa\u7c7b\u58f0\u660evirtual\u6790\u6784\u51fd\u6570 \u2003\u5982\u679c\u4e00\u4e2aclass \u5305\u542b\u4efb\u4f55\u7684virtual \u51fd\u6570\uff0c\u5219\u5e94\u8be5\u6709\u4e00\u4e2avirtual \u6790\u6784\u51fd\u6570\u3002 \u2003\u8fd9\u4e2a\u89c4\u5219\u53ea\u9002\u7528\u4e8epolymorphic base classes\u8eab\u4e0a\uff0c\u8fd9\u79cdclass\u8bbe\u8ba1\u7684\u76ee\u7684\u662f\u4e3a\u4e86 \u901a\u8fc7base class\u63a5\u53e3\u6765\u5904\u7406derived class\u5bf9\u8c61 \uff0c\u5426\u5219\u6839\u636e\u9759\u6001\u7ed1\u5b9a\uff0c\u8c03\u7528\u7684\u5c06\u662fbase class\u7684\u6790\u6784\u51fd\u6570\uff0c\u800c\u975e\u6307\u9488\u5b9e\u9645\u6307\u5411\u7684derived clas; \u81f3\u4e8e\u90a3\u4e9b\u4e0d\u662f\u4e3a\u4e86\u591a\u6001\u76ee\u7684\u8bbe\u8ba1\u7684base class\uff0c\u5219\u65e0\u9700\u865a\u6790\u6784\u51fd\u6570\u3002 8\u3001\u4e0d\u8981\u8ba9\u5f02\u5e38\u9003\u79bb\u6790\u6784\u51fd\u6570 9\u3001\u51b3\u4e0d\u5728constructor\u548cdestructor\u5185\u8c03\u7528virtual\u51fd\u6570 10\u3001\u4ee4operator=\u8fd4\u56de\u4e00\u4e2a reference to *this \u2003\u4e3a\u4e86\u5b9e\u73b0\u8fde\u9501\u8d4b\u503c\uff0c\u4e14\u9002\u7528\u4e8e\u6240\u6709\u8d4b\u503c\u76f8\u5173\u8fd0\u7b97 11\u3001\u5728operatot=\u4e2d\u5904\u7406\u81ea\u6211\u8d4b\u503c //identity test Object& Object::operator=(const Object& rhs){ if(this==&rhs)return *this; delete p; // delete pointer member p = new T(*rhs.p); return *this; } //\u8003\u8651\u5f02\u5e38\u5b89\u5168\u548c\u81ea\u6211\u8d4b\u503c\u5b89\u5168 Object& Object::operator=(const Object& rhs){ T* tmp=p; p = new T(*rhs.p); delete tmp; // delete old pointer member; \u5982\u679cnew \u8fc7\u7a0b\u629b\u51fa\u5f02\u5e38\uff0c\u6b64\u65f6\u539f\u5148\u7684\u6307\u9488\u5c06\u4fdd\u6301\u539f\u72b6 return *this; } Object& Object::operator==(Object rhs){ //pass by value swap(rhs); //\u4ea4\u6362*this\u548crhs\u7684\u6570\u636e return *this; } 12\u3001Copy all parts of an object \u2003\u5f53\u4f60\u7f16\u5199\u4e00\u4e2acopying\u51fd\u6570(\u5305\u62eccopy ctor\u548ccopy-assignment)\u65f6\uff0c\u786e\u4fdd\u590d\u5236\u6240\u6709local\u6210\u5458\u53d8\u91cf\uff1b\u8c03\u7528base class\u76f8\u5e94copying\u51fd\u6570\u3002 \u2003\u53e6\u5916\u9700\u6ce8\u610f:\u4e0d\u5e94\u8be5\u8ba9copy assignment\u64cd\u4f5c\u7b26\u8c03\u7528copy ctor(\u8bd5\u56fe\u6784\u9020\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5bf9\u8c61)\uff0c\u53cd\u4e4b(\u8bd5\u56fe\u5bf9\u4e00\u4e2a\u5c1a\u672a\u6784\u9020\u7684\u5bf9\u8c61\u8d4b\u503c)\u4ea6\u5982\u6b64\uff1b\u6d88\u9664\u4e24\u8005\u91cd\u590d\u4ee3\u7801\u7684\u505a\u6cd5\uff0c\u662f\u5c06\u8fd9\u90e8\u5206\u4ee3\u7801\u5c01\u88c5\u5230\u5176\u4ed6\u51fd\u6570\uff0c\u88ab\u4e24\u8005\u8c03\u7528\u3002 resource management 13\u3001\u4ee5\u5bf9\u8c61\u7ba1\u7406\u8d44\u6e90 \u2003\u5c06\u8d44\u6e90(\u6307\u9488\u7c7b\u578b)\u653e\u8fdb\u5bf9\u8c61\u5185\uff0c\u5f53\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\uff0c\u6790\u6784\u51fd\u6570\u4f1a\u81ea\u52a8\u91ca\u653e\u8d44\u6e90(\u901a\u5e38\u4f9d\u8d56\u4e8e\u667a\u80fd\u6307\u9488)\u3002 \u2003\u83b7\u5f97\u8d44\u6e90\u540e\u7acb\u523b\u653e\u5165\u7ba1\u7406\u5bf9\u8c61\uff0c(\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u53c2\u6570\uff0c\u7528\u4ee5\u521d\u59cb\u5316);( RAII:Resource Acquistion Is Initialization) \u2003\u7ba1\u7406\u5bf9\u8c61\u8fd0\u7528\u6790\u6784\u51fd\u6570\u786e\u4fdd\u8d44\u6e90\u5f97\u5230\u91ca\u653e; \u2003\u4e00\u4e2a\u5408\u9002\u7684\u4f8b\u5b50\u5c31\u662f \u901a\u8fc7\u5bf9\u8c61\u7ba1\u7406\u9501\uff0c\u8fd9\u6837\u5f53\u4e2d\u9014\u5f02\u5e38\u9000\u51fa\u65f6\uff0c\u5bf9\u8c61\u7684\u6790\u6784\u51fd\u6570\u4f1a\u91ca\u653e\u9501 \u3002 14\u3001\u5728\u8d44\u6e90\u7ba1\u7406\u7c7b\u4e2d\u5c0f\u5fc3copying\u884c\u4e3a \u5bf9\u4e8e\u975eheap-based(heap-based\u5373\u901a\u8fc7new\u83b7\u5f97\u7684\u6307\u9488)\u7684\u8d44\u6e90\uff0c\u667a\u80fd\u6307\u9488\u4e0d\u9002\u5408\u4f5c\u4e3aresource handler\u3002\u800c\u5f53RAII\u5bf9\u8c61\u53d1\u751f\u590d\u5236\u65f6\uff0c\u4e00\u822c\u6709\u4e24\u79cd\u53ef\u80fd:\u7981\u6b62\u590d\u5236\u6216\u8005\u5bf9\u5e95\u5c42\u8d44\u6e90\u91c7\u7528\u5f15\u7528\u8ba1\u6570\u6cd5(shared_ptr\u91c7\u7528\u7684\u505a\u6cd5)\uff0c\u4e0d\u8fc7\u4e5f\u53ef\u4ee5\u91c7\u7528\u6df1\u62f7\u8d1d\u6216\u8005\u8f6c\u79fb\u5e95\u90e8\u5bf9\u8c61\u6240\u6709\u6743(auto_ptr\u91c7\u7528\u7684\u505a\u6cd5\uff0c\u8d44\u6e90\u7684\u6240\u6709\u6743\u4ece\u590d\u5236\u7269\u8f6c\u79fb\u5230\u76ee\u6807\u7269) 15\u3001\u5728\u8d44\u6e90\u7ba1\u7406\u7c7b\u4e2d\u63d0\u4f9b\u5bf9\u539f\u59cb\u8d44\u6e90\u7684\u8bbf\u95ee \u2003\u6bcf\u4e00\u4e2aRAII class\u5e94\u8be5\u63d0\u4f9b\u4e00\u4e2a\u53d6\u5f97\u5176\u6240\u7ba1\u7406\u4e4b\u8d44\u6e90\u7684\u65b9\u6cd5\uff1b \u2003\u5bf9\u539f\u59cb\u8d44\u6e90\u7684\u8bbf\u95ee\u53ef\u80fd\u7ecf\u7531\u663e\u793a\u8f6c\u6362(\u6bd4\u8f83\u5b89\u5168)\u6216\u8005\u9690\u5f0f\u8f6c\u6362(\u65b9\u4fbf\u5ba2\u6237) 16\u3001\u6210\u5bf9\u4f7f\u7528new\u548cdelete\u65f6\u8981\u91c7\u53d6\u76f8\u540c\u5f62\u5f0f 17\u3001\u4ee5\u72ec\u7acb\u8bed\u53e5\u5c06newed\u5bf9\u8c61\u7f6e\u5165\u667a\u80fd\u6307\u9488 int priority(); void process(shared_ptr<Widget> pw, int pri); //\u53c2\u6570\u4f20\u9012\u524d\u6709\u4e09\u4e2a\u6b65\u9aa4\uff0c\u8c03\u7528priority()\uff0cnew Widget\uff0c\u6784\u5efashaerd_ptr //new\u64cd\u4f5c\u4e00\u5b9a\u53d1\u751f\u5728\u6784\u5efashared_ptr\u4e4b\u524d\uff0c\u4f46priority()\u8c03\u7528\u53ef\u80fd\u53d1\u751f\u5728\u4e24\u8005\u4e2d\u95f4\uff0c //\u5982\u679c\u6b64\u65f6\u53d1\u9001\u5f02\u5e38\uff0c\u5219new\u5f97\u5230\u7684\u8d44\u6e90\u5c06\u4f1a\u6cc4\u6f0f process(shared_ptr<Widget>(new Widget), priority()); //\u56e0\u6b64\u91c7\u7528\u72ec\u7acb\u8bed\u53e5\u5c06newd\u5bf9\u8c61\u7f6e\u5165\u667a\u80fd\u6307\u9488 shared_ptr<Widget> pw(new Widget); process(pw, priority); design and declarations 18\u3001\u8ba9\u63a5\u53e3\u5bb9\u6613\u88ab\u6b63\u786e\u4f7f\u7528\uff0c\u4e0d\u6613\u88ab\u8bef\u7528 shared_ptr\u652f\u6301\u5b9a\u5236\u5220\u9664\u5668\uff0c\u53ef\u9632\u8303cross-DLL problem(object\u5728\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93DLL\u4e2d\u88abnew\u521b\u5efa\uff0c\u5374\u5728\u53e6\u4e00\u4e2aDLL\u5185\u88abdelete\u9500\u6bc1\uff0c\u5728\u8bb8\u591a\u5e73\u53f0\u4e0a\u8fd9\u4f1a\u5bfc\u81f4\u8fd0\u884c\u671f\u9519\u8bef\uff1b\u800cshare_ptr\u5305\u542b\u7f3a\u7701\u7684deletor, \u5176\u6765\u81ea\u521b\u5efa\u65f6\u7684DLL\uff0c\u56e0\u6b64\u5176\u8c03\u7528\u7684\u662f\u539f\u6765\u7684DLL\u4e2d\u7684deletor) 19\u3001\u8bbe\u8ba1class\u72b9\u5982\u8bbe\u8ba1type 20\u3001Prefer pass-by-reference-to-const to pass-by-value \u2003\u524d\u8005\u6548\u7387\u66f4\u9ad8\uff1b \u2003\u4e14\u5f53\u51fd\u6570\u7c7b\u578b\u662f\u4e00\u4e2a\u57fa\u7c7b\u7c7b\u578b\uff0c\u5982\u679c\u4f20\u9012\u7ed9\u5176\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\u65f6\uff0c\u5219\u4f1a\u91cd\u65b0\u6784\u9020\uff0c\u4e22\u5931\u6d3e\u751f\u7c7b\u7684\u7279\u5316\u4fe1\u606f(\u5373\u5207\u5272\u95ee\u9898)\uff0c\u9009\u62e9pass-by-reference\u4f20\u9012\u53c2\u6570\u5219\u53ef\u4ee5\u907f\u514dsliceing(\u4e5f\u5c31\u662f\u552f\u6709\u4ee5\u57fa\u7c7b\u7684\u6307\u9488\u548c\u5f15\u7528\u624d\u80fd\u652f\u6301\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u6982\u5ff5)\u3002 \u2003 \u5bf9\u4e8e\u5185\u7f6e\u7c7b\u578b\u548cSTL\u7684\u8fed\u4ee3\u5668\u4ee5\u53ca\u51fd\u6570\u5bf9\u8c61\u800c\u8a00\uff0cpass-by-value\u5f80\u5f80\u66f4\u9002\u5f53 \u3002 21\u3001\u5fc5\u987b\u8fd4\u56de\u5bf9\u8c61\u65f6\uff0c\u4e0d\u8981\u8bd5\u56fe\u8fd4\u56dereference \u2003\u4e0d\u5141\u8bb8\u51fd\u6570\u8fd4\u56de\u4e00\u4e2areference\u6216pointer\u6307\u5411local object\u3002(local object\u5728\u6808\u7a7a\u95f4\u4e2d\u521b\u5efa\uff0c\u51fd\u6570\u8fd4\u56de\u65f6\u4f1a\u9500\u6bc1\u6808\u7a7a\u95f4) \u2003\u5982\u679c\u5728\u51fd\u6570\u5185\u901a\u8fc7new\u5728heap\u5185\u521b\u5efa\u4e00\u4e2aobject\uff0c\u867d\u7136\u53ef\u4ee5\u8fd4\u56de\u5176\u5f15\u7528\uff0c\u4f46\u5374\u4e0d\u6613\u88ab\u4eba\u53d1\u89c9\u9700\u8981delete\uff0c\u4ece\u800c\u53d1\u751f\u5185\u5b58\u6cc4\u6f0f\uff0c\u8fd9\u79cd\u505a\u6cd5\u4e5f\u8981\u907f\u514d\u3002 22\u3001\u5c06\u6210\u5458\u53d8\u91cf\u58f0\u660e\u4e3aprivate \u2003\u4ece\u5c01\u88c5\u89d2\u5ea6\u770b\uff0c\u53ea\u6709\u4e24\u79cd\u8bbf\u95ee\u6743\u9650:private(\u63d0\u4f9b\u5c01\u88c5)\u548c\u5176\u4ed6(\u4e0d\u63d0\u4f9b\u5c01\u88c5\uff0cprotected\u5e76\u4e0d\u6bd4public\u66f4\u5177\u5c01\u88c5\u6027\uff0c\u5176\u4f1a\u5f71\u54cdderived class)\u3002 \u2003\u5c01\u88c5\u6210\u5458\u53d8\u91cf\uff0c\u53ef\u4ee5\u786e\u4fddclass\u7684\u7ea6\u675f\u6761\u4ef6\u603b\u662f\u5f97\u5230\u7ef4\u62a4\uff0c\u53ea\u6709\u6210\u5458\u51fd\u6570\u53ef\u4ee5\u5f71\u54cd\u5b83\u4eec\u3002 \u2003\u88ab\u5c01\u88c5\u7684\u4e1c\u897f\u610f\u5473\u7740\u4fee\u6539\u8fd9\u90e8\u5206\u4e5f\u66f4\u5bb9\u6613\uff0c\u56e0\u4e3a\u5916\u754c\u53ea\u80fd\u901a\u8fc7\u6709\u9650\u7684\u51fd\u6570\u6765\u8bbf\u95ee\uff1b\u800c\u90a3\u4e9b\u6ca1\u6709\u88ab\u5c01\u88c5\u7684\u4e1c\u897f\uff0c\u5916\u754c\u53ef\u4ee5\u968f\u610f\u8bbf\u95ee\u3001\u4fee\u6539\uff0c\u5bf9\u4e8e\u8bbe\u8ba1\u8005\u6765\u8bf4\uff0c\u4e0d\u80fd\u8f7b\u6613\u4fee\u6539\uff0c\u5426\u5219\u4f1a\u9020\u6210\u65e7\u7248\u672c\u4e0d\u80fd\u517c\u5bb9\u3002 23\u3001Prefer non-member non-friend functions to member functions \u2003\u57fa\u4e8e22\u5219\u7b2c\u4e09\u70b9\u7684\u539f\u56e0\uff0c\u5728\u5b9e\u73b0\u76f8\u540c\u529f\u80fd\u7684\u524d\u63d0\u4e0b\uff0cnon-member non-friend funtion\u76f8\u6bd4member function\u6709\u66f4\u5927\u7684\u5c01\u88c5\u6027\uff0c\u5b83\u65e0\u6cd5\u8bbf\u95eeclass\u5185private\u90e8\u5206\uff0c\u6545\u524d\u8005\u4e5f\u66f4\u53d7\u8bbe\u8ba1\u8005\u6b22\u8fce\u3002 24\u3001\u82e5\u6240\u6709\u53c2\u6570\u7686\u987b\u7c7b\u578b\u8f6c\u6362\uff0c\u8bf7\u4e3a\u6b64\u91c7\u7528non-member function; \u2003\u5982\u679c\u9700\u8981\u4e3a\u67d0\u4e2a\u51fd\u6570\u7684\u6240\u6709\u53c2\u6570(\u5305\u62ecthis\u6307\u9488\u6240\u6307\u7684\u9690\u55bb\u53c2\u6570)\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff0c\u5219\u8fd9\u4e2a\u51fd\u6570\u6700\u597d\u662fnon-member function\u3002 25\u3001\u8003\u8651\u5199\u51fa\u4e00\u4e2a\u4e0d\u629b\u5f02\u5e38\u7684swap\u51fd\u6570 \u2003std\u63d0\u4f9b\u7684\u7f3a\u7701swap\u51fd\u6570\uff0c\u5728\u5904\u7406\u5305\u542b\u6307\u9488\u6210\u5458\u7684\u5bf9\u8c61\u65f6\uff0c\u8fd9\u79cd\u9ed8\u8ba4\u64cd\u4f5c\u5c06\u663e\u5f97\u5197\u4f59 \u2003\u5bf9\u4e8e\u5185\u542b\u6307\u9488\u6210\u5458\u7684\u7c7b\uff0c\u53ef\u4ee5\u5982\u4e0b\u5f62\u5f0f\uff0c\u8bbe\u8ba1swap\u51fd\u6570\u3002 implementation 26\u3001\u5c3d\u53ef\u80fd\u5ef6\u540e\u53d8\u91cf\u5b9a\u4e49\u5f0f\u7684\u51fa\u73b0\u65f6\u95f4 \u2003\u5ef6\u540e\u53d8\u91cf\u7684\u5b9a\u4e49\uff0c\u76f4\u5230\u975e\u5f97\u4f7f\u7528\u53d8\u91cf\u7684\u524d\u4e00\u523b\u4e3a\u6b62\uff0c\u751a\u81f3\u8fdb\u4e00\u6b65\u5ef6\u8fdf\u5230\u8fd9\u4efd\u5b9a\u4e49\u80fd\u591f\u83b7\u5f97\u521d\u503c\u5b9e\u53c2\u4e3a\u6b62\uff1b\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86 \u907f\u514d\u6784\u9020\u548c\u6790\u6784\u975e\u5fc5\u8981\u5bf9\u8c61\uff0c\u8fd8\u53ef\u4ee5\u907f\u514d\u65e0\u610f\u4e49\u7684default\u6784\u9020\u884c\u4e3a \u3002 \u2003\u5bf9\u4e8e\u53ea\u5728\u5faa\u73af\u4f53\u5185\u4f7f\u7528\u7684\u53d8\u91cf\uff0c\u5982\u679c\u5176\u7c7b\u578b\u7684\u6784\u9020\u548c\u6790\u6784\u6210\u672c \u5927\u4e8e \u8d4b\u503c\u6210\u672c\uff0c\u5219\u5728\u5faa\u73af\u4f53\u5916\u5b9a\u4e49\uff0c\u53cd\u4e4b\u5728\u5faa\u73af\u5185\u5b9a\u4e49\u3002 27\u3001\u5c3d\u91cf\u5c11\u505a\u8f6c\u578b\u52a8\u4f5c 28\u3001\u907f\u514d\u8fd4\u56dehandles\u6307\u5411\u5bf9\u8c61\u5185\u90e8\u6210\u5206 \u2003\u907f\u514d\u8fd4\u56dehandles(\u5305\u62ecreference\u3001\u6307\u9488\u3001\u8fed\u4ee3\u5668)\u6307\u5411\u5bf9\u8c61\u5185\u90e8\uff0c\u56e0\u4e3a\u65e0\u8bba\u8fd9\u4e2ahandle\u662f\u5426\u6709const\uff0c\u4e5f\u4e0d\u8bba\u8fd4\u56de\u5176\u7684\u51fd\u6570\u662f\u5426\u4e3aconst\uff0c\u90fd\u6709\u53ef\u80fd \u9020\u6210handle\u6bd4\u5176\u6240\u6307\u5411\u5bf9\u8c61\u5bff\u547d\u66f4\u957f\u7684\u98ce\u9669 \uff0c\u4f8b\u5982\u6307\u5411\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u7684\u5185\u90e8\uff0c\u800chandle\u5374\u88ab\u4fdd\u5b58\u4e3a\u957f\u671f\u5bf9\u8c61\u3002 \u2003\u4e0d\u8fc7\u5bf9\u4e8e\u4e00\u4e9b\u91cd\u8f7doperator[]\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u901a\u8fc7\u8fd4\u56de\u5f15\u7528\uff0c\u6765\u76f4\u63a5\u4fee\u6539\u5176\u5185\u90e8\u5bf9\u8c61\uff1b\u9664\u6b64\u4e4b\u5916\uff0c\u5e94\u8c28\u614e\u8fd4\u56de\u6307\u5411\u5bf9\u8c61\u5185\u90e8\u7684handles\u3002 29\u3001\u4e3a\u5f02\u5e38\u5b89\u5168\u800c\u52aa\u529b\u662f\u503c\u5f97\u7684 \u5f53\u5f02\u5e38\u88ab\u629b\u51fa\u65f6\uff0c\u5f02\u5e38\u5b89\u5168\u51fd\u6570\u5373\u4f7f\u53d1\u751f\u5f02\u5e38\u4e5f\u4e0d\u4f1a\u6cc4\u6f0f\u4efb\u4f55\u8d44\u6e90\u6216\u5141\u8bb8\u4efb\u4f55\u6570\u636e\u8d25\u574f\uff0c\u8fd9\u6837\u7684\u51fd\u6570\u533a\u5206\u4e09\u79cd\u53ef\u80fd\u7684\u4fdd\u8bc1: \u57fa\u672c\u627f\u8bfa : \u5982\u679c\u5f02\u5e38\u88ab\u629b\u51fa\uff0c\u7a0b\u5e8f\u5185\u7684\u4efb\u4f55\u4e8b\u7269\u4ecd\u7136\u4fdd\u6301\u5728\u6709\u6548\u72b6\u6001\u4e0b\uff0c\u6ca1\u6709\u4efb\u4f55\u5bf9\u8c61\u6216\u8005\u6570\u636e\u7ed3\u6784\u4f1a\u56e0\u6b64\u800c\u8d25\u574f\uff1b\u4f46\u7a0b\u5e8f\u7684exact state\u4e0d\u53ef\u9884\u6599\u3002 \u5f3a\u70c8\u4fdd\u8bc1 \uff1a\u5982\u679c\u5f02\u5e38\u88ab\u629b\u51fa\uff0c\u7a0b\u5e8f\u72b6\u6001\u4e0d\u6539\u53d8\uff0c\u5373\u51fd\u6570\u6210\u529f\u5c31\u662f\u5b8c\u5168\u6210\u529f\uff1b\u51fd\u6570\u5931\u8d25\uff0c\u7a0b\u5e8f\u5c31\u56de\u590d\u5230\u8c03\u7528\u51fd\u6570\u4e4b\u524d\u7684\u72b6\u6001\u3002 \u2003\u901a\u5e38\u60c5\u51b5\uff0ccopy-and-swap\u7b56\u7565\u662f\u4e00\u79cd\u597d\u7684\u505a\u6cd5\uff1a\u4e3a\u6253\u7b97\u4fee\u6539\u7684\u5bf9\u8c61(\u539f\u4ef6)\u505a\u51fa\u4e00\u4efd\u526f\u672c\uff0c\u7136\u540e\u5728\u526f\u672c\u4e0a\u505a\u4e00\u5207\u4fee\u6539\u3002\u82e5\u4fee\u6539\u8fc7\u7a0b\u629b\u51fa\u5f02\u5e38\uff0c\u539f\u5bf9\u8c61\u4ecd\u4fdd\u6301\u672a\u6539\u53d8\u72b6\u6001\uff1b\u5f85\u6240\u6709\u4fee\u6539\u6210\u529f\u540e\uff0c\u518d\u5c06\u526f\u672c\u548c\u539f\u4ef6\u5728\u4e00\u4e2a\u4e0d\u629b\u51fa\u5f02\u5e38\u7684\u64cd\u4f5c\u4e2dswap\u3002 \u2003\u7531\u4e8e\u51fd\u6570\u63d0\u4f9b\u7684\u5f02\u5e38\u5b89\u5168\u4fdd\u8bc1\u53d6\u51b3\u4e8e\u5176\u6240\u8c03\u7528\u7684\u5404\u4e2a\u51fd\u6570\u4e2d\u5f02\u5e38\u5b89\u5168\u4fdd\u8bc1\u6700\u4f4e\u8005\uff0c\u56e0\u6b64\u5373\u4f7f\u91c7\u7528copy-and-swap\uff0c\u4f9d\u65e7\u65e0\u6cd5\u4fdd\u8bc1\u6574\u4e2a\u51fd\u6570\u6709\u5f3a\u70c8\u7684\u5f02\u5e38\u5b89\u5168\u6027\uff1b \u4e14\u505a\u51fa\u4e00\u4efd\u526f\u672c\u9700\u8981\u989d\u5916\u7684\u8017\u65f6\u548c\u7a7a\u95f4\u6d88\u8017\u3002 \u2003\u56e0\u6b64\u5f3a\u70c8\u4fdd\u8bc1\u5e76\u975e\u5bf9\u6240\u6709\u51fd\u6570\u90fd\u53ef\u5b9e\u73b0\u6216\u5177\u5907\u73b0\u5b9e\u610f\u4e49\u3002 nothrow \u4fdd\u8bc1 \uff1a\u627f\u8bfa\u7edd\u4e0d\u629b\u51fa\u5f02\u5e38\uff0c\u603b\u662f\u80fd\u5b8c\u6210\u5b83\u4eec\u539f\u5148\u627f\u8bfa\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u5185\u7f6e\u7c7b\u578b\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u63d0\u4f9bnothrow\u4fdd\u8bc1\u3002 30\u3001understanding the ins and outs of inlining 31\u3001\u5c06\u6587\u4ef6\u95f4\u7684\u7f16\u8bd1\u4f9d\u5b58\u5173\u7cfb\u964d\u81f3\u6700\u4f4e \u2003\u5982\u679cclass A\u7684\u5b9a\u4e49\u6587\u4ef6\u4e2d\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u5176\u4ed6\u7c7b\u578b\u7684\u5b9a\u4e49\u5f0f(\u901a\u8fc7include\u5b9e\u73b0)\uff0c\u5219\u5f53\u90a3\u4e9b\u7c7b\u578b\u53d1\u9001\u6539\u53d8\u65f6\uff0c\u5e76\u91cd\u65b0\u7f16\u8bd1\u65f6\uff0c\u6b64\u65f6\u6240\u6709\u5305\u542bA\u7684\u5b9a\u4e49\u5f0f\u7684\u6587\u4ef6\u90fd\u5c06\u91cd\u65b0\u7f16\u8bd1\uff0c\u8fd9\u5373\u662f\u8fde\u4e32\u7f16\u8bd1\u4f9d\u5b58\u5173\u7cfb\u3002 \u2003 \u5c3d\u91cf\u4ee5class\u58f0\u660e\u5f0f\u66ff\u6362class\u5b9a\u4e49\u5f0f \uff0c\u5e76\u4e14\u53ea\u4f9d\u9760class \u58f0\u660e\u5f0f\u5c31\u80fd\u5b9a\u4e49\u51fa\u6307\u5411\u8be5\u7c7b\u578b\u7684reference\u6216pointer; \u5982\u679c\u5b9a\u4e49\u67d0\u7c7b\u578b\u7684objects\uff0c\u5c31\u5fc5\u987b\u7528\u5230\u5176\u5b9a\u4e49\u5f0f\u3002\u4ee5\u58f0\u660e\u4f9d\u5b58\u6027\u4ee3\u66ff\u5b9a\u4e49\u4f9d\u5b58\u6027\uff0c\u53ef\u4ee5\u6539\u5584\u524d\u8ff0\u95ee\u9898\u3002 \u2003\u8fdb\u4e00\u6b65\u53ef\u4ee5\u4e3a\u58f0\u660e\u5f0f\u548c\u5b9a\u4e49\u5f0f\u63d0\u4f9b\u4e0d\u540c\u7684\u5934\u6587\u4ef6\uff1b\u5e76\u4e14\u901a\u8fc7handle class\u548cinterface class\u6765\u964d\u4f4e\u63a5\u53e3\u548c\u5b9e\u73b0\u95f4\u7684\u8026\u5408\uff0c\u4ece\u800c\u964d\u4f4e\u6587\u4ef6\u95f4\u7684\u7f16\u8bd1\u4f9d\u5b58\u6027\u3002 \u2003 handle class \u7684\u505a\u6cd5\u662f\uff1aA\u53ea\u63d0\u4f9b\u63a5\u53e3\uff0cB\u8d1f\u8d23\u5b9e\u73b0\u63a5\u53e3\uff0cA\u5305\u542b\u4e00\u4e2a\u6307\u5411B\u7c7b\u578b\u7684\u6307\u9488pImpl(pointer to implementation), \u901a\u8fc7pImpl\u6765\u8c03\u7528B\u4e2d\u5b9e\u73b0\u597d\u7684\u63a5\u53e3\uff1b\u8fd9\u6837A\u7684\u7528\u6237\u5c31\u4e0e\u5176\u5305\u542b\u7684\u989d\u5916\u7684classes\u7684\u5b9e\u73b0\u76f8\u5206\u79bb\uff0c\u90a3\u4e9bclasses\u7684\u4fee\u6539\u4e5f\u4e0d\u4f1a\u9700\u8981A\u7684\u5ba2\u6237\u7aef\u91cd\u65b0\u7f16\u8bd1\u3002 \u2003 interface class \u7684\u505a\u6cd5\u662f\uff1a\u4ee4A\u6210\u4e3a\u4e00\u79cd\u7279\u6b8a\u7684abstract class, \u53ea\u6709\u4e00\u4e2avirtual \u6790\u6784\u51fd\u6570\uff0c\u548c\u4e00\u7ec4\u7eaf\u865a\u51fd\u6570\uff0c\u7528\u4ee5\u63cf\u8ff0\u51fd\u6570\u63a5\u53e3\uff1b\u5e76\u4e14\u5bf9\u4e8e\u6d3e\u751f\u4f53\u7cfb\u5185\u5168\u90e8\u90fd\u76f8\u540c\u7684\u505a\u6cd5\uff0c\u53ef\u4ee5\u8ba9\u5176\u6210\u4e3ainterface class\u4e2dnon-virtual\u51fd\u6570\uff0c\u6d3e\u751f\u7c7b\u5171\u540c\u4f7f\u7528\u8fd9\u4e00\u4efd\u51fd\u6570\u3002 \u2003\u4e0a\u8ff0\u505a\u6cd5\u7684\u7f3a\u70b9\uff0c\u5373\u4e3a\u6bcf\u4e00\u6b21\u8bbf\u95ee\u589e\u52a0\u4e86\u4e00\u5c42\u95f4\u63a5\u6027\uff0c\u5982\u901a\u8fc7pImpl\u6216\u8005\u865a\u51fd\u6570\u8868\uff0c\u8fd9\u90fd\u4f1a\u5e26\u6765\u989d\u5916\u7684\u5f00\u9500\uff0c\u540c\u65f6pImpl\u662f\u901a\u8fc7\u52a8\u6001\u5206\u914d\u5f97\u5230\u7684\uff0c\u9700\u8981\u8003\u8651bad_alloc\u5f02\u5e38\u7684\u53ef\u80fd\u6027\u3002 32\u3001make sure public inheritance model \"is-a\" \u2003public\u7ee7\u627f \u4e3b\u5f20\u80fd\u591f\u65bd\u884c\u4e8ebase class\u5bf9\u8c61\u8eab\u4e0a\u7684\u6bcf\u4ef6\u4e8b\u60c5\uff0c\u4e5f\u53ef\u4ee5\u65bd\u884c\u4e8ederived class\u5bf9\u8c61\u8eab\u4e0a\uff1b\u8ba9\u7c7bA\u4ee5pulic inherit\u5f62\u5f0f\u7ee7\u627f\u7c7bB\uff0c\u9700\u8981\u786e\u4fdd A \u201cis a\u201d B, \u4e14\u5bf9\u4e8eB\u5bf9\u8c61\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u80fd\u65bd\u52a0\u5230A\u5bf9\u8c61\u4e0a\u3002 33\u3001\u907f\u514dhiding\u7ee7\u627f\u800c\u6765\u7684name \u2003\u53ef\u53c2\u8003c_base\u4e2d\u7684\u91cd\u8f7d/\u8986\u76d6/\u9690\u85cf/using\u3002 34\u3001\u533a\u5206\u63a5\u53e3\u7ee7\u627f\u548c\u5b9e\u73b0\u7ee7\u627f \u2003\u58f0\u660e\u4e00\u4e2apure virtual function\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9derived class\u53ea\u7ee7\u627f\u51fd\u6570\u63a5\u53e3\uff1b\u4e00\u822c\u60c5\u51b5\u4e0b\u57fa\u7c7b\u4e2d\u7eaf\u865a\u4e0d\u9700\u8981\u5b9a\u4e49\uff0c\u4f46\u5176\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u5b9a\u4e49\uff0c\u4f5c\u4e3a\u7f3a\u7701\u5b9e\u73b0\uff1b\u6b64\u65f6\u6d3e\u751f\u7c7b\u5982\u679c\u8986\u76d6\u8fd9\u4e2a\u7eaf\u865a\u51fd\u6570\uff0c\u53ef\u4ee5\u63d0\u4f9b\u81ea\u5df1\u7684\u5b9e\u73b0\uff0c\u6216\u8005\u901a\u8fc7Base::fun(args)\u5f62\u5f0f\u76f4\u63a5\u8c03\u7528\u7eaf\u865a\u51fd\u6570\u7684\u5b9e\u73b0\uff1b\u5982\u679c\u6d3e\u751f\u7c7b\u4e0d\u63d0\u4f9bfun\u7684\u5b9e\u73b0\uff0c\u5219\u4e0d\u4f1a\u901a\u8fc7\u7f16\u8bd1\uff0c\u56e0\u4e3afun\u4e3a\u4e00\u4e2apure virtual function\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u907f\u514d\u5982\u679cfcn\u662f\u666e\u901a\u865a\u51fd\u6570\uff0c\u4f46\u4e0d\u540c\u7684\u6d3e\u751f\u7c7b\u8981\u6c42\u7684\u7f3a\u7701\u5b9e\u73b0\u4e0d\u540c\uff0c\u6240\u4ee5\u5982\u679c\u6d3e\u751f\u7c7b\u60f3\u8981\u57fa\u7c7b\u4e2d\u7684\u7f3a\u7701\u5b9e\u73b0\uff0c\u5fc5\u987b\u4e3b\u52a8\u63d0\u51fa\uff0c\u5426\u5219\u5c31\u91cd\u65b0\u5b9e\u73b0\u3002 \u2003\u58f0\u660e\u4e00\u4e2a\u666e\u901a\u865a\u51fd\u6570\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9derived class\u7ee7\u627f\u51fd\u6570\u7684\u63a5\u53e3\u548c\u7f3a\u7701\u5b9e\u73b0\u3002 \u2003\u58f0\u660e\u4e00\u4e2a\u666e\u901a\u975e\u865a\u51fd\u6570\uff0c\u610f\u5473\u7740derived class\u4e2d\u7ee7\u627f\u51fd\u6570\u7684\u63a5\u53e3\uff0c\u540c\u65f6\u63d0\u4f9b\u4e00\u4efd\u5f3a\u5236\u7684\u5b9e\u73b0\uff0c\u5373\u671f\u671b\u4e0d\u540c\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\u6709\u76f8\u540c\u7684\u884c\u4e3a\uff1b\u5982\u679c\u6d3e\u751f\u7c7b\u4e2d\u91cd\u65b0\u58f0\u660e\u4e86\u4e00\u4e2a\u4e0e\u6b64\u540c\u540d\u7684\u51fd\u6570\uff0c\u5219\u65e0\u8bba\u53c2\u6570\u662f\u5426\u76f8\u540c\uff0c\u57fa\u7c7b\u4e2d\u7684\u7248\u672c\u90fd\u5c06\u88ab\u9690\u85cf\u3002 35\u3001\u8003\u8651\u865a\u51fd\u6570\u4ee5\u5916\u7684\u5176\u4ed6\u9009\u62e9 36\u3001\u7edd\u4e0d\u91cd\u65b0\u5b9a\u4e49\u7ee7\u627f\u800c\u6765\u7684non-virtual\u51fd\u6570 \u2003\u5982\u679c\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\uff0c\u5219\u5c06\u8be5\u51fd\u6570\u58f0\u660e\u4e3avirtual function\u3002 37\u3001\u7edd\u4e0d\u91cd\u65b0\u5b9a\u4e49\u7ee7\u627f\u800c\u6765\u7684\u7f3a\u7701\u53c2\u6570\u503c \u56e0\u4e3a\u7f3a\u7701\u53c2\u6570\u503c\u90fd\u662f\u9759\u6001\u7ed1\u5b9a\uff0c\u5728\u4f7f\u7528\u591a\u6001\u65f6(\u6307\u901a\u8fc7pointer\u6216reference\u6765\u8bbf\u95ee\u6d3e\u751f\u7c7b\u5bf9\u8c61)\uff0c\u91cd\u65b0\u5b9a\u4e49\u7ee7\u627f\u800c\u6765\u7684\u865a\u51fd\u6570\u4e2d\u7684\u7f3a\u7701\u53c2\u6570\uff0c\u901a\u5e38\u4e0d\u4f1a\u6709\u5982\u671f\u884c\u4e3a\u53d1\u751f\uff0c\u5b9e\u9645\u4f7f\u7528\u7684\u4f9d\u65e7\u662f\u57fa\u7c7b\u63d0\u4f9b\u7684\u7f3a\u7701\u53c2\u6570\u503c\u3002 38\u3001 Model \"has-a\" or \"is-implemented-in-terms-of\" through composition \u2003\u590d\u5408(composition) \u662f\u7c7b\u578b\u4e4b\u95f4\u7684\u4e00\u79cd\u5173\u7cfb\uff0c\u5f53\u67d0\u79cd\u7c7b\u578b\u7684\u5bf9\u8c61\u5305\u542b\u5176\u4ed6\u79cd\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4fbf\u662f\u8fd9\u79cd\u5173\u7cfb\u3002 39\u3001\u8c28\u614e\u4f7f\u7528private \u7ee7\u627f private \u7ee7\u627f\u610f\u5473\u7740implemented-in-terms-of(\u6839\u636e\u67d0\u7269\u5b9e\u73b0\u51fa)\uff0c\u5373\u6d3e\u751f\u7c7b\u4e0e\u57fa\u7c7b\u5e76\u4e0d\u5b58\u5728is-a\u7684\u5173\u7cfb\u3002 \u2003\u5f53\u4f60\u9762\u5bf9\u5e76\u4e0d\u5b58\u5728is-a\u5173\u7cfb\u7684\u4e24\u4e2aclasses\uff0c\u5176\u4e2d\u4e00\u4e2a\u9700\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2aprotected\u6210\u5458\uff0c\u6216\u8005\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\u5176\u4e00\u6216\u591a\u4e2avirtual\u51fd\u6570\uff0c\u53ef\u4ee5\u8003\u8651private\u7ee7\u627f\u3002 40\u3001\u8c28\u614e\u4f7f\u7528\u591a\u91cd\u7ee7\u627f templates and generic programming 41\u3001\u4e86\u89e3\u9690\u5f0f\u63a5\u53e3\u548c\u7f16\u8bd1\u671f\u591a\u6001 \u2003\u7f16\u8bd1\u5668\u591a\u6001\uff1a\u4ee5\u4e0d\u540c\u7684template\u53c2\u6570\u5177\u73b0\u5316function templates \u4f1a\u5bfc\u81f4\u8c03\u7528\u4e0d\u540c\u7684\u51fd\u6570\uff0c\u548c\u91cd\u8f7d\u7c7b\u4f3c\uff0c\u90fd\u662f\u7f16\u8bd1\u5668\u7ed1\u5b9a\uff1b \u2003\u8fd0\u884c\u671f\u591a\u6001: \u8fd0\u884c\u671f\u6839\u636e\u53c2\u6570\u7684\u52a8\u6001\u7c7b\u578b\u51b3\u5b9a\u52a8\u6001\u7ed1\u5b9a\u54ea\u4e00\u4e2a\u865a\u51fd\u6570\u3002 42\u3001understand the two meanings of typename 43\u3001\u5b66\u4e60\u5904\u7406\u6a21\u677f\u5316\u57fa\u7c7b\u5185\u7684\u540d\u79f0 \u5bf9\u4e8e\u4e00\u4e2a\u7ee7\u627ftemplatized base class\u7684\u6d3e\u751f\u6a21\u677f\u7c7b\uff0c\u5982\u679c\u76f4\u63a5\u5728\u5176\u5185\u90e8\u8c03\u7528\u57fa\u7c7b\u4e2d\u7684public \u6210\u5458\u51fd\u6570\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7\u7f16\u8bd1\uff1b \u56e0\u4e3a\u7f16\u8bd1\u5668\u77e5\u9053base class template\u6709\u53ef\u80fd\u4f1a\u88ab\u7279\u5316\uff0c\u800c\u7279\u5316\u7248\u672c\u53ef\u80fd\u4e0d\u63d0\u4f9b\u548c\u4e00\u822c\u6027template\u76f8\u540c\u7684\u63a5\u53e3\u3002\u56e0\u6b64\u5b83\u62d2\u7edd\u5728templatized base class\u5185\u5bfb\u627e\u7ee7\u627f\u800c\u6765\u7684\u540d\u79f0\u3002 \u2003\u53ef\u5728derived class templates\u901a\u8fc7 this-> \u6307\u6d89base class templates\u5185\u7684\u6210\u5458\u540d\u79f0\uff0c\u6216\u4f7f\u7528using \u58f0\u660e\u5f0f\uff1b\u6216\u660e\u767d\u6307\u51fa\u88ab\u8c03\u7528\u7684\u51fd\u6570\u4f4d\u4e8ebase class\u5185\u3002 \u2003\u5982\u679c\u63d0\u4f9b\u4e00\u4e2a\u6ca1\u6709sendClear\u63a5\u53e3\u7684\u7279\u5316\u7248\u672c\uff0c\u5c06\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\u3002 template<typename company> class LoggingMsgSender:: public MsgSender<company>{ public: using MsgSender<company>::sendClear; //\u660e\u786e\u544a\u8bc9\u7f16\u8bd1\u5668\u51fd\u6570\u4f4d\u4e8ebase class\u5185 void sendClearMsg(const MsgInfo& info){ ... this->sendClear(info); //\u5047\u8bbesendClear\u88ab\u7ee7\u627f // MsgSender::sendClear(info); //\u8fd9\u79cd\u60c5\u51b5\u4f1a\u7834\u574fvirtual\u7ed1\u5b9a\u884c\u4e3a ... } } 44\u3001\u5c06\u4e0e\u53c2\u6570\u65e0\u5173\u7684\u4ee3\u7801\u5265\u79bbtemplates 45\u3001\u8fd0\u7528\u6210\u5458\u51fd\u6570\u6a21\u677f\u63a5\u53d7\u6240\u6709\u517c\u5bb9\u7c7b\u578b \u2003\u4e00\u4e2atemplate class\u63a5\u53d7\u4e0d\u540c\u7c7b\u578b\u53c2\u6570\u5f97\u5230\u7684\u5b9e\u4f8b\u4e4b\u95f4\u5e76\u4e0d\u5b58\u5728\u56fa\u6709\u5173\u7cfb\uff0c\u5373\u4f7f\u8fd9\u4e9b\u7c7b\u578b\u4e4b\u95f4\u672c\u8eab\u5b58\u5728\u7ee7\u627f\u5173\u7cfb\u3002 \u2003\u6784\u9020\u6a21\u677f: \u2003\u5bf9\u6784\u9020\u6a21\u677f\u65bd\u52a0\u7ea6\u675f: \u2003\u6210\u5458\u51fd\u6570\u6a21\u677f: 46\u3001\u9700\u8981\u7c7b\u578b\u8f6c\u6362\u65f6\u8bf7\u4e3a\u6a21\u677f\u5b9a\u4e49\u975e\u6210\u5458\u51fd\u6570 \u2003\u4e3a\u4e86\u8ba9\u7c7b\u578b\u8f6c\u6362\u53ef\u80fd\u53d1\u751f\u4e8e\u6240\u6709\u5b9e\u53c2\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2anon-member\u51fd\u6570(\u6761\u6b3e24); \u4e3a\u4e86\u4ee4\u8fd9\u4e2a\u51fd\u6570\u88ab\u81ea\u52a8\u5177\u73b0\u5316\uff0c\u6211\u4eec\u9700\u8981\u5c06\u5b83\u58f0\u660e\u5728class\u5185\u90e8\uff0c\u5373\u4ee4\u5b83\u6210\u4e3a\u4e00\u4e2afriend\u51fd\u6570\u3002 \u2003\u5982\u679c\u8fd9\u4e2anon-member\u51fd\u6570\u5b9a\u4e49\u5728class\u5916\u90e8\uff0c\u5219\u5bf9\u4e8e\u53ef\u80fd\u53d1\u751f\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff0c\u8c03\u7528\u76f8\u5173\u51fd\u6570\u5e76\u4e0d\u80fd\u6210\u529f\uff1b\u56e0\u4e3atemplate\u5b9e\u53c2\u63a8\u5bfc\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u4f1a\u8003\u8651\u9690\u5f0f\u8f6c\u6362\uff1b\u6240\u4ee5\u4f20\u9012\u7ed9\u51fd\u6570\u7684\u5b9e\u53c2\u53d1\u751f\u9690\u5f0f\u8f6c\u6362\uff0c\u7f16\u8bd1\u5668\u5e76\u4e0d\u80fd\u51c6\u786e\u77e5\u9053\u5e94\u8be5\u5177\u73b0\u5316\u54ea\u4e2a\u51fd\u6570\u3002 47\u3001\u4f7f\u7528traits classes\u8868\u73b0\u7c7b\u578b\u4fe1\u606f \u2003 typedef typename iterator_traits ::value_type valType; 48\u3001\u8ba4\u8bc6\u6a21\u677f\u5143\u7f16\u7a0b customizing new and delete 49\u3001undertand the behavior of the new handler \u5f53operator new\u629b\u51fa\u5f02\u5e38\u4ee5\u53cd\u6620\u4e00\u4e2a\u672a\u83b7\u6ee1\u8db3\u7684\u5185\u5b58\u9700\u6c42\u4e4b\u524d\uff0c\u5b83\u4f1a\u5148\u8c03\u7528\u4e00\u4e2a\u5ba2\u6237\u6307\u5b9a\u7684\u9519\u8bef\u5904\u7406\u51fd\u6570\uff0c\u5373\u4e00\u4e2anew-handler\u3002 \u4e00\u4e2a\u8bbe\u8ba1\u826f\u597d\u7684handler\u5fc5\u987b\u5305\u542b: \u8ba9\u66f4\u591a\u5185\u5b58\u53ef\u7528\u3001\u5b89\u88c5\u53e6\u4e00\u4e2anew-handler(\u65e0\u9650\u5faa\u73af)\u3001\u5378\u8f7dnew-handler(\u5c06null\u6307\u9488\u4f20\u7ed9set_new_handler)\u3001\u629b\u51fabad_alloc\u5f02\u5e38\u3001\u4e0d\u8fd4\u56de(\u8c03\u7528abort\u6216exit). 50\u3001\u4e86\u89e3new\u548cdelete\u7684\u5408\u7406\u66ff\u6362\u65f6\u95f4 51\u3001\u7f16\u5199new\u548cdelete\u65f6\u9700\u56fa\u5b88\u5e38\u89c4 52\u3001write placement delete if you write placement new \u8865\u5145 53\u3001 \u4e0d\u7528\u5ffd\u7565\u7f16\u8bd1\u5668\u7684\u8b66\u544a 54\u3001\u719f\u6089\u5305\u62ecTR1\u5728\u5185\u7684\u6807\u51c6\u7a0b\u5e8f\u5e93 55\u3001\u719f\u6089Boost","title":"RULES"},{"location":"EffectiveCPP/rule/#_1","text":"","title":"\u6761\u6b3e"},{"location":"EffectiveCPP/rule/#base","text":"1\u3001View C++ as a federations of lanuages 2\u3001Prefer consts, enums and inlines to #define \u5bf9\u4e8e\u5355\u7eaf\u5e38\u91cf\u5bf9\u8c61\uff0c\u6700\u540e\u4ee5const\u5bf9\u8c61\u6216enums\u66ff\u6362#define \u5bf9\u4e8e\u5f62\u4f3c\u51fd\u6570\u7684\u5b8f\uff0c\u6700\u597d\u7528inline\u51fd\u6570\u66ff\u6362#define 3\u3001Use const whenever possible \u2003\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u503c\uff0c\u907f\u514d\u8bf8\u5982\"a*b=c\"\u8fd9\u79cd\u539f\u610f\u662f\u5224\u65ad\u76f8\u7b49\uff0c\u800c\u9519\u5199\u6210\u8d4b\u503c\u7684\u64cd\u4f5c\uff0c\u8fd9\u79cd\u9519\u8bef\u5728\u7f16\u8bd1\u5668\u5c31\u4f1a\u68c0\u6d4b\u51fa\u6765\u3002 \u2003\u67d0\u4e9b\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u5f15\u7528\uff0c\u4e00\u6765\u53ef\u4ee5\u63d0\u4f9b\u4f20\u9012\u6548\u7387\uff0c\u4e8c\u6765\u53ef\u4ee5\u907f\u514d\u901a\u8fc7\u8fd4\u56de\u7684\u5f15\u7528\u4fee\u6539\u5b9e\u9645\u7684\u5bf9\u8c61\u3002 4\u3001Make sure that objects are initialized before they're used. 1>. \u624b\u5de5\u521d\u59cb\u5316\u5185\u7f6e\u578bnon-member\u5bf9\u8c61\u3002 2>. \u4f7f\u7528\u6210\u5458\u521d\u59cb\u5316\u5217\u8868\u6765\u521d\u59cb\u5316\u5bf9\u8c61\u6240\u6709\u6210\u5206\u3002 3>. \u7531\u4e8eC++ \u5bf9\u4e8e\u201c\u5b9a\u4e49\u5728\u4e0d\u540c\u7f16\u8bd1\u5355\u5143\u5185\u7684non-local static\u5bf9\u8c61\u201d\u7684\u521d\u59cb\u5316\u6b21\u5e8f\u5e76\u65e0\u660e\u786e\u5b9a\u4e49 \uff0c \u56e0\u6b64\u53ef\u4ee5\u5c06non-local static\u5bf9\u8c61\u7684\u58f0\u660e\u653e\u7f6e\u5728\u51fd\u6570\u5185\uff0c\u8fd9\u6837\u5176\u5c31\u53d8\u6210\u4e86local static\u5bf9\u8c61\uff0c \u800c\u8be5\u51fd\u6570\u53c8\u8fd4\u56de\u8be5\u5bf9\u8c61\u7684reference\u3002\u56e0\u4e3aC++\u4fdd\u8bc1, \u51fd\u6570\u5185\u7684local static\u5bf9\u8c61\u4f1a\u5728\u201c\u8be5\u51fd\u6570\u8c03\u7528\u671f\u95f4\uff0c\u9996\u6b21\u9047\u5230\u8be5\u5bf9\u8c61\u4e4b\u5b9a\u4e49\u5f0f\u201d\u65f6\u88ab\u521d\u59cb\u5316 \u3002 \u901a\u8fc7\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u83b7\u5f97\u4e00\u4e2a\u6307\u5411\u5df2\u7ecf\u521d\u59cb\u5316\u7684\u5bf9\u8c61\u7684reference\u3002","title":"base"},{"location":"EffectiveCPP/rule/#ctordtorassignment","text":"5\u3001\u4e86\u89e3C++\u9ed8\u9ed8\u7f16\u5199\u5e76\u8c03\u7528\u4e86\u54ea\u4e9b\u51fd\u6570 \u2003\u4e00\u822c\u60c5\u51b5\uff0c\u7f16\u8bd1\u5668\u53ef\u4ee5\u4e3aclass\u521b\u5efa\u9ed8\u8ba4constructor\u3001copy-constructor\u3001copy-assignment\u4ee5\u53cadestructor\uff0c \u4f46\u5f53class\u5185\u542b\u6709reference/pointer/const\u6210\u5458\uff0c\u4ee5\u53cabase classes\u5c06copy-assignment\u8bbe\u7f6e\u4e3aprivate\u65f6\uff0c\u65e0\u6cd5\u521b\u5efa\u9ed8\u8ba4copy-assignment\u3002 6\u3001\u82e5\u4e0d\u60f3\u4f7f\u7528\u7f16\u8bd1\u5668\u81ea\u52a8\u751f\u6210\u7684\u6784\u9020\u51fd\u6570\uff0c\u5c31\u5e94\u8be5\u660e\u786e\u62d2\u7edd \u2003\u4f7f\u7528=delete\uff1b\u6216\u8005\u5c06\u5176\u58f0\u660e\u4e3aprivate, \u4e0d\u8fc7\u8fd9\u6837\u5176member\u548cfriend\u4ecd\u7136\u80fd\u8bbf\u95ee\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2abase class\uff0c\u5728\u5176\u4e2d\u5c06\u8fd9\u4e9b\u51fd\u6570\u58f0\u660e\u4e3aprivate\uff0c\u8ba9\u4f60\u7684\u7c7b\u7ee7\u627f\u8fd9\u4e2abase class\uff0c\u5219\u51fa\u73b0\u8bd5\u56fe\u8bbf\u95ee\u8fd9\u4e9b\u51fd\u6570\u65f6\uff0c\u4f1a\u5728\u7f16\u8bd1\u5668\u4ef6\u62a5\u9519\u3002 7\u3001\u4e3a\u591a\u6001\u57fa\u7c7b\u58f0\u660evirtual\u6790\u6784\u51fd\u6570 \u2003\u5982\u679c\u4e00\u4e2aclass \u5305\u542b\u4efb\u4f55\u7684virtual \u51fd\u6570\uff0c\u5219\u5e94\u8be5\u6709\u4e00\u4e2avirtual \u6790\u6784\u51fd\u6570\u3002 \u2003\u8fd9\u4e2a\u89c4\u5219\u53ea\u9002\u7528\u4e8epolymorphic base classes\u8eab\u4e0a\uff0c\u8fd9\u79cdclass\u8bbe\u8ba1\u7684\u76ee\u7684\u662f\u4e3a\u4e86 \u901a\u8fc7base class\u63a5\u53e3\u6765\u5904\u7406derived class\u5bf9\u8c61 \uff0c\u5426\u5219\u6839\u636e\u9759\u6001\u7ed1\u5b9a\uff0c\u8c03\u7528\u7684\u5c06\u662fbase class\u7684\u6790\u6784\u51fd\u6570\uff0c\u800c\u975e\u6307\u9488\u5b9e\u9645\u6307\u5411\u7684derived clas; \u81f3\u4e8e\u90a3\u4e9b\u4e0d\u662f\u4e3a\u4e86\u591a\u6001\u76ee\u7684\u8bbe\u8ba1\u7684base class\uff0c\u5219\u65e0\u9700\u865a\u6790\u6784\u51fd\u6570\u3002 8\u3001\u4e0d\u8981\u8ba9\u5f02\u5e38\u9003\u79bb\u6790\u6784\u51fd\u6570 9\u3001\u51b3\u4e0d\u5728constructor\u548cdestructor\u5185\u8c03\u7528virtual\u51fd\u6570 10\u3001\u4ee4operator=\u8fd4\u56de\u4e00\u4e2a reference to *this \u2003\u4e3a\u4e86\u5b9e\u73b0\u8fde\u9501\u8d4b\u503c\uff0c\u4e14\u9002\u7528\u4e8e\u6240\u6709\u8d4b\u503c\u76f8\u5173\u8fd0\u7b97 11\u3001\u5728operatot=\u4e2d\u5904\u7406\u81ea\u6211\u8d4b\u503c //identity test Object& Object::operator=(const Object& rhs){ if(this==&rhs)return *this; delete p; // delete pointer member p = new T(*rhs.p); return *this; } //\u8003\u8651\u5f02\u5e38\u5b89\u5168\u548c\u81ea\u6211\u8d4b\u503c\u5b89\u5168 Object& Object::operator=(const Object& rhs){ T* tmp=p; p = new T(*rhs.p); delete tmp; // delete old pointer member; \u5982\u679cnew \u8fc7\u7a0b\u629b\u51fa\u5f02\u5e38\uff0c\u6b64\u65f6\u539f\u5148\u7684\u6307\u9488\u5c06\u4fdd\u6301\u539f\u72b6 return *this; } Object& Object::operator==(Object rhs){ //pass by value swap(rhs); //\u4ea4\u6362*this\u548crhs\u7684\u6570\u636e return *this; } 12\u3001Copy all parts of an object \u2003\u5f53\u4f60\u7f16\u5199\u4e00\u4e2acopying\u51fd\u6570(\u5305\u62eccopy ctor\u548ccopy-assignment)\u65f6\uff0c\u786e\u4fdd\u590d\u5236\u6240\u6709local\u6210\u5458\u53d8\u91cf\uff1b\u8c03\u7528base class\u76f8\u5e94copying\u51fd\u6570\u3002 \u2003\u53e6\u5916\u9700\u6ce8\u610f:\u4e0d\u5e94\u8be5\u8ba9copy assignment\u64cd\u4f5c\u7b26\u8c03\u7528copy ctor(\u8bd5\u56fe\u6784\u9020\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5bf9\u8c61)\uff0c\u53cd\u4e4b(\u8bd5\u56fe\u5bf9\u4e00\u4e2a\u5c1a\u672a\u6784\u9020\u7684\u5bf9\u8c61\u8d4b\u503c)\u4ea6\u5982\u6b64\uff1b\u6d88\u9664\u4e24\u8005\u91cd\u590d\u4ee3\u7801\u7684\u505a\u6cd5\uff0c\u662f\u5c06\u8fd9\u90e8\u5206\u4ee3\u7801\u5c01\u88c5\u5230\u5176\u4ed6\u51fd\u6570\uff0c\u88ab\u4e24\u8005\u8c03\u7528\u3002","title":"ctor\\dtor\\assignment"},{"location":"EffectiveCPP/rule/#resource-management","text":"13\u3001\u4ee5\u5bf9\u8c61\u7ba1\u7406\u8d44\u6e90 \u2003\u5c06\u8d44\u6e90(\u6307\u9488\u7c7b\u578b)\u653e\u8fdb\u5bf9\u8c61\u5185\uff0c\u5f53\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\uff0c\u6790\u6784\u51fd\u6570\u4f1a\u81ea\u52a8\u91ca\u653e\u8d44\u6e90(\u901a\u5e38\u4f9d\u8d56\u4e8e\u667a\u80fd\u6307\u9488)\u3002 \u2003\u83b7\u5f97\u8d44\u6e90\u540e\u7acb\u523b\u653e\u5165\u7ba1\u7406\u5bf9\u8c61\uff0c(\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u53c2\u6570\uff0c\u7528\u4ee5\u521d\u59cb\u5316);( RAII:Resource Acquistion Is Initialization) \u2003\u7ba1\u7406\u5bf9\u8c61\u8fd0\u7528\u6790\u6784\u51fd\u6570\u786e\u4fdd\u8d44\u6e90\u5f97\u5230\u91ca\u653e; \u2003\u4e00\u4e2a\u5408\u9002\u7684\u4f8b\u5b50\u5c31\u662f \u901a\u8fc7\u5bf9\u8c61\u7ba1\u7406\u9501\uff0c\u8fd9\u6837\u5f53\u4e2d\u9014\u5f02\u5e38\u9000\u51fa\u65f6\uff0c\u5bf9\u8c61\u7684\u6790\u6784\u51fd\u6570\u4f1a\u91ca\u653e\u9501 \u3002 14\u3001\u5728\u8d44\u6e90\u7ba1\u7406\u7c7b\u4e2d\u5c0f\u5fc3copying\u884c\u4e3a \u5bf9\u4e8e\u975eheap-based(heap-based\u5373\u901a\u8fc7new\u83b7\u5f97\u7684\u6307\u9488)\u7684\u8d44\u6e90\uff0c\u667a\u80fd\u6307\u9488\u4e0d\u9002\u5408\u4f5c\u4e3aresource handler\u3002\u800c\u5f53RAII\u5bf9\u8c61\u53d1\u751f\u590d\u5236\u65f6\uff0c\u4e00\u822c\u6709\u4e24\u79cd\u53ef\u80fd:\u7981\u6b62\u590d\u5236\u6216\u8005\u5bf9\u5e95\u5c42\u8d44\u6e90\u91c7\u7528\u5f15\u7528\u8ba1\u6570\u6cd5(shared_ptr\u91c7\u7528\u7684\u505a\u6cd5)\uff0c\u4e0d\u8fc7\u4e5f\u53ef\u4ee5\u91c7\u7528\u6df1\u62f7\u8d1d\u6216\u8005\u8f6c\u79fb\u5e95\u90e8\u5bf9\u8c61\u6240\u6709\u6743(auto_ptr\u91c7\u7528\u7684\u505a\u6cd5\uff0c\u8d44\u6e90\u7684\u6240\u6709\u6743\u4ece\u590d\u5236\u7269\u8f6c\u79fb\u5230\u76ee\u6807\u7269) 15\u3001\u5728\u8d44\u6e90\u7ba1\u7406\u7c7b\u4e2d\u63d0\u4f9b\u5bf9\u539f\u59cb\u8d44\u6e90\u7684\u8bbf\u95ee \u2003\u6bcf\u4e00\u4e2aRAII class\u5e94\u8be5\u63d0\u4f9b\u4e00\u4e2a\u53d6\u5f97\u5176\u6240\u7ba1\u7406\u4e4b\u8d44\u6e90\u7684\u65b9\u6cd5\uff1b \u2003\u5bf9\u539f\u59cb\u8d44\u6e90\u7684\u8bbf\u95ee\u53ef\u80fd\u7ecf\u7531\u663e\u793a\u8f6c\u6362(\u6bd4\u8f83\u5b89\u5168)\u6216\u8005\u9690\u5f0f\u8f6c\u6362(\u65b9\u4fbf\u5ba2\u6237) 16\u3001\u6210\u5bf9\u4f7f\u7528new\u548cdelete\u65f6\u8981\u91c7\u53d6\u76f8\u540c\u5f62\u5f0f 17\u3001\u4ee5\u72ec\u7acb\u8bed\u53e5\u5c06newed\u5bf9\u8c61\u7f6e\u5165\u667a\u80fd\u6307\u9488 int priority(); void process(shared_ptr<Widget> pw, int pri); //\u53c2\u6570\u4f20\u9012\u524d\u6709\u4e09\u4e2a\u6b65\u9aa4\uff0c\u8c03\u7528priority()\uff0cnew Widget\uff0c\u6784\u5efashaerd_ptr //new\u64cd\u4f5c\u4e00\u5b9a\u53d1\u751f\u5728\u6784\u5efashared_ptr\u4e4b\u524d\uff0c\u4f46priority()\u8c03\u7528\u53ef\u80fd\u53d1\u751f\u5728\u4e24\u8005\u4e2d\u95f4\uff0c //\u5982\u679c\u6b64\u65f6\u53d1\u9001\u5f02\u5e38\uff0c\u5219new\u5f97\u5230\u7684\u8d44\u6e90\u5c06\u4f1a\u6cc4\u6f0f process(shared_ptr<Widget>(new Widget), priority()); //\u56e0\u6b64\u91c7\u7528\u72ec\u7acb\u8bed\u53e5\u5c06newd\u5bf9\u8c61\u7f6e\u5165\u667a\u80fd\u6307\u9488 shared_ptr<Widget> pw(new Widget); process(pw, priority);","title":"resource management"},{"location":"EffectiveCPP/rule/#design-and-declarations","text":"18\u3001\u8ba9\u63a5\u53e3\u5bb9\u6613\u88ab\u6b63\u786e\u4f7f\u7528\uff0c\u4e0d\u6613\u88ab\u8bef\u7528 shared_ptr\u652f\u6301\u5b9a\u5236\u5220\u9664\u5668\uff0c\u53ef\u9632\u8303cross-DLL problem(object\u5728\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93DLL\u4e2d\u88abnew\u521b\u5efa\uff0c\u5374\u5728\u53e6\u4e00\u4e2aDLL\u5185\u88abdelete\u9500\u6bc1\uff0c\u5728\u8bb8\u591a\u5e73\u53f0\u4e0a\u8fd9\u4f1a\u5bfc\u81f4\u8fd0\u884c\u671f\u9519\u8bef\uff1b\u800cshare_ptr\u5305\u542b\u7f3a\u7701\u7684deletor, \u5176\u6765\u81ea\u521b\u5efa\u65f6\u7684DLL\uff0c\u56e0\u6b64\u5176\u8c03\u7528\u7684\u662f\u539f\u6765\u7684DLL\u4e2d\u7684deletor) 19\u3001\u8bbe\u8ba1class\u72b9\u5982\u8bbe\u8ba1type 20\u3001Prefer pass-by-reference-to-const to pass-by-value \u2003\u524d\u8005\u6548\u7387\u66f4\u9ad8\uff1b \u2003\u4e14\u5f53\u51fd\u6570\u7c7b\u578b\u662f\u4e00\u4e2a\u57fa\u7c7b\u7c7b\u578b\uff0c\u5982\u679c\u4f20\u9012\u7ed9\u5176\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\u65f6\uff0c\u5219\u4f1a\u91cd\u65b0\u6784\u9020\uff0c\u4e22\u5931\u6d3e\u751f\u7c7b\u7684\u7279\u5316\u4fe1\u606f(\u5373\u5207\u5272\u95ee\u9898)\uff0c\u9009\u62e9pass-by-reference\u4f20\u9012\u53c2\u6570\u5219\u53ef\u4ee5\u907f\u514dsliceing(\u4e5f\u5c31\u662f\u552f\u6709\u4ee5\u57fa\u7c7b\u7684\u6307\u9488\u548c\u5f15\u7528\u624d\u80fd\u652f\u6301\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u6982\u5ff5)\u3002 \u2003 \u5bf9\u4e8e\u5185\u7f6e\u7c7b\u578b\u548cSTL\u7684\u8fed\u4ee3\u5668\u4ee5\u53ca\u51fd\u6570\u5bf9\u8c61\u800c\u8a00\uff0cpass-by-value\u5f80\u5f80\u66f4\u9002\u5f53 \u3002 21\u3001\u5fc5\u987b\u8fd4\u56de\u5bf9\u8c61\u65f6\uff0c\u4e0d\u8981\u8bd5\u56fe\u8fd4\u56dereference \u2003\u4e0d\u5141\u8bb8\u51fd\u6570\u8fd4\u56de\u4e00\u4e2areference\u6216pointer\u6307\u5411local object\u3002(local object\u5728\u6808\u7a7a\u95f4\u4e2d\u521b\u5efa\uff0c\u51fd\u6570\u8fd4\u56de\u65f6\u4f1a\u9500\u6bc1\u6808\u7a7a\u95f4) \u2003\u5982\u679c\u5728\u51fd\u6570\u5185\u901a\u8fc7new\u5728heap\u5185\u521b\u5efa\u4e00\u4e2aobject\uff0c\u867d\u7136\u53ef\u4ee5\u8fd4\u56de\u5176\u5f15\u7528\uff0c\u4f46\u5374\u4e0d\u6613\u88ab\u4eba\u53d1\u89c9\u9700\u8981delete\uff0c\u4ece\u800c\u53d1\u751f\u5185\u5b58\u6cc4\u6f0f\uff0c\u8fd9\u79cd\u505a\u6cd5\u4e5f\u8981\u907f\u514d\u3002 22\u3001\u5c06\u6210\u5458\u53d8\u91cf\u58f0\u660e\u4e3aprivate \u2003\u4ece\u5c01\u88c5\u89d2\u5ea6\u770b\uff0c\u53ea\u6709\u4e24\u79cd\u8bbf\u95ee\u6743\u9650:private(\u63d0\u4f9b\u5c01\u88c5)\u548c\u5176\u4ed6(\u4e0d\u63d0\u4f9b\u5c01\u88c5\uff0cprotected\u5e76\u4e0d\u6bd4public\u66f4\u5177\u5c01\u88c5\u6027\uff0c\u5176\u4f1a\u5f71\u54cdderived class)\u3002 \u2003\u5c01\u88c5\u6210\u5458\u53d8\u91cf\uff0c\u53ef\u4ee5\u786e\u4fddclass\u7684\u7ea6\u675f\u6761\u4ef6\u603b\u662f\u5f97\u5230\u7ef4\u62a4\uff0c\u53ea\u6709\u6210\u5458\u51fd\u6570\u53ef\u4ee5\u5f71\u54cd\u5b83\u4eec\u3002 \u2003\u88ab\u5c01\u88c5\u7684\u4e1c\u897f\u610f\u5473\u7740\u4fee\u6539\u8fd9\u90e8\u5206\u4e5f\u66f4\u5bb9\u6613\uff0c\u56e0\u4e3a\u5916\u754c\u53ea\u80fd\u901a\u8fc7\u6709\u9650\u7684\u51fd\u6570\u6765\u8bbf\u95ee\uff1b\u800c\u90a3\u4e9b\u6ca1\u6709\u88ab\u5c01\u88c5\u7684\u4e1c\u897f\uff0c\u5916\u754c\u53ef\u4ee5\u968f\u610f\u8bbf\u95ee\u3001\u4fee\u6539\uff0c\u5bf9\u4e8e\u8bbe\u8ba1\u8005\u6765\u8bf4\uff0c\u4e0d\u80fd\u8f7b\u6613\u4fee\u6539\uff0c\u5426\u5219\u4f1a\u9020\u6210\u65e7\u7248\u672c\u4e0d\u80fd\u517c\u5bb9\u3002 23\u3001Prefer non-member non-friend functions to member functions \u2003\u57fa\u4e8e22\u5219\u7b2c\u4e09\u70b9\u7684\u539f\u56e0\uff0c\u5728\u5b9e\u73b0\u76f8\u540c\u529f\u80fd\u7684\u524d\u63d0\u4e0b\uff0cnon-member non-friend funtion\u76f8\u6bd4member function\u6709\u66f4\u5927\u7684\u5c01\u88c5\u6027\uff0c\u5b83\u65e0\u6cd5\u8bbf\u95eeclass\u5185private\u90e8\u5206\uff0c\u6545\u524d\u8005\u4e5f\u66f4\u53d7\u8bbe\u8ba1\u8005\u6b22\u8fce\u3002 24\u3001\u82e5\u6240\u6709\u53c2\u6570\u7686\u987b\u7c7b\u578b\u8f6c\u6362\uff0c\u8bf7\u4e3a\u6b64\u91c7\u7528non-member function; \u2003\u5982\u679c\u9700\u8981\u4e3a\u67d0\u4e2a\u51fd\u6570\u7684\u6240\u6709\u53c2\u6570(\u5305\u62ecthis\u6307\u9488\u6240\u6307\u7684\u9690\u55bb\u53c2\u6570)\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff0c\u5219\u8fd9\u4e2a\u51fd\u6570\u6700\u597d\u662fnon-member function\u3002 25\u3001\u8003\u8651\u5199\u51fa\u4e00\u4e2a\u4e0d\u629b\u5f02\u5e38\u7684swap\u51fd\u6570 \u2003std\u63d0\u4f9b\u7684\u7f3a\u7701swap\u51fd\u6570\uff0c\u5728\u5904\u7406\u5305\u542b\u6307\u9488\u6210\u5458\u7684\u5bf9\u8c61\u65f6\uff0c\u8fd9\u79cd\u9ed8\u8ba4\u64cd\u4f5c\u5c06\u663e\u5f97\u5197\u4f59 \u2003\u5bf9\u4e8e\u5185\u542b\u6307\u9488\u6210\u5458\u7684\u7c7b\uff0c\u53ef\u4ee5\u5982\u4e0b\u5f62\u5f0f\uff0c\u8bbe\u8ba1swap\u51fd\u6570\u3002","title":"design and declarations"},{"location":"EffectiveCPP/rule/#implementation","text":"26\u3001\u5c3d\u53ef\u80fd\u5ef6\u540e\u53d8\u91cf\u5b9a\u4e49\u5f0f\u7684\u51fa\u73b0\u65f6\u95f4 \u2003\u5ef6\u540e\u53d8\u91cf\u7684\u5b9a\u4e49\uff0c\u76f4\u5230\u975e\u5f97\u4f7f\u7528\u53d8\u91cf\u7684\u524d\u4e00\u523b\u4e3a\u6b62\uff0c\u751a\u81f3\u8fdb\u4e00\u6b65\u5ef6\u8fdf\u5230\u8fd9\u4efd\u5b9a\u4e49\u80fd\u591f\u83b7\u5f97\u521d\u503c\u5b9e\u53c2\u4e3a\u6b62\uff1b\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86 \u907f\u514d\u6784\u9020\u548c\u6790\u6784\u975e\u5fc5\u8981\u5bf9\u8c61\uff0c\u8fd8\u53ef\u4ee5\u907f\u514d\u65e0\u610f\u4e49\u7684default\u6784\u9020\u884c\u4e3a \u3002 \u2003\u5bf9\u4e8e\u53ea\u5728\u5faa\u73af\u4f53\u5185\u4f7f\u7528\u7684\u53d8\u91cf\uff0c\u5982\u679c\u5176\u7c7b\u578b\u7684\u6784\u9020\u548c\u6790\u6784\u6210\u672c \u5927\u4e8e \u8d4b\u503c\u6210\u672c\uff0c\u5219\u5728\u5faa\u73af\u4f53\u5916\u5b9a\u4e49\uff0c\u53cd\u4e4b\u5728\u5faa\u73af\u5185\u5b9a\u4e49\u3002 27\u3001\u5c3d\u91cf\u5c11\u505a\u8f6c\u578b\u52a8\u4f5c 28\u3001\u907f\u514d\u8fd4\u56dehandles\u6307\u5411\u5bf9\u8c61\u5185\u90e8\u6210\u5206 \u2003\u907f\u514d\u8fd4\u56dehandles(\u5305\u62ecreference\u3001\u6307\u9488\u3001\u8fed\u4ee3\u5668)\u6307\u5411\u5bf9\u8c61\u5185\u90e8\uff0c\u56e0\u4e3a\u65e0\u8bba\u8fd9\u4e2ahandle\u662f\u5426\u6709const\uff0c\u4e5f\u4e0d\u8bba\u8fd4\u56de\u5176\u7684\u51fd\u6570\u662f\u5426\u4e3aconst\uff0c\u90fd\u6709\u53ef\u80fd \u9020\u6210handle\u6bd4\u5176\u6240\u6307\u5411\u5bf9\u8c61\u5bff\u547d\u66f4\u957f\u7684\u98ce\u9669 \uff0c\u4f8b\u5982\u6307\u5411\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u7684\u5185\u90e8\uff0c\u800chandle\u5374\u88ab\u4fdd\u5b58\u4e3a\u957f\u671f\u5bf9\u8c61\u3002 \u2003\u4e0d\u8fc7\u5bf9\u4e8e\u4e00\u4e9b\u91cd\u8f7doperator[]\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u901a\u8fc7\u8fd4\u56de\u5f15\u7528\uff0c\u6765\u76f4\u63a5\u4fee\u6539\u5176\u5185\u90e8\u5bf9\u8c61\uff1b\u9664\u6b64\u4e4b\u5916\uff0c\u5e94\u8c28\u614e\u8fd4\u56de\u6307\u5411\u5bf9\u8c61\u5185\u90e8\u7684handles\u3002 29\u3001\u4e3a\u5f02\u5e38\u5b89\u5168\u800c\u52aa\u529b\u662f\u503c\u5f97\u7684 \u5f53\u5f02\u5e38\u88ab\u629b\u51fa\u65f6\uff0c\u5f02\u5e38\u5b89\u5168\u51fd\u6570\u5373\u4f7f\u53d1\u751f\u5f02\u5e38\u4e5f\u4e0d\u4f1a\u6cc4\u6f0f\u4efb\u4f55\u8d44\u6e90\u6216\u5141\u8bb8\u4efb\u4f55\u6570\u636e\u8d25\u574f\uff0c\u8fd9\u6837\u7684\u51fd\u6570\u533a\u5206\u4e09\u79cd\u53ef\u80fd\u7684\u4fdd\u8bc1: \u57fa\u672c\u627f\u8bfa : \u5982\u679c\u5f02\u5e38\u88ab\u629b\u51fa\uff0c\u7a0b\u5e8f\u5185\u7684\u4efb\u4f55\u4e8b\u7269\u4ecd\u7136\u4fdd\u6301\u5728\u6709\u6548\u72b6\u6001\u4e0b\uff0c\u6ca1\u6709\u4efb\u4f55\u5bf9\u8c61\u6216\u8005\u6570\u636e\u7ed3\u6784\u4f1a\u56e0\u6b64\u800c\u8d25\u574f\uff1b\u4f46\u7a0b\u5e8f\u7684exact state\u4e0d\u53ef\u9884\u6599\u3002 \u5f3a\u70c8\u4fdd\u8bc1 \uff1a\u5982\u679c\u5f02\u5e38\u88ab\u629b\u51fa\uff0c\u7a0b\u5e8f\u72b6\u6001\u4e0d\u6539\u53d8\uff0c\u5373\u51fd\u6570\u6210\u529f\u5c31\u662f\u5b8c\u5168\u6210\u529f\uff1b\u51fd\u6570\u5931\u8d25\uff0c\u7a0b\u5e8f\u5c31\u56de\u590d\u5230\u8c03\u7528\u51fd\u6570\u4e4b\u524d\u7684\u72b6\u6001\u3002 \u2003\u901a\u5e38\u60c5\u51b5\uff0ccopy-and-swap\u7b56\u7565\u662f\u4e00\u79cd\u597d\u7684\u505a\u6cd5\uff1a\u4e3a\u6253\u7b97\u4fee\u6539\u7684\u5bf9\u8c61(\u539f\u4ef6)\u505a\u51fa\u4e00\u4efd\u526f\u672c\uff0c\u7136\u540e\u5728\u526f\u672c\u4e0a\u505a\u4e00\u5207\u4fee\u6539\u3002\u82e5\u4fee\u6539\u8fc7\u7a0b\u629b\u51fa\u5f02\u5e38\uff0c\u539f\u5bf9\u8c61\u4ecd\u4fdd\u6301\u672a\u6539\u53d8\u72b6\u6001\uff1b\u5f85\u6240\u6709\u4fee\u6539\u6210\u529f\u540e\uff0c\u518d\u5c06\u526f\u672c\u548c\u539f\u4ef6\u5728\u4e00\u4e2a\u4e0d\u629b\u51fa\u5f02\u5e38\u7684\u64cd\u4f5c\u4e2dswap\u3002 \u2003\u7531\u4e8e\u51fd\u6570\u63d0\u4f9b\u7684\u5f02\u5e38\u5b89\u5168\u4fdd\u8bc1\u53d6\u51b3\u4e8e\u5176\u6240\u8c03\u7528\u7684\u5404\u4e2a\u51fd\u6570\u4e2d\u5f02\u5e38\u5b89\u5168\u4fdd\u8bc1\u6700\u4f4e\u8005\uff0c\u56e0\u6b64\u5373\u4f7f\u91c7\u7528copy-and-swap\uff0c\u4f9d\u65e7\u65e0\u6cd5\u4fdd\u8bc1\u6574\u4e2a\u51fd\u6570\u6709\u5f3a\u70c8\u7684\u5f02\u5e38\u5b89\u5168\u6027\uff1b \u4e14\u505a\u51fa\u4e00\u4efd\u526f\u672c\u9700\u8981\u989d\u5916\u7684\u8017\u65f6\u548c\u7a7a\u95f4\u6d88\u8017\u3002 \u2003\u56e0\u6b64\u5f3a\u70c8\u4fdd\u8bc1\u5e76\u975e\u5bf9\u6240\u6709\u51fd\u6570\u90fd\u53ef\u5b9e\u73b0\u6216\u5177\u5907\u73b0\u5b9e\u610f\u4e49\u3002 nothrow \u4fdd\u8bc1 \uff1a\u627f\u8bfa\u7edd\u4e0d\u629b\u51fa\u5f02\u5e38\uff0c\u603b\u662f\u80fd\u5b8c\u6210\u5b83\u4eec\u539f\u5148\u627f\u8bfa\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u5185\u7f6e\u7c7b\u578b\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u63d0\u4f9bnothrow\u4fdd\u8bc1\u3002 30\u3001understanding the ins and outs of inlining 31\u3001\u5c06\u6587\u4ef6\u95f4\u7684\u7f16\u8bd1\u4f9d\u5b58\u5173\u7cfb\u964d\u81f3\u6700\u4f4e \u2003\u5982\u679cclass A\u7684\u5b9a\u4e49\u6587\u4ef6\u4e2d\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u5176\u4ed6\u7c7b\u578b\u7684\u5b9a\u4e49\u5f0f(\u901a\u8fc7include\u5b9e\u73b0)\uff0c\u5219\u5f53\u90a3\u4e9b\u7c7b\u578b\u53d1\u9001\u6539\u53d8\u65f6\uff0c\u5e76\u91cd\u65b0\u7f16\u8bd1\u65f6\uff0c\u6b64\u65f6\u6240\u6709\u5305\u542bA\u7684\u5b9a\u4e49\u5f0f\u7684\u6587\u4ef6\u90fd\u5c06\u91cd\u65b0\u7f16\u8bd1\uff0c\u8fd9\u5373\u662f\u8fde\u4e32\u7f16\u8bd1\u4f9d\u5b58\u5173\u7cfb\u3002 \u2003 \u5c3d\u91cf\u4ee5class\u58f0\u660e\u5f0f\u66ff\u6362class\u5b9a\u4e49\u5f0f \uff0c\u5e76\u4e14\u53ea\u4f9d\u9760class \u58f0\u660e\u5f0f\u5c31\u80fd\u5b9a\u4e49\u51fa\u6307\u5411\u8be5\u7c7b\u578b\u7684reference\u6216pointer; \u5982\u679c\u5b9a\u4e49\u67d0\u7c7b\u578b\u7684objects\uff0c\u5c31\u5fc5\u987b\u7528\u5230\u5176\u5b9a\u4e49\u5f0f\u3002\u4ee5\u58f0\u660e\u4f9d\u5b58\u6027\u4ee3\u66ff\u5b9a\u4e49\u4f9d\u5b58\u6027\uff0c\u53ef\u4ee5\u6539\u5584\u524d\u8ff0\u95ee\u9898\u3002 \u2003\u8fdb\u4e00\u6b65\u53ef\u4ee5\u4e3a\u58f0\u660e\u5f0f\u548c\u5b9a\u4e49\u5f0f\u63d0\u4f9b\u4e0d\u540c\u7684\u5934\u6587\u4ef6\uff1b\u5e76\u4e14\u901a\u8fc7handle class\u548cinterface class\u6765\u964d\u4f4e\u63a5\u53e3\u548c\u5b9e\u73b0\u95f4\u7684\u8026\u5408\uff0c\u4ece\u800c\u964d\u4f4e\u6587\u4ef6\u95f4\u7684\u7f16\u8bd1\u4f9d\u5b58\u6027\u3002 \u2003 handle class \u7684\u505a\u6cd5\u662f\uff1aA\u53ea\u63d0\u4f9b\u63a5\u53e3\uff0cB\u8d1f\u8d23\u5b9e\u73b0\u63a5\u53e3\uff0cA\u5305\u542b\u4e00\u4e2a\u6307\u5411B\u7c7b\u578b\u7684\u6307\u9488pImpl(pointer to implementation), \u901a\u8fc7pImpl\u6765\u8c03\u7528B\u4e2d\u5b9e\u73b0\u597d\u7684\u63a5\u53e3\uff1b\u8fd9\u6837A\u7684\u7528\u6237\u5c31\u4e0e\u5176\u5305\u542b\u7684\u989d\u5916\u7684classes\u7684\u5b9e\u73b0\u76f8\u5206\u79bb\uff0c\u90a3\u4e9bclasses\u7684\u4fee\u6539\u4e5f\u4e0d\u4f1a\u9700\u8981A\u7684\u5ba2\u6237\u7aef\u91cd\u65b0\u7f16\u8bd1\u3002 \u2003 interface class \u7684\u505a\u6cd5\u662f\uff1a\u4ee4A\u6210\u4e3a\u4e00\u79cd\u7279\u6b8a\u7684abstract class, \u53ea\u6709\u4e00\u4e2avirtual \u6790\u6784\u51fd\u6570\uff0c\u548c\u4e00\u7ec4\u7eaf\u865a\u51fd\u6570\uff0c\u7528\u4ee5\u63cf\u8ff0\u51fd\u6570\u63a5\u53e3\uff1b\u5e76\u4e14\u5bf9\u4e8e\u6d3e\u751f\u4f53\u7cfb\u5185\u5168\u90e8\u90fd\u76f8\u540c\u7684\u505a\u6cd5\uff0c\u53ef\u4ee5\u8ba9\u5176\u6210\u4e3ainterface class\u4e2dnon-virtual\u51fd\u6570\uff0c\u6d3e\u751f\u7c7b\u5171\u540c\u4f7f\u7528\u8fd9\u4e00\u4efd\u51fd\u6570\u3002 \u2003\u4e0a\u8ff0\u505a\u6cd5\u7684\u7f3a\u70b9\uff0c\u5373\u4e3a\u6bcf\u4e00\u6b21\u8bbf\u95ee\u589e\u52a0\u4e86\u4e00\u5c42\u95f4\u63a5\u6027\uff0c\u5982\u901a\u8fc7pImpl\u6216\u8005\u865a\u51fd\u6570\u8868\uff0c\u8fd9\u90fd\u4f1a\u5e26\u6765\u989d\u5916\u7684\u5f00\u9500\uff0c\u540c\u65f6pImpl\u662f\u901a\u8fc7\u52a8\u6001\u5206\u914d\u5f97\u5230\u7684\uff0c\u9700\u8981\u8003\u8651bad_alloc\u5f02\u5e38\u7684\u53ef\u80fd\u6027\u3002 32\u3001make sure public inheritance model \"is-a\" \u2003public\u7ee7\u627f \u4e3b\u5f20\u80fd\u591f\u65bd\u884c\u4e8ebase class\u5bf9\u8c61\u8eab\u4e0a\u7684\u6bcf\u4ef6\u4e8b\u60c5\uff0c\u4e5f\u53ef\u4ee5\u65bd\u884c\u4e8ederived class\u5bf9\u8c61\u8eab\u4e0a\uff1b\u8ba9\u7c7bA\u4ee5pulic inherit\u5f62\u5f0f\u7ee7\u627f\u7c7bB\uff0c\u9700\u8981\u786e\u4fdd A \u201cis a\u201d B, \u4e14\u5bf9\u4e8eB\u5bf9\u8c61\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u80fd\u65bd\u52a0\u5230A\u5bf9\u8c61\u4e0a\u3002 33\u3001\u907f\u514dhiding\u7ee7\u627f\u800c\u6765\u7684name \u2003\u53ef\u53c2\u8003c_base\u4e2d\u7684\u91cd\u8f7d/\u8986\u76d6/\u9690\u85cf/using\u3002 34\u3001\u533a\u5206\u63a5\u53e3\u7ee7\u627f\u548c\u5b9e\u73b0\u7ee7\u627f \u2003\u58f0\u660e\u4e00\u4e2apure virtual function\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9derived class\u53ea\u7ee7\u627f\u51fd\u6570\u63a5\u53e3\uff1b\u4e00\u822c\u60c5\u51b5\u4e0b\u57fa\u7c7b\u4e2d\u7eaf\u865a\u4e0d\u9700\u8981\u5b9a\u4e49\uff0c\u4f46\u5176\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u5b9a\u4e49\uff0c\u4f5c\u4e3a\u7f3a\u7701\u5b9e\u73b0\uff1b\u6b64\u65f6\u6d3e\u751f\u7c7b\u5982\u679c\u8986\u76d6\u8fd9\u4e2a\u7eaf\u865a\u51fd\u6570\uff0c\u53ef\u4ee5\u63d0\u4f9b\u81ea\u5df1\u7684\u5b9e\u73b0\uff0c\u6216\u8005\u901a\u8fc7Base::fun(args)\u5f62\u5f0f\u76f4\u63a5\u8c03\u7528\u7eaf\u865a\u51fd\u6570\u7684\u5b9e\u73b0\uff1b\u5982\u679c\u6d3e\u751f\u7c7b\u4e0d\u63d0\u4f9bfun\u7684\u5b9e\u73b0\uff0c\u5219\u4e0d\u4f1a\u901a\u8fc7\u7f16\u8bd1\uff0c\u56e0\u4e3afun\u4e3a\u4e00\u4e2apure virtual function\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u907f\u514d\u5982\u679cfcn\u662f\u666e\u901a\u865a\u51fd\u6570\uff0c\u4f46\u4e0d\u540c\u7684\u6d3e\u751f\u7c7b\u8981\u6c42\u7684\u7f3a\u7701\u5b9e\u73b0\u4e0d\u540c\uff0c\u6240\u4ee5\u5982\u679c\u6d3e\u751f\u7c7b\u60f3\u8981\u57fa\u7c7b\u4e2d\u7684\u7f3a\u7701\u5b9e\u73b0\uff0c\u5fc5\u987b\u4e3b\u52a8\u63d0\u51fa\uff0c\u5426\u5219\u5c31\u91cd\u65b0\u5b9e\u73b0\u3002 \u2003\u58f0\u660e\u4e00\u4e2a\u666e\u901a\u865a\u51fd\u6570\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9derived class\u7ee7\u627f\u51fd\u6570\u7684\u63a5\u53e3\u548c\u7f3a\u7701\u5b9e\u73b0\u3002 \u2003\u58f0\u660e\u4e00\u4e2a\u666e\u901a\u975e\u865a\u51fd\u6570\uff0c\u610f\u5473\u7740derived class\u4e2d\u7ee7\u627f\u51fd\u6570\u7684\u63a5\u53e3\uff0c\u540c\u65f6\u63d0\u4f9b\u4e00\u4efd\u5f3a\u5236\u7684\u5b9e\u73b0\uff0c\u5373\u671f\u671b\u4e0d\u540c\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\u6709\u76f8\u540c\u7684\u884c\u4e3a\uff1b\u5982\u679c\u6d3e\u751f\u7c7b\u4e2d\u91cd\u65b0\u58f0\u660e\u4e86\u4e00\u4e2a\u4e0e\u6b64\u540c\u540d\u7684\u51fd\u6570\uff0c\u5219\u65e0\u8bba\u53c2\u6570\u662f\u5426\u76f8\u540c\uff0c\u57fa\u7c7b\u4e2d\u7684\u7248\u672c\u90fd\u5c06\u88ab\u9690\u85cf\u3002 35\u3001\u8003\u8651\u865a\u51fd\u6570\u4ee5\u5916\u7684\u5176\u4ed6\u9009\u62e9 36\u3001\u7edd\u4e0d\u91cd\u65b0\u5b9a\u4e49\u7ee7\u627f\u800c\u6765\u7684non-virtual\u51fd\u6570 \u2003\u5982\u679c\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\uff0c\u5219\u5c06\u8be5\u51fd\u6570\u58f0\u660e\u4e3avirtual function\u3002 37\u3001\u7edd\u4e0d\u91cd\u65b0\u5b9a\u4e49\u7ee7\u627f\u800c\u6765\u7684\u7f3a\u7701\u53c2\u6570\u503c \u56e0\u4e3a\u7f3a\u7701\u53c2\u6570\u503c\u90fd\u662f\u9759\u6001\u7ed1\u5b9a\uff0c\u5728\u4f7f\u7528\u591a\u6001\u65f6(\u6307\u901a\u8fc7pointer\u6216reference\u6765\u8bbf\u95ee\u6d3e\u751f\u7c7b\u5bf9\u8c61)\uff0c\u91cd\u65b0\u5b9a\u4e49\u7ee7\u627f\u800c\u6765\u7684\u865a\u51fd\u6570\u4e2d\u7684\u7f3a\u7701\u53c2\u6570\uff0c\u901a\u5e38\u4e0d\u4f1a\u6709\u5982\u671f\u884c\u4e3a\u53d1\u751f\uff0c\u5b9e\u9645\u4f7f\u7528\u7684\u4f9d\u65e7\u662f\u57fa\u7c7b\u63d0\u4f9b\u7684\u7f3a\u7701\u53c2\u6570\u503c\u3002 38\u3001 Model \"has-a\" or \"is-implemented-in-terms-of\" through composition \u2003\u590d\u5408(composition) \u662f\u7c7b\u578b\u4e4b\u95f4\u7684\u4e00\u79cd\u5173\u7cfb\uff0c\u5f53\u67d0\u79cd\u7c7b\u578b\u7684\u5bf9\u8c61\u5305\u542b\u5176\u4ed6\u79cd\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4fbf\u662f\u8fd9\u79cd\u5173\u7cfb\u3002 39\u3001\u8c28\u614e\u4f7f\u7528private \u7ee7\u627f private \u7ee7\u627f\u610f\u5473\u7740implemented-in-terms-of(\u6839\u636e\u67d0\u7269\u5b9e\u73b0\u51fa)\uff0c\u5373\u6d3e\u751f\u7c7b\u4e0e\u57fa\u7c7b\u5e76\u4e0d\u5b58\u5728is-a\u7684\u5173\u7cfb\u3002 \u2003\u5f53\u4f60\u9762\u5bf9\u5e76\u4e0d\u5b58\u5728is-a\u5173\u7cfb\u7684\u4e24\u4e2aclasses\uff0c\u5176\u4e2d\u4e00\u4e2a\u9700\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2aprotected\u6210\u5458\uff0c\u6216\u8005\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\u5176\u4e00\u6216\u591a\u4e2avirtual\u51fd\u6570\uff0c\u53ef\u4ee5\u8003\u8651private\u7ee7\u627f\u3002 40\u3001\u8c28\u614e\u4f7f\u7528\u591a\u91cd\u7ee7\u627f","title":"implementation"},{"location":"EffectiveCPP/rule/#templates-and-generic-programming","text":"41\u3001\u4e86\u89e3\u9690\u5f0f\u63a5\u53e3\u548c\u7f16\u8bd1\u671f\u591a\u6001 \u2003\u7f16\u8bd1\u5668\u591a\u6001\uff1a\u4ee5\u4e0d\u540c\u7684template\u53c2\u6570\u5177\u73b0\u5316function templates \u4f1a\u5bfc\u81f4\u8c03\u7528\u4e0d\u540c\u7684\u51fd\u6570\uff0c\u548c\u91cd\u8f7d\u7c7b\u4f3c\uff0c\u90fd\u662f\u7f16\u8bd1\u5668\u7ed1\u5b9a\uff1b \u2003\u8fd0\u884c\u671f\u591a\u6001: \u8fd0\u884c\u671f\u6839\u636e\u53c2\u6570\u7684\u52a8\u6001\u7c7b\u578b\u51b3\u5b9a\u52a8\u6001\u7ed1\u5b9a\u54ea\u4e00\u4e2a\u865a\u51fd\u6570\u3002 42\u3001understand the two meanings of typename 43\u3001\u5b66\u4e60\u5904\u7406\u6a21\u677f\u5316\u57fa\u7c7b\u5185\u7684\u540d\u79f0 \u5bf9\u4e8e\u4e00\u4e2a\u7ee7\u627ftemplatized base class\u7684\u6d3e\u751f\u6a21\u677f\u7c7b\uff0c\u5982\u679c\u76f4\u63a5\u5728\u5176\u5185\u90e8\u8c03\u7528\u57fa\u7c7b\u4e2d\u7684public \u6210\u5458\u51fd\u6570\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7\u7f16\u8bd1\uff1b \u56e0\u4e3a\u7f16\u8bd1\u5668\u77e5\u9053base class template\u6709\u53ef\u80fd\u4f1a\u88ab\u7279\u5316\uff0c\u800c\u7279\u5316\u7248\u672c\u53ef\u80fd\u4e0d\u63d0\u4f9b\u548c\u4e00\u822c\u6027template\u76f8\u540c\u7684\u63a5\u53e3\u3002\u56e0\u6b64\u5b83\u62d2\u7edd\u5728templatized base class\u5185\u5bfb\u627e\u7ee7\u627f\u800c\u6765\u7684\u540d\u79f0\u3002 \u2003\u53ef\u5728derived class templates\u901a\u8fc7 this-> \u6307\u6d89base class templates\u5185\u7684\u6210\u5458\u540d\u79f0\uff0c\u6216\u4f7f\u7528using \u58f0\u660e\u5f0f\uff1b\u6216\u660e\u767d\u6307\u51fa\u88ab\u8c03\u7528\u7684\u51fd\u6570\u4f4d\u4e8ebase class\u5185\u3002 \u2003\u5982\u679c\u63d0\u4f9b\u4e00\u4e2a\u6ca1\u6709sendClear\u63a5\u53e3\u7684\u7279\u5316\u7248\u672c\uff0c\u5c06\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\u3002 template<typename company> class LoggingMsgSender:: public MsgSender<company>{ public: using MsgSender<company>::sendClear; //\u660e\u786e\u544a\u8bc9\u7f16\u8bd1\u5668\u51fd\u6570\u4f4d\u4e8ebase class\u5185 void sendClearMsg(const MsgInfo& info){ ... this->sendClear(info); //\u5047\u8bbesendClear\u88ab\u7ee7\u627f // MsgSender::sendClear(info); //\u8fd9\u79cd\u60c5\u51b5\u4f1a\u7834\u574fvirtual\u7ed1\u5b9a\u884c\u4e3a ... } } 44\u3001\u5c06\u4e0e\u53c2\u6570\u65e0\u5173\u7684\u4ee3\u7801\u5265\u79bbtemplates 45\u3001\u8fd0\u7528\u6210\u5458\u51fd\u6570\u6a21\u677f\u63a5\u53d7\u6240\u6709\u517c\u5bb9\u7c7b\u578b \u2003\u4e00\u4e2atemplate class\u63a5\u53d7\u4e0d\u540c\u7c7b\u578b\u53c2\u6570\u5f97\u5230\u7684\u5b9e\u4f8b\u4e4b\u95f4\u5e76\u4e0d\u5b58\u5728\u56fa\u6709\u5173\u7cfb\uff0c\u5373\u4f7f\u8fd9\u4e9b\u7c7b\u578b\u4e4b\u95f4\u672c\u8eab\u5b58\u5728\u7ee7\u627f\u5173\u7cfb\u3002 \u2003\u6784\u9020\u6a21\u677f: \u2003\u5bf9\u6784\u9020\u6a21\u677f\u65bd\u52a0\u7ea6\u675f: \u2003\u6210\u5458\u51fd\u6570\u6a21\u677f: 46\u3001\u9700\u8981\u7c7b\u578b\u8f6c\u6362\u65f6\u8bf7\u4e3a\u6a21\u677f\u5b9a\u4e49\u975e\u6210\u5458\u51fd\u6570 \u2003\u4e3a\u4e86\u8ba9\u7c7b\u578b\u8f6c\u6362\u53ef\u80fd\u53d1\u751f\u4e8e\u6240\u6709\u5b9e\u53c2\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2anon-member\u51fd\u6570(\u6761\u6b3e24); \u4e3a\u4e86\u4ee4\u8fd9\u4e2a\u51fd\u6570\u88ab\u81ea\u52a8\u5177\u73b0\u5316\uff0c\u6211\u4eec\u9700\u8981\u5c06\u5b83\u58f0\u660e\u5728class\u5185\u90e8\uff0c\u5373\u4ee4\u5b83\u6210\u4e3a\u4e00\u4e2afriend\u51fd\u6570\u3002 \u2003\u5982\u679c\u8fd9\u4e2anon-member\u51fd\u6570\u5b9a\u4e49\u5728class\u5916\u90e8\uff0c\u5219\u5bf9\u4e8e\u53ef\u80fd\u53d1\u751f\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff0c\u8c03\u7528\u76f8\u5173\u51fd\u6570\u5e76\u4e0d\u80fd\u6210\u529f\uff1b\u56e0\u4e3atemplate\u5b9e\u53c2\u63a8\u5bfc\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u4f1a\u8003\u8651\u9690\u5f0f\u8f6c\u6362\uff1b\u6240\u4ee5\u4f20\u9012\u7ed9\u51fd\u6570\u7684\u5b9e\u53c2\u53d1\u751f\u9690\u5f0f\u8f6c\u6362\uff0c\u7f16\u8bd1\u5668\u5e76\u4e0d\u80fd\u51c6\u786e\u77e5\u9053\u5e94\u8be5\u5177\u73b0\u5316\u54ea\u4e2a\u51fd\u6570\u3002 47\u3001\u4f7f\u7528traits classes\u8868\u73b0\u7c7b\u578b\u4fe1\u606f \u2003 typedef typename iterator_traits ::value_type valType; 48\u3001\u8ba4\u8bc6\u6a21\u677f\u5143\u7f16\u7a0b","title":"templates and generic programming"},{"location":"EffectiveCPP/rule/#customizing-new-and-delete","text":"49\u3001undertand the behavior of the new handler \u5f53operator new\u629b\u51fa\u5f02\u5e38\u4ee5\u53cd\u6620\u4e00\u4e2a\u672a\u83b7\u6ee1\u8db3\u7684\u5185\u5b58\u9700\u6c42\u4e4b\u524d\uff0c\u5b83\u4f1a\u5148\u8c03\u7528\u4e00\u4e2a\u5ba2\u6237\u6307\u5b9a\u7684\u9519\u8bef\u5904\u7406\u51fd\u6570\uff0c\u5373\u4e00\u4e2anew-handler\u3002 \u4e00\u4e2a\u8bbe\u8ba1\u826f\u597d\u7684handler\u5fc5\u987b\u5305\u542b: \u8ba9\u66f4\u591a\u5185\u5b58\u53ef\u7528\u3001\u5b89\u88c5\u53e6\u4e00\u4e2anew-handler(\u65e0\u9650\u5faa\u73af)\u3001\u5378\u8f7dnew-handler(\u5c06null\u6307\u9488\u4f20\u7ed9set_new_handler)\u3001\u629b\u51fabad_alloc\u5f02\u5e38\u3001\u4e0d\u8fd4\u56de(\u8c03\u7528abort\u6216exit). 50\u3001\u4e86\u89e3new\u548cdelete\u7684\u5408\u7406\u66ff\u6362\u65f6\u95f4 51\u3001\u7f16\u5199new\u548cdelete\u65f6\u9700\u56fa\u5b88\u5e38\u89c4 52\u3001write placement delete if you write placement new","title":"customizing new and delete"},{"location":"EffectiveCPP/rule/#_2","text":"53\u3001 \u4e0d\u7528\u5ffd\u7565\u7f16\u8bd1\u5668\u7684\u8b66\u544a 54\u3001\u719f\u6089\u5305\u62ecTR1\u5728\u5185\u7684\u6807\u51c6\u7a0b\u5e8f\u5e93 55\u3001\u719f\u6089Boost","title":"\u8865\u5145"},{"location":"MySQL/0_start/","text":"\u6570\u636e\u5e93\u5165\u95e8 \u57fa\u7840\u6982\u5ff5 \u6570\u636e\u7c7b\u578b: \u6bcf\u4e2a\u8868\u5217\u90fd\u6709\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5141\u8bb8\u8be5\u5217\u4e2d\u53ef\u4ee5\u5b58\u50a8\u7684\u6570\u636e\u3002 \u4e3b\u952e(primary key): \u4e00\u5217\u6216\u4e00\u7ec4\u5217\uff0c\u5176\u503c(\u4f7f\u7528\u591a\u5217\uff0c\u5219\u8981\u6c42\u5b83\u4eec\u7684\u7ec4\u5408\u503c)\u80fd\u552f\u4e00\u533a\u5206\u8868\u4e2d\u6bcf\u4e00\u4e2a\u884c\u3002 \u2003\u4efb\u610f\u4e24\u884c\u90fd\u4e0d\u5177\u6709\u76f8\u540c\u7684\u4e3b\u952e\u503c\u3002 \u2003\u6bcf\u4e2a\u884c\u90fd\u5fc5\u987b\u6709\u4e00\u4e2a\u4e3b\u952e\u503c(\u4e3b\u952e\u5217\u4e0d\u5141\u8bb8\u4e3aNULL\u503c)\u3002 NULL: \u521b\u5efa\u8868\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a\u5176\u4e2d\u7684\u5217\u662f\u5426\u53ef\u4ee5\u4e0d\u542b\u503c\uff0c\u5982\u679c\u4e0d\u542b\u503c\uff0c\u79f0\u5176\u4e3a\u5305\u542b\u7a7a\u503cNULL\u3002 \u5916\u952e(foreign key): \u4ee5A\u8868\u4e2d\u7684col\u5217\u5173\u8054B\u8868\u4e2d\u7684col\u5217\uff0c\u8981\u6c42B\u4e2dcol\u5217\u5177\u6709\u552f\u4e00\u6027\u7ea6\u675f\uff0c\u4e00\u822c\u4e3a\u5176\u4e3b\u952e\uff1b\u65bd\u52a0\u7ea6\u675f\u540e\uff0cB\u8868\u79f0\u4e3a\u4e3b\u8868\uff0cA\u8868\u79f0\u4e3a\u5916\u952e\u8868\uff1a \u5916\u952e\u5b57\u6bb5\u5728\u521b\u5efa\u7684\u65f6\u5019\u5c31\u5e94\u8be5\u4e0e\u4e3b\u8868\u7684\u7c7b\u578b\u5b8c\u5168\u4e00\u81f4(\u957f\u5ea6\u554a\u7b49)\uff0c\u5426\u5219\u521b\u5efa\u5916\u952e\u4f1a\u62a5\u9519 \u5916\u952e\u8868\u662f\u4e0d\u80fd\u63d2\u5165\u4e3b\u8868\u4e0d\u5b58\u5728\u7684\u6570\u636e \u5916\u952e\u8868\u4e0d\u80fd\u5220\u9664\u5df2\u7ecf\u5173\u8054\u4e0a\u7684\u4e3b\u8868\u6570\u636e \u5e38\u7528\u547d\u4ee4 show use xx_database; # help show; \u67e5\u770b\u6240\u6709show show databases; show tables from db_name; show columns from tbl_name; describe xx_table; # \u662f\u4e0a\u9762\u4e00\u53e5\u7684\u5feb\u6377\u547d\u4ee4 show status; # \u663e\u793a\u670d\u52a1\u5668\u72b6\u6001\u4fe1\u606f show variables; # \u67e5\u770b\u5f53\u524dmysql\u914d\u7f6e show create database/table db_name/tbl_name; # \u663e\u793a\u521b\u5efa\u7279\u5b9a\u6570\u636e\u5e93/\u8868\u7684mysql\u8bed\u53e5 show errors; show warnings; \u68c0\u7d22\u8bed\u53e5 select col_name from tbl_name; select col_name1, col_name2 from tbl_name; SELECT DISTINCT col_name FROM tbl_name; # \u8fd4\u56de\u4e0d\u540c\u7684col_name\u884c(\u53bb\u91cd)\u3002distinct\u4f1a\u4fee\u9970\u5176\u540e\u6240\u6709\u7684\u5217 SELECT col_name FROM tbl_name LIMIT 5; # \u8fd4\u56de\u7684\u884c\u4e0d\u591a\u4e8e5\u884c SELECT col_name FROM tbl_name LIMIT 1, 6; # \u8fd4\u56de\u4ece\u7b2c\u4e00\u884c\u5f00\u59cb\u76846\u884c SELECT col_name FROM tbl_name LIMIT 6 OFFSET 1; # \u4eceMysql 5 \u5f00\u59cb\uff0c\u652f\u6301\u4e0a\u4e00\u53e5\u7684\u66ff\u4ee3\u65b9\u6cd5 SELECT tbl_name.col_name FROM db_name.tbl_name; # \u5b8c\u5168\u9650\u5b9a\u8868\u540d\u548c\u5217\u540d \u6392\u5e8f\u6570\u636e SELECT col_name FROM tbl_name ORDER BY col_name; # \u4e5f\u53ef\u4f7f\u7528\u5176\u4ed6\u5217\u8fdb\u884c\u6392\u5e8f SELECT col_name, .. FROM tbl_name ORDER BY col_name1, col_name2, ..; # \u6309\u591a\u4e2a\u5217\u6392\u5e8f\uff0c\u4e14\u6309\u7167\u5217\u51fa\u7684\u5217\u987a\u5e8f # \u9ed8\u8ba4\u662f\u5347\u5e8f\u6392\u5e8f\uff0c\u8fd9\u91cc\u6307\u5b9a\u964d\u5e8f\u6392\u5e8f\u3002DESC\u53ea\u4fee\u9970\u5176\u524d\u7684\u5217\uff0c\u5bf9\u4e8e\u540e\u9762\u7684\u5217\u4efb\u6309\u7167\u5347\u5e8f\u6392\u5e8f SELECT col_name FORM tbl_name ORDER BY col_name DESC; \u8fc7\u6ee4\u6570\u636e SELECT col_name, .. FROM tbl_name WHERE col_name=xx; # where\u5e94\u8be5\u5728order by\u4e4b\u524d # where\u5b50\u53e5\u64cd\u4f5c\u7b26\u5305\u62ec =\u3001<\u3001<=\u3001>\u3001>=\uff0c<>\u548c!=\u90fd\u662f\u4e0d\u7b49\u4e8e # \u4ee5\u53cabetween SELECT prod_name, prod_price FROM products WHERE prod_price BETWEEN 10 AND 20; SELECT col_name FROM tbl_name WHERE col_name IS NULL; # \u68c0\u7d22col_name\u503c\u4e3aNULL\u7684\u884c # AND\u3001OR \u64cd\u4f5c\u7b26\u53ef\u4ee5\u7528\u6765\u7ec4\u5408\u591a\u4e2a\u5b50\u53e5\uff0c\u4e14AND\u7684\u8ba1\u7b97\u6b21\u5e8f\u66f4\u9ad8\uff0c\u53ef\u4ee5\u901a\u8fc7()\u6765\u660e\u786e\u5206\u7ec4\u76f8\u5e94\u7684\u64cd\u4f5c\u7b26 SELECT prod_id FROM products HWERE vend_id = 1000 AND prod_price<100; # IN \u64cd\u4f5c\u7b26\uff0c\u5bf9\u4e8e()\u5185\u7684\u6bcf\u4e2a\u6761\u4ef6\u90fd\u8fdb\u884c\u5339\u914d SELECT col_name FROM tbl_name WHERE col_name2 IN (x, xx, xxx); # NOT \u64cd\u4f5c\u7b26\u7528\u6765\u5426\u5b9a\u540e\u8ddf\u6761\u4ef6\uff0c MySQL\u652f\u6301\u4f7f\u7528NOT\u5bf9 IN\u3001BETWEEN \u548c EXISTS \u5b50\u53e5\u53d6\u53cd SELECT col_name FROM tbl_name WHERE col_name2 NOT IN (x, xx, xxx); \u901a\u914d\u7b26 \u4e3a\u5728\u641c\u7d22\u5b50\u53e5\u4e2d\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u5fc5\u987b\u4f7f\u7528LIKE\u64cd\u4f5c\u7b26\uff0c\u5176\u6307\u793aMySQL\u540e\u8ddf\u7684\u641c\u7d22\u6a21\u5f0f\u5229\u7528\u901a\u914d\u7b26\u5339\u914d\u800c\u4e0d\u662f\u76f4\u63a5\u76f8\u7b49\u5339\u914d\u8fdb\u884c\u6bd4\u8f83\u3002 # %\uff0c \u8868\u793a\u4efb\u4f55\u5b57\u7b26\u51fa\u73b0\u4efb\u4f55\u6b21\u6570, \u8fd9\u662f\u641c\u7d22\u4efb\u610f\u4ee5'jet'\u5f00\u5934\u7684\u8bcd\uff0c\u4e14\u662f\u533a\u5206\u5927\u5c0f\u5199\u7684\uff0c\u5373'JET'\u4e0d\u5339\u914d # LIKE '%' \u5e76\u4e0d\u80fd\u7528\u6765\u5339\u914d\u5176\u503c\u4e3aNULL\u7684\u884c SELECT prod_id, prod_name FROM prodcuts WHERE prod_name LIKE 'jet%'; # _\uff0c \u8868\u793a\u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26 \u6b63\u5219\u8868\u8fbe\u5f0f\u641c\u7d22 \u4f7f\u7528REGEXP\u64cd\u4f5c\u7b26\uff0c\u6307\u660e\u5176\u540e\u7684\u6a21\u5f0f\u4f5c\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u5904\u7406 SELECT col_name, .. FROM tbl_name WHERE col_name2 REGEXP 'XX'; # LIKE \u4f1a\u5339\u914d\u6574\u4e2a\u5217\uff1b\u800cREGEXP\u5728\u5217\u503c\u5185\u8fdb\u884c\u5339\u914d\uff0c\u5982\u679c\u88ab\u5339\u914d\u7684\u6587\u672c\u51fa\u73b0\u5728\u5217\u503c\u4e2d\uff0c\u4e14\u8fd8\u5305\u542b\u5176\u4ed6\u6587\u672c # \u5728\u4e0d\u4f7f\u7528\u901a\u914d\u7b26\u60c5\u51b5\u4e0b\uff0cLIKE\u662f\u65e0\u6cd5\u5339\u914d\u7684\uff0c\u800cREGEXP\u662f\u53ef\u4ee5\u8fd4\u56de\u5339\u914d\u7ed3\u679c\u7684 SELECT prod_name FROM products WHERE prod_name LIKE/REGEXP '1000'; # \u4e14\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u9664\u975e\u662f\u6709BINARY \u5173\u952e\u5b57 SELECT prod_name FROM producys WHERE prod_name REGEXP BINARY 'JET'; . \u8868\u793a\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff1b | \u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u7684or\u64cd\u4f5c\u7b26\uff0c\u8868\u793a\u5339\u914d\u5176\u4e2d\u4e4b\u4e00\uff0c\u201c100|200|300\u201d\uff1b [] \u5339\u914d\u5176\u4e2d\u5b57\u7b26\u4e4b\u4e00\uff0c\u201c[123] tom\u201d \u8868\u793a\u5339\u914d \u201c1 tom\u201d \u6216 \u201c2 tom\u201d \u6216 \u201c3 tom\u201d\uff1b [0-9] \u5339\u914d0\u52309\u4e2d\u7684\u4e00\u4e2a\u6570\u5b57\uff0c[a-z]\u5339\u914da\u5230z\u4e2d\u7684\u4e00\u4e2a\u5b57\u7b26\uff1b \\\\ \u8f6c\u4e49\uff0c\u7528\u6765\u5339\u914d\u7279\u6b8a\u5b57\u7b26 \u5b9a\u4f4d\u5143\u5b57\u7b26\uff1a ^ \u6587\u672c\u7684\u5f00\u59cb $ \u6587\u672c\u7684\u7ed3\u5c3e [[: < :]] \u8bcd\u7684\u5f00\u59cb [[:>:]] \u8bcd\u7684\u7ed3\u5c3e eg. \"\\\\([0-9] sticks?\\\\)\": \u5339\u914d\u5305\u542b\u5f62\u5982 \"(1 stick)\" \u6216\u8005 \"(2 stciks)\"\u6587\u672c\u7684\u5217\u503c \"[[:digit:]]{4}\"\uff1a\u5339\u914d\u8fde\u5728\u4e00\u8d77\u7684\u4efb\u610f4\u4f4d\u6570\u5b57 \"^[0-9\\\\.]\"\uff1a\u5339\u914d\u4ee5\u6570\u5b57\u6216\u5c0f\u6570\u70b9\u5f00\u59cb\u7684\u6587\u672c \u8ba1\u7b97\u5b57\u6bb5 \u8fd0\u884c\u65f6\u5728SELECT\u8bed\u53e5\u5185\u521b\u5efa \uff0c\u4f8b\u5982\u5d4c\u5957\u5b50\u67e5\u8be2\u6216\u8005\u901a\u8fc7\u7ec4\u5408\u5b57\u6bb5(\u5373 column)\u6765\u683c\u5f0f\u5316\u68c0\u7d22\u8f93\u51fa\u7ed3\u679c Concat()\u62fc\u63a5\u5b50\u4e32 \u5220\u9664\u7a7a\u683c\uff0cRTrim()\u53bb\u9664\u4e32\u53f3\u4fa7\u7a7a\u683c\uff0cLTrim()\u53bb\u9664\u4e32\u53f3\u4fa7\u7a7a\u683c\uff0cTrim()\u53bb\u9664\u4e24\u4fa7\u7a7a\u683c AS\uff0c\u53ef\u4ee5\u4e3aConcat()\u5f97\u5230\u7684\u7ed3\u679c\u521b\u5efa\u4e00\u4e2a\u5217\u522b\u540d\uff0c\u65b9\u4fbf\u5ba2\u6237\u673a\u4f7f\u7528 \u53ef\u4ee5\u5728\u8ba1\u7b97\u5b57\u6bb5\u4e2d\u6307\u5411\u7b97\u672f\u8ba1\u7b97 SELECT Concat(Rtrim(vend_name), '(', RTrim(vend_country), ')') AS vend_title FROM vendors; SELECT quantity*item_price AS expanded_price FROM orderitems; \u6570\u636e\u5904\u7406\u51fd\u6570 \u6587\u672c\u5904\u7406\u51fd\u6570: Trim(), Upper(), Lower(), Soundex()\u7b49\uff1b\u5176\u4e2dSoundex\u53ef\u4ee5\u5c06\u6587\u672c\u4e32\u8f6c\u4e3a\u63cf\u8ff0\u5176\u8bed\u97f3\u8868\u793a\u7684\u5b57\u6bcd\u6570\u5b57\u6a21\u5f0f\u7684\u7b97\u6cd5\uff0c\u8003\u8651\u4e86\u7c7b\u4f3c\u7684\u53d1\u97f3\u5b57\u7b26\u548c\u97f3\u8282\uff0c\u4f7f\u5f97\u5bf9\u4e32\u8fdb\u884c\u53d1\u97f3\u6bd4\u8f83\u800c\u4e0d\u662f\u5b57\u7b26\u6bd4\u8f83\u3002 # \u5339\u914d\u6240\u6709\u53d1\u97f3\u7c7b\u4f3c\u2018Lee\u2019\u7684cust_name SELECT cust_name, cust_contact FROM customers WHERE Soundex(cust_name)=Soundex('Lee') \u65e5\u671f\u548c\u65f6\u95f4\u5904\u7406\u51fd\u6570 MySQL\u4f7f\u7528\u7684\u9ed8\u8ba4\u65e5\u671f\u683c\u5f0f\u4e3ayyyy-mm-dd, datetime\u7c7b\u578b\u9664\u4e86\u65e5\u671f\u8fd8\u5305\u62ec\u65f6\u95f4\u503c\uff0chh-mm-ss # \u68c0\u7d222005\u5e749\u6708\u6240\u6709\u8ba2\u5355 SELECT cust_id, order_num FROM orders WHERE DATE(order_date) BETWEEN '2005-09-01' AND '2005-09-30'; SELECT cust_id, order_num FROM orders WHERE Year(order_data)=2005 AND Month(order_date)=9; \u6570\u503c\u5904\u7406\u51fd\u6570 \u4ec5\u7528\u6765\u5904\u7406\u6570\u503c\u6570\u636e\uff0c\u7528\u4e8e\u4ee3\u6570\u3001\u4e09\u89d2\u51fd\u6570\u8ba1\u7b97\u3002\u5982Abs()\u3001Cos()\u3001Sin()\u3001Pi()\u3001Rand()\u3001Mod()\u3001Sqrt()\u3001Exp(). \u805a\u96c6\u51fd\u6570 \u7528\u4e8e\u5bf9\u8868\u4e2d\u6570\u636e\u8fdb\u884c\u6c47\u603b\uff0c\u4f46\u65e0\u9700\u8fd4\u56de\u5b9e\u9645\u8868\u9879\u6570\u636e\uff0c\u5982\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\u6570\uff0c\u8868\u5217\u7684\u6700\u5927/\u5c0f\u503c\u7b49\u3002 # AVG\u53ea\u80fd\u7528\u4e8e\u5355\u4e2a\u5217\uff0c\u4e3a\u83b7\u5f97\u591a\u4e2a\u5217\uff0c\u5fc5\u987b\u4f7f\u7528\u591a\u4e2aAVG\u51fd\u6570 SELECT AVG(prod_price) AS avg_price WHERE vend_id=100; # COUNT(*) \u7edf\u8ba1\u8868\u4e2d\u884c\u7684\u6570\u76ee\uff0c\u5373\u4f7f\u5217\u503c\u4e3aNULL\uff0c\u800cCOUNT(column)\u5bf9\u7279\u5b9a\u5217\u4e2d\u5177\u6709\u503c\u5f97\u884c\u8fdb\u884c\u7edf\u8ba1\uff0c\u5ffd\u7565NULL # \u5229\u7528\u6807\u51c6\u7b97\u672f\u64cd\u4f5c\u7b26\uff0c\u53ef\u4ee5\u5728\u591a\u4e2a\u5217\u4e0a\u8fdb\u884c\u8ba1\u7b97; SUM\u4f1a\u5ffd\u7565\u5217\u503c\u4e3aNULL\u7684\u884c SELECT SUM(item_price*quantity) AS total_price FROM orderitems WHERE order_num=200; \u805a\u96c6\u4e0d\u540c\u503c: \u4e0a\u8ff0\u4e94\u4e2a\u805a\u96c6\u51fd\u6570\u53ef\u4ee5\u5bf9\u76f8\u5e94\u7684\u5217\u6307\u5b9aALL\u6216DISTINCT\u5173\u952e\u5b57\uff0c\u524d\u8005\u8868\u793a\u5bf9\u6240\u6709\u7684\u884c\u6267\u884c\u7b5b\u9009\uff1b\u540e\u8005\u53ea\u5bf9\u503c\u4e0d\u540c\u7684\u884c\u8fdb\u884c\u7b5b\u9009\u3002ALL\u53ef\u4ee5\u4e0d\u7528\u6307\u5b9a\uff0c\u662f\u9ed8\u8ba4\u884c\u4e3a\u3002 SELECT\u8bed\u53e5\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u805a\u96c6\u51fd\u6570\u3002 SELECT COUNT(*) AS num_items, MIN(prod_price) AS price_min, AVG(prod_price) AS avg_price FROM products; \u5206\u7ec4\u6570\u636e \u521b\u5efa\u5206\u7ec4: GROUP BY \u8fc7\u6ee4\u5206\u7ec4: HAVING HAVING\u5b50\u53e5\u7c7b\u4f3cWHERE\uff0cWHERE\u5b50\u53e5\u53ef\u4ee5\u7528HAVING\u4ee3\u66ff\uff0c\u4e24\u8005\u533a\u522b\u5728\u4e8e: \u2003WHERE\u53ea\u80fd\u8fc7\u6ee4\u884c\uff0c\u4e14\u5176\u5728\u5206\u7ec4\u524d\u8fdb\u884c\u8fc7\u6ee4\uff0c\u800cHAVING\u57fa\u4e8e\u5206\u7ec4\u7684\u805a\u5408\u503c\u800c\u4e0d\u662f\u7279\u5b9a\u884c\u7684\u503c\u6765\u8fc7\u6ee4\u6570\u636e\uff0c\u4e3b\u8981\u7528\u6765\u8fc7\u6ee4\u5206\u7ec4\u3002 \u2003WHERE\u5b50\u53e5\u4e0d\u53ef\u4ee5\u5305\u542b\u805a\u5408\u51fd\u6570\uff0cHAVING \u5b50\u53e5\u4e2d\u7684\u6761\u4ef6\u53ef\u4ee5\u5305\u542b\u805a\u5408\u51fd\u6570\u3002 \u2003HAVING \u5b50\u53e5\u662f\u5728\u6570\u636e\u5206\u7ec4\u540e\u8fdb\u884c\u8fc7\u6ee4\uff0cWHERE \u5b50\u53e5\u4f1a\u5728\u6570\u636e\u5206\u7ec4\u524d\u8fdb\u884c\u8fc7\u6ee4\u3002WHERE \u5b50\u53e5\u6392\u9664\u7684\u884c\u4e0d\u5305\u542b\u5728\u5206\u7ec4\u4e2d\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd HAVING \u5b50\u53e5\u57fa\u4e8e\u8fd9\u4e9b\u503c\u8fc7\u6ee4\u6389\u7684\u5206\u7ec4\u3002 SELECT vend_id, COUNT(*) AS num_prods FROM products GROUP BY vend_id; SELECT cust_id, COUNT(*) AS orders FROM orders GROUP BY cust_id HAVING COUNT(*)>=2; SELECT vend_id, COUNT(*) AS num_prods FROM products WHERE prod_price>=10 GROUP BY vend_id HAVING COUNT(*)>=2; SELECT order_num, SUM(quantity*item_price) AS ordertotal FROM orderitems GROUP BY order_num HAVING SUM(quantity*item_price) ORDER BY ordertotal; \u5b50\u67e5\u8be2 \u2003\u5d4c\u5957\u5728\u5176\u4ed6\u67e5\u8be2\u4e2d\u7684\u67e5\u8be2\u3002 SELECT cust_name,cust_contact FROM customers WHERE cust_id IN ( SELECT cust_id FROM orders WHERE order_num IN ( SELECT order_num FROM orderitems WHERE prod_id='TNT2' ) ); SELECT cust_name, (SELECT COUNT(*) FROM orders WHERE orders.cust_id=customere.cust_id) AS num_orders FROM customers ORDER BY cust_name; \u8054\u7ed3 \u2003\u662f\u4e00\u79cd\u673a\u5236\uff0c\u7528\u4e8e\u5728SELECT\u4e2d\u5173\u8054\u8868\uff0c\u53ef\u4ee5\u8054\u7ed3\u591a\u4e2a\u8868\u8fd4\u56de\u4e00\u7ec4\u8f93\u51fa\uff0c\u8054\u7ed3\u5728\u8fd0\u884c\u65f6\u5173\u8054\u8868\u4e2d\u7684\u884c\u3002 # \u901a\u8fc7where\u5b50\u53e5\u5b9e\u73b0\u8054\u7ed3 SELECT vend_name, prod_name, prod_price FROM vendors, products WHERE vendors.vend_id=products.vend_id ORDER BY vend_nam, prod_name; # \u53c9\u8054\u7ed3/\u7b1b\u5361\u5c14\u79ef\uff0c\u7531\u6ca1\u6709\u8054\u7ed3\u5173\u7cfb\u7684\u8868\u8fd4\u56de\u7684\u7ed3\u679c\u4e3a\u7b1b\u5361\u5c14\u79ef # \u68c0\u7d22\u7684\u884c\u7684\u6570\u76ee\u5c06\u662f\u7b2c\u4e00\u4e2a\u8868\u7684\u884c\u6570\u4e58\u4ee5\u7b2c\u4e8c\u4e2a\u8868\u7684\u884c\u6570 SELECT vend_name, prod_name, prod_price FROM vendors, products ORDER BY vend_nam, prod_name; # \u7b49\u503c\u8054\u7ed3/\u5185\u90e8\u8054\u7ed3\uff0c\u57fa\u4e8e\u4e24\u4e2a\u8868\u4e4b\u95f4\u7684\u76f8\u7b49\u6d4b\u8bd5\uff0c\u901a\u8fc7where\u5b50\u53e5\u5b9e\u73b0\u7684\u5c31\u662f\u8fd9\u79cd\u8054\u7ed3 # \u4e0d\u8fc7\u4e5f\u53ef\u7528\u5176\u4ed6\u8bed\u6cd5(INNER JOIN)\u6765\u6307\u660e\u8054\u7ed3\u5173\u7cfb, \u6b64\u65f6\u53ea\u80fd\u7528ON\u4f20\u9012\u8054\u7ed3\u6761\u4ef6 SELECT vend_name, prod_name, prod_price FROM vendors INNER JOIN products ON vendors.vend_id=products.vend_id # \u8054\u7ed3\u591a\u4e2a\u8868\uff0cSQL\u5bf9\u4e8e\u8054\u7ed3\u7684\u8868\u6570\u91cf\u6ca1\u6709\u9650\u5236 # \u4e0b\u9762\u7528\u8054\u7ed3\u5b9e\u73b0\u4e4b\u524d\u7684\u5b50\u67e5\u8be2 SELECT cust_name, cust_contact FROM customers, orders, orderitems WHERE customers.cust_id=orders.cust_id AND orders.order_num=orderitems.order_num AND prod_id='TNT2'; # \u4f7f\u7528\u8868\u522b\u540d\uff0c\u7b80\u5316\u8bed\u53e5\uff0c\u8868\u522b\u540d\u53ea\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528\uff0c\u4e0d\u8fd4\u56de\u5ba2\u6237\u673a # \u8868\u522b\u540d\u5728 FROM \u5b50\u53e5\u4e2d\u5b9a\u4e49\uff0c\u53ef\u7528\u5728 SELECT\u3001WHERE\u3001ORDER BY \u7b49\u5b50\u53e5\u4e2d SELECT cust_name, cust_contact FROM customers AS c, orders AS o, orderitems AS oi WHERE c.cust_id=o.cust_id AND o.order_num=oi.order_num AND prod_id='TNT2'; # \u81ea\u8054\u7ed3\uff0c\u5728\u5355\u6761\u8bed\u53e5\u503c\u591a\u6b21\u5f15\u7528\u76f8\u540c\u7684\u8868 # \u901a\u8fc7\u8868\u522b\u540d\u6765\u907f\u514d\u4e8c\u4e49\u6027\uff0c\u4ece\u800c\u5c06\u540c\u4e00\u4e2a\u8868\u770b\u6210\u65b0\u8868\uff0c\u548c\u81ea\u8eab\u8054\u7ed3 # \u4e0b\u9762\u662f\u67e5\u8be2\u63d0\u4f9bDTNTR\u7684\u4f9b\u8d27\u5546\u63d0\u4f9b\u7684\u6240\u6709\u4ea7\u54c1 SELECT p1.prod_id, p1.prod_num FROM products AS p1, products AS p2 WHERE p1.vend_id=p2.vend_id AND p2.prod_id='DTNTR'; # \u5916\u90e8\u8054\u7ed3\uff0c\u8054\u7ed3\u5305\u542b\u4e86\u90a3\u4e9b\u5728\u76f8\u5173\u8868\u4e2d\u6ca1\u6709\u5173\u8054\u884c\u7684\u884c # \u4f8b\u5982\u7edf\u8ba1\u6bcf\u4e2a\u7528\u6237\u7684\u8ba2\u5355\uff0c\u5305\u62ec\u90a3\u4e9b\u6ca1\u6709\u8ba2\u5355\u7684\u7528\u6237(\u5176\u5728\u8ba2\u5355\u8868\u4e2d\u4e0d\u5b58\u5728\u5173\u8054\u7684\u884c) # OUTER JOIN\u6307\u660e\u5c5e\u4e8e\u5916\u90e8\u8054\u7ed3\uff0cLEFT\u6307\u660e\u662f\u5de6\u4fa7\u7684customers\u5305\u542b\u6240\u6709\u7684\u884c\uff1b # \u82e5\u662f\u4f7f\u7528 RIGHT\uff0c\u5219\u662f\u53f3\u4fa7\u7684order\u8868\u6240\u6709\u7684\u884c\uff0c\u8fd4\u56de\u7ed3\u679c\u662f\u90a3\u4e9b\u4e0b\u4e86\u8ba2\u5355\u7684\u7528\u6237\u7684\u884c\u3002 # order_num\u4ee3\u8868\u7684\u662f\u8ba2\u5355 id, \u800c\u975e\u6570\u91cf SELECT customers.cust_id, order_num FROM customers LEFT OUTER JOIN orders ON customers.cust_id=orders.cust_id; # \u4e0b\u9762\u5219\u662f\u7edf\u8ba1\u6bcf\u4e2a\u7528\u6237\u7684\u8ba2\u5355\u6570\u91cf\uff0c\u91c7\u7528\u805a\u96c6\u51fd\u6570\u7684\u5916\u90e8\u8054\u7ed3 SELECT customers.cust_id, COUNT(order_num) AS num_ord FROM customers LEFT OUTER JOIN orders ON customers.cust_id=orders.cust_id GROUP BY customers.cust_id; \u7ec4\u5408\u67e5\u8be2 \u2003\u5728\u5355\u4e2a\u67e5\u8be2\u4e2d\u4ece\u4e0d\u540c\u7684\u8868\u8fd4\u56de\u7c7b\u4f3c\u7ed3\u6784\u7684\u6570\u636e \u2003\u5bf9\u5355\u4e2a\u8868\u6267\u884c\u591a\u4e2a\u67e5\u8be2\uff0c\u6309\u5355\u4e2a\u67e5\u8be2\u8fd4\u56de\u6570\u636e \u53ef\u4f7f\u7528 UNION \u64cd\u4f5c\u7b26\u7ec4\u5408\u6570\u6761SQL\u67e5\u8be2\uff0c\u5176\u6548\u679c\u4e0e\u5177\u6709\u591a\u4e2aWHERE\u5b50\u53e5\u6761\u4ef6\u7684\u67e5\u8be2\u5b8c\u6210\u7684\u5de5\u4f5c\u76f8\u540c\uff0c\u5177\u4f53\u4f7f\u7528\u54ea\u79cd\u65b9\u5f0f\u7b80\u4fbf\u3001\u9ad8\u6548\u9700\u8981\u7ecf\u8fc7\u6d4b\u8bd5\u3002 UNION\u5fc5\u987b\u7531\u4e24\u6761\u6216\u591a\u6761SELECT\u8bed\u53e5\u7ec4\u6210\uff0c\u8bed\u53e5\u4e4b\u95f4\u901a\u8fc7UNION\u5206\u9694\uff1b UNION\u7684\u6bcf\u4e2a\u67e5\u8be2 \u5fc5\u987b\u5305\u542b\u76f8\u540c\u7684\u5217\u3001\u8868\u8fbe\u5f0f\u3001\u805a\u96c6\u51fd\u6570 \uff1b \u5217\u7c7b\u578b\u5fc5\u987b\u517c\u5bb9\uff0c\u5373DBMS\u53ef\u4ee5\u9690\u5f0f\u8f6c\u6362\u7684\u7c7b\u578b \u2003 UNION\u9ed8\u8ba4\u4f1a\u53bb\u9664\u591a\u6761\u67e5\u8be2\u8bed\u53e5\u8fd4\u56de\u4e2d\u91cd\u590d\u7684\u884c\uff0c\u4f7f\u7528UNION ALL\u53ef\u4ee5\u8fd4\u56de\u6240\u6709\u5339\u914d\u884c\uff0c\u5305\u62ec\u91cd\u590d\u884c\u3002 \u5bf9\u7ec4\u5408\u7ed3\u679c\u6392\u5e8f\uff0c\u53ea\u80fd\u5728\u6700\u540e\u4e00\u6761SELECT\u8bed\u53e5\u4e4b\u540e\u4f7f\u7528 ORDER BY\u3002 SELECT vend_id, prod_id, prod_price FROM proucts WHERE prod_price <=5 UNION SELECT vend_id, prod_id, prod_price FROM proucts WHERE vend_id in (1000, 1005); \u5168\u6587\u672c\u641c\u7d22 MyISAM\u5f15\u64ce\u652f\u6301\uff0c\u800cInnoDB\u4e0d\u652f\u6301\u3002 \u76f8\u8f83\u4e8e\u901a\u914d\u7b26\u548c\u6b63\u5219\u8868\u8fbe\u5f0f\u5c1d\u8bd5\u5339\u914d\u8868\u4e2d\u6240\u6709\u884c\uff0c\u65e0\u6cd5\u660e\u786e\u63a7\u5236\u5339\u914d\u6761\u4ef6\uff0c\u4ee5\u53ca\u4e0d\u80fd\u63d0\u4f9b\u667a\u80fd\u5316\u7684\u641c\u7d22\u7ed3\u679c\uff0c \u5168\u6587\u672c\u641c\u7d22\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002 \u542f\u7528\u5168\u6587\u672c\u641c\u7d22\uff0cMySQL\u4f1a\u521b\u5efa\u6307\u5b9a\u5217\u4e2d\u5404\u8bcd\u7684\u4e00\u4e2a\u7d22\u5f15\uff0c\u641c\u7d22\u65f6\u4f1a\u9488\u5bf9\u8fd9\u4e9b\u8bcd\u8fdb\u884c\u3002 \u2003 \u4e00\u822c\u5728\u521b\u5efa\u8868\u65f6\u542f\u7528\u5168\u6587\u672c\u641c\u7d22\uff0c CREATE TABLE productnotes( note_text text NULL, FULLTEXT(note_text) )ENGINE=MyISAM; FULLTEXT\u53ef\u4ee5\u7d22\u5f15\u591a\u4e2a\u5217\uff0c\u5b9a\u4e49\u4e4b\u540e\uff0cMySQL\u4f1a\u81ea\u52a8\u7ef4\u62a4\u7d22\u5f15\u3002\u4f7f\u7528Match()\u548cAgainst()\u6267\u884c\u5168\u6587\u672c\u641c\u7d22\u3002 \u5168\u6587\u672c\u641c\u7d22\u7684\u4e00\u4e2a\u91cd\u8981\u90e8\u5206\u5c31\u662f\u5bf9\u7ed3\u679c\u6392\u5e8f\uff0c\u5177\u6709\u8f83\u9ad8\u7b49\u7ea7\u7684\u884c\u5148\u8fd4\u56de # \u4f20\u9012\u7ed9Match()\u7684\u503c\u5fc5\u987b\u4e0eFULLTEXT\u4e2d\u7684\u5b9a\u4e49\u76f8\u540c\uff0c\u4e14\u6b21\u5e8f\u76f8\u540c\uff0c\u5373\u4f7f\u4e0d\u641c\u7d22\u67d0\u4e2a\u5217\uff0c\u4e5f\u8981\u5217\u51fa\u6765 # \u641c\u7d22\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u9664\u975e\u4f7f\u7528BINARY\u3002 SELECT note_text FROM productnotes WHERE Match(note_text) Against('rabbit'); \u67e5\u8be2\u6269\u5c55 SELECT note_text FROM productnotes WHERE Match(note_text) Against('anvils' WITH QUERY EXPANSION); \u5e03\u5c14\u6587\u672c\u641c\u7d22 # \u5339\u914d\u5305\u542banvils\u4f46\u4e0d\u5305\u542b\u4efb\u610f\u4ee5rope\u5f00\u5934\u7684\u8bcd\u7684\u884c SELECT note_text FROM productnotes WHERE Match(note_text) Against('anvils -rope*' IN BOOLEAN MODE); # \u5339\u914d\u77ed\u8bedrabbit bait\u800c\u975e\u4e24\u4e2a\u5355\u72ec\u7684\u5355\u8bcd SELECT note_text FROM productnotes WHERE Match(note_text) Against('\"rabbit bait\"' IN BOOLEAN MODE); # \u5339\u914dsafe\u548ccombination\uff0c\u4f46\u964d\u4f4e\u540e\u8005\u7684\u7b49\u7ea7 SELECT note_text FROM productnotes WHERE Match(note_text) Against('+safe +(<combination)' IN BOOLEAN MODE); \u6570\u636e\u63d2\u5165 # \u6309\u521b\u5efa\u8868\u65f6\u5217\u7684\u987a\u5e8f\uff0c\u63d2\u5165\u5217\u503c INSERT INTO tbl_name VALUES(..); # \u6839\u636e\u7b2c\u4e00\u4e2a()\u5185\u63d0\u4f9b\u7684\u5217\u540d\u6765\u9009\u62e9\u63d2\u5165\uff0c\u987a\u5e8f\u4e0d\u9700\u6309\u7167\u521b\u5efa\u987a\u5e8f\uff0c\u4e14\u53ef\u4ee5\u7701\u7565\u67d0\u4e9b\u5217(\u8981\u6c42\u8be5\u5217\u5141\u8bb8NULL\u6216\u8005\u6709\u9ed8\u8ba4\u503c) INSERT INTO tbl_name(col_name1, ..) VALUES(col_value1,..) # \u63d2\u5165\u591a\u884c, \u53ef\u4ee5\u4f7f\u7528\u591a\u6761INSERT\u8bed\u53e5\uff0c\u4e00\u6b21\u63d0\u4ea4\uff0c\u4e2d\u95f4\u7528\u2018;\u2019\u9694\u5f00, # \u6216\u8005\u5982\u4e0b, \u8981\u6c42INSERT\u8bed\u53e5\u4e2d\u5217\u540d\u548c\u6b21\u5e8f\u76f8\u540c\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6027\u80fd\u4e5f\u8981\u66f4\u597d INSERT INTO tbl_name(col_name1, ..) VALUES(col1_value,..), VALUES(col1_value2, ..); # \u63d2\u5165\u68c0\u7d22\u51fa\u7684\u6570\u636e, \u5c06\u4ece\u5176\u4ed6\u8868\u4e2d\u68c0\u7d22\u5230\u7684\u6570\u636e\u63d2\u5165\u8868\u4e2d # \u68c0\u7d22\u7684\u5217\u5bf9\u5e94\u88ab\u63d2\u5165\u8868\u7684\u6bcf\u4e00\u5217 INSERT INTO tbl_name(col_name, ..) SELECT tbl_nameX, .. FROM tbl_name_new WHERE ..; \u66f4\u65b0\u6570\u636e # IGNORE, \u5728\u66f4\u65b0\u591a\u884c\u65f6\uff0c\u5982\u679c\u67d0\u4e00\u884c\u66f4\u65b0\u9519\u8bef\uff0c\u4f7f\u7528IGNORE\u5173\u952e\u5b57\u53ef\u4ee5\u907f\u514d\u4e4b\u524d\u53d1\u751f\u66f4\u65b0\u7684\u884c\u6062\u590d\u5230\u539f\u503c UPDATE IGNORE tbl_name SET col_name='xx' col_name2='xx' WHERE ..; # \u82e5\u7f3a\u5c11WHERE\u5b50\u53e5\u5219\u4f1a\u66f4\u65b0\u6240\u6709\u884c # \u5220\u9664\u67d0\u4e9b\u884c\u7684\u4e00\u5217\u7684\u503c UPDATE tbl_name SET col_name=NULL WHERE ..; \u5220\u9664\u6570\u636e # \u5220\u9664\u7279\u5b9a\u7684\u884c, \u82e5\u60f3\u5220\u9664\u5217\uff0c\u9700\u8981\u901a\u8fc7UPDATE\u6765\u66f4\u65b0\u8be5\u5217\u503c\u4e3aNULL\u3002 DELETE FROM tbl_name; WHERE ..; # \u4ece\u8868\u4e2d\u5220\u9664\u6240\u6709\u884c\uff0c\u5b9e\u9645\u4e0a\u662f\u5220\u9664\u539f\u8868\uff0c\u5e76\u91cd\u65b0\u521b\u5efa\uff1b # DELETE FROM tbl_name;\u5219\u662f\u9010\u884c\u5220\u9664 TRUNCATE tbl_name; MySQL\u6ca1\u6709\u64a4\u9500\u64cd\u4f5c\uff0c\u5e94\u5341\u5206\u5c0f\u5fc3\u4f7f\u7528UPDATE\u548cDELETE \u521b\u5efa\u548c\u64cd\u4f5c\u8868 # cust_id \u548ccust_name\u4e24\u5217\u4e0d\u5141\u8bb8\u4e3a\u7a7a\uff1b # \u5176\u4e2dcust_id\u8bbe\u7f6e\u4e3a\u81ea\u589e\uff0c\u53ef\u4ee5\u5728\u63d2\u5165\u65f6\u4e0d\u63d0\u4f9b\u503c\uff0c\u7531MySQL\u81ea\u52a8\u63d0\u4f9b # \u6bcf\u4e2a\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u5217\u8bbe\u7f6eAUTO_INCREMENT # \u63d2\u5165\u65f6\u4e5f\u53ef\u4ee5\u4e3a\u8fd9\u6837\u7684\u5217\u8bbe\u7f6e\u4e00\u4e2a\u4ece\u672a\u7528\u8fc7\u7684\u503c\uff0c\u540e\u7eed\u5c06\u4ece\u65b0\u503c\u5f00\u59cb\u9012\u589e # \u4f7f\u7528last_insert_id()\u53ef\u4ee5\u83b7\u5f97\u6700\u540e\u4e00\u6b21\u9012\u589e\u5f97\u5230\u7684AUTO_INCREMENT\u503c\uff1b # \u53ef\u4ee5\u4f7f\u7528' DEFAULT xx '\u5728'NULL, '\u540e\uff0c\u4e3a\u8be5\u5217\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff1b CREATE TABLE customers IF NOT EXISTS # IF NOT EXISTS \u8868\u793a\u4ec5\u5728customers\u8868\u4e0d\u5b58\u5728\u65f6\u521b\u5efa\uff0c\u5426\u5219\u8df3\u8fc7 ( cust_id int NOT NULL AUTO_INCREMENT, cust_name char(50) NOT NULL , cust_address char(50) NULL , cust_city char(50) NULL , cust_state char(5) NULL , cust_zip char(10) NULL , cust_country char(50) NULL , cust_contact char(50) NULL , cust_email char(255) NULL , PRIMARY KEY (cust_id) # \u6307\u5b9a\u4e3b\u952e, \u62ec\u53f7\u5185\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5217 ) ENGINE=InnoDB; # \u901a\u8fc7 ALTER TABLE \u66f4\u65b0\u8868\uff0c\u53ef\u4ee5\u65b0\u589e\u5217\uff0c\u5220\u9664\u65e7\u5217(DROP COLUMN col_name)\uff0c\u4ee5\u53ca\u5b9a\u4e49\u5916\u952e ALTER TABLE tbl_name ADD col_name, col_type; # \u4e3atbl_name.col_name1\u65bd\u52a0\u5916\u952etbl_name2.col_name2\u7ea6\u675f ALTER TABLE tbl_name ADD CONSTRAINT fk_name FOREIGN KEY (col_name1) REFERENCES tbl_name2(col_name2); # \u5220\u9664\u5916\u952e ALTER TABLE tbl_name DROP FOREIGN KEY fk_name; # \u5220\u9664\u8868 DROP TABLE tbl_name; # \u91cd\u547d\u540d\u8868 RENAME TABLE old_tbl TO new_tbl, old_tbl2 TO new_tbl2; \u2003ENGINE:MySQL\u5e38\u7528\u7684\u5f15\u64ce\u5305\u62ecInnoDB(\u4e00\u79cd\u4e8b\u52a1\u5904\u7406\u5f15\u64ce\uff0c\u4e0d\u652f\u6301\u5168\u6587\u672c\u641c\u7d22)\u3001MyISAM(\u6027\u80fd\u6781\u9ad8\uff0c\u652f\u6301\u5168\u6587\u672c\u5904\u7406\uff0c\u4e0d\u652f\u6301\u4e8b\u52a1\u5904\u7406)\u3001MEMORY(\u529f\u80fd\u7b49\u540cMyISAM\uff0c\u4f46\u7531\u4e8e\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u800c\u975e\u78c1\u76d8\u4e2d\uff0c\u901f\u5ea6\u5f88\u5feb\uff0c\u9002\u7528\u4e8e\u4e34\u65f6\u8868)\uff0c\u5728\u4e00\u4e2a\u6570\u636e\u5e93\u4e2d\uff0c\u4e0d\u540c\u8868\u53ef\u4ee5\u91c7\u7528\u4e0d\u540c\u7684\u5f15\u64ce\u3002 \u8865\u5145 # SELECT \u53ef\u4ee5\u7701\u7565 FROM \u5b50\u53e5\u4ee5\u4fbf\u7b80\u5355\u8bbf\u95ee\u548c\u5904\u7406\u8868\u8fbe\u5f0f\uff0c\u4ece\u800c\u8fdb\u884c\u6d4b\u8bd5\u548c\u5b9e\u9a8c SELECT 2*3; # \u8fd4\u56de6 SELECT Trim(' abc '); # \u8fd4\u56de'abc' set names gbk; # \u8bbe\u7f6eMYSQL\u663e\u793a\u5b57\u7b26\u96c6\uff0cCMD\u9ed8\u8ba4\u7f16\u7801\u4e3aGBK\uff0c\u901a\u8fc7\u6b64\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u663e\u793a\u4e2d\u6587 \u89c6\u56fe \u89c6\u56fe\u662f\u865a\u62df\u7684\u8868\uff0c\u4e0e\u5305\u542b\u6570\u636e\u7684\u8868\u4e0d\u540c\uff0c\u89c6\u56fe\u53ea\u5305\u542b\u4f7f\u7528\u65f6\u52a8\u6001\u68c0\u7d22\u6570\u636e\u7684\u67e5\u8be2\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cdSELECT\u8bed\u53e5\u5c42\u6b21\u7684\u5c01\u88c5\uff0c\u7528\u4ee5\u7b80\u5316\u6570\u636e\u5904\u7406\u4ee5\u53ca\u91cd\u65b0\u683c\u5f0f\u5316\u57fa\u7840\u6570\u636e\u6216\u5305\u542b\u57fa\u7840\u6570\u636e\u3002 \u89c6\u56fe\u7684\u89c4\u5219\u548c\u9650\u5236 # \u521b\u5efa\u89c6\u56fe\uff0cproductcustomers\u8054\u7ed3\u4e09\u4e2a\u8868 CREATE VIEW productcustomers AS SELECT cust_name, cust_contact, prod_id FROM customers, orders, orderitems WHERE customers.cust_id=orders.cust_id AND orders.order_num=orderitems.order_num; # \u5220\u9664\u89c6\u56fe DROP VIEW viewname; # \u67e5\u770b\u521b\u5efa\u89c6\u56fe\u8bed\u53e5 SHOW CREEATE VIEW viewname; \u66f4\u65b0\u89c6\u56fe\uff1a\u53ef\u4ee5\u5bf9\u89c6\u56fe\u4f7f\u7528INSERT\u3001UPDATE \u3001DELETE\u6765\u8fdb\u884c\u66f4\u65b0(\u5b9e\u9645\u4e0a\u662f\u5728\u66f4\u65b0\u57fa\u8868)\uff0c\u4e0d\u8fc7\u5f53\u89c6\u56fe\u5b9a\u4e49\u4e2d\u5305\u542b\u4ee5\u4e0b\u64cd\u4f5c\u65f6\uff0c\u5219\u4e0d\u80fd\u8fdb\u884c\u66f4\u65b0: \u5206\u7ec4(GROUP BY\u548cHAVING)\u3001\u8054\u7ed3\u3001\u5b50\u67e5\u8be2\u3001\u5e76(UNION)\u3001\u805a\u96c6\u51fd\u6570\u3001DISTINCT\u3001\u5bfc\u51fa(\u8ba1\u7b97)\u5217 \u5b58\u50a8\u8fc7\u7a0b \u4fdd\u5b58\u7684\u4e00\u6761\u6216\u591a\u6761MySQL\u8bed\u53e5\u7684\u96c6\u5408\u3002 \u4f18\u70b9: CREATE PROCEDURE productpricing() # ()\u5185\u662f\u5b58\u50a8\u8fc7\u7a0b\u63a5\u6536\u7684\u53c2\u6570 BEGIN SELECT Avg(pord_price) AS priceaverage FROM products; END; # \u6ce8\u610f\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b\u7ed3\u675f\u65f6\u7684';'\u5c5e\u4e8e\u5b58\u50a8\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u4ee3\u8868MySQL\u8bed\u6cd5\u4e2d\u7684\u5206\u9694\u7b26\uff1b # \u4e00\u822c\u5728\u547d\u4ee4\u884c\u8fd0\u884cSQL\u8bed\u53e5\u65f6\u7ed3\u5c3e\u7684';'\u662f\u5219\u662f\u547d\u4ee4\u884c\u8bed\u53e5\u5206\u9694\u7b26\uff1b # \u5728\u547d\u4ee4\u884c\u4e2d\u521b\u5efa\u8fc7\u7a0b\u65f6\u5185\u90e8\u7684';'\u4e0d\u4f1a\u88ab\u89e3\u91ca\u4e3a\u5b58\u50a8\u8fc7\u7a0b\u7684\u6210\u5206\uff1b # \u53ef\u4ee5\u5728\u521b\u5efa\u524d\u91c7\u7528 DELIMETER \\\\ \u4e34\u65f6\u66f4\u6539\u547d\u4ee4\u884c\u8bed\u53e5\u5206\u9694\u7b26\u4e3a'\\\\' DELIMETER \\\\ CREATE PROCEDURE productpricing() # ()\u5185\u662f\u5b58\u50a8\u8fc7\u7a0b\u63a5\u6536\u7684\u53c2\u6570 BEGIN SELECT Avg(pord_price) AS priceaverage FROM products; END \\\\ DELIMETER ; # \u6062\u590d\u539f\u6765\u7684\u5206\u9694\u7b26 CALL productpricing(); # \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b DROP PROCEDURE pro_name IF EXISTS; # \u5220\u9664\u5b58\u50a8\u8fc7\u7a0b\uff0c \u540e\u9762\u7684IF EXISTS\u4fdd\u8bc1\u5220\u9664\u65f6\u5373\u4f7f\u4e0d\u5b58\u5728\u4e5f\u4e0d\u4f1a\u62a5\u9519 SHOW CREATE PROCEDURE pro_name; #\u663e\u793a\u5b58\u50a8\u8fc7\u7a0b\u521b\u5efa\u8bed\u53e5 SHOW PROCEDURE STATUS like 'pro_name'; # \u663e\u793a\u5b58\u50a8\u8fc7\u7a0b\u4fe1\u606f\u5217\u8868 \u4f7f\u7528\u53c2\u6570 \u2003\u53c2\u6570\u4f20\u9012\u7c7b\u578b: OUT(\u4ece\u5b58\u50a8\u8fc7\u7a0b\u4f20\u51fa\uff0c\u76f8\u5f53\u4e8e\u8fd4\u56de\u53d8\u91cf)\u3001IN(\u4f20\u9012\u7ed9\u5b58\u50a8\u8fc7\u7a0b\uff0c\u76f8\u5f53\u4e8e\u4f20\u5165\u53c2\u6570)\u3001INOUT(\u5bf9\u5b58\u50a8\u8fc7\u7a0b\u4f20\u5165\u3001\u4f20\u51fa\uff0c\u76f8\u5f53\u4e8e\u5f15\u7528\u53c2\u6570). (\u56e0\u6b64\u5b58\u50a8\u8fc7\u7a0b\u5176\u5b9e\u7c7b\u4f3c\u81ea\u5b9a\u4e49\u7684\u67e5\u8be2\u51fd\u6570) \u2003INTO\u628a\u68c0\u7d22\u7ed3\u679c\u4fdd\u5b58\u5230\u6307\u5b9a\u53d8\u91cf\u3002 \u2003\u56e0\u4e3a\u4e0d\u5141\u8bb8\u901a\u8fc7\u4e00\u4e2a\u53c2\u6570\u8fd4\u56de\u591a\u4e2a\u884c\u548c\u5217\uff0c\u56e0\u6b64\u524d\u9762\u8981\u91c7\u75283\u4e2a\u53c2\u6570\u3002 CALL productpricing( @pricelow, @pricehigh, @priceaverage ); # \u8c03\u7528\u540e\uff0c\u5e76\u4e0d\u663e\u793a\u7ed3\u679c\uff0c\u7ed3\u679c\u5b58\u50a8\u5728\u76f8\u5e94\u7684\u53d8\u91cf\u4e2d SELECT @pricelow; # \u663e\u793a\u7ed3\u679c CREATE PROCEDURE ordertotal( IN onumber INT, OUT total DECIMAL (8, 2) ) BEGIN SELECT Sum(quantity*item_price) FROM orderitems WHERE order_num=onumber INTO total; END; CALL ordertotal(20005, @total); SELECT @total; \u2003 --\u4ee3\u8868\u6ce8\u91ca\uff1bDECLARE\u5b9a\u4e49\u5c40\u90e8\u53d8\u91cf\uff0c\u6307\u5b9a\u53d8\u91cf\u540d\u548c\u6570\u636e\u7c7b\u578b\uff1b \u6e38\u6807 \u3002\u3002\u3002 \u89e6\u53d1\u5668 \u2003\u5728\u8868\u53d1\u751f\u6539\u52a8\u4e14\u6ee1\u8db3\u54cd\u5e94\u6761\u4ef6\u65f6\u81ea\u52a8\u6267\u884c\uff0c\u53ea\u80fd\u4e3a\u54cd\u5e94DELETE\u3001INSERT\u3001UPDATE\u7684SQL\u8bed\u53e5\u6216\u8005\u4f4d\u4e8eBEGIN\u548cEND\u4e4b\u5185\u7684\u4e00\u7ec4\u8bed\u53e5\u3002 \u2003\u53ea\u6709\u8868\u624d\u652f\u6301TRIGGER\uff0cVIEW\u548c\u4e34\u65f6\u8868\u90fd\u4e0d\u652f\u6301\u3002 # \u89e6\u53d1\u5668\u540d\u6700\u597d\u5728\u6570\u636e\u5e93\u4e2d\u552f\u4e00(MySQL5\u5141\u8bb8\u4e0d\u540c\u7684\u8868\u6709\u76f8\u540c\u7684trigger name) # BEFORE \u548c AFTER\uff0c\u89e6\u53d1\u5668\u88ab\u89e6\u53d1\u7684\u65f6\u523b\u3002\u82e5\u5e0c\u671b\u9a8c\u8bc1\u65b0\u6570\u636e\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u4f7f\u7528 BEFORE \u9009\u9879\uff1b # \u82e5\u5e0c\u671b\u5728\u6fc0\u6d3b\u89e6\u53d1\u5668\u7684\u8bed\u53e5\u6267\u884c\u4e4b\u540e\u5b8c\u6210\u51e0\u4e2a\u6216\u66f4\u591a\u7684\u6539\u53d8\uff0c\u5219\u901a\u5e38\u4f7f\u7528 AFTER \u9009\u9879 # FOR EACH ROW \u4e00\u822c\u662f\u6307\u884c\u7ea7\u89e6\u53d1\uff0c\u5bf9\u4e8e\u53d7\u89e6\u53d1\u4e8b\u4ef6\u5f71\u54cd\u7684\u6bcf\u4e00\u884c\u90fd\u8981\u6fc0\u6d3b\u89e6\u53d1\u5668\u7684\u52a8\u4f5c # \u89e6\u53d1\u5668\u52a8\u4f5c\u4e3b\u4f53\uff0c\u5305\u542b\u89e6\u53d1\u5668\u6fc0\u6d3b\u65f6\u5c06\u8981\u6267\u884c\u7684 MySQL \u8bed\u53e5\u3002\u5982\u679c\u8981\u6267\u884c\u591a\u4e2a\u8bed\u53e5\uff0c\u53ef\u4f7f\u7528 BEGIN\u2026END \u590d\u5408\u8bed\u53e5\u7ed3\u6784 # \u6bcf\u4e2a\u8868\u6700\u591a\u652f\u63016\u4e2aTRIGGER(insert\\update\\delete\u7684before\u548cafter) CREATE <\u89e6\u53d1\u5668\u540d> < BEFORE | AFTER > <INSERT | UPDATE | DELETE > ON <\u8868\u540d> FOR EACH Row<\u89e6\u53d1\u5668\u4e3b\u4f53> # MySQL5\u4ee5\u540e\u4e0d\u5141\u8bb8TRIGGER\u8fd4\u56de\u7ed3\u679c\u96c6\uff0c\u8fd9\u91cc\u53ea\u80fd\u5c06\u7ed3\u679c\u8d4b\u7ed9\u53d8\u91cf CREATE TRIGGER newproduct AFTER INSERT ON products FOR EACH ROW SELECT 'Product added' INTO @result; SELECT @result; # \u5220\u9664\u89e6\u53d1\u5668 DROP TRIGGER tri_name; # \u5728INSERT TRIGGER\u4ee3\u7801\u5185\uff0c\u53ef\u5f15\u7528\u4e00\u4e2a\u540d\u4e3aNEW\u7684\u865a\u62df\u8868 # \u800c\u5728DELETE TRIGGER\u4ee3\u7801\u5185\uff0c\u53ef\u5f15\u7528\u4e00\u4e2a\u540d\u4e3aOLD\u7684\u865a\u62df\u8868\uff0c\u8bbf\u95ee\u88ab\u5220\u9664\u7684\u884c CREATE TRIGGER neworder AFTER INSERT ON orders FOR EACH ROW SELECT NEW.order_num INTO @result; \u4e8b\u7269\u5904\u7406 \u7528\u4ee5\u7ef4\u62a4\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\uff0c\u5b83\u4fdd\u8bc1\u6210\u6279\u7684MySQL\u64cd\u4f5c\u8981\u4e48\u5b8c\u5168\u6267\u884c\uff0c\u8981\u4e48\u5b8c\u5168\u4e0d\u6267\u884c\u3002 SELECT * FROM tbl; START TRANSACTION; # \u5f00\u59cb\u4e00\u4e2a\u4e8b\u7269\u5904\u7406 DELETE TABLE tbl; DELETE TABLE tbl2; ROLLBACK; # \u56de\u9000\u5230\u4e8b\u7269\u5f00\u59cb\u4e4b\u524d\uff0cSELECT\\CREATE\\DROP\u8fd9\u4e09\u79cd\u8bed\u53e5\u65e0\u6cd5\u56de\u9000 COMMIT; # \u624b\u52a8\u63d0\u4ea4\uff0c\u5982\u679c DELETE \u51fa\u9519,\u5219\u81ea\u52a8\u64a4\u9500\u63d0\u4ea4 # \u4f7f\u7528\u4fdd\u7559\u70b9\uff0c\u5b9e\u73b0\u90e8\u5206\u56de\u9000\uff0c \u4fdd\u7559\u70b9\u5728\u4e8b\u7269\u5904\u7406\u5b8c\u6210(ROLLBACK \u6216 commit)\u540e\u81ea\u52a8\u91ca\u653e SAVEPOINT pos1; ROLLBACK pos1; # pos1\u4e4b\u540e\u7684\u8bed\u53e5\u4e0d\u4f1a\u88ab\u6267\u884c # \u5173\u95ed\u9ed8\u8ba4\u63d0\u4ea4 SET autocommit=0; \u5b57\u7b26\u96c6\u548c\u6821\u5bf9\u987a\u5e8f \u2003\u5b57\u7b26\u96c6\u4e3a\u5b57\u6bcd\u548c\u7b26\u53f7\u7684\u96c6\u5408 \u2003\u7f16\u7801\u4e3a\u67d0\u4e2a\u5b57\u7b26\u96c6\u7684\u5185\u90e8\u8868\u793a \u2003\u6821\u5bf9\u4e3a\u89c4\u5b9a\u5b57\u7b26\u5982\u4f55\u6bd4\u8f83\u7684\u6307\u4ee4, \u5728ORDER BY\\GROUP BY\u7b49\u68c0\u7d22\u6392\u5e8f\u65f6\u6709\u7528\u3002 SHOW CHARACTER SET; SHOW COLLATION; # \u663e\u793a\u6821\u5bf9\u5217\u8868 # \u786e\u5b9a\u6570\u636e\u5e93\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u548c\u6821\u5bf9 SHOW VARIABLES LIKE 'character%'; SHOW VARIABLES LIKE 'collation%'; #\u5728\u521b\u5efa\u8868\u65f6\u6307\u5b9a\u5b57\u7b26\u96c6\u6216\u8005\u6821\u5bf9\uff0c\u751a\u81f3\u5141\u8bb8\u5bf9\u5217\u8fdb\u884c\u8bbe\u7f6e CREATE TABLE tbl{ xx, column VARCHAR(10) CHARACTER SET BIG5 COLLATE big5_chinese_ci }DEFAULT CHARACTER SET latine COLLATE xx; # \u53ef\u4ee5\u5728SELECT\u65f6\u6307\u5b9a\u4e0e\u521b\u5efa\u65f6\u4e0d\u540c\u7684\u6821\u5bf9 SELECT * FROM tbl ORDER BY x COLLATE XX; \u7ba1\u7406\u7528\u6237 # IDENTIFIED BY 'p@$$w0rd' \u6307\u5b9a\u7528\u6237\u767b\u5f55\u5bc6\u7801(\u6216\u79f0\u53e3\u4ee4) CREATE USER name IDENTIFIED BY 'p@$$w0rd'; RENAME USER old_name TO new_name; DROP USER name; # \u67e5\u770b\u7528\u6237\u8d26\u53f7\u6743\u9650, host\u8868\u793a\u4e3b\u673a\u540d\uff0c\u53ea\u63d0\u4f9busername\u65f6\uff0c\u5219\u9ed8\u8ba4\u4e3b\u673a\u540d\u4e3a%\uff0c\u8868\u793a\u4e0d\u7ba1\u4e3b\u673a\u540d SHOW GRANTS FOR username@host; SHOW GRANTS FOR root@localhost; # \u6388\u4e88\u7528\u6237\u6743\u9650; \u6388\u4e88\u7528\u6237\u5728db_name\u7684\u6240\u6709\u8868\u4e0a\u67e5\u8be2\u7684\u6743\u9650 GRANT SELECT ON db_name.* TO username; # \u64a4\u9500\u6743\u9650 REVOKE SELECT ON db_name.* FROM username; # \u66f4\u6539\u5bc6\u7801 SET PASSWORD FOR username = Password('new password');","title":"home"},{"location":"MySQL/0_start/#_1","text":"","title":"\u6570\u636e\u5e93\u5165\u95e8"},{"location":"MySQL/0_start/#_2","text":"\u6570\u636e\u7c7b\u578b: \u6bcf\u4e2a\u8868\u5217\u90fd\u6709\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5141\u8bb8\u8be5\u5217\u4e2d\u53ef\u4ee5\u5b58\u50a8\u7684\u6570\u636e\u3002 \u4e3b\u952e(primary key): \u4e00\u5217\u6216\u4e00\u7ec4\u5217\uff0c\u5176\u503c(\u4f7f\u7528\u591a\u5217\uff0c\u5219\u8981\u6c42\u5b83\u4eec\u7684\u7ec4\u5408\u503c)\u80fd\u552f\u4e00\u533a\u5206\u8868\u4e2d\u6bcf\u4e00\u4e2a\u884c\u3002 \u2003\u4efb\u610f\u4e24\u884c\u90fd\u4e0d\u5177\u6709\u76f8\u540c\u7684\u4e3b\u952e\u503c\u3002 \u2003\u6bcf\u4e2a\u884c\u90fd\u5fc5\u987b\u6709\u4e00\u4e2a\u4e3b\u952e\u503c(\u4e3b\u952e\u5217\u4e0d\u5141\u8bb8\u4e3aNULL\u503c)\u3002 NULL: \u521b\u5efa\u8868\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a\u5176\u4e2d\u7684\u5217\u662f\u5426\u53ef\u4ee5\u4e0d\u542b\u503c\uff0c\u5982\u679c\u4e0d\u542b\u503c\uff0c\u79f0\u5176\u4e3a\u5305\u542b\u7a7a\u503cNULL\u3002 \u5916\u952e(foreign key): \u4ee5A\u8868\u4e2d\u7684col\u5217\u5173\u8054B\u8868\u4e2d\u7684col\u5217\uff0c\u8981\u6c42B\u4e2dcol\u5217\u5177\u6709\u552f\u4e00\u6027\u7ea6\u675f\uff0c\u4e00\u822c\u4e3a\u5176\u4e3b\u952e\uff1b\u65bd\u52a0\u7ea6\u675f\u540e\uff0cB\u8868\u79f0\u4e3a\u4e3b\u8868\uff0cA\u8868\u79f0\u4e3a\u5916\u952e\u8868\uff1a \u5916\u952e\u5b57\u6bb5\u5728\u521b\u5efa\u7684\u65f6\u5019\u5c31\u5e94\u8be5\u4e0e\u4e3b\u8868\u7684\u7c7b\u578b\u5b8c\u5168\u4e00\u81f4(\u957f\u5ea6\u554a\u7b49)\uff0c\u5426\u5219\u521b\u5efa\u5916\u952e\u4f1a\u62a5\u9519 \u5916\u952e\u8868\u662f\u4e0d\u80fd\u63d2\u5165\u4e3b\u8868\u4e0d\u5b58\u5728\u7684\u6570\u636e \u5916\u952e\u8868\u4e0d\u80fd\u5220\u9664\u5df2\u7ecf\u5173\u8054\u4e0a\u7684\u4e3b\u8868\u6570\u636e","title":"\u57fa\u7840\u6982\u5ff5"},{"location":"MySQL/0_start/#_3","text":"show use xx_database; # help show; \u67e5\u770b\u6240\u6709show show databases; show tables from db_name; show columns from tbl_name; describe xx_table; # \u662f\u4e0a\u9762\u4e00\u53e5\u7684\u5feb\u6377\u547d\u4ee4 show status; # \u663e\u793a\u670d\u52a1\u5668\u72b6\u6001\u4fe1\u606f show variables; # \u67e5\u770b\u5f53\u524dmysql\u914d\u7f6e show create database/table db_name/tbl_name; # \u663e\u793a\u521b\u5efa\u7279\u5b9a\u6570\u636e\u5e93/\u8868\u7684mysql\u8bed\u53e5 show errors; show warnings; \u68c0\u7d22\u8bed\u53e5 select col_name from tbl_name; select col_name1, col_name2 from tbl_name; SELECT DISTINCT col_name FROM tbl_name; # \u8fd4\u56de\u4e0d\u540c\u7684col_name\u884c(\u53bb\u91cd)\u3002distinct\u4f1a\u4fee\u9970\u5176\u540e\u6240\u6709\u7684\u5217 SELECT col_name FROM tbl_name LIMIT 5; # \u8fd4\u56de\u7684\u884c\u4e0d\u591a\u4e8e5\u884c SELECT col_name FROM tbl_name LIMIT 1, 6; # \u8fd4\u56de\u4ece\u7b2c\u4e00\u884c\u5f00\u59cb\u76846\u884c SELECT col_name FROM tbl_name LIMIT 6 OFFSET 1; # \u4eceMysql 5 \u5f00\u59cb\uff0c\u652f\u6301\u4e0a\u4e00\u53e5\u7684\u66ff\u4ee3\u65b9\u6cd5 SELECT tbl_name.col_name FROM db_name.tbl_name; # \u5b8c\u5168\u9650\u5b9a\u8868\u540d\u548c\u5217\u540d \u6392\u5e8f\u6570\u636e SELECT col_name FROM tbl_name ORDER BY col_name; # \u4e5f\u53ef\u4f7f\u7528\u5176\u4ed6\u5217\u8fdb\u884c\u6392\u5e8f SELECT col_name, .. FROM tbl_name ORDER BY col_name1, col_name2, ..; # \u6309\u591a\u4e2a\u5217\u6392\u5e8f\uff0c\u4e14\u6309\u7167\u5217\u51fa\u7684\u5217\u987a\u5e8f # \u9ed8\u8ba4\u662f\u5347\u5e8f\u6392\u5e8f\uff0c\u8fd9\u91cc\u6307\u5b9a\u964d\u5e8f\u6392\u5e8f\u3002DESC\u53ea\u4fee\u9970\u5176\u524d\u7684\u5217\uff0c\u5bf9\u4e8e\u540e\u9762\u7684\u5217\u4efb\u6309\u7167\u5347\u5e8f\u6392\u5e8f SELECT col_name FORM tbl_name ORDER BY col_name DESC; \u8fc7\u6ee4\u6570\u636e SELECT col_name, .. FROM tbl_name WHERE col_name=xx; # where\u5e94\u8be5\u5728order by\u4e4b\u524d # where\u5b50\u53e5\u64cd\u4f5c\u7b26\u5305\u62ec =\u3001<\u3001<=\u3001>\u3001>=\uff0c<>\u548c!=\u90fd\u662f\u4e0d\u7b49\u4e8e # \u4ee5\u53cabetween SELECT prod_name, prod_price FROM products WHERE prod_price BETWEEN 10 AND 20; SELECT col_name FROM tbl_name WHERE col_name IS NULL; # \u68c0\u7d22col_name\u503c\u4e3aNULL\u7684\u884c # AND\u3001OR \u64cd\u4f5c\u7b26\u53ef\u4ee5\u7528\u6765\u7ec4\u5408\u591a\u4e2a\u5b50\u53e5\uff0c\u4e14AND\u7684\u8ba1\u7b97\u6b21\u5e8f\u66f4\u9ad8\uff0c\u53ef\u4ee5\u901a\u8fc7()\u6765\u660e\u786e\u5206\u7ec4\u76f8\u5e94\u7684\u64cd\u4f5c\u7b26 SELECT prod_id FROM products HWERE vend_id = 1000 AND prod_price<100; # IN \u64cd\u4f5c\u7b26\uff0c\u5bf9\u4e8e()\u5185\u7684\u6bcf\u4e2a\u6761\u4ef6\u90fd\u8fdb\u884c\u5339\u914d SELECT col_name FROM tbl_name WHERE col_name2 IN (x, xx, xxx); # NOT \u64cd\u4f5c\u7b26\u7528\u6765\u5426\u5b9a\u540e\u8ddf\u6761\u4ef6\uff0c MySQL\u652f\u6301\u4f7f\u7528NOT\u5bf9 IN\u3001BETWEEN \u548c EXISTS \u5b50\u53e5\u53d6\u53cd SELECT col_name FROM tbl_name WHERE col_name2 NOT IN (x, xx, xxx); \u901a\u914d\u7b26 \u4e3a\u5728\u641c\u7d22\u5b50\u53e5\u4e2d\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u5fc5\u987b\u4f7f\u7528LIKE\u64cd\u4f5c\u7b26\uff0c\u5176\u6307\u793aMySQL\u540e\u8ddf\u7684\u641c\u7d22\u6a21\u5f0f\u5229\u7528\u901a\u914d\u7b26\u5339\u914d\u800c\u4e0d\u662f\u76f4\u63a5\u76f8\u7b49\u5339\u914d\u8fdb\u884c\u6bd4\u8f83\u3002 # %\uff0c \u8868\u793a\u4efb\u4f55\u5b57\u7b26\u51fa\u73b0\u4efb\u4f55\u6b21\u6570, \u8fd9\u662f\u641c\u7d22\u4efb\u610f\u4ee5'jet'\u5f00\u5934\u7684\u8bcd\uff0c\u4e14\u662f\u533a\u5206\u5927\u5c0f\u5199\u7684\uff0c\u5373'JET'\u4e0d\u5339\u914d # LIKE '%' \u5e76\u4e0d\u80fd\u7528\u6765\u5339\u914d\u5176\u503c\u4e3aNULL\u7684\u884c SELECT prod_id, prod_name FROM prodcuts WHERE prod_name LIKE 'jet%'; # _\uff0c \u8868\u793a\u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26 \u6b63\u5219\u8868\u8fbe\u5f0f\u641c\u7d22 \u4f7f\u7528REGEXP\u64cd\u4f5c\u7b26\uff0c\u6307\u660e\u5176\u540e\u7684\u6a21\u5f0f\u4f5c\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u5904\u7406 SELECT col_name, .. FROM tbl_name WHERE col_name2 REGEXP 'XX'; # LIKE \u4f1a\u5339\u914d\u6574\u4e2a\u5217\uff1b\u800cREGEXP\u5728\u5217\u503c\u5185\u8fdb\u884c\u5339\u914d\uff0c\u5982\u679c\u88ab\u5339\u914d\u7684\u6587\u672c\u51fa\u73b0\u5728\u5217\u503c\u4e2d\uff0c\u4e14\u8fd8\u5305\u542b\u5176\u4ed6\u6587\u672c # \u5728\u4e0d\u4f7f\u7528\u901a\u914d\u7b26\u60c5\u51b5\u4e0b\uff0cLIKE\u662f\u65e0\u6cd5\u5339\u914d\u7684\uff0c\u800cREGEXP\u662f\u53ef\u4ee5\u8fd4\u56de\u5339\u914d\u7ed3\u679c\u7684 SELECT prod_name FROM products WHERE prod_name LIKE/REGEXP '1000'; # \u4e14\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u9664\u975e\u662f\u6709BINARY \u5173\u952e\u5b57 SELECT prod_name FROM producys WHERE prod_name REGEXP BINARY 'JET'; . \u8868\u793a\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff1b | \u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u7684or\u64cd\u4f5c\u7b26\uff0c\u8868\u793a\u5339\u914d\u5176\u4e2d\u4e4b\u4e00\uff0c\u201c100|200|300\u201d\uff1b [] \u5339\u914d\u5176\u4e2d\u5b57\u7b26\u4e4b\u4e00\uff0c\u201c[123] tom\u201d \u8868\u793a\u5339\u914d \u201c1 tom\u201d \u6216 \u201c2 tom\u201d \u6216 \u201c3 tom\u201d\uff1b [0-9] \u5339\u914d0\u52309\u4e2d\u7684\u4e00\u4e2a\u6570\u5b57\uff0c[a-z]\u5339\u914da\u5230z\u4e2d\u7684\u4e00\u4e2a\u5b57\u7b26\uff1b \\\\ \u8f6c\u4e49\uff0c\u7528\u6765\u5339\u914d\u7279\u6b8a\u5b57\u7b26 \u5b9a\u4f4d\u5143\u5b57\u7b26\uff1a ^ \u6587\u672c\u7684\u5f00\u59cb $ \u6587\u672c\u7684\u7ed3\u5c3e [[: < :]] \u8bcd\u7684\u5f00\u59cb [[:>:]] \u8bcd\u7684\u7ed3\u5c3e eg. \"\\\\([0-9] sticks?\\\\)\": \u5339\u914d\u5305\u542b\u5f62\u5982 \"(1 stick)\" \u6216\u8005 \"(2 stciks)\"\u6587\u672c\u7684\u5217\u503c \"[[:digit:]]{4}\"\uff1a\u5339\u914d\u8fde\u5728\u4e00\u8d77\u7684\u4efb\u610f4\u4f4d\u6570\u5b57 \"^[0-9\\\\.]\"\uff1a\u5339\u914d\u4ee5\u6570\u5b57\u6216\u5c0f\u6570\u70b9\u5f00\u59cb\u7684\u6587\u672c \u8ba1\u7b97\u5b57\u6bb5 \u8fd0\u884c\u65f6\u5728SELECT\u8bed\u53e5\u5185\u521b\u5efa \uff0c\u4f8b\u5982\u5d4c\u5957\u5b50\u67e5\u8be2\u6216\u8005\u901a\u8fc7\u7ec4\u5408\u5b57\u6bb5(\u5373 column)\u6765\u683c\u5f0f\u5316\u68c0\u7d22\u8f93\u51fa\u7ed3\u679c Concat()\u62fc\u63a5\u5b50\u4e32 \u5220\u9664\u7a7a\u683c\uff0cRTrim()\u53bb\u9664\u4e32\u53f3\u4fa7\u7a7a\u683c\uff0cLTrim()\u53bb\u9664\u4e32\u53f3\u4fa7\u7a7a\u683c\uff0cTrim()\u53bb\u9664\u4e24\u4fa7\u7a7a\u683c AS\uff0c\u53ef\u4ee5\u4e3aConcat()\u5f97\u5230\u7684\u7ed3\u679c\u521b\u5efa\u4e00\u4e2a\u5217\u522b\u540d\uff0c\u65b9\u4fbf\u5ba2\u6237\u673a\u4f7f\u7528 \u53ef\u4ee5\u5728\u8ba1\u7b97\u5b57\u6bb5\u4e2d\u6307\u5411\u7b97\u672f\u8ba1\u7b97 SELECT Concat(Rtrim(vend_name), '(', RTrim(vend_country), ')') AS vend_title FROM vendors; SELECT quantity*item_price AS expanded_price FROM orderitems; \u6570\u636e\u5904\u7406\u51fd\u6570 \u6587\u672c\u5904\u7406\u51fd\u6570: Trim(), Upper(), Lower(), Soundex()\u7b49\uff1b\u5176\u4e2dSoundex\u53ef\u4ee5\u5c06\u6587\u672c\u4e32\u8f6c\u4e3a\u63cf\u8ff0\u5176\u8bed\u97f3\u8868\u793a\u7684\u5b57\u6bcd\u6570\u5b57\u6a21\u5f0f\u7684\u7b97\u6cd5\uff0c\u8003\u8651\u4e86\u7c7b\u4f3c\u7684\u53d1\u97f3\u5b57\u7b26\u548c\u97f3\u8282\uff0c\u4f7f\u5f97\u5bf9\u4e32\u8fdb\u884c\u53d1\u97f3\u6bd4\u8f83\u800c\u4e0d\u662f\u5b57\u7b26\u6bd4\u8f83\u3002 # \u5339\u914d\u6240\u6709\u53d1\u97f3\u7c7b\u4f3c\u2018Lee\u2019\u7684cust_name SELECT cust_name, cust_contact FROM customers WHERE Soundex(cust_name)=Soundex('Lee') \u65e5\u671f\u548c\u65f6\u95f4\u5904\u7406\u51fd\u6570 MySQL\u4f7f\u7528\u7684\u9ed8\u8ba4\u65e5\u671f\u683c\u5f0f\u4e3ayyyy-mm-dd, datetime\u7c7b\u578b\u9664\u4e86\u65e5\u671f\u8fd8\u5305\u62ec\u65f6\u95f4\u503c\uff0chh-mm-ss # \u68c0\u7d222005\u5e749\u6708\u6240\u6709\u8ba2\u5355 SELECT cust_id, order_num FROM orders WHERE DATE(order_date) BETWEEN '2005-09-01' AND '2005-09-30'; SELECT cust_id, order_num FROM orders WHERE Year(order_data)=2005 AND Month(order_date)=9; \u6570\u503c\u5904\u7406\u51fd\u6570 \u4ec5\u7528\u6765\u5904\u7406\u6570\u503c\u6570\u636e\uff0c\u7528\u4e8e\u4ee3\u6570\u3001\u4e09\u89d2\u51fd\u6570\u8ba1\u7b97\u3002\u5982Abs()\u3001Cos()\u3001Sin()\u3001Pi()\u3001Rand()\u3001Mod()\u3001Sqrt()\u3001Exp(). \u805a\u96c6\u51fd\u6570 \u7528\u4e8e\u5bf9\u8868\u4e2d\u6570\u636e\u8fdb\u884c\u6c47\u603b\uff0c\u4f46\u65e0\u9700\u8fd4\u56de\u5b9e\u9645\u8868\u9879\u6570\u636e\uff0c\u5982\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\u6570\uff0c\u8868\u5217\u7684\u6700\u5927/\u5c0f\u503c\u7b49\u3002 # AVG\u53ea\u80fd\u7528\u4e8e\u5355\u4e2a\u5217\uff0c\u4e3a\u83b7\u5f97\u591a\u4e2a\u5217\uff0c\u5fc5\u987b\u4f7f\u7528\u591a\u4e2aAVG\u51fd\u6570 SELECT AVG(prod_price) AS avg_price WHERE vend_id=100; # COUNT(*) \u7edf\u8ba1\u8868\u4e2d\u884c\u7684\u6570\u76ee\uff0c\u5373\u4f7f\u5217\u503c\u4e3aNULL\uff0c\u800cCOUNT(column)\u5bf9\u7279\u5b9a\u5217\u4e2d\u5177\u6709\u503c\u5f97\u884c\u8fdb\u884c\u7edf\u8ba1\uff0c\u5ffd\u7565NULL # \u5229\u7528\u6807\u51c6\u7b97\u672f\u64cd\u4f5c\u7b26\uff0c\u53ef\u4ee5\u5728\u591a\u4e2a\u5217\u4e0a\u8fdb\u884c\u8ba1\u7b97; SUM\u4f1a\u5ffd\u7565\u5217\u503c\u4e3aNULL\u7684\u884c SELECT SUM(item_price*quantity) AS total_price FROM orderitems WHERE order_num=200; \u805a\u96c6\u4e0d\u540c\u503c: \u4e0a\u8ff0\u4e94\u4e2a\u805a\u96c6\u51fd\u6570\u53ef\u4ee5\u5bf9\u76f8\u5e94\u7684\u5217\u6307\u5b9aALL\u6216DISTINCT\u5173\u952e\u5b57\uff0c\u524d\u8005\u8868\u793a\u5bf9\u6240\u6709\u7684\u884c\u6267\u884c\u7b5b\u9009\uff1b\u540e\u8005\u53ea\u5bf9\u503c\u4e0d\u540c\u7684\u884c\u8fdb\u884c\u7b5b\u9009\u3002ALL\u53ef\u4ee5\u4e0d\u7528\u6307\u5b9a\uff0c\u662f\u9ed8\u8ba4\u884c\u4e3a\u3002 SELECT\u8bed\u53e5\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u805a\u96c6\u51fd\u6570\u3002 SELECT COUNT(*) AS num_items, MIN(prod_price) AS price_min, AVG(prod_price) AS avg_price FROM products; \u5206\u7ec4\u6570\u636e \u521b\u5efa\u5206\u7ec4: GROUP BY \u8fc7\u6ee4\u5206\u7ec4: HAVING HAVING\u5b50\u53e5\u7c7b\u4f3cWHERE\uff0cWHERE\u5b50\u53e5\u53ef\u4ee5\u7528HAVING\u4ee3\u66ff\uff0c\u4e24\u8005\u533a\u522b\u5728\u4e8e: \u2003WHERE\u53ea\u80fd\u8fc7\u6ee4\u884c\uff0c\u4e14\u5176\u5728\u5206\u7ec4\u524d\u8fdb\u884c\u8fc7\u6ee4\uff0c\u800cHAVING\u57fa\u4e8e\u5206\u7ec4\u7684\u805a\u5408\u503c\u800c\u4e0d\u662f\u7279\u5b9a\u884c\u7684\u503c\u6765\u8fc7\u6ee4\u6570\u636e\uff0c\u4e3b\u8981\u7528\u6765\u8fc7\u6ee4\u5206\u7ec4\u3002 \u2003WHERE\u5b50\u53e5\u4e0d\u53ef\u4ee5\u5305\u542b\u805a\u5408\u51fd\u6570\uff0cHAVING \u5b50\u53e5\u4e2d\u7684\u6761\u4ef6\u53ef\u4ee5\u5305\u542b\u805a\u5408\u51fd\u6570\u3002 \u2003HAVING \u5b50\u53e5\u662f\u5728\u6570\u636e\u5206\u7ec4\u540e\u8fdb\u884c\u8fc7\u6ee4\uff0cWHERE \u5b50\u53e5\u4f1a\u5728\u6570\u636e\u5206\u7ec4\u524d\u8fdb\u884c\u8fc7\u6ee4\u3002WHERE \u5b50\u53e5\u6392\u9664\u7684\u884c\u4e0d\u5305\u542b\u5728\u5206\u7ec4\u4e2d\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd HAVING \u5b50\u53e5\u57fa\u4e8e\u8fd9\u4e9b\u503c\u8fc7\u6ee4\u6389\u7684\u5206\u7ec4\u3002 SELECT vend_id, COUNT(*) AS num_prods FROM products GROUP BY vend_id; SELECT cust_id, COUNT(*) AS orders FROM orders GROUP BY cust_id HAVING COUNT(*)>=2; SELECT vend_id, COUNT(*) AS num_prods FROM products WHERE prod_price>=10 GROUP BY vend_id HAVING COUNT(*)>=2; SELECT order_num, SUM(quantity*item_price) AS ordertotal FROM orderitems GROUP BY order_num HAVING SUM(quantity*item_price) ORDER BY ordertotal; \u5b50\u67e5\u8be2 \u2003\u5d4c\u5957\u5728\u5176\u4ed6\u67e5\u8be2\u4e2d\u7684\u67e5\u8be2\u3002 SELECT cust_name,cust_contact FROM customers WHERE cust_id IN ( SELECT cust_id FROM orders WHERE order_num IN ( SELECT order_num FROM orderitems WHERE prod_id='TNT2' ) ); SELECT cust_name, (SELECT COUNT(*) FROM orders WHERE orders.cust_id=customere.cust_id) AS num_orders FROM customers ORDER BY cust_name; \u8054\u7ed3 \u2003\u662f\u4e00\u79cd\u673a\u5236\uff0c\u7528\u4e8e\u5728SELECT\u4e2d\u5173\u8054\u8868\uff0c\u53ef\u4ee5\u8054\u7ed3\u591a\u4e2a\u8868\u8fd4\u56de\u4e00\u7ec4\u8f93\u51fa\uff0c\u8054\u7ed3\u5728\u8fd0\u884c\u65f6\u5173\u8054\u8868\u4e2d\u7684\u884c\u3002 # \u901a\u8fc7where\u5b50\u53e5\u5b9e\u73b0\u8054\u7ed3 SELECT vend_name, prod_name, prod_price FROM vendors, products WHERE vendors.vend_id=products.vend_id ORDER BY vend_nam, prod_name; # \u53c9\u8054\u7ed3/\u7b1b\u5361\u5c14\u79ef\uff0c\u7531\u6ca1\u6709\u8054\u7ed3\u5173\u7cfb\u7684\u8868\u8fd4\u56de\u7684\u7ed3\u679c\u4e3a\u7b1b\u5361\u5c14\u79ef # \u68c0\u7d22\u7684\u884c\u7684\u6570\u76ee\u5c06\u662f\u7b2c\u4e00\u4e2a\u8868\u7684\u884c\u6570\u4e58\u4ee5\u7b2c\u4e8c\u4e2a\u8868\u7684\u884c\u6570 SELECT vend_name, prod_name, prod_price FROM vendors, products ORDER BY vend_nam, prod_name; # \u7b49\u503c\u8054\u7ed3/\u5185\u90e8\u8054\u7ed3\uff0c\u57fa\u4e8e\u4e24\u4e2a\u8868\u4e4b\u95f4\u7684\u76f8\u7b49\u6d4b\u8bd5\uff0c\u901a\u8fc7where\u5b50\u53e5\u5b9e\u73b0\u7684\u5c31\u662f\u8fd9\u79cd\u8054\u7ed3 # \u4e0d\u8fc7\u4e5f\u53ef\u7528\u5176\u4ed6\u8bed\u6cd5(INNER JOIN)\u6765\u6307\u660e\u8054\u7ed3\u5173\u7cfb, \u6b64\u65f6\u53ea\u80fd\u7528ON\u4f20\u9012\u8054\u7ed3\u6761\u4ef6 SELECT vend_name, prod_name, prod_price FROM vendors INNER JOIN products ON vendors.vend_id=products.vend_id # \u8054\u7ed3\u591a\u4e2a\u8868\uff0cSQL\u5bf9\u4e8e\u8054\u7ed3\u7684\u8868\u6570\u91cf\u6ca1\u6709\u9650\u5236 # \u4e0b\u9762\u7528\u8054\u7ed3\u5b9e\u73b0\u4e4b\u524d\u7684\u5b50\u67e5\u8be2 SELECT cust_name, cust_contact FROM customers, orders, orderitems WHERE customers.cust_id=orders.cust_id AND orders.order_num=orderitems.order_num AND prod_id='TNT2'; # \u4f7f\u7528\u8868\u522b\u540d\uff0c\u7b80\u5316\u8bed\u53e5\uff0c\u8868\u522b\u540d\u53ea\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528\uff0c\u4e0d\u8fd4\u56de\u5ba2\u6237\u673a # \u8868\u522b\u540d\u5728 FROM \u5b50\u53e5\u4e2d\u5b9a\u4e49\uff0c\u53ef\u7528\u5728 SELECT\u3001WHERE\u3001ORDER BY \u7b49\u5b50\u53e5\u4e2d SELECT cust_name, cust_contact FROM customers AS c, orders AS o, orderitems AS oi WHERE c.cust_id=o.cust_id AND o.order_num=oi.order_num AND prod_id='TNT2'; # \u81ea\u8054\u7ed3\uff0c\u5728\u5355\u6761\u8bed\u53e5\u503c\u591a\u6b21\u5f15\u7528\u76f8\u540c\u7684\u8868 # \u901a\u8fc7\u8868\u522b\u540d\u6765\u907f\u514d\u4e8c\u4e49\u6027\uff0c\u4ece\u800c\u5c06\u540c\u4e00\u4e2a\u8868\u770b\u6210\u65b0\u8868\uff0c\u548c\u81ea\u8eab\u8054\u7ed3 # \u4e0b\u9762\u662f\u67e5\u8be2\u63d0\u4f9bDTNTR\u7684\u4f9b\u8d27\u5546\u63d0\u4f9b\u7684\u6240\u6709\u4ea7\u54c1 SELECT p1.prod_id, p1.prod_num FROM products AS p1, products AS p2 WHERE p1.vend_id=p2.vend_id AND p2.prod_id='DTNTR'; # \u5916\u90e8\u8054\u7ed3\uff0c\u8054\u7ed3\u5305\u542b\u4e86\u90a3\u4e9b\u5728\u76f8\u5173\u8868\u4e2d\u6ca1\u6709\u5173\u8054\u884c\u7684\u884c # \u4f8b\u5982\u7edf\u8ba1\u6bcf\u4e2a\u7528\u6237\u7684\u8ba2\u5355\uff0c\u5305\u62ec\u90a3\u4e9b\u6ca1\u6709\u8ba2\u5355\u7684\u7528\u6237(\u5176\u5728\u8ba2\u5355\u8868\u4e2d\u4e0d\u5b58\u5728\u5173\u8054\u7684\u884c) # OUTER JOIN\u6307\u660e\u5c5e\u4e8e\u5916\u90e8\u8054\u7ed3\uff0cLEFT\u6307\u660e\u662f\u5de6\u4fa7\u7684customers\u5305\u542b\u6240\u6709\u7684\u884c\uff1b # \u82e5\u662f\u4f7f\u7528 RIGHT\uff0c\u5219\u662f\u53f3\u4fa7\u7684order\u8868\u6240\u6709\u7684\u884c\uff0c\u8fd4\u56de\u7ed3\u679c\u662f\u90a3\u4e9b\u4e0b\u4e86\u8ba2\u5355\u7684\u7528\u6237\u7684\u884c\u3002 # order_num\u4ee3\u8868\u7684\u662f\u8ba2\u5355 id, \u800c\u975e\u6570\u91cf SELECT customers.cust_id, order_num FROM customers LEFT OUTER JOIN orders ON customers.cust_id=orders.cust_id; # \u4e0b\u9762\u5219\u662f\u7edf\u8ba1\u6bcf\u4e2a\u7528\u6237\u7684\u8ba2\u5355\u6570\u91cf\uff0c\u91c7\u7528\u805a\u96c6\u51fd\u6570\u7684\u5916\u90e8\u8054\u7ed3 SELECT customers.cust_id, COUNT(order_num) AS num_ord FROM customers LEFT OUTER JOIN orders ON customers.cust_id=orders.cust_id GROUP BY customers.cust_id; \u7ec4\u5408\u67e5\u8be2 \u2003\u5728\u5355\u4e2a\u67e5\u8be2\u4e2d\u4ece\u4e0d\u540c\u7684\u8868\u8fd4\u56de\u7c7b\u4f3c\u7ed3\u6784\u7684\u6570\u636e \u2003\u5bf9\u5355\u4e2a\u8868\u6267\u884c\u591a\u4e2a\u67e5\u8be2\uff0c\u6309\u5355\u4e2a\u67e5\u8be2\u8fd4\u56de\u6570\u636e \u53ef\u4f7f\u7528 UNION \u64cd\u4f5c\u7b26\u7ec4\u5408\u6570\u6761SQL\u67e5\u8be2\uff0c\u5176\u6548\u679c\u4e0e\u5177\u6709\u591a\u4e2aWHERE\u5b50\u53e5\u6761\u4ef6\u7684\u67e5\u8be2\u5b8c\u6210\u7684\u5de5\u4f5c\u76f8\u540c\uff0c\u5177\u4f53\u4f7f\u7528\u54ea\u79cd\u65b9\u5f0f\u7b80\u4fbf\u3001\u9ad8\u6548\u9700\u8981\u7ecf\u8fc7\u6d4b\u8bd5\u3002 UNION\u5fc5\u987b\u7531\u4e24\u6761\u6216\u591a\u6761SELECT\u8bed\u53e5\u7ec4\u6210\uff0c\u8bed\u53e5\u4e4b\u95f4\u901a\u8fc7UNION\u5206\u9694\uff1b UNION\u7684\u6bcf\u4e2a\u67e5\u8be2 \u5fc5\u987b\u5305\u542b\u76f8\u540c\u7684\u5217\u3001\u8868\u8fbe\u5f0f\u3001\u805a\u96c6\u51fd\u6570 \uff1b \u5217\u7c7b\u578b\u5fc5\u987b\u517c\u5bb9\uff0c\u5373DBMS\u53ef\u4ee5\u9690\u5f0f\u8f6c\u6362\u7684\u7c7b\u578b \u2003 UNION\u9ed8\u8ba4\u4f1a\u53bb\u9664\u591a\u6761\u67e5\u8be2\u8bed\u53e5\u8fd4\u56de\u4e2d\u91cd\u590d\u7684\u884c\uff0c\u4f7f\u7528UNION ALL\u53ef\u4ee5\u8fd4\u56de\u6240\u6709\u5339\u914d\u884c\uff0c\u5305\u62ec\u91cd\u590d\u884c\u3002 \u5bf9\u7ec4\u5408\u7ed3\u679c\u6392\u5e8f\uff0c\u53ea\u80fd\u5728\u6700\u540e\u4e00\u6761SELECT\u8bed\u53e5\u4e4b\u540e\u4f7f\u7528 ORDER BY\u3002 SELECT vend_id, prod_id, prod_price FROM proucts WHERE prod_price <=5 UNION SELECT vend_id, prod_id, prod_price FROM proucts WHERE vend_id in (1000, 1005); \u5168\u6587\u672c\u641c\u7d22 MyISAM\u5f15\u64ce\u652f\u6301\uff0c\u800cInnoDB\u4e0d\u652f\u6301\u3002 \u76f8\u8f83\u4e8e\u901a\u914d\u7b26\u548c\u6b63\u5219\u8868\u8fbe\u5f0f\u5c1d\u8bd5\u5339\u914d\u8868\u4e2d\u6240\u6709\u884c\uff0c\u65e0\u6cd5\u660e\u786e\u63a7\u5236\u5339\u914d\u6761\u4ef6\uff0c\u4ee5\u53ca\u4e0d\u80fd\u63d0\u4f9b\u667a\u80fd\u5316\u7684\u641c\u7d22\u7ed3\u679c\uff0c \u5168\u6587\u672c\u641c\u7d22\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002 \u542f\u7528\u5168\u6587\u672c\u641c\u7d22\uff0cMySQL\u4f1a\u521b\u5efa\u6307\u5b9a\u5217\u4e2d\u5404\u8bcd\u7684\u4e00\u4e2a\u7d22\u5f15\uff0c\u641c\u7d22\u65f6\u4f1a\u9488\u5bf9\u8fd9\u4e9b\u8bcd\u8fdb\u884c\u3002 \u2003 \u4e00\u822c\u5728\u521b\u5efa\u8868\u65f6\u542f\u7528\u5168\u6587\u672c\u641c\u7d22\uff0c CREATE TABLE productnotes( note_text text NULL, FULLTEXT(note_text) )ENGINE=MyISAM; FULLTEXT\u53ef\u4ee5\u7d22\u5f15\u591a\u4e2a\u5217\uff0c\u5b9a\u4e49\u4e4b\u540e\uff0cMySQL\u4f1a\u81ea\u52a8\u7ef4\u62a4\u7d22\u5f15\u3002\u4f7f\u7528Match()\u548cAgainst()\u6267\u884c\u5168\u6587\u672c\u641c\u7d22\u3002 \u5168\u6587\u672c\u641c\u7d22\u7684\u4e00\u4e2a\u91cd\u8981\u90e8\u5206\u5c31\u662f\u5bf9\u7ed3\u679c\u6392\u5e8f\uff0c\u5177\u6709\u8f83\u9ad8\u7b49\u7ea7\u7684\u884c\u5148\u8fd4\u56de # \u4f20\u9012\u7ed9Match()\u7684\u503c\u5fc5\u987b\u4e0eFULLTEXT\u4e2d\u7684\u5b9a\u4e49\u76f8\u540c\uff0c\u4e14\u6b21\u5e8f\u76f8\u540c\uff0c\u5373\u4f7f\u4e0d\u641c\u7d22\u67d0\u4e2a\u5217\uff0c\u4e5f\u8981\u5217\u51fa\u6765 # \u641c\u7d22\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u9664\u975e\u4f7f\u7528BINARY\u3002 SELECT note_text FROM productnotes WHERE Match(note_text) Against('rabbit'); \u67e5\u8be2\u6269\u5c55 SELECT note_text FROM productnotes WHERE Match(note_text) Against('anvils' WITH QUERY EXPANSION); \u5e03\u5c14\u6587\u672c\u641c\u7d22 # \u5339\u914d\u5305\u542banvils\u4f46\u4e0d\u5305\u542b\u4efb\u610f\u4ee5rope\u5f00\u5934\u7684\u8bcd\u7684\u884c SELECT note_text FROM productnotes WHERE Match(note_text) Against('anvils -rope*' IN BOOLEAN MODE); # \u5339\u914d\u77ed\u8bedrabbit bait\u800c\u975e\u4e24\u4e2a\u5355\u72ec\u7684\u5355\u8bcd SELECT note_text FROM productnotes WHERE Match(note_text) Against('\"rabbit bait\"' IN BOOLEAN MODE); # \u5339\u914dsafe\u548ccombination\uff0c\u4f46\u964d\u4f4e\u540e\u8005\u7684\u7b49\u7ea7 SELECT note_text FROM productnotes WHERE Match(note_text) Against('+safe +(<combination)' IN BOOLEAN MODE); \u6570\u636e\u63d2\u5165 # \u6309\u521b\u5efa\u8868\u65f6\u5217\u7684\u987a\u5e8f\uff0c\u63d2\u5165\u5217\u503c INSERT INTO tbl_name VALUES(..); # \u6839\u636e\u7b2c\u4e00\u4e2a()\u5185\u63d0\u4f9b\u7684\u5217\u540d\u6765\u9009\u62e9\u63d2\u5165\uff0c\u987a\u5e8f\u4e0d\u9700\u6309\u7167\u521b\u5efa\u987a\u5e8f\uff0c\u4e14\u53ef\u4ee5\u7701\u7565\u67d0\u4e9b\u5217(\u8981\u6c42\u8be5\u5217\u5141\u8bb8NULL\u6216\u8005\u6709\u9ed8\u8ba4\u503c) INSERT INTO tbl_name(col_name1, ..) VALUES(col_value1,..) # \u63d2\u5165\u591a\u884c, \u53ef\u4ee5\u4f7f\u7528\u591a\u6761INSERT\u8bed\u53e5\uff0c\u4e00\u6b21\u63d0\u4ea4\uff0c\u4e2d\u95f4\u7528\u2018;\u2019\u9694\u5f00, # \u6216\u8005\u5982\u4e0b, \u8981\u6c42INSERT\u8bed\u53e5\u4e2d\u5217\u540d\u548c\u6b21\u5e8f\u76f8\u540c\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6027\u80fd\u4e5f\u8981\u66f4\u597d INSERT INTO tbl_name(col_name1, ..) VALUES(col1_value,..), VALUES(col1_value2, ..); # \u63d2\u5165\u68c0\u7d22\u51fa\u7684\u6570\u636e, \u5c06\u4ece\u5176\u4ed6\u8868\u4e2d\u68c0\u7d22\u5230\u7684\u6570\u636e\u63d2\u5165\u8868\u4e2d # \u68c0\u7d22\u7684\u5217\u5bf9\u5e94\u88ab\u63d2\u5165\u8868\u7684\u6bcf\u4e00\u5217 INSERT INTO tbl_name(col_name, ..) SELECT tbl_nameX, .. FROM tbl_name_new WHERE ..; \u66f4\u65b0\u6570\u636e # IGNORE, \u5728\u66f4\u65b0\u591a\u884c\u65f6\uff0c\u5982\u679c\u67d0\u4e00\u884c\u66f4\u65b0\u9519\u8bef\uff0c\u4f7f\u7528IGNORE\u5173\u952e\u5b57\u53ef\u4ee5\u907f\u514d\u4e4b\u524d\u53d1\u751f\u66f4\u65b0\u7684\u884c\u6062\u590d\u5230\u539f\u503c UPDATE IGNORE tbl_name SET col_name='xx' col_name2='xx' WHERE ..; # \u82e5\u7f3a\u5c11WHERE\u5b50\u53e5\u5219\u4f1a\u66f4\u65b0\u6240\u6709\u884c # \u5220\u9664\u67d0\u4e9b\u884c\u7684\u4e00\u5217\u7684\u503c UPDATE tbl_name SET col_name=NULL WHERE ..; \u5220\u9664\u6570\u636e # \u5220\u9664\u7279\u5b9a\u7684\u884c, \u82e5\u60f3\u5220\u9664\u5217\uff0c\u9700\u8981\u901a\u8fc7UPDATE\u6765\u66f4\u65b0\u8be5\u5217\u503c\u4e3aNULL\u3002 DELETE FROM tbl_name; WHERE ..; # \u4ece\u8868\u4e2d\u5220\u9664\u6240\u6709\u884c\uff0c\u5b9e\u9645\u4e0a\u662f\u5220\u9664\u539f\u8868\uff0c\u5e76\u91cd\u65b0\u521b\u5efa\uff1b # DELETE FROM tbl_name;\u5219\u662f\u9010\u884c\u5220\u9664 TRUNCATE tbl_name; MySQL\u6ca1\u6709\u64a4\u9500\u64cd\u4f5c\uff0c\u5e94\u5341\u5206\u5c0f\u5fc3\u4f7f\u7528UPDATE\u548cDELETE \u521b\u5efa\u548c\u64cd\u4f5c\u8868 # cust_id \u548ccust_name\u4e24\u5217\u4e0d\u5141\u8bb8\u4e3a\u7a7a\uff1b # \u5176\u4e2dcust_id\u8bbe\u7f6e\u4e3a\u81ea\u589e\uff0c\u53ef\u4ee5\u5728\u63d2\u5165\u65f6\u4e0d\u63d0\u4f9b\u503c\uff0c\u7531MySQL\u81ea\u52a8\u63d0\u4f9b # \u6bcf\u4e2a\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u5217\u8bbe\u7f6eAUTO_INCREMENT # \u63d2\u5165\u65f6\u4e5f\u53ef\u4ee5\u4e3a\u8fd9\u6837\u7684\u5217\u8bbe\u7f6e\u4e00\u4e2a\u4ece\u672a\u7528\u8fc7\u7684\u503c\uff0c\u540e\u7eed\u5c06\u4ece\u65b0\u503c\u5f00\u59cb\u9012\u589e # \u4f7f\u7528last_insert_id()\u53ef\u4ee5\u83b7\u5f97\u6700\u540e\u4e00\u6b21\u9012\u589e\u5f97\u5230\u7684AUTO_INCREMENT\u503c\uff1b # \u53ef\u4ee5\u4f7f\u7528' DEFAULT xx '\u5728'NULL, '\u540e\uff0c\u4e3a\u8be5\u5217\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff1b CREATE TABLE customers IF NOT EXISTS # IF NOT EXISTS \u8868\u793a\u4ec5\u5728customers\u8868\u4e0d\u5b58\u5728\u65f6\u521b\u5efa\uff0c\u5426\u5219\u8df3\u8fc7 ( cust_id int NOT NULL AUTO_INCREMENT, cust_name char(50) NOT NULL , cust_address char(50) NULL , cust_city char(50) NULL , cust_state char(5) NULL , cust_zip char(10) NULL , cust_country char(50) NULL , cust_contact char(50) NULL , cust_email char(255) NULL , PRIMARY KEY (cust_id) # \u6307\u5b9a\u4e3b\u952e, \u62ec\u53f7\u5185\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5217 ) ENGINE=InnoDB; # \u901a\u8fc7 ALTER TABLE \u66f4\u65b0\u8868\uff0c\u53ef\u4ee5\u65b0\u589e\u5217\uff0c\u5220\u9664\u65e7\u5217(DROP COLUMN col_name)\uff0c\u4ee5\u53ca\u5b9a\u4e49\u5916\u952e ALTER TABLE tbl_name ADD col_name, col_type; # \u4e3atbl_name.col_name1\u65bd\u52a0\u5916\u952etbl_name2.col_name2\u7ea6\u675f ALTER TABLE tbl_name ADD CONSTRAINT fk_name FOREIGN KEY (col_name1) REFERENCES tbl_name2(col_name2); # \u5220\u9664\u5916\u952e ALTER TABLE tbl_name DROP FOREIGN KEY fk_name; # \u5220\u9664\u8868 DROP TABLE tbl_name; # \u91cd\u547d\u540d\u8868 RENAME TABLE old_tbl TO new_tbl, old_tbl2 TO new_tbl2; \u2003ENGINE:MySQL\u5e38\u7528\u7684\u5f15\u64ce\u5305\u62ecInnoDB(\u4e00\u79cd\u4e8b\u52a1\u5904\u7406\u5f15\u64ce\uff0c\u4e0d\u652f\u6301\u5168\u6587\u672c\u641c\u7d22)\u3001MyISAM(\u6027\u80fd\u6781\u9ad8\uff0c\u652f\u6301\u5168\u6587\u672c\u5904\u7406\uff0c\u4e0d\u652f\u6301\u4e8b\u52a1\u5904\u7406)\u3001MEMORY(\u529f\u80fd\u7b49\u540cMyISAM\uff0c\u4f46\u7531\u4e8e\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u800c\u975e\u78c1\u76d8\u4e2d\uff0c\u901f\u5ea6\u5f88\u5feb\uff0c\u9002\u7528\u4e8e\u4e34\u65f6\u8868)\uff0c\u5728\u4e00\u4e2a\u6570\u636e\u5e93\u4e2d\uff0c\u4e0d\u540c\u8868\u53ef\u4ee5\u91c7\u7528\u4e0d\u540c\u7684\u5f15\u64ce\u3002 \u8865\u5145 # SELECT \u53ef\u4ee5\u7701\u7565 FROM \u5b50\u53e5\u4ee5\u4fbf\u7b80\u5355\u8bbf\u95ee\u548c\u5904\u7406\u8868\u8fbe\u5f0f\uff0c\u4ece\u800c\u8fdb\u884c\u6d4b\u8bd5\u548c\u5b9e\u9a8c SELECT 2*3; # \u8fd4\u56de6 SELECT Trim(' abc '); # \u8fd4\u56de'abc' set names gbk; # \u8bbe\u7f6eMYSQL\u663e\u793a\u5b57\u7b26\u96c6\uff0cCMD\u9ed8\u8ba4\u7f16\u7801\u4e3aGBK\uff0c\u901a\u8fc7\u6b64\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u663e\u793a\u4e2d\u6587","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"MySQL/0_start/#_4","text":"\u89c6\u56fe\u662f\u865a\u62df\u7684\u8868\uff0c\u4e0e\u5305\u542b\u6570\u636e\u7684\u8868\u4e0d\u540c\uff0c\u89c6\u56fe\u53ea\u5305\u542b\u4f7f\u7528\u65f6\u52a8\u6001\u68c0\u7d22\u6570\u636e\u7684\u67e5\u8be2\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cdSELECT\u8bed\u53e5\u5c42\u6b21\u7684\u5c01\u88c5\uff0c\u7528\u4ee5\u7b80\u5316\u6570\u636e\u5904\u7406\u4ee5\u53ca\u91cd\u65b0\u683c\u5f0f\u5316\u57fa\u7840\u6570\u636e\u6216\u5305\u542b\u57fa\u7840\u6570\u636e\u3002 \u89c6\u56fe\u7684\u89c4\u5219\u548c\u9650\u5236 # \u521b\u5efa\u89c6\u56fe\uff0cproductcustomers\u8054\u7ed3\u4e09\u4e2a\u8868 CREATE VIEW productcustomers AS SELECT cust_name, cust_contact, prod_id FROM customers, orders, orderitems WHERE customers.cust_id=orders.cust_id AND orders.order_num=orderitems.order_num; # \u5220\u9664\u89c6\u56fe DROP VIEW viewname; # \u67e5\u770b\u521b\u5efa\u89c6\u56fe\u8bed\u53e5 SHOW CREEATE VIEW viewname; \u66f4\u65b0\u89c6\u56fe\uff1a\u53ef\u4ee5\u5bf9\u89c6\u56fe\u4f7f\u7528INSERT\u3001UPDATE \u3001DELETE\u6765\u8fdb\u884c\u66f4\u65b0(\u5b9e\u9645\u4e0a\u662f\u5728\u66f4\u65b0\u57fa\u8868)\uff0c\u4e0d\u8fc7\u5f53\u89c6\u56fe\u5b9a\u4e49\u4e2d\u5305\u542b\u4ee5\u4e0b\u64cd\u4f5c\u65f6\uff0c\u5219\u4e0d\u80fd\u8fdb\u884c\u66f4\u65b0: \u5206\u7ec4(GROUP BY\u548cHAVING)\u3001\u8054\u7ed3\u3001\u5b50\u67e5\u8be2\u3001\u5e76(UNION)\u3001\u805a\u96c6\u51fd\u6570\u3001DISTINCT\u3001\u5bfc\u51fa(\u8ba1\u7b97)\u5217","title":"\u89c6\u56fe"},{"location":"MySQL/0_start/#_5","text":"\u4fdd\u5b58\u7684\u4e00\u6761\u6216\u591a\u6761MySQL\u8bed\u53e5\u7684\u96c6\u5408\u3002 \u4f18\u70b9: CREATE PROCEDURE productpricing() # ()\u5185\u662f\u5b58\u50a8\u8fc7\u7a0b\u63a5\u6536\u7684\u53c2\u6570 BEGIN SELECT Avg(pord_price) AS priceaverage FROM products; END; # \u6ce8\u610f\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b\u7ed3\u675f\u65f6\u7684';'\u5c5e\u4e8e\u5b58\u50a8\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u4ee3\u8868MySQL\u8bed\u6cd5\u4e2d\u7684\u5206\u9694\u7b26\uff1b # \u4e00\u822c\u5728\u547d\u4ee4\u884c\u8fd0\u884cSQL\u8bed\u53e5\u65f6\u7ed3\u5c3e\u7684';'\u662f\u5219\u662f\u547d\u4ee4\u884c\u8bed\u53e5\u5206\u9694\u7b26\uff1b # \u5728\u547d\u4ee4\u884c\u4e2d\u521b\u5efa\u8fc7\u7a0b\u65f6\u5185\u90e8\u7684';'\u4e0d\u4f1a\u88ab\u89e3\u91ca\u4e3a\u5b58\u50a8\u8fc7\u7a0b\u7684\u6210\u5206\uff1b # \u53ef\u4ee5\u5728\u521b\u5efa\u524d\u91c7\u7528 DELIMETER \\\\ \u4e34\u65f6\u66f4\u6539\u547d\u4ee4\u884c\u8bed\u53e5\u5206\u9694\u7b26\u4e3a'\\\\' DELIMETER \\\\ CREATE PROCEDURE productpricing() # ()\u5185\u662f\u5b58\u50a8\u8fc7\u7a0b\u63a5\u6536\u7684\u53c2\u6570 BEGIN SELECT Avg(pord_price) AS priceaverage FROM products; END \\\\ DELIMETER ; # \u6062\u590d\u539f\u6765\u7684\u5206\u9694\u7b26 CALL productpricing(); # \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b DROP PROCEDURE pro_name IF EXISTS; # \u5220\u9664\u5b58\u50a8\u8fc7\u7a0b\uff0c \u540e\u9762\u7684IF EXISTS\u4fdd\u8bc1\u5220\u9664\u65f6\u5373\u4f7f\u4e0d\u5b58\u5728\u4e5f\u4e0d\u4f1a\u62a5\u9519 SHOW CREATE PROCEDURE pro_name; #\u663e\u793a\u5b58\u50a8\u8fc7\u7a0b\u521b\u5efa\u8bed\u53e5 SHOW PROCEDURE STATUS like 'pro_name'; # \u663e\u793a\u5b58\u50a8\u8fc7\u7a0b\u4fe1\u606f\u5217\u8868 \u4f7f\u7528\u53c2\u6570 \u2003\u53c2\u6570\u4f20\u9012\u7c7b\u578b: OUT(\u4ece\u5b58\u50a8\u8fc7\u7a0b\u4f20\u51fa\uff0c\u76f8\u5f53\u4e8e\u8fd4\u56de\u53d8\u91cf)\u3001IN(\u4f20\u9012\u7ed9\u5b58\u50a8\u8fc7\u7a0b\uff0c\u76f8\u5f53\u4e8e\u4f20\u5165\u53c2\u6570)\u3001INOUT(\u5bf9\u5b58\u50a8\u8fc7\u7a0b\u4f20\u5165\u3001\u4f20\u51fa\uff0c\u76f8\u5f53\u4e8e\u5f15\u7528\u53c2\u6570). (\u56e0\u6b64\u5b58\u50a8\u8fc7\u7a0b\u5176\u5b9e\u7c7b\u4f3c\u81ea\u5b9a\u4e49\u7684\u67e5\u8be2\u51fd\u6570) \u2003INTO\u628a\u68c0\u7d22\u7ed3\u679c\u4fdd\u5b58\u5230\u6307\u5b9a\u53d8\u91cf\u3002 \u2003\u56e0\u4e3a\u4e0d\u5141\u8bb8\u901a\u8fc7\u4e00\u4e2a\u53c2\u6570\u8fd4\u56de\u591a\u4e2a\u884c\u548c\u5217\uff0c\u56e0\u6b64\u524d\u9762\u8981\u91c7\u75283\u4e2a\u53c2\u6570\u3002 CALL productpricing( @pricelow, @pricehigh, @priceaverage ); # \u8c03\u7528\u540e\uff0c\u5e76\u4e0d\u663e\u793a\u7ed3\u679c\uff0c\u7ed3\u679c\u5b58\u50a8\u5728\u76f8\u5e94\u7684\u53d8\u91cf\u4e2d SELECT @pricelow; # \u663e\u793a\u7ed3\u679c CREATE PROCEDURE ordertotal( IN onumber INT, OUT total DECIMAL (8, 2) ) BEGIN SELECT Sum(quantity*item_price) FROM orderitems WHERE order_num=onumber INTO total; END; CALL ordertotal(20005, @total); SELECT @total; \u2003 --\u4ee3\u8868\u6ce8\u91ca\uff1bDECLARE\u5b9a\u4e49\u5c40\u90e8\u53d8\u91cf\uff0c\u6307\u5b9a\u53d8\u91cf\u540d\u548c\u6570\u636e\u7c7b\u578b\uff1b","title":"\u5b58\u50a8\u8fc7\u7a0b"},{"location":"MySQL/0_start/#_6","text":"\u3002\u3002\u3002","title":"\u6e38\u6807"},{"location":"MySQL/0_start/#_7","text":"\u5728\u8868\u53d1\u751f\u6539\u52a8\u4e14\u6ee1\u8db3\u54cd\u5e94\u6761\u4ef6\u65f6\u81ea\u52a8\u6267\u884c\uff0c\u53ea\u80fd\u4e3a\u54cd\u5e94DELETE\u3001INSERT\u3001UPDATE\u7684SQL\u8bed\u53e5\u6216\u8005\u4f4d\u4e8eBEGIN\u548cEND\u4e4b\u5185\u7684\u4e00\u7ec4\u8bed\u53e5\u3002 \u2003\u53ea\u6709\u8868\u624d\u652f\u6301TRIGGER\uff0cVIEW\u548c\u4e34\u65f6\u8868\u90fd\u4e0d\u652f\u6301\u3002 # \u89e6\u53d1\u5668\u540d\u6700\u597d\u5728\u6570\u636e\u5e93\u4e2d\u552f\u4e00(MySQL5\u5141\u8bb8\u4e0d\u540c\u7684\u8868\u6709\u76f8\u540c\u7684trigger name) # BEFORE \u548c AFTER\uff0c\u89e6\u53d1\u5668\u88ab\u89e6\u53d1\u7684\u65f6\u523b\u3002\u82e5\u5e0c\u671b\u9a8c\u8bc1\u65b0\u6570\u636e\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u4f7f\u7528 BEFORE \u9009\u9879\uff1b # \u82e5\u5e0c\u671b\u5728\u6fc0\u6d3b\u89e6\u53d1\u5668\u7684\u8bed\u53e5\u6267\u884c\u4e4b\u540e\u5b8c\u6210\u51e0\u4e2a\u6216\u66f4\u591a\u7684\u6539\u53d8\uff0c\u5219\u901a\u5e38\u4f7f\u7528 AFTER \u9009\u9879 # FOR EACH ROW \u4e00\u822c\u662f\u6307\u884c\u7ea7\u89e6\u53d1\uff0c\u5bf9\u4e8e\u53d7\u89e6\u53d1\u4e8b\u4ef6\u5f71\u54cd\u7684\u6bcf\u4e00\u884c\u90fd\u8981\u6fc0\u6d3b\u89e6\u53d1\u5668\u7684\u52a8\u4f5c # \u89e6\u53d1\u5668\u52a8\u4f5c\u4e3b\u4f53\uff0c\u5305\u542b\u89e6\u53d1\u5668\u6fc0\u6d3b\u65f6\u5c06\u8981\u6267\u884c\u7684 MySQL \u8bed\u53e5\u3002\u5982\u679c\u8981\u6267\u884c\u591a\u4e2a\u8bed\u53e5\uff0c\u53ef\u4f7f\u7528 BEGIN\u2026END \u590d\u5408\u8bed\u53e5\u7ed3\u6784 # \u6bcf\u4e2a\u8868\u6700\u591a\u652f\u63016\u4e2aTRIGGER(insert\\update\\delete\u7684before\u548cafter) CREATE <\u89e6\u53d1\u5668\u540d> < BEFORE | AFTER > <INSERT | UPDATE | DELETE > ON <\u8868\u540d> FOR EACH Row<\u89e6\u53d1\u5668\u4e3b\u4f53> # MySQL5\u4ee5\u540e\u4e0d\u5141\u8bb8TRIGGER\u8fd4\u56de\u7ed3\u679c\u96c6\uff0c\u8fd9\u91cc\u53ea\u80fd\u5c06\u7ed3\u679c\u8d4b\u7ed9\u53d8\u91cf CREATE TRIGGER newproduct AFTER INSERT ON products FOR EACH ROW SELECT 'Product added' INTO @result; SELECT @result; # \u5220\u9664\u89e6\u53d1\u5668 DROP TRIGGER tri_name; # \u5728INSERT TRIGGER\u4ee3\u7801\u5185\uff0c\u53ef\u5f15\u7528\u4e00\u4e2a\u540d\u4e3aNEW\u7684\u865a\u62df\u8868 # \u800c\u5728DELETE TRIGGER\u4ee3\u7801\u5185\uff0c\u53ef\u5f15\u7528\u4e00\u4e2a\u540d\u4e3aOLD\u7684\u865a\u62df\u8868\uff0c\u8bbf\u95ee\u88ab\u5220\u9664\u7684\u884c CREATE TRIGGER neworder AFTER INSERT ON orders FOR EACH ROW SELECT NEW.order_num INTO @result;","title":"\u89e6\u53d1\u5668"},{"location":"MySQL/0_start/#_8","text":"\u7528\u4ee5\u7ef4\u62a4\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\uff0c\u5b83\u4fdd\u8bc1\u6210\u6279\u7684MySQL\u64cd\u4f5c\u8981\u4e48\u5b8c\u5168\u6267\u884c\uff0c\u8981\u4e48\u5b8c\u5168\u4e0d\u6267\u884c\u3002 SELECT * FROM tbl; START TRANSACTION; # \u5f00\u59cb\u4e00\u4e2a\u4e8b\u7269\u5904\u7406 DELETE TABLE tbl; DELETE TABLE tbl2; ROLLBACK; # \u56de\u9000\u5230\u4e8b\u7269\u5f00\u59cb\u4e4b\u524d\uff0cSELECT\\CREATE\\DROP\u8fd9\u4e09\u79cd\u8bed\u53e5\u65e0\u6cd5\u56de\u9000 COMMIT; # \u624b\u52a8\u63d0\u4ea4\uff0c\u5982\u679c DELETE \u51fa\u9519,\u5219\u81ea\u52a8\u64a4\u9500\u63d0\u4ea4 # \u4f7f\u7528\u4fdd\u7559\u70b9\uff0c\u5b9e\u73b0\u90e8\u5206\u56de\u9000\uff0c \u4fdd\u7559\u70b9\u5728\u4e8b\u7269\u5904\u7406\u5b8c\u6210(ROLLBACK \u6216 commit)\u540e\u81ea\u52a8\u91ca\u653e SAVEPOINT pos1; ROLLBACK pos1; # pos1\u4e4b\u540e\u7684\u8bed\u53e5\u4e0d\u4f1a\u88ab\u6267\u884c # \u5173\u95ed\u9ed8\u8ba4\u63d0\u4ea4 SET autocommit=0;","title":"\u4e8b\u7269\u5904\u7406"},{"location":"MySQL/0_start/#_9","text":"\u5b57\u7b26\u96c6\u4e3a\u5b57\u6bcd\u548c\u7b26\u53f7\u7684\u96c6\u5408 \u2003\u7f16\u7801\u4e3a\u67d0\u4e2a\u5b57\u7b26\u96c6\u7684\u5185\u90e8\u8868\u793a \u2003\u6821\u5bf9\u4e3a\u89c4\u5b9a\u5b57\u7b26\u5982\u4f55\u6bd4\u8f83\u7684\u6307\u4ee4, \u5728ORDER BY\\GROUP BY\u7b49\u68c0\u7d22\u6392\u5e8f\u65f6\u6709\u7528\u3002 SHOW CHARACTER SET; SHOW COLLATION; # \u663e\u793a\u6821\u5bf9\u5217\u8868 # \u786e\u5b9a\u6570\u636e\u5e93\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u548c\u6821\u5bf9 SHOW VARIABLES LIKE 'character%'; SHOW VARIABLES LIKE 'collation%'; #\u5728\u521b\u5efa\u8868\u65f6\u6307\u5b9a\u5b57\u7b26\u96c6\u6216\u8005\u6821\u5bf9\uff0c\u751a\u81f3\u5141\u8bb8\u5bf9\u5217\u8fdb\u884c\u8bbe\u7f6e CREATE TABLE tbl{ xx, column VARCHAR(10) CHARACTER SET BIG5 COLLATE big5_chinese_ci }DEFAULT CHARACTER SET latine COLLATE xx; # \u53ef\u4ee5\u5728SELECT\u65f6\u6307\u5b9a\u4e0e\u521b\u5efa\u65f6\u4e0d\u540c\u7684\u6821\u5bf9 SELECT * FROM tbl ORDER BY x COLLATE XX;","title":"\u5b57\u7b26\u96c6\u548c\u6821\u5bf9\u987a\u5e8f"},{"location":"MySQL/0_start/#_10","text":"# IDENTIFIED BY 'p@$$w0rd' \u6307\u5b9a\u7528\u6237\u767b\u5f55\u5bc6\u7801(\u6216\u79f0\u53e3\u4ee4) CREATE USER name IDENTIFIED BY 'p@$$w0rd'; RENAME USER old_name TO new_name; DROP USER name; # \u67e5\u770b\u7528\u6237\u8d26\u53f7\u6743\u9650, host\u8868\u793a\u4e3b\u673a\u540d\uff0c\u53ea\u63d0\u4f9busername\u65f6\uff0c\u5219\u9ed8\u8ba4\u4e3b\u673a\u540d\u4e3a%\uff0c\u8868\u793a\u4e0d\u7ba1\u4e3b\u673a\u540d SHOW GRANTS FOR username@host; SHOW GRANTS FOR root@localhost; # \u6388\u4e88\u7528\u6237\u6743\u9650; \u6388\u4e88\u7528\u6237\u5728db_name\u7684\u6240\u6709\u8868\u4e0a\u67e5\u8be2\u7684\u6743\u9650 GRANT SELECT ON db_name.* TO username; # \u64a4\u9500\u6743\u9650 REVOKE SELECT ON db_name.* FROM username; # \u66f4\u6539\u5bc6\u7801 SET PASSWORD FOR username = Password('new password');","title":"\u7ba1\u7406\u7528\u6237"},{"location":"Network/1_application/","text":"\u7f51\u7edc\u5e94\u7528\u5c42 \u5e94\u7528\u7a0b\u5e8f\u4f53\u7cfb\u7ed3\u6784 \u5ba2\u6237-\u670d\u52a1\u5668\u4f53\u7cfb\u7ed3\u6784(client-server, CS) p2p\u7ed3\u6784: \u5bf9\u4f4d\u4e8e\u6570\u636e\u4e2d\u5fc3\u7684\u4e13\u7528\u670d\u52a1\u5668\u6709\u5f88\u5c0f\u6216\u4e0d\u9700\u4f9d\u8d56\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u95f4\u65ad\u8fde\u63a5\u7684\u4e3b\u673a\u5bf9\u4e4b\u95f4\u4f7f\u7528\u76f4\u63a5\u901a\u4fe1\uff0c\u8fd9\u4e9b\u4e3b\u673a\u79f0\u4e3a\u5bf9\u7b49\u65b9\u3002 \u76ee\u524d\u8bb8\u591a\u6d41\u91cf\u5bc6\u96c6\u578b\u7684\u5e94\u7528\u90fd\u662fP2P\u4f53\u7cfb\u7ed3\u6784\uff0c\u4f8b\u5982\u6587\u4ef6\u5171\u4eab\u3001\u5bf9\u7b49\u65b9\u534f\u52a9\u4e0b\u8f7d\u52a0\u901f\u5668(\u8fc5\u96f7\u7b49)\u3002 \u2003 \u4e5f\u6709\u5e94\u7528\u662f\u5177\u6709\u6df7\u5408\u7684\u4f53\u7cfb\u7ed3\u6784\u3002\u4f8b\u5982\u5373\u65f6\u8baf\u606f\u5e94\u7528\uff0c\u670d\u52a1\u5668\u88ab\u7528\u4e8e\u8ddf\u8e2a\u7528\u6237\u7684IP\u5730\u5740\uff0c\u4f46\u7528\u6237\u548c\u7528\u6237\u4e4b\u95f4\u7684\u62a5\u6587\u5728\u7528\u6237\u4e3b\u673a\u4e4b\u95f4(\u65e0\u9700\u901a\u8fc7\u4e2d\u95f4\u670d\u52a1\u5668)\u76f4\u63a5\u53d1\u9001\u3002 \u7f51\u7edc\u5e94\u7528\u8fdb\u7a0b\u901a\u4fe1 \u2003\u5ba2\u6237\u8fdb\u7a0b: \u53d1\u8d77\u901a\u4fe1\u7684\u8fdb\u7a0b\uff1b \u670d\u52a1\u5668\u8fdb\u7a0b\uff1a\u7b49\u5f85\u901a\u4fe1\u8bf7\u6c42\u7684\u8fdb\u7a0b\u3002 socket\u5957\u63a5\u5b57: \u5e94\u7528\u7a0b\u5e8f\u548c\u7f51\u7edc\u4e4b\u95f4\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3; \u56e0\u6b64\u8fdb\u7a0b\u901a\u8fc7socket\u5411\u7f51\u7edc\u53d1\u9001\u62a5\u6587\u548c\u63a5\u6536\u62a5\u6587\u3002 \u8fdb\u7a0b\u5bfb\u5740: \u4f20\u8f93\u5c42\u534f\u8bae\u63d0\u4f9b\u670d\u52a1: \u53ef\u9760\u6570\u636e\u4f20\u8f93\u3001\u541e\u5410\u91cf\u3001\u5b9a\u65f6(\u65f6\u5ef6)\u3001\u5b89\u5168\u6027(\u4f20\u8f93\u5c42\u534f\u8bae\u80fd\u591f\u52a0\u5bc6\u53d1\u9001\u8fdb\u7a0b\u4f20\u8f93\u7684\u6240\u6709\u6570\u636e\uff1b\u4e5f\u80fd\u5728\u5c06\u6570\u636e\u4ea4\u4ed8\u7ed9\u63a5\u6536\u8fdb\u7a0b\u524d\u89e3\u5bc6\u6570\u636e\uff0c\u4f20\u8f93\u5c42\u8fd8\u63d0\u4f9b\u6570\u636e\u5b8c\u6574\u6027\u548c\u7aef\u70b9\u9274\u522b\u7684\u5b89\u5168\u6027\u670d\u52a1)\u3002 Internet\u4e3a\u4f20\u8f93\u5c42\u63d0\u4f9b\u4e24\u4e2a\u534f\u8bae\uff0c\u5176\u4e2dTCP\u534f\u8bae\u53ef\u4ee5\u63d0\u4f9b \u53ef\u9760\u6570\u636e\u4f20\u8f93\u548c\u5b89\u5168\u6027(\u901a\u8fc7Secure Socket Layer\u5b9e\u73b0) \uff0c\u4f46TCP\u548cUDP\u5747\u4e0d\u63d0\u4f9b\u541e\u5410\u91cf\u548c\u65f6\u5ef6\u7684\u4fdd\u8bc1\u3002 \u4f55\u8c13\u201c\u8fde\u63a5\u201d TCP\u901a\u8baf\uff0c\u901a\u8fc7\u4e09\u6b21\u63e1\u624b\uff0c\u5728\u5ba2\u6237\u7aef\u8fdb\u7a0b\u548c\u670d\u52a1\u5668\u8fdb\u7a0b\u95f4\u5efa\u7acb\u4e00\u4e2a\u957f\u671f\u8fde\u63a5\uff0c \u4fdd\u8bc1\u4e24\u8005\u4e4b\u95f4\u7684\u6570\u636e\u53ef\u4ee5\u6b63\u786e\u53d1\u9001\u548c\u63a5\u6536\uff0c\u901a\u8fc7\u552f\u4e00\u7684\u7aef\u53e3\u53f7\uff0c\u786e\u4fdd\u6bcf\u6b21\u63a5\u6536\u5230\u6765\u81ea\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u7684\u6570\u636e\u3002 \u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u95f4\u4f20\u8f93\u6570\u636e\u65f6\uff0c\u4e24\u65b9\u9700\u8981\u7ef4\u62a4\u8fde\u63a5\u7684\u72b6\u6001\u3002 UDP\u901a\u8baf\uff0c\u5e76\u6ca1\u6709\u63e1\u624b\u8fc7\u7a0b\uff0c\u6bcf\u4e2a\u5ba2\u6237\u7aef\u7aef\u53e3\u548c\u670d\u52a1\u5668\u7aef\u53e3\u4e4b\u95f4\u7684\u8fde\u63a5\u662f\u77ed\u671f\u7684\uff0c \u5e76\u4e0d\u4fdd\u8bc1\u53d1\u9001\u7684\u6570\u636e\u4e00\u5b9a\u88ab\u63a5\u53d7\u5230\uff1b \u4e14\u6bcf\u6b21\u5411\u4e00\u4e2a\u670d\u52a1\u5668\u7aef\u53e3\u53d1\u8d77\u7533\u8bf7\uff0c\u7136\u540e\u4e0b\u4e00\u6b21\u53ef\u4ee5\u5411\u53e6\u5916\u4e00\u4e2a\u670d\u52a1\u5668\u7aef\u53e3\u7533\u8bf7\u63a5\u6536\u6570\u636e\uff1b \u56e0\u6b64\u4e00\u4e2audp\u670d\u52a1\u5668\u7aef\u53e3\u53ef\u4ee5\u4e00\u6bb5\u65f6\u95f4\u5185\u63a5\u53d7\u591a\u4e2a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c \u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u4e5f\u53ef\u4ee5\u77ed\u65f6\u95f4\u5185\u63a5\u6536\u591a\u4e2a\u670d\u52a1\u7aef\u53d1\u6765\u7684\u6570\u636e\u3002 \u5e94\u7528\u5c42\u534f\u8bae\u5b9a\u4e49: WEB\u5e94\u7528 http: \u2003web\u7684\u5e94\u7528\u5c42\u534f\u8bae\u662fHTTP(HyperText Transfer Protocol)\u534f\u8bae\uff1b\u5ba2\u6237\u673a\u548c\u670d\u52a1\u5668\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u7aef\u7cfb\u7edf\u4e2d\uff0c\u901a\u8fc7\u4ea4\u6362HTTP\u62a5\u6587\u8fdb\u884c\u4f1a\u8bdd\u3002HTTP\u5b9a\u4e49\u4e86web\u5ba2\u6237\u5411web\u670d\u52a1\u5668\u8bf7\u6c42web\u9875\u9762\u7684\u683c\u5f0f\uff0c\u4ee5\u53caweb\u670d\u52a1\u5668\u5411\u5ba2\u6237\u53d1\u9001web\u9875\u9762\u7684\u65b9\u5f0f\u3002 HTTP\u4f7f\u7528TCP\u4f5c\u4e3a\u4f20\u8f93\u5c42\u534f\u8bae: \u6301\u4e45\u6027\u8fde\u63a5\u548c\u975e\u6301\u4e45\u6027\u8fde\u63a5 \u975e\u6301\u4e45\u6027\u8fde\u63a5: \u6bcf\u4e2a\u4e2aTCP\u8fde\u63a5\u53ea\u5141\u8bb8\u4f20\u8f93\u4e00\u4e2a\u5bf9\u8c61\uff1b \u6301\u4e45\u6027\u8fde\u63a5: \u6bcf\u4e2aTCP\u8fde\u63a5\u5141\u8bb8\u4f20\u8f93\u591a\u4e2a\u5bf9\u8c61\u3002 http\u6d88\u606f\u683c\u5f0f: HTTP\u6709\u4e24\u79cd\u62a5\u6587: \u8bf7\u6c42\u62a5\u6587\u548c\u54cd\u5e94\u62a5\u6587 \u8bf7\u6c42\u62a5\u6587 : \u8bf7\u6c42\u62a5\u6587\u7531ASCII\u6587\u672c\u5199\u6210; Host: xx, \u6307\u660e\u4e86\u5bf9\u8c61\u6240\u5728\u4e3b\u673a\uff0c\u8be5\u9996\u90e8\u884c\u4fe1\u606f\u662fWeb\u4ee3\u7406\u9ad8\u901f\u7f13\u5b58\u6240\u8981\u6c42\u7684; Connection:close, \u544a\u8bc9\u670d\u52a1\u5668\u4e0d\u5e0c\u671b\u4f7f\u7528\u6301\u7eed\u6027\u8fde\u63a5\uff0c\u8981\u6c42\u670d\u52a1\u5668\u5728\u53d1\u9001\u5b8c\u88ab\u8bf7\u6c42\u7684\u5bf9\u8c61\u540e\u5c31\u5173\u95ed\u8fd9\u6761\u8fde\u63a5; keep-alive\uff1a\u8868\u793a\u4f7f\u7528\u6301\u4e45\u6027\u8fde\u63a5 User-agent, \u6307\u660e\u7528\u6237\u4ee3\u7406\uff0c\u5373\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u7684\u6d4f\u89c8\u5668\u7c7b\u578b\uff0c \u56e0\u6b64\u670d\u52a1\u5668\u53ef\u4ee5\u6709\u6548\u5730\u4e3a\u4e0d\u540c\u7c7b\u578b\u7684\u7528\u6237\u4ee3\u7406\u5b9e\u9645\u53d1\u9001\u76f8\u540c\u5bf9\u8c61\u7684\u4e0d\u540c\u7248\u672c(\u6bcf\u4e2a\u7248\u672c\u90fd\u7531\u76f8\u540c\u7684URL\u5bfb\u5740); Accept-lanuage, \u7528\u6237\u671f\u671b\u5f97\u5230\u7684\u5bf9\u8c61\u7684\u8bed\u8a00\u7248\u672c\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u670d\u52a1\u5668\u4f1a\u53d1\u9001\u9ed8\u8ba4\u7248\u672c\u3002 method get: \u4ece\u670d\u52a1\u5668\u83b7\u53d6\u8d44\u6e90\uff0c\u5982\u9759\u6001\u6587\u672c\u3001\u56fe\u7247\u3001\u89c6\u9891\u7b49\uff0c\u6d4f\u89c8\u5668\u53ef\u4ee5\u5bf9get\u8bf7\u6c42\u7684\u6570\u636e\u8fdb\u884c\u7f13\u5b58\uff1b get\u8bf7\u6c42\u53ef\u4ee5\u5c06\u53c2\u6570(querystring)\u901a\u8fc7URL\u4f20\u9012\uff0c\u4e14\u8bf7\u6c42\u53c2\u6570\u662f\u53ef\u89c1\u7684\uff1b post: \u63d0\u4ea4\u8868\u5355, \u5411\u670d\u52a1\u5668\u4f20\u8f93\u8d44\u6e90\uff0c\u8868\u5355\u6570\u636e\u88ab\u7f16\u7801\u5728\u62a5\u6587\u7684body\u4e2d\uff1b post\u4e00\u4e2a\u8868\u5355\u65f6\uff0curl\u4e5f\u53ef\u4ee5\u5e26\u4e0a\u53c2\u6570\uff0c\u4f46\u9700\u8981\u63d0\u4f9bquerystring post\u8bf7\u6c42\u8fd4\u56de\u7684\u8d44\u6e90\u4e0d\u53ef\u4ee5\u88ab\u7f13\u5b58\uff0cpost\u8bf7\u6c42\u4e5f\u4e0d\u80fd\u4f5c\u4e3a\u4e66\u7b7e\u4fdd\u5b58 \u54cd\u5e94\u62a5\u6587 : \u72b6\u6001\u7801 : 200 OK\u662f\u6700\u5e38\u2ec5\u7684\u6210\u529f\u72b6\u6001\u7801\uff0c\u8868\u793a\u2f00\u5207\u6b63\u5e38\u3002\u5982\u679c\u662f\u2faeHEAD\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u5934\u90fd\u4f1a\u6709body\u6570\u636e. 204 No Content\u4e5f\u662f\u5e38\u2ec5\u7684\u6210\u529f\u72b6\u6001\u7801\uff0c\u4e0e 200 OK \u57fa\u672c\u76f8\u540c\uff0c\u4f46\u54cd\u5e94\u5934\u6ca1\u6709 body \u6570\u636e. 206 Partial Content\u662f\u5e94\u2f64\u4e8e HTTP \u5206\u5757\u4e0b\u8f7d\u6216\u65ad\u70b9\u7eed\u4f20\uff0c\u8868\u793a\u54cd\u5e94\u8fd4\u56de\u7684 body \u6570\u636e\u5e76\u4e0d\u662f\u5168\u90e8\u8d44\u6e90\uff0c \u2f7d\u662f\u5176\u4e2d\u7684\u2f00\u90e8\u5206\uff0c\u4e5f\u662f\u670d\u52a1\u5668\u5904\u7406\u6210\u529f\u7684\u72b6\u6001\u3002 301 Moved Permanently,\u6c38\u4e45\u79fb\u52a8\u3002\u8bf7\u6c42\u7684\u8d44\u6e90\u5df2\u88ab\u6c38\u4e45\u7684\u79fb\u52a8\u5230\u65b0URI\uff0c\u8fd4\u56de\u4fe1\u606f\u4f1a\u5305\u62ec\u65b0\u7684URI\uff0c \u6d4f\u89c8\u5668\u4f1a\u81ea\u52a8\u5b9a\u5411\u5230\u65b0URI\u3002\u4eca\u540e\u4efb\u4f55\u65b0\u7684\u8bf7\u6c42\u90fd\u5e94\u4f7f\u7528\u65b0\u7684URI\u4ee3\u66ff. 302 Found,\u4e34\u65f6\u79fb\u52a8\u3002\u4e0e301\u7c7b\u4f3c\u3002\u4f46\u8d44\u6e90\u53ea\u662f\u4e34\u65f6\u88ab\u79fb\u52a8\u3002\u5ba2\u6237\u7aef\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709URI. 304 Not Modified,\u672a\u4fee\u6539\u3002\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u672a\u4fee\u6539\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u72b6\u6001\u7801\u65f6\uff0c\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u8d44\u6e90\u3002 \u5ba2\u6237\u7aef\u901a\u5e38\u4f1a\u7f13\u5b58\u8bbf\u95ee\u8fc7\u7684\u8d44\u6e90\uff0c\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e2a\u5934\u4fe1\u606f\u6307\u51fa\u5ba2\u6237\u7aef\u5e0c\u671b\u53ea\u8fd4\u56de\u5728\u6307\u5b9a\u65e5\u671f\u4e4b\u540e\u4fee\u6539\u7684\u8d44\u6e90. 305 Use Proxy,\u4f7f\u7528\u4ee3\u7406\u3002\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u5fc5\u987b\u901a\u8fc7\u4ee3\u7406\u8bbf\u95ee. 400 Bad Request \u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u8bed\u6cd5\u9519\u8bef\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u7406\u89e3. 401 Unauthorized,\u8bf7\u6c42\u8981\u6c42\u7528\u6237\u7684\u8eab\u4efd\u8ba4\u8bc1. 403 Forbidden, \u670d\u52a1\u5668\u7406\u89e3\u8bf7\u6c42\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u4f46\u662f\u62d2\u7edd\u6267\u884c\u6b64\u8bf7\u6c42. 404 Not Found, \u8868\u793a\u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u670d\u52a1\u5668\u4e0a\u4e0d\u5b58\u5728\u6216\u672a\u627e\u5230\uff0c\u6240\u4ee5\u2f46\u6cd5\u63d0\u4f9b\u7ed9\u5ba2\u6237\u7aef. 405 Method Not Allowed \u5ba2\u6237\u7aef\u8bf7\u6c42\u4e2d\u7684\u65b9\u6cd5\u88ab\u7981\u6b62. 501 Not Implemented \u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u7684\u529f\u80fd\uff0c\u65e0\u6cd5\u5b8c\u6210\u8bf7\u6c42 502 Bad Gateway \u4f5c\u4e3a\u7f51\u5173\u6216\u8005\u4ee3\u7406\u5de5\u4f5c\u7684\u670d\u52a1\u5668\u5c1d\u8bd5\u6267\u884c\u8bf7\u6c42\u65f6\uff0c\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u65e0\u6548\u7684\u54cd\u5e94 503 Service Unavailable \u7531\u4e8e\u8d85\u8f7d\u6216\u7cfb\u7edf\u7ef4\u62a4\uff0c\u670d\u52a1\u5668\u6682\u65f6\u7684\u65e0\u6cd5\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u3002 504 Gateway Time-out\uff0c\u5145\u5f53\u7f51\u5173\u6216\u4ee3\u7406\u7684\u670d\u52a1\u5668\uff0c\u672a\u53ca\u65f6\u4ece\u8fdc\u7aef\u670d\u52a1\u5668\u83b7\u53d6\u8bf7\u6c42 505 HTTP Version not supported \u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u7684HTTP\u534f\u8bae\u7684\u7248\u672c\uff0c\u65e0\u6cd5\u5b8c\u6210\u5904\u7406 entity body\u5305\u542b\u4e86\u6240\u8bf7\u6c42\u5bf9\u8c61\u672c\u8eab; content-type \u6307\u793a\u4e86entity\u4e2d\u5bf9\u8c61\u7684\u7c7b\u578b\u3002 http\u53d1\u5c55 http1.0\u91c7\u7528\u7684\u662f\u975e\u6301\u7eed\u6027\u8fde\u63a5\uff0c\u6bcf\u4e2aTCP\u8fde\u63a5\u53ea\u5141\u8bb8\u4f20\u8f93\u4e00\u4e2a\u5bf9\u8c61\uff1b http1.1\u9ed8\u8ba4\u91c7\u7528\u7684\u662f\u6301\u7eed\u6027\u8fde\u63a5(\u4e5f\u79f0\u957f\u8fde\u63a5\uff0c\u8bf7\u6c42\u62a5\u6587\u4e2d\u7684\u9996\u90e8\u4fe1\u606fconnection\u9ed8\u8ba4\u4e3akeep-alive)\uff0c \u6bcf\u4e2aTCP\u8fde\u63a5\u5141\u8bb8\u4f20\u8f93\u591a\u4e2a\u5bf9\u8c61\uff0c\u540c\u65f6\u4f7f\u7528\u7ba1\u9053\u6280\u672f(\u79f0\u4e3aPipelining\uff0c\u4e5f\u79f0\u4f5c\u6d41\u6c34\u7ebf)\uff0c \u5728\u7b49\u5f85\u4e0a\u4e00\u4e2a\u8bf7\u6c42\u54cd\u5e94\u7684\u540c\u65f6\uff0c\u53d1\u9001\u4e0b\u4e00\u4e2a\u8bf7\u6c42\uff0c\u800c\u5728\u53d1\u9001\u8fc7\u7a0b\u4e2d\u4e0d\u9700\u8981\u7b49\u5f85\u670d\u52a1\u5668\u5bf9\u524d\u4e00\u4e2a\u8bf7\u6c42\u7684\u54cd\u5e94\u3002 http1.1\u7f3a\u70b9: http1.1\u89c4\u5219\u89c4\u5b9a\uff0c\u670d\u52a1\u5668\u7aef\u5728\u54cd\u5e94\u65f6\uff0c\u8981\u4e25\u683c\u6309\u7167\u63a5\u6536\u8bf7\u6c42\u7684\u987a\u5e8f\u53d1\u9001\u54cd\u5e94\uff0c\u5373\u5148\u63a5\u6536\u5230\u7684\u8bf7\u6c42\uff0c \u9700\u8981\u5148\u53d1\u9001\u5176\u54cd\u5e94\uff0c\u5ba2\u6237\u7aef\u4e5f\u662f\u5982\u6b64\uff0c\u63a5\u6536\u54cd\u5e94\u7684\u987a\u5e8f\u8981\u6309\u7167\u81ea\u5df1\u53d1\u9001\u8bf7\u6c42\u7684\u987a\u5e8f\u3002 \u56e0\u6b64 \u5982\u679c\u670d\u52a1\u5668\u6536\u5230\u7684\u7b2c\u4e00\u4e2a\u8bf7\u6c42\uff0c\u9700\u8981\u5f88\u957f\u7684\u5904\u7406\u65f6\u95f4\uff0c\u5219\u5bf9\u4e8e\u540e\u9762\u5df2\u7ecf\u5904\u7406\u5b8c\u54cd\u5e94\u7684\u8bf7\u6c42\u6765\u8bf4\uff0c \u5b83\u4eec\u53ea\u80fd\u963b\u585e\u7b49\u5f85\uff0c\u7b49\u5f85\u524d\u9762\u7684\u54cd\u5e94\u53d1\u9001\u5b8c\u540e\uff0c\u624d\u80fd\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u9020\u6210\u4e86\u201c\u961f\u9996\u963b\u585e\u201d\u95ee\u9898 \u3002 \u53ef\u89c1\u961f\u9996\u963b\u585e\u53d1\u751f\u5728\u670d\u52a1\u5668\u7aef\u3002\u56e0\u6b64\u5ba2\u6237\u7aef\u5728\u9700\u8981\u53d1\u8d77\u591a\u6b21\u8bf7\u6c42\u65f6\uff0c\u901a\u5e38\u4f1a\u91c7\u7528\u591a\u4e2aTCP\u8fde\u63a5\u6765\u51cf\u5c11\u5ef6\u8fdf\u3002 (\u4e0d\u540c\u6d4f\u89c8\u5668\u5141\u8bb8\u7684\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\u662f\u4e0d\u540c\u7684) \u6b64\u5916\u8fd8\u6709\u53ea\u80fd\u5ba2\u6237\u7aef\u5355\u5411 \u5411\u670d\u52a1\u5668\u53d1\u8d77\u8bf7\u6c42\u83b7\u5f97\u54cd\u5e94\u3001\u8bf7\u6c42\u62a5\u6587\u4e0e\u54cd\u5e94\u62a5\u6587\u9996\u90e8\u4fe1\u606f\u5197\u4f59\u91cf\u5927\uff0c \u5e76\u4e14\u672a\u91c7\u7528\u6570\u636e\u538b\u7f29\uff0c\u5bfc\u81f4\u4f20\u8f93\u91cf\u5927\u3002 http2.0\u6539\u8fdb: \u2003\u4e8c\u8fdb\u5236\u5206\u5e27: \u4e0d\u540c\u4e8ehttp1.x\u4e2d\u901a\u8fc7\u6587\u672c\u7684\u5f62\u5f0f\u4f20\u8f93\u6570\u636e\uff0chttp2.0\u5f15\u5165\u65b0\u7684\u7f16\u7801\u673a\u5236\uff0c \u5c06\u6240\u6709\u4f20\u8f93\u7684\u4fe1\u606f\u5206\u4e3a\u66f4\u5c0f\u7684\u6d88\u606f\u548c\u5e27\uff0c\u91c7\u7528\u4e8c\u8fdb\u5236\u683c\u5f0f\u7f16\u7801\uff0c\u7ec4\u6210\u4e8c\u8fdb\u5236\u5e27\u5c42 \u5176\u4e2dHTTP1.x\u7684\u9996\u90e8\u4fe1\u606f\u4f1a\u88ab\u5c01\u88c5\u5230Headers\u5e27\uff0c\u800cRequest Body\u5219\u5c01\u88c5\u5230Data\u5e27\u3002 \u56e0\u4e3a\u6bcf\u4e2a\u5e27\u90fd\u6709\u7f16\u53f7\uff0c\u4e8c\u8fdb\u5236\u5e27\u6570\u636e\u6d41\u53ef\u4ee5\u5230\u8fbe\u53e6\u4e00\u7aef\u540e\u518d\u6839\u636e\u5e27\u7684\u7f16\u53f7\u8fdb\u884c\u7ec4\u88c5\u3002 \u2003\u591a\u8def\u590d\u7528: \u5141\u8bb8\u540c\u65f6\u901a\u8fc7\u5355\u4e00\u7684TCP\u8fde\u63a5\u53d1\u8d77\u591a\u91cd\u7684\u8bf7\u6c42-\u54cd\u5e94\u6d88\u606f\uff0c \u539f\u56e0:\u4e8c\u8fdb\u5236\u5e27\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u7684TCP\u8fde\u63a5\u4e0a\u662f\u4ee5\u5b57\u8282\u6d41\u7684\u65b9\u5f0f\u53cc\u5411\u4f20\u8f93\u7684\uff0c\u7531\u4e8e\u7f16\u7801\u548c\u5c01\u88c5\u65b9\u5f0f\uff0c\u4e0d\u540c\u7684\u5e27\u4e92\u4e0d\u5e72\u6270\uff0c \u56e0\u6b64\u53ef\u4ee5\u5e76\u884c\u53d1\u9001\u591a\u4e2a\u4ea4\u9519\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u5b9e\u73b0\u4e86 \u7ba1\u9053\u591a\u8def\u590d\u7528 \uff1b\u53ea\u8981\u5f53\u524dTCP\u8fde\u63a5\u53ef\u7528\uff0c\u5c31\u53ef\u4ee5\u53d1\u9001\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c \u6d88\u9664\u4e86HTTP/1.1\u4e2d\u8bf7\u6c42\u548c\u54cd\u5e94\u987a\u5e8f\u5bf9\u5e94\u7684\u5173\u7cfb\u3002 \u2003\u5934\u90e8\u538b\u7f29: \u91c7\u7528HPACK\u7b97\u6cd5\u5bf9header\u4fe1\u606f\u8fdb\u884c\u538b\u7f29\u7f16\u7801\uff0c\u63d0\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\u3002 \u5177\u4f53\u4e3a: \u5982\u679c\u540c\u65f6\u53d1\u51fa\u591a\u4e2a\u8bf7\u6c42\uff0c\u5b83\u4eec\u7684\u5934\u662f\u2f00\u6837\u7684\u6216\u662f\u76f8\u4f3c\u7684\uff0c\u90a3\u4e48\u534f\u8bae\u4f1a\u6d88\u9664\u91cd\u590d\u7684\u90e8\u5206\u3002 HPACK\u4f7f\u75282\u4e2a\u7d22\u5f15\u8868(\u9759\u6001\u3001\u52a8\u6001\u7d22\u5f15\u8868)\u6765\u628a\u5934\u90e8(\u5305\u542bheader name\u548cheader value)\u6620\u5c04\u5230\u7d22\u5f15\u503c\uff0c \u5e76\u5bf9\u4e0d\u5b58\u5728\u7684\u5934\u90e8\u4f7f\u7528 huffman \u7f16\u7801\uff0c\u5e76\u52a8\u6001\u7f13\u5b58\u5230\u7d22\u5f15\uff0c\u4ece\u800c\u8fbe\u5230\u538b\u7f29\u5934\u90e8\u7684\u6548\u679c\u3002 \u9759\u6001\u7d22\u5f15\u8868: \u9884\u5148\u5b9a\u4e49\u597d\u7684\u5185\u5bb9\uff0c\u53ea\u6709\u56fa\u5b9a\u7684\u51e0\u5341\u4e2a\u503c\uff0c\u5982\u679c\u8981\u53d1\u9001\u7684\u503c\u7b26\u5408\u9759\u6001\u8868\u65f6\uff0c\u7528\u5bf9\u5e94\u7684 Index \u66ff\u6362\u5373\u53ef. \u52a8\u6001\u7d22\u5f15\u8868:\u662f\u4e00\u4e2a\u7531FIFO\u961f\u5217\u7ef4\u62a4\u7684\u6709\u7a7a\u95f4\u9650\u5236\u7684\u8868\uff0c\u540c\u6837\u7ef4\u62a4\u7684\u662f\u5934\u90e8\u4e0e\u5bf9\u5e94\u7684\u7d22\u5f15\u3002 \u6bcf\u4e2a\u52a8\u6001\u8868\u53ea\u9488\u5bf9\u4e00\u4e2a\u8fde\u63a5\uff0c\u6bcf\u4e2a\u8fde\u63a5\u7684\u538b\u7f29\u89e3\u538b\u7f29\u7684\u4e0a\u4e0b\u6587\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u52a8\u6001\u8868\u3002 \u5f53\u4e00\u4e2a\u5934\u90e8\u6ca1\u6709\u51fa\u73b0\u8fc7\u7684\u65f6\u5019\uff0c\u4f1a\u628a\u5b83\u63d2\u5165\u52a8\u6001\u8868\u4e2d\uff0c\u4e0b\u6b21\u540c\u540d\u7684\u503c\u5c31\u53ef\u80fd\u4f1a\u5728\u8868\u4e2d\u67e5\u627e\u5230\u7d22\u5f15\u5e76\u66ff\u6362\u6389\u5934\u90e8\u3002 \u2003\u670d\u52a1\u5668\u63a8\u9001: \u4e3a\u4e86\u6539\u5584\u5ef6\u8fdf\uff0cHTTP2.0\u5f15\u5165\u4e86server push\uff0c\u5b83\u5141\u8bb8\u670d\u52a1\u7aef\u4e3b\u52a8\u63a8\u9001\u8d44\u6e90\u7ed9\u6d4f\u89c8\u5668\uff0c \u4f8b\u5982\u5728\u6d4f\u89c8\u5668\u521a\u8bf7\u6c42 HTML \u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u5c31\u63d0\u524d\u628a\u53ef\u80fd\u4f1a\u2f64\u5230\u7684 JS\u3001CSS \u2f42\u4ef6\u7b49\u9759\u6001\u8d44\u6e90\u4e3b\u52a8\u53d1\u7ed9 \u5ba2\u6237\u7aef\uff0c\u51cf\u5c11\u7b49\u5f85\u65f6\u95f4\u3002 http2.0\u7f3a\u70b9: \u591a\u4e2aHTTP\u8bf7\u6c42\u5728\u590d\u2f64\u2f00\u4e2aTCP\u8fde\u63a5\uff0c\u4e0b\u5c42\u7684TCP\u534f\u8bae\u662f\u4e0d\u77e5\u9053\u6709\u591a\u5c11\u4e2aHTTP\u8bf7\u6c42\u7684\u3002 \u6240\u4ee5\u2f00\u65e6\u53d1\u2f63\u4e86\u4e22\u5305\u73b0\u8c61\uff0c\u5c31\u4f1a\u89e6\u53d1TCP\u7684\u91cd\u4f20\u673a\u5236\uff0c\u8fd9\u6837\u5728\u2f00\u4e2aTCP\u8fde\u63a5\u4e2d\u7684\u6240\u6709\u7684HTTP\u8bf7\u6c42 \u90fd\u5fc5\u987b\u7b49\u5f85\u8fd9\u4e2a\u4e22\u4e86\u7684\u5305\u88ab\u91cd\u4f20\u56de\u6765\u3002 http3.0: \u53c8\u79f0\u4e3aHTTP Over QUIC\uff0c\u5176\u5f03\u7528TCP\u534f\u8bae\uff0c\u6539\u4e3a\u4f7f\u7528\u57fa\u4e8eUDP\u534f\u8bae\u7684 QUIC(Quick UDP Internet Protocol)\u534f\u8bae\u6765\u5b9e\u73b0. \u5982\u4f55\u5904\u7406\u4e22\u5305: \u2003\u524d\u5411\u7ea0\u9519: QUIC\u534f\u8bae\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u9664\u4e86\u672c\u8eab\u7684\u6570\u636e\u4ee5\u5916\uff0c\u4f1a\u5e26\u6709\u5176\u4ed6\u6570\u636e\u5305\u7684\u90e8\u5206\u6570\u636e\uff0c\u5728\u5c11\u91cf\u4e22\u5305\u7684\u60c5\u51b5\u4e0b\uff0c \u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6570\u636e\u5305\u7684\u5197\u4f59\u6570\u636e\u5b8c\u6210\u6570\u636e\u7ec4\u88c5\u800c\u65e0\u9700\u91cd\u4f20\uff0c\u4ece\u800c\u63d0\u9ad8\u6570\u636e\u7684\u4f20\u8f93\u901f\u5ea6\u3002 \u2003\u5feb\u901f\u91cd\u542f\u4f1a\u8bdd: \u666e\u901a\u57fa\u4e8etcp\u7684\u8fde\u63a5\uff0c\u662f\u57fa\u4e8e\u4e24\u7aef\u7684ip\u548c\u7aef\u53e3\u548c\u534f\u8bae\u6765\u5efa\u7acb\u7684\u3002\u5728\u7f51\u7edc\u5207\u6362\u573a\u666f\uff0c\u4f8b\u5982\u624b\u673a\u7aef\u5207\u6362\u4e86\u65e0\u7ebf\u7f51\uff0c \u4f7f\u75284G\u7f51\u7edc\uff0c\u4f1a\u6539\u53d8\u672c\u8eab\u7684ip\uff0c\u8fd9\u5c31\u5bfc\u81f4tcp\u8fde\u63a5\u5fc5\u987b\u91cd\u65b0\u521b\u5efa\u3002\u800cQUIC\u534f\u8bae\u4f7f\u7528\u7279\u6709\u7684UUID\u6765\u6807\u8bb0\u6bcf\u4e00\u6b21\u8fde\u63a5\uff0c \u5728\u7f51\u7edc\u73af\u5883\u53d1\u751f\u53d8\u5316\u7684\u65f6\u5019\uff0c\u53ea\u8981UUID\u4e0d\u53d8\uff0c\u5c31\u80fd\u4e0d\u9700\u8981\u63e1\u624b\uff0c\u7ee7\u7eed\u4f20\u8f93\u6570\u636e\u3002 cookie \u2003cookie\u53ef\u4ee5\u7528\u4e8e\u6807\u8bb0\u4e00\u4e2a\u7528\u6237\uff0c\u7528\u6237\u9996\u6b21\u8bbf\u95ee\u4e00\u4e2a\u7ad9\u70b9\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u7528\u6237\u6807\u8bc6\uff0c\u5728\u540e\u7ee7\u4f1a\u8bdd\u4e2d\uff0c \u6d4f\u89c8\u5668\u5411\u670d\u52a1\u5668\u4f20\u9012\u4e00\u4e2acookie\u9996\u90e8\uff0c\u4ece\u800c\u5411\u8be5\u670d\u52a1\u5668\u6807\u8bc6\u4e86\u7528\u6237\u3002\u56e0\u6b64cookie\u53ef\u4ee5\u5728\u65e0\u72b6\u6001\u7684http\u4e4b\u4e0a\u5efa\u7acb\u4e00\u4e2a\u7528\u6237\u4f1a\u8bdd\u5c42 \u3002 Web\u7f13\u5b58/\u4ee3\u7406\u670d\u52a1\u5668\u6280\u672f \u2003\u5728\u4e0d\u8bbf\u95ee\u670d\u52a1\u5668\u7684\u524d\u63d0\u4e0b\u6ee1\u8db3\u5ba2\u6237\u7aef\u7684HTTP\u8bf7\u6c42\uff0cweb\u7f13\u5b58\u5668\u6709\u81ea\u5df1\u7684\u78c1\u76d8\u5b58\u50a8\u7a7a\u95f4\uff0c\u5e76\u5728\u5b58\u50a8\u7a7a\u95f4\u4e2d\u4fdd\u5b58\u6700\u8fd1\u8bf7\u6c42\u8fc7\u7684\u5bf9\u8c61\u7684\u526f\u672c\u3002 \u2003\u4e3a\u4e86\u786e\u4fdd\u7f13\u5b58\u670d\u52a1\u5668\u4e2d\u7684\u5bf9\u8c61\u662f\u6700\u65b0\u7684\uff0cHTTP\u63d0\u4f9b\u4e86\u6761\u4ef6GET\u65b9\u6cd5\u3002 \u7f13\u5b58\u670d\u52a1\u5668\u5728\u5c06\u5bf9\u8c61\u8f6c\u53d1\u5230\u8bf7\u6c42\u7684\u6d4f\u89c8\u5668\u7684\u540c\u65f6\uff0c\u4e5f\u5728\u672c\u5730\u7f13\u5b58\u4e86\u5bf9\u8c61\uff0c\u5e76\u4e14\u5b58\u50a8\u4e86\u8be5\u5bf9\u8c61\u7684\u6700\u540e\u4fee\u6539\u65f6\u671f\u3002 \u6587\u4ef6\u4f20\u8f93\u534f\u8bae(FTP) \u8fde\u63a5\u8fc7\u7a0b \u4e0eHTTP\u533a\u522b Email\u5e94\u7528 Email\u5e94\u7528\u7ec4\u6210\u4e0eSMTP \u2003 SMTP: Simple Mail Transport Protocol(\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae) SMTP\u4e0eHTTP\u4e0d\u540c \u2003HTTP is a pull protocol, \u5373\u7528\u6237\u4f7f\u7528HTTP\u4ece\u670d\u52a1\u5668\u4e0a\u62c9\u53d6\u4fe1\u606f\uff0cTCP\u8fde\u63a5\u662f\u7531\u63a5\u6536\u65b9\u53d1\u8d77\u7684\uff1b SMTP is a push protocol, \u5373\u53d1\u9001\u90ae\u4ef6\u670d\u52a1\u5668\u628a\u6587\u4ef6\u63a8\u5411\u63a5\u6536\u90ae\u4ef6\u670d\u52a1\u5668\uff0c TCP\u8fde\u63a5\u662f\u7531\u53d1\u9001\u65b9\u53d1\u8d77\u7684\u3002 \u2003SMTP\u62a5\u6587\u4f7f\u75287bit ASCII\u683c\u5f0f\uff0cHTTP\u4e0d\u53d7\u6b64\u9650\u5236\u3002 \u2003 \u5728\u5904\u7406\u5305\u542b\u591a\u4e2a\u5bf9\u8c61\u65f6(\u5982\u5305\u542b\u6587\u672c\u548c\u56fe\u7247\u7684\u6587\u6863)\uff0cHTTP\u4f1a\u628a\u6bcf\u4e2a\u5bf9\u8c61\u5c01\u88c5\u5230\u5404\u81ea\u7684HTTP\u54cd\u5e94\u62a5\u6587\u4e2d\uff0c\u800cSMTP\u5219\u628a\u6240\u6709\u62a5\u6587\u5bf9\u8c61\u653e\u5728\u4e00\u4e2a\u62a5\u6587\u4e2d \u3002 \u90ae\u4ef6\u8bbf\u95ee\u534f\u8bae \u2003\u90ae\u4ef6\u4f20\u8f93\u8fc7\u7a0b: \u53d1\u9001\u65b9\u7528\u6237\u4ee3\u7406->\u53d1\u9001\u65b9\u90ae\u4ef6\u670d\u52a1\u5668->\u63a5\u6536\u65b9\u90ae\u4ef6\u670d\u52a1\u5668->\u63a5\u6536\u65b9\u7528\u6237\u4ee3\u7406 \u2003\u91c7\u7528\u53d1\u9001\u65b9\u90ae\u4ef6\u670d\u52a1\u5668\u4f5c\u4e3a\u4e2d\u7ee7\uff0c\u901a\u8fc7\u6d88\u606f\u961f\u5217\uff0c\u5b58\u50a8\u53d1\u9001\u65b9\u53d1\u51fa\u7684\u90ae\u4ef6\uff0c\u53ef\u4ee5\u907f\u514d\u63a5\u6536\u65b9\u90ae\u4ef6\u670d\u52a1\u5668\u4e0d\u5728\u7ebf\u65f6\uff0c\u76f4\u63a5\u901a\u8fc7\u7528\u6237\u4ee3\u7406\uff0c\u65e0\u6cd5\u5230\u8fbe\u63a5\u6536\u65b9\uff1b\u53d1\u9001\u65b9\u90ae\u4ef6\u670d\u52a1\u5668\u4f1a\u5b9a\u65f6\u67e5\u8be2\u8fde\u63a5\uff0c\u4e00\u65e6\u8fde\u63a5\uff0c\u5c31\u5c06\u90ae\u4ef6\u4f20\u8f93\u5230\u63a5\u6536\u65b9\u670d\u52a1\u5668\u3002 \u2003\u4f20\u8f93\u8fc7\u7a0b\u7684\u524d\u4e24\u90e8\u5206\u91c7\u7528SMTP\u534f\u8bae\uff0c\u800c\u6700\u540e\u4e00\u90e8\u5206\u4e0d\u80fd\u91c7\u7528SMTP\u534f\u8bae\uff0c\u56e0\u4e3a\u53ea\u80fd\u7531\u7528\u6237\u4ee3\u7406\u4e3b\u52a8\u63a5\u6536\u90ae\u4ef6\uff0c\u800c\u8fd9\u662f\u4e00\u4e2apull\u52a8\u4f5c\uff0c\u9700\u8981\u901a\u8fc7\u90ae\u4ef6\u8bbf\u95ee\u534f\u8bae\u6765\u4ece\u63a5\u6536\u65b9\u670d\u52a1\u5668\u63a5\u6536\u90ae\u4ef6\u3002 \u2003POP3(Post Office Protocol v3)\u534f\u8bae: authorization(\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u53e3\u4ee4)\u3001\u4e8b\u7269\u5904\u7406(\u53d6\u56de\u62a5\u6587\u5373\u90ae\u4ef6\uff0c\u5bf9\u62a5\u6587\u6dfb\u52a0\u5220\u9664\u6807\u8bb0)\u3001\u66f4\u65b0(\u4f1a\u8bdd\u7ed3\u675f\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u5220\u9664\u88ab\u6807\u8bb0\u4e3a\u5220\u9664\u7684\u62a5\u6587)\u3002 \u2003IMAP(Internet Mail Access Protocol)\u534f\u8bae \u4ee5\u53ca HTTP\u534f\u8bae(\u5982web mail, \u6d4f\u89c8\u5668\u5145\u5f53\u7528\u6237\u4ee3\u7406\uff0c\u901a\u8fc7HTTP\u4e0e\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u4e0d\u8fc7\u90ae\u4ef6\u670d\u52a1\u4e4b\u95f4\u4ecd\u662f\u901a\u8fc7SMTP\u534f\u8bae)\u3002 MMIE DNS(Domain Name System) \u2003\u6307\u4e00\u4e2a\u7531\u591a\u5c42\u57df\u540d\u670d\u52a1\u5668\u6784\u6210\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u91c7\u7528\u96c6\u4e2d\u5f0fDNS\u7f3a\u70b9: \u5355\u70b9\u5931\u8d25(\u5373\u82e5\u552f\u4e00\u7684DNS\u670d\u52a1\u5668\u6545\u969c\uff0c\u5219\u6574\u4e2aINTERNET\u5c06\u5d29\u6e83)\u3001\u6d41\u91cf\u95ee\u9898(\u9ad8\u5e76\u53d1\u67e5\u8be2)\u3001\u8ddd\u79bb\u95ee\u9898(\u5355\u4e2aDNS server\u4e0d\u53ef\u80fd\u90bb\u8fd1\u6240\u6709\u67e5\u8be2\u5ba2\u6237)\u3001\u7ef4\u62a4\u6027\u95ee\u9898(\u5355\u4e00\u6570\u636e\u5e93\u7ef4\u62a4\u548c\u66f4\u65b0\u5de8\u5927\u7684\u67e5\u8be2\u8bb0\u5f55)\u3002 \u2003\u4e5f\u6307\u4e00\u4e2a\u4f7f\u5f97\u4e3b\u673a\u80fd\u591f\u67e5\u8be2\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7684\u5e94\u7528\u5c42\u534f\u8bae(DNS\u534f\u8bae)\u3002 \u2003DNS\u534f\u8bae\u5b8c\u6210Internet\u6838\u5fc3\u4efb\u52a1\uff0c\u5c06\u57df\u540d\u6620\u5c04\u4e3aIP\u5730\u5740\u3002 \u8fd0\u884c\u5728UDP\u4e0a\uff0c\u4f7f\u752853\u53f7\u7aef\u53e3 \u3002 DNS\u670d\u52a1 \u57df\u540d\u89e3\u6790\u3001\u4e3b\u673a\u522b\u540d\u3001\u90ae\u4ef6\u670d\u52a1\u5668\u522b\u540d\u3001\u8d1f\u8f7d\u5747\u8861\u3002 \u67e5\u8be2 \u8fed\u4ee3\u67e5\u8be2\u548c\u9012\u5f52\u67e5\u8be2 DNS\u7f13\u5b58 \u2003\u53ea\u8981DNS\u670d\u52a1\u5668\u63a5\u6536\u4e00\u4e2aDNS\u56de\u7b54(\u57df\u540d-IP\u7684\u6620\u5c04)\uff0c\u5373\u7f13\u5b58\u8be5\u56de\u7b54\uff1b\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u7f13\u5b58\u6761\u76ee\u4f1a\u5931\u6548(\u88ab\u5220\u9664)\uff1b\u672c\u5730DNS\u670d\u52a1\u5668\u4e00\u822c\u4f1a\u7f13\u5b58\u9876\u7ea7\u57df\u540d\u670d\u52a1\u5668\u7684\u6620\u5c04\uff0c\u56e0\u6b64DNS \u6839\u670d\u52a1\u5668\u5f88\u5c11\u88ab\u8bbf\u95ee\u3002 DNS\u8bb0\u5f55\u548c\u62a5\u6587 \u2003TTL\u4ee3\u8868\u8be5\u8bb0\u5f55\u7684\u751f\u5b58\u65f6\u95f4\uff0c\u5b83\u51b3\u5b9a\u4e86\u8d44\u6e90\u8bb0\u5f55(Resource Record)\u5e94\u5f53\u88ab\u5220\u9664\u7684\u65f6\u95f4 P2P\u5e94\u7528 \u7ed3\u6784\u7279\u70b9 P2P\u7d22\u5f15 \u7d22\u5f15\u7ed3\u6784 socket\u7f16\u7a0b\u57fa\u7840 socket socket API\u51fd\u6570 \u5ba2\u6237\u7aef/\u670d\u52a1\u5668\u7aef","title":"application"},{"location":"Network/1_application/#_1","text":"","title":"\u7f51\u7edc\u5e94\u7528\u5c42"},{"location":"Network/1_application/#_2","text":"\u5ba2\u6237-\u670d\u52a1\u5668\u4f53\u7cfb\u7ed3\u6784(client-server, CS) p2p\u7ed3\u6784: \u5bf9\u4f4d\u4e8e\u6570\u636e\u4e2d\u5fc3\u7684\u4e13\u7528\u670d\u52a1\u5668\u6709\u5f88\u5c0f\u6216\u4e0d\u9700\u4f9d\u8d56\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u95f4\u65ad\u8fde\u63a5\u7684\u4e3b\u673a\u5bf9\u4e4b\u95f4\u4f7f\u7528\u76f4\u63a5\u901a\u4fe1\uff0c\u8fd9\u4e9b\u4e3b\u673a\u79f0\u4e3a\u5bf9\u7b49\u65b9\u3002 \u76ee\u524d\u8bb8\u591a\u6d41\u91cf\u5bc6\u96c6\u578b\u7684\u5e94\u7528\u90fd\u662fP2P\u4f53\u7cfb\u7ed3\u6784\uff0c\u4f8b\u5982\u6587\u4ef6\u5171\u4eab\u3001\u5bf9\u7b49\u65b9\u534f\u52a9\u4e0b\u8f7d\u52a0\u901f\u5668(\u8fc5\u96f7\u7b49)\u3002 \u2003 \u4e5f\u6709\u5e94\u7528\u662f\u5177\u6709\u6df7\u5408\u7684\u4f53\u7cfb\u7ed3\u6784\u3002\u4f8b\u5982\u5373\u65f6\u8baf\u606f\u5e94\u7528\uff0c\u670d\u52a1\u5668\u88ab\u7528\u4e8e\u8ddf\u8e2a\u7528\u6237\u7684IP\u5730\u5740\uff0c\u4f46\u7528\u6237\u548c\u7528\u6237\u4e4b\u95f4\u7684\u62a5\u6587\u5728\u7528\u6237\u4e3b\u673a\u4e4b\u95f4(\u65e0\u9700\u901a\u8fc7\u4e2d\u95f4\u670d\u52a1\u5668)\u76f4\u63a5\u53d1\u9001\u3002","title":"\u5e94\u7528\u7a0b\u5e8f\u4f53\u7cfb\u7ed3\u6784"},{"location":"Network/1_application/#_3","text":"\u5ba2\u6237\u8fdb\u7a0b: \u53d1\u8d77\u901a\u4fe1\u7684\u8fdb\u7a0b\uff1b \u670d\u52a1\u5668\u8fdb\u7a0b\uff1a\u7b49\u5f85\u901a\u4fe1\u8bf7\u6c42\u7684\u8fdb\u7a0b\u3002 socket\u5957\u63a5\u5b57: \u5e94\u7528\u7a0b\u5e8f\u548c\u7f51\u7edc\u4e4b\u95f4\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u7a0b\u63a5\u53e3; \u56e0\u6b64\u8fdb\u7a0b\u901a\u8fc7socket\u5411\u7f51\u7edc\u53d1\u9001\u62a5\u6587\u548c\u63a5\u6536\u62a5\u6587\u3002 \u8fdb\u7a0b\u5bfb\u5740: \u4f20\u8f93\u5c42\u534f\u8bae\u63d0\u4f9b\u670d\u52a1: \u53ef\u9760\u6570\u636e\u4f20\u8f93\u3001\u541e\u5410\u91cf\u3001\u5b9a\u65f6(\u65f6\u5ef6)\u3001\u5b89\u5168\u6027(\u4f20\u8f93\u5c42\u534f\u8bae\u80fd\u591f\u52a0\u5bc6\u53d1\u9001\u8fdb\u7a0b\u4f20\u8f93\u7684\u6240\u6709\u6570\u636e\uff1b\u4e5f\u80fd\u5728\u5c06\u6570\u636e\u4ea4\u4ed8\u7ed9\u63a5\u6536\u8fdb\u7a0b\u524d\u89e3\u5bc6\u6570\u636e\uff0c\u4f20\u8f93\u5c42\u8fd8\u63d0\u4f9b\u6570\u636e\u5b8c\u6574\u6027\u548c\u7aef\u70b9\u9274\u522b\u7684\u5b89\u5168\u6027\u670d\u52a1)\u3002 Internet\u4e3a\u4f20\u8f93\u5c42\u63d0\u4f9b\u4e24\u4e2a\u534f\u8bae\uff0c\u5176\u4e2dTCP\u534f\u8bae\u53ef\u4ee5\u63d0\u4f9b \u53ef\u9760\u6570\u636e\u4f20\u8f93\u548c\u5b89\u5168\u6027(\u901a\u8fc7Secure Socket Layer\u5b9e\u73b0) \uff0c\u4f46TCP\u548cUDP\u5747\u4e0d\u63d0\u4f9b\u541e\u5410\u91cf\u548c\u65f6\u5ef6\u7684\u4fdd\u8bc1\u3002 \u4f55\u8c13\u201c\u8fde\u63a5\u201d TCP\u901a\u8baf\uff0c\u901a\u8fc7\u4e09\u6b21\u63e1\u624b\uff0c\u5728\u5ba2\u6237\u7aef\u8fdb\u7a0b\u548c\u670d\u52a1\u5668\u8fdb\u7a0b\u95f4\u5efa\u7acb\u4e00\u4e2a\u957f\u671f\u8fde\u63a5\uff0c \u4fdd\u8bc1\u4e24\u8005\u4e4b\u95f4\u7684\u6570\u636e\u53ef\u4ee5\u6b63\u786e\u53d1\u9001\u548c\u63a5\u6536\uff0c\u901a\u8fc7\u552f\u4e00\u7684\u7aef\u53e3\u53f7\uff0c\u786e\u4fdd\u6bcf\u6b21\u63a5\u6536\u5230\u6765\u81ea\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u7684\u6570\u636e\u3002 \u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u95f4\u4f20\u8f93\u6570\u636e\u65f6\uff0c\u4e24\u65b9\u9700\u8981\u7ef4\u62a4\u8fde\u63a5\u7684\u72b6\u6001\u3002 UDP\u901a\u8baf\uff0c\u5e76\u6ca1\u6709\u63e1\u624b\u8fc7\u7a0b\uff0c\u6bcf\u4e2a\u5ba2\u6237\u7aef\u7aef\u53e3\u548c\u670d\u52a1\u5668\u7aef\u53e3\u4e4b\u95f4\u7684\u8fde\u63a5\u662f\u77ed\u671f\u7684\uff0c \u5e76\u4e0d\u4fdd\u8bc1\u53d1\u9001\u7684\u6570\u636e\u4e00\u5b9a\u88ab\u63a5\u53d7\u5230\uff1b \u4e14\u6bcf\u6b21\u5411\u4e00\u4e2a\u670d\u52a1\u5668\u7aef\u53e3\u53d1\u8d77\u7533\u8bf7\uff0c\u7136\u540e\u4e0b\u4e00\u6b21\u53ef\u4ee5\u5411\u53e6\u5916\u4e00\u4e2a\u670d\u52a1\u5668\u7aef\u53e3\u7533\u8bf7\u63a5\u6536\u6570\u636e\uff1b \u56e0\u6b64\u4e00\u4e2audp\u670d\u52a1\u5668\u7aef\u53e3\u53ef\u4ee5\u4e00\u6bb5\u65f6\u95f4\u5185\u63a5\u53d7\u591a\u4e2a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c \u4e00\u4e2a\u5ba2\u6237\u7aef\u63a5\u53e3\u4e5f\u53ef\u4ee5\u77ed\u65f6\u95f4\u5185\u63a5\u6536\u591a\u4e2a\u670d\u52a1\u7aef\u53d1\u6765\u7684\u6570\u636e\u3002 \u5e94\u7528\u5c42\u534f\u8bae\u5b9a\u4e49:","title":"\u7f51\u7edc\u5e94\u7528\u8fdb\u7a0b\u901a\u4fe1"},{"location":"Network/1_application/#web","text":"http: \u2003web\u7684\u5e94\u7528\u5c42\u534f\u8bae\u662fHTTP(HyperText Transfer Protocol)\u534f\u8bae\uff1b\u5ba2\u6237\u673a\u548c\u670d\u52a1\u5668\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u7aef\u7cfb\u7edf\u4e2d\uff0c\u901a\u8fc7\u4ea4\u6362HTTP\u62a5\u6587\u8fdb\u884c\u4f1a\u8bdd\u3002HTTP\u5b9a\u4e49\u4e86web\u5ba2\u6237\u5411web\u670d\u52a1\u5668\u8bf7\u6c42web\u9875\u9762\u7684\u683c\u5f0f\uff0c\u4ee5\u53caweb\u670d\u52a1\u5668\u5411\u5ba2\u6237\u53d1\u9001web\u9875\u9762\u7684\u65b9\u5f0f\u3002 HTTP\u4f7f\u7528TCP\u4f5c\u4e3a\u4f20\u8f93\u5c42\u534f\u8bae: \u6301\u4e45\u6027\u8fde\u63a5\u548c\u975e\u6301\u4e45\u6027\u8fde\u63a5 \u975e\u6301\u4e45\u6027\u8fde\u63a5: \u6bcf\u4e2a\u4e2aTCP\u8fde\u63a5\u53ea\u5141\u8bb8\u4f20\u8f93\u4e00\u4e2a\u5bf9\u8c61\uff1b \u6301\u4e45\u6027\u8fde\u63a5: \u6bcf\u4e2aTCP\u8fde\u63a5\u5141\u8bb8\u4f20\u8f93\u591a\u4e2a\u5bf9\u8c61\u3002 http\u6d88\u606f\u683c\u5f0f: HTTP\u6709\u4e24\u79cd\u62a5\u6587: \u8bf7\u6c42\u62a5\u6587\u548c\u54cd\u5e94\u62a5\u6587 \u8bf7\u6c42\u62a5\u6587 : \u8bf7\u6c42\u62a5\u6587\u7531ASCII\u6587\u672c\u5199\u6210; Host: xx, \u6307\u660e\u4e86\u5bf9\u8c61\u6240\u5728\u4e3b\u673a\uff0c\u8be5\u9996\u90e8\u884c\u4fe1\u606f\u662fWeb\u4ee3\u7406\u9ad8\u901f\u7f13\u5b58\u6240\u8981\u6c42\u7684; Connection:close, \u544a\u8bc9\u670d\u52a1\u5668\u4e0d\u5e0c\u671b\u4f7f\u7528\u6301\u7eed\u6027\u8fde\u63a5\uff0c\u8981\u6c42\u670d\u52a1\u5668\u5728\u53d1\u9001\u5b8c\u88ab\u8bf7\u6c42\u7684\u5bf9\u8c61\u540e\u5c31\u5173\u95ed\u8fd9\u6761\u8fde\u63a5; keep-alive\uff1a\u8868\u793a\u4f7f\u7528\u6301\u4e45\u6027\u8fde\u63a5 User-agent, \u6307\u660e\u7528\u6237\u4ee3\u7406\uff0c\u5373\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u7684\u6d4f\u89c8\u5668\u7c7b\u578b\uff0c \u56e0\u6b64\u670d\u52a1\u5668\u53ef\u4ee5\u6709\u6548\u5730\u4e3a\u4e0d\u540c\u7c7b\u578b\u7684\u7528\u6237\u4ee3\u7406\u5b9e\u9645\u53d1\u9001\u76f8\u540c\u5bf9\u8c61\u7684\u4e0d\u540c\u7248\u672c(\u6bcf\u4e2a\u7248\u672c\u90fd\u7531\u76f8\u540c\u7684URL\u5bfb\u5740); Accept-lanuage, \u7528\u6237\u671f\u671b\u5f97\u5230\u7684\u5bf9\u8c61\u7684\u8bed\u8a00\u7248\u672c\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u670d\u52a1\u5668\u4f1a\u53d1\u9001\u9ed8\u8ba4\u7248\u672c\u3002 method get: \u4ece\u670d\u52a1\u5668\u83b7\u53d6\u8d44\u6e90\uff0c\u5982\u9759\u6001\u6587\u672c\u3001\u56fe\u7247\u3001\u89c6\u9891\u7b49\uff0c\u6d4f\u89c8\u5668\u53ef\u4ee5\u5bf9get\u8bf7\u6c42\u7684\u6570\u636e\u8fdb\u884c\u7f13\u5b58\uff1b get\u8bf7\u6c42\u53ef\u4ee5\u5c06\u53c2\u6570(querystring)\u901a\u8fc7URL\u4f20\u9012\uff0c\u4e14\u8bf7\u6c42\u53c2\u6570\u662f\u53ef\u89c1\u7684\uff1b post: \u63d0\u4ea4\u8868\u5355, \u5411\u670d\u52a1\u5668\u4f20\u8f93\u8d44\u6e90\uff0c\u8868\u5355\u6570\u636e\u88ab\u7f16\u7801\u5728\u62a5\u6587\u7684body\u4e2d\uff1b post\u4e00\u4e2a\u8868\u5355\u65f6\uff0curl\u4e5f\u53ef\u4ee5\u5e26\u4e0a\u53c2\u6570\uff0c\u4f46\u9700\u8981\u63d0\u4f9bquerystring post\u8bf7\u6c42\u8fd4\u56de\u7684\u8d44\u6e90\u4e0d\u53ef\u4ee5\u88ab\u7f13\u5b58\uff0cpost\u8bf7\u6c42\u4e5f\u4e0d\u80fd\u4f5c\u4e3a\u4e66\u7b7e\u4fdd\u5b58 \u54cd\u5e94\u62a5\u6587 : \u72b6\u6001\u7801 : 200 OK\u662f\u6700\u5e38\u2ec5\u7684\u6210\u529f\u72b6\u6001\u7801\uff0c\u8868\u793a\u2f00\u5207\u6b63\u5e38\u3002\u5982\u679c\u662f\u2faeHEAD\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u5934\u90fd\u4f1a\u6709body\u6570\u636e. 204 No Content\u4e5f\u662f\u5e38\u2ec5\u7684\u6210\u529f\u72b6\u6001\u7801\uff0c\u4e0e 200 OK \u57fa\u672c\u76f8\u540c\uff0c\u4f46\u54cd\u5e94\u5934\u6ca1\u6709 body \u6570\u636e. 206 Partial Content\u662f\u5e94\u2f64\u4e8e HTTP \u5206\u5757\u4e0b\u8f7d\u6216\u65ad\u70b9\u7eed\u4f20\uff0c\u8868\u793a\u54cd\u5e94\u8fd4\u56de\u7684 body \u6570\u636e\u5e76\u4e0d\u662f\u5168\u90e8\u8d44\u6e90\uff0c \u2f7d\u662f\u5176\u4e2d\u7684\u2f00\u90e8\u5206\uff0c\u4e5f\u662f\u670d\u52a1\u5668\u5904\u7406\u6210\u529f\u7684\u72b6\u6001\u3002 301 Moved Permanently,\u6c38\u4e45\u79fb\u52a8\u3002\u8bf7\u6c42\u7684\u8d44\u6e90\u5df2\u88ab\u6c38\u4e45\u7684\u79fb\u52a8\u5230\u65b0URI\uff0c\u8fd4\u56de\u4fe1\u606f\u4f1a\u5305\u62ec\u65b0\u7684URI\uff0c \u6d4f\u89c8\u5668\u4f1a\u81ea\u52a8\u5b9a\u5411\u5230\u65b0URI\u3002\u4eca\u540e\u4efb\u4f55\u65b0\u7684\u8bf7\u6c42\u90fd\u5e94\u4f7f\u7528\u65b0\u7684URI\u4ee3\u66ff. 302 Found,\u4e34\u65f6\u79fb\u52a8\u3002\u4e0e301\u7c7b\u4f3c\u3002\u4f46\u8d44\u6e90\u53ea\u662f\u4e34\u65f6\u88ab\u79fb\u52a8\u3002\u5ba2\u6237\u7aef\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709URI. 304 Not Modified,\u672a\u4fee\u6539\u3002\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u672a\u4fee\u6539\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u72b6\u6001\u7801\u65f6\uff0c\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u8d44\u6e90\u3002 \u5ba2\u6237\u7aef\u901a\u5e38\u4f1a\u7f13\u5b58\u8bbf\u95ee\u8fc7\u7684\u8d44\u6e90\uff0c\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e2a\u5934\u4fe1\u606f\u6307\u51fa\u5ba2\u6237\u7aef\u5e0c\u671b\u53ea\u8fd4\u56de\u5728\u6307\u5b9a\u65e5\u671f\u4e4b\u540e\u4fee\u6539\u7684\u8d44\u6e90. 305 Use Proxy,\u4f7f\u7528\u4ee3\u7406\u3002\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u5fc5\u987b\u901a\u8fc7\u4ee3\u7406\u8bbf\u95ee. 400 Bad Request \u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u8bed\u6cd5\u9519\u8bef\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u7406\u89e3. 401 Unauthorized,\u8bf7\u6c42\u8981\u6c42\u7528\u6237\u7684\u8eab\u4efd\u8ba4\u8bc1. 403 Forbidden, \u670d\u52a1\u5668\u7406\u89e3\u8bf7\u6c42\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u4f46\u662f\u62d2\u7edd\u6267\u884c\u6b64\u8bf7\u6c42. 404 Not Found, \u8868\u793a\u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u670d\u52a1\u5668\u4e0a\u4e0d\u5b58\u5728\u6216\u672a\u627e\u5230\uff0c\u6240\u4ee5\u2f46\u6cd5\u63d0\u4f9b\u7ed9\u5ba2\u6237\u7aef. 405 Method Not Allowed \u5ba2\u6237\u7aef\u8bf7\u6c42\u4e2d\u7684\u65b9\u6cd5\u88ab\u7981\u6b62. 501 Not Implemented \u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u7684\u529f\u80fd\uff0c\u65e0\u6cd5\u5b8c\u6210\u8bf7\u6c42 502 Bad Gateway \u4f5c\u4e3a\u7f51\u5173\u6216\u8005\u4ee3\u7406\u5de5\u4f5c\u7684\u670d\u52a1\u5668\u5c1d\u8bd5\u6267\u884c\u8bf7\u6c42\u65f6\uff0c\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u65e0\u6548\u7684\u54cd\u5e94 503 Service Unavailable \u7531\u4e8e\u8d85\u8f7d\u6216\u7cfb\u7edf\u7ef4\u62a4\uff0c\u670d\u52a1\u5668\u6682\u65f6\u7684\u65e0\u6cd5\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u3002 504 Gateway Time-out\uff0c\u5145\u5f53\u7f51\u5173\u6216\u4ee3\u7406\u7684\u670d\u52a1\u5668\uff0c\u672a\u53ca\u65f6\u4ece\u8fdc\u7aef\u670d\u52a1\u5668\u83b7\u53d6\u8bf7\u6c42 505 HTTP Version not supported \u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u7684HTTP\u534f\u8bae\u7684\u7248\u672c\uff0c\u65e0\u6cd5\u5b8c\u6210\u5904\u7406 entity body\u5305\u542b\u4e86\u6240\u8bf7\u6c42\u5bf9\u8c61\u672c\u8eab; content-type \u6307\u793a\u4e86entity\u4e2d\u5bf9\u8c61\u7684\u7c7b\u578b\u3002 http\u53d1\u5c55 http1.0\u91c7\u7528\u7684\u662f\u975e\u6301\u7eed\u6027\u8fde\u63a5\uff0c\u6bcf\u4e2aTCP\u8fde\u63a5\u53ea\u5141\u8bb8\u4f20\u8f93\u4e00\u4e2a\u5bf9\u8c61\uff1b http1.1\u9ed8\u8ba4\u91c7\u7528\u7684\u662f\u6301\u7eed\u6027\u8fde\u63a5(\u4e5f\u79f0\u957f\u8fde\u63a5\uff0c\u8bf7\u6c42\u62a5\u6587\u4e2d\u7684\u9996\u90e8\u4fe1\u606fconnection\u9ed8\u8ba4\u4e3akeep-alive)\uff0c \u6bcf\u4e2aTCP\u8fde\u63a5\u5141\u8bb8\u4f20\u8f93\u591a\u4e2a\u5bf9\u8c61\uff0c\u540c\u65f6\u4f7f\u7528\u7ba1\u9053\u6280\u672f(\u79f0\u4e3aPipelining\uff0c\u4e5f\u79f0\u4f5c\u6d41\u6c34\u7ebf)\uff0c \u5728\u7b49\u5f85\u4e0a\u4e00\u4e2a\u8bf7\u6c42\u54cd\u5e94\u7684\u540c\u65f6\uff0c\u53d1\u9001\u4e0b\u4e00\u4e2a\u8bf7\u6c42\uff0c\u800c\u5728\u53d1\u9001\u8fc7\u7a0b\u4e2d\u4e0d\u9700\u8981\u7b49\u5f85\u670d\u52a1\u5668\u5bf9\u524d\u4e00\u4e2a\u8bf7\u6c42\u7684\u54cd\u5e94\u3002 http1.1\u7f3a\u70b9: http1.1\u89c4\u5219\u89c4\u5b9a\uff0c\u670d\u52a1\u5668\u7aef\u5728\u54cd\u5e94\u65f6\uff0c\u8981\u4e25\u683c\u6309\u7167\u63a5\u6536\u8bf7\u6c42\u7684\u987a\u5e8f\u53d1\u9001\u54cd\u5e94\uff0c\u5373\u5148\u63a5\u6536\u5230\u7684\u8bf7\u6c42\uff0c \u9700\u8981\u5148\u53d1\u9001\u5176\u54cd\u5e94\uff0c\u5ba2\u6237\u7aef\u4e5f\u662f\u5982\u6b64\uff0c\u63a5\u6536\u54cd\u5e94\u7684\u987a\u5e8f\u8981\u6309\u7167\u81ea\u5df1\u53d1\u9001\u8bf7\u6c42\u7684\u987a\u5e8f\u3002 \u56e0\u6b64 \u5982\u679c\u670d\u52a1\u5668\u6536\u5230\u7684\u7b2c\u4e00\u4e2a\u8bf7\u6c42\uff0c\u9700\u8981\u5f88\u957f\u7684\u5904\u7406\u65f6\u95f4\uff0c\u5219\u5bf9\u4e8e\u540e\u9762\u5df2\u7ecf\u5904\u7406\u5b8c\u54cd\u5e94\u7684\u8bf7\u6c42\u6765\u8bf4\uff0c \u5b83\u4eec\u53ea\u80fd\u963b\u585e\u7b49\u5f85\uff0c\u7b49\u5f85\u524d\u9762\u7684\u54cd\u5e94\u53d1\u9001\u5b8c\u540e\uff0c\u624d\u80fd\u88ab\u53d1\u9001\u51fa\u53bb\uff0c\u9020\u6210\u4e86\u201c\u961f\u9996\u963b\u585e\u201d\u95ee\u9898 \u3002 \u53ef\u89c1\u961f\u9996\u963b\u585e\u53d1\u751f\u5728\u670d\u52a1\u5668\u7aef\u3002\u56e0\u6b64\u5ba2\u6237\u7aef\u5728\u9700\u8981\u53d1\u8d77\u591a\u6b21\u8bf7\u6c42\u65f6\uff0c\u901a\u5e38\u4f1a\u91c7\u7528\u591a\u4e2aTCP\u8fde\u63a5\u6765\u51cf\u5c11\u5ef6\u8fdf\u3002 (\u4e0d\u540c\u6d4f\u89c8\u5668\u5141\u8bb8\u7684\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\u662f\u4e0d\u540c\u7684) \u6b64\u5916\u8fd8\u6709\u53ea\u80fd\u5ba2\u6237\u7aef\u5355\u5411 \u5411\u670d\u52a1\u5668\u53d1\u8d77\u8bf7\u6c42\u83b7\u5f97\u54cd\u5e94\u3001\u8bf7\u6c42\u62a5\u6587\u4e0e\u54cd\u5e94\u62a5\u6587\u9996\u90e8\u4fe1\u606f\u5197\u4f59\u91cf\u5927\uff0c \u5e76\u4e14\u672a\u91c7\u7528\u6570\u636e\u538b\u7f29\uff0c\u5bfc\u81f4\u4f20\u8f93\u91cf\u5927\u3002 http2.0\u6539\u8fdb: \u2003\u4e8c\u8fdb\u5236\u5206\u5e27: \u4e0d\u540c\u4e8ehttp1.x\u4e2d\u901a\u8fc7\u6587\u672c\u7684\u5f62\u5f0f\u4f20\u8f93\u6570\u636e\uff0chttp2.0\u5f15\u5165\u65b0\u7684\u7f16\u7801\u673a\u5236\uff0c \u5c06\u6240\u6709\u4f20\u8f93\u7684\u4fe1\u606f\u5206\u4e3a\u66f4\u5c0f\u7684\u6d88\u606f\u548c\u5e27\uff0c\u91c7\u7528\u4e8c\u8fdb\u5236\u683c\u5f0f\u7f16\u7801\uff0c\u7ec4\u6210\u4e8c\u8fdb\u5236\u5e27\u5c42 \u5176\u4e2dHTTP1.x\u7684\u9996\u90e8\u4fe1\u606f\u4f1a\u88ab\u5c01\u88c5\u5230Headers\u5e27\uff0c\u800cRequest Body\u5219\u5c01\u88c5\u5230Data\u5e27\u3002 \u56e0\u4e3a\u6bcf\u4e2a\u5e27\u90fd\u6709\u7f16\u53f7\uff0c\u4e8c\u8fdb\u5236\u5e27\u6570\u636e\u6d41\u53ef\u4ee5\u5230\u8fbe\u53e6\u4e00\u7aef\u540e\u518d\u6839\u636e\u5e27\u7684\u7f16\u53f7\u8fdb\u884c\u7ec4\u88c5\u3002 \u2003\u591a\u8def\u590d\u7528: \u5141\u8bb8\u540c\u65f6\u901a\u8fc7\u5355\u4e00\u7684TCP\u8fde\u63a5\u53d1\u8d77\u591a\u91cd\u7684\u8bf7\u6c42-\u54cd\u5e94\u6d88\u606f\uff0c \u539f\u56e0:\u4e8c\u8fdb\u5236\u5e27\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u7684TCP\u8fde\u63a5\u4e0a\u662f\u4ee5\u5b57\u8282\u6d41\u7684\u65b9\u5f0f\u53cc\u5411\u4f20\u8f93\u7684\uff0c\u7531\u4e8e\u7f16\u7801\u548c\u5c01\u88c5\u65b9\u5f0f\uff0c\u4e0d\u540c\u7684\u5e27\u4e92\u4e0d\u5e72\u6270\uff0c \u56e0\u6b64\u53ef\u4ee5\u5e76\u884c\u53d1\u9001\u591a\u4e2a\u4ea4\u9519\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u5b9e\u73b0\u4e86 \u7ba1\u9053\u591a\u8def\u590d\u7528 \uff1b\u53ea\u8981\u5f53\u524dTCP\u8fde\u63a5\u53ef\u7528\uff0c\u5c31\u53ef\u4ee5\u53d1\u9001\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c \u6d88\u9664\u4e86HTTP/1.1\u4e2d\u8bf7\u6c42\u548c\u54cd\u5e94\u987a\u5e8f\u5bf9\u5e94\u7684\u5173\u7cfb\u3002 \u2003\u5934\u90e8\u538b\u7f29: \u91c7\u7528HPACK\u7b97\u6cd5\u5bf9header\u4fe1\u606f\u8fdb\u884c\u538b\u7f29\u7f16\u7801\uff0c\u63d0\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\u3002 \u5177\u4f53\u4e3a: \u5982\u679c\u540c\u65f6\u53d1\u51fa\u591a\u4e2a\u8bf7\u6c42\uff0c\u5b83\u4eec\u7684\u5934\u662f\u2f00\u6837\u7684\u6216\u662f\u76f8\u4f3c\u7684\uff0c\u90a3\u4e48\u534f\u8bae\u4f1a\u6d88\u9664\u91cd\u590d\u7684\u90e8\u5206\u3002 HPACK\u4f7f\u75282\u4e2a\u7d22\u5f15\u8868(\u9759\u6001\u3001\u52a8\u6001\u7d22\u5f15\u8868)\u6765\u628a\u5934\u90e8(\u5305\u542bheader name\u548cheader value)\u6620\u5c04\u5230\u7d22\u5f15\u503c\uff0c \u5e76\u5bf9\u4e0d\u5b58\u5728\u7684\u5934\u90e8\u4f7f\u7528 huffman \u7f16\u7801\uff0c\u5e76\u52a8\u6001\u7f13\u5b58\u5230\u7d22\u5f15\uff0c\u4ece\u800c\u8fbe\u5230\u538b\u7f29\u5934\u90e8\u7684\u6548\u679c\u3002 \u9759\u6001\u7d22\u5f15\u8868: \u9884\u5148\u5b9a\u4e49\u597d\u7684\u5185\u5bb9\uff0c\u53ea\u6709\u56fa\u5b9a\u7684\u51e0\u5341\u4e2a\u503c\uff0c\u5982\u679c\u8981\u53d1\u9001\u7684\u503c\u7b26\u5408\u9759\u6001\u8868\u65f6\uff0c\u7528\u5bf9\u5e94\u7684 Index \u66ff\u6362\u5373\u53ef. \u52a8\u6001\u7d22\u5f15\u8868:\u662f\u4e00\u4e2a\u7531FIFO\u961f\u5217\u7ef4\u62a4\u7684\u6709\u7a7a\u95f4\u9650\u5236\u7684\u8868\uff0c\u540c\u6837\u7ef4\u62a4\u7684\u662f\u5934\u90e8\u4e0e\u5bf9\u5e94\u7684\u7d22\u5f15\u3002 \u6bcf\u4e2a\u52a8\u6001\u8868\u53ea\u9488\u5bf9\u4e00\u4e2a\u8fde\u63a5\uff0c\u6bcf\u4e2a\u8fde\u63a5\u7684\u538b\u7f29\u89e3\u538b\u7f29\u7684\u4e0a\u4e0b\u6587\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u52a8\u6001\u8868\u3002 \u5f53\u4e00\u4e2a\u5934\u90e8\u6ca1\u6709\u51fa\u73b0\u8fc7\u7684\u65f6\u5019\uff0c\u4f1a\u628a\u5b83\u63d2\u5165\u52a8\u6001\u8868\u4e2d\uff0c\u4e0b\u6b21\u540c\u540d\u7684\u503c\u5c31\u53ef\u80fd\u4f1a\u5728\u8868\u4e2d\u67e5\u627e\u5230\u7d22\u5f15\u5e76\u66ff\u6362\u6389\u5934\u90e8\u3002 \u2003\u670d\u52a1\u5668\u63a8\u9001: \u4e3a\u4e86\u6539\u5584\u5ef6\u8fdf\uff0cHTTP2.0\u5f15\u5165\u4e86server push\uff0c\u5b83\u5141\u8bb8\u670d\u52a1\u7aef\u4e3b\u52a8\u63a8\u9001\u8d44\u6e90\u7ed9\u6d4f\u89c8\u5668\uff0c \u4f8b\u5982\u5728\u6d4f\u89c8\u5668\u521a\u8bf7\u6c42 HTML \u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u5c31\u63d0\u524d\u628a\u53ef\u80fd\u4f1a\u2f64\u5230\u7684 JS\u3001CSS \u2f42\u4ef6\u7b49\u9759\u6001\u8d44\u6e90\u4e3b\u52a8\u53d1\u7ed9 \u5ba2\u6237\u7aef\uff0c\u51cf\u5c11\u7b49\u5f85\u65f6\u95f4\u3002 http2.0\u7f3a\u70b9: \u591a\u4e2aHTTP\u8bf7\u6c42\u5728\u590d\u2f64\u2f00\u4e2aTCP\u8fde\u63a5\uff0c\u4e0b\u5c42\u7684TCP\u534f\u8bae\u662f\u4e0d\u77e5\u9053\u6709\u591a\u5c11\u4e2aHTTP\u8bf7\u6c42\u7684\u3002 \u6240\u4ee5\u2f00\u65e6\u53d1\u2f63\u4e86\u4e22\u5305\u73b0\u8c61\uff0c\u5c31\u4f1a\u89e6\u53d1TCP\u7684\u91cd\u4f20\u673a\u5236\uff0c\u8fd9\u6837\u5728\u2f00\u4e2aTCP\u8fde\u63a5\u4e2d\u7684\u6240\u6709\u7684HTTP\u8bf7\u6c42 \u90fd\u5fc5\u987b\u7b49\u5f85\u8fd9\u4e2a\u4e22\u4e86\u7684\u5305\u88ab\u91cd\u4f20\u56de\u6765\u3002 http3.0: \u53c8\u79f0\u4e3aHTTP Over QUIC\uff0c\u5176\u5f03\u7528TCP\u534f\u8bae\uff0c\u6539\u4e3a\u4f7f\u7528\u57fa\u4e8eUDP\u534f\u8bae\u7684 QUIC(Quick UDP Internet Protocol)\u534f\u8bae\u6765\u5b9e\u73b0. \u5982\u4f55\u5904\u7406\u4e22\u5305: \u2003\u524d\u5411\u7ea0\u9519: QUIC\u534f\u8bae\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u9664\u4e86\u672c\u8eab\u7684\u6570\u636e\u4ee5\u5916\uff0c\u4f1a\u5e26\u6709\u5176\u4ed6\u6570\u636e\u5305\u7684\u90e8\u5206\u6570\u636e\uff0c\u5728\u5c11\u91cf\u4e22\u5305\u7684\u60c5\u51b5\u4e0b\uff0c \u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6570\u636e\u5305\u7684\u5197\u4f59\u6570\u636e\u5b8c\u6210\u6570\u636e\u7ec4\u88c5\u800c\u65e0\u9700\u91cd\u4f20\uff0c\u4ece\u800c\u63d0\u9ad8\u6570\u636e\u7684\u4f20\u8f93\u901f\u5ea6\u3002 \u2003\u5feb\u901f\u91cd\u542f\u4f1a\u8bdd: \u666e\u901a\u57fa\u4e8etcp\u7684\u8fde\u63a5\uff0c\u662f\u57fa\u4e8e\u4e24\u7aef\u7684ip\u548c\u7aef\u53e3\u548c\u534f\u8bae\u6765\u5efa\u7acb\u7684\u3002\u5728\u7f51\u7edc\u5207\u6362\u573a\u666f\uff0c\u4f8b\u5982\u624b\u673a\u7aef\u5207\u6362\u4e86\u65e0\u7ebf\u7f51\uff0c \u4f7f\u75284G\u7f51\u7edc\uff0c\u4f1a\u6539\u53d8\u672c\u8eab\u7684ip\uff0c\u8fd9\u5c31\u5bfc\u81f4tcp\u8fde\u63a5\u5fc5\u987b\u91cd\u65b0\u521b\u5efa\u3002\u800cQUIC\u534f\u8bae\u4f7f\u7528\u7279\u6709\u7684UUID\u6765\u6807\u8bb0\u6bcf\u4e00\u6b21\u8fde\u63a5\uff0c \u5728\u7f51\u7edc\u73af\u5883\u53d1\u751f\u53d8\u5316\u7684\u65f6\u5019\uff0c\u53ea\u8981UUID\u4e0d\u53d8\uff0c\u5c31\u80fd\u4e0d\u9700\u8981\u63e1\u624b\uff0c\u7ee7\u7eed\u4f20\u8f93\u6570\u636e\u3002 cookie \u2003cookie\u53ef\u4ee5\u7528\u4e8e\u6807\u8bb0\u4e00\u4e2a\u7528\u6237\uff0c\u7528\u6237\u9996\u6b21\u8bbf\u95ee\u4e00\u4e2a\u7ad9\u70b9\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u7528\u6237\u6807\u8bc6\uff0c\u5728\u540e\u7ee7\u4f1a\u8bdd\u4e2d\uff0c \u6d4f\u89c8\u5668\u5411\u670d\u52a1\u5668\u4f20\u9012\u4e00\u4e2acookie\u9996\u90e8\uff0c\u4ece\u800c\u5411\u8be5\u670d\u52a1\u5668\u6807\u8bc6\u4e86\u7528\u6237\u3002\u56e0\u6b64cookie\u53ef\u4ee5\u5728\u65e0\u72b6\u6001\u7684http\u4e4b\u4e0a\u5efa\u7acb\u4e00\u4e2a\u7528\u6237\u4f1a\u8bdd\u5c42 \u3002 Web\u7f13\u5b58/\u4ee3\u7406\u670d\u52a1\u5668\u6280\u672f \u2003\u5728\u4e0d\u8bbf\u95ee\u670d\u52a1\u5668\u7684\u524d\u63d0\u4e0b\u6ee1\u8db3\u5ba2\u6237\u7aef\u7684HTTP\u8bf7\u6c42\uff0cweb\u7f13\u5b58\u5668\u6709\u81ea\u5df1\u7684\u78c1\u76d8\u5b58\u50a8\u7a7a\u95f4\uff0c\u5e76\u5728\u5b58\u50a8\u7a7a\u95f4\u4e2d\u4fdd\u5b58\u6700\u8fd1\u8bf7\u6c42\u8fc7\u7684\u5bf9\u8c61\u7684\u526f\u672c\u3002 \u2003\u4e3a\u4e86\u786e\u4fdd\u7f13\u5b58\u670d\u52a1\u5668\u4e2d\u7684\u5bf9\u8c61\u662f\u6700\u65b0\u7684\uff0cHTTP\u63d0\u4f9b\u4e86\u6761\u4ef6GET\u65b9\u6cd5\u3002 \u7f13\u5b58\u670d\u52a1\u5668\u5728\u5c06\u5bf9\u8c61\u8f6c\u53d1\u5230\u8bf7\u6c42\u7684\u6d4f\u89c8\u5668\u7684\u540c\u65f6\uff0c\u4e5f\u5728\u672c\u5730\u7f13\u5b58\u4e86\u5bf9\u8c61\uff0c\u5e76\u4e14\u5b58\u50a8\u4e86\u8be5\u5bf9\u8c61\u7684\u6700\u540e\u4fee\u6539\u65f6\u671f\u3002","title":"WEB\u5e94\u7528"},{"location":"Network/1_application/#ftp","text":"\u8fde\u63a5\u8fc7\u7a0b \u4e0eHTTP\u533a\u522b","title":"\u6587\u4ef6\u4f20\u8f93\u534f\u8bae(FTP)"},{"location":"Network/1_application/#email","text":"Email\u5e94\u7528\u7ec4\u6210\u4e0eSMTP \u2003 SMTP: Simple Mail Transport Protocol(\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae) SMTP\u4e0eHTTP\u4e0d\u540c \u2003HTTP is a pull protocol, \u5373\u7528\u6237\u4f7f\u7528HTTP\u4ece\u670d\u52a1\u5668\u4e0a\u62c9\u53d6\u4fe1\u606f\uff0cTCP\u8fde\u63a5\u662f\u7531\u63a5\u6536\u65b9\u53d1\u8d77\u7684\uff1b SMTP is a push protocol, \u5373\u53d1\u9001\u90ae\u4ef6\u670d\u52a1\u5668\u628a\u6587\u4ef6\u63a8\u5411\u63a5\u6536\u90ae\u4ef6\u670d\u52a1\u5668\uff0c TCP\u8fde\u63a5\u662f\u7531\u53d1\u9001\u65b9\u53d1\u8d77\u7684\u3002 \u2003SMTP\u62a5\u6587\u4f7f\u75287bit ASCII\u683c\u5f0f\uff0cHTTP\u4e0d\u53d7\u6b64\u9650\u5236\u3002 \u2003 \u5728\u5904\u7406\u5305\u542b\u591a\u4e2a\u5bf9\u8c61\u65f6(\u5982\u5305\u542b\u6587\u672c\u548c\u56fe\u7247\u7684\u6587\u6863)\uff0cHTTP\u4f1a\u628a\u6bcf\u4e2a\u5bf9\u8c61\u5c01\u88c5\u5230\u5404\u81ea\u7684HTTP\u54cd\u5e94\u62a5\u6587\u4e2d\uff0c\u800cSMTP\u5219\u628a\u6240\u6709\u62a5\u6587\u5bf9\u8c61\u653e\u5728\u4e00\u4e2a\u62a5\u6587\u4e2d \u3002 \u90ae\u4ef6\u8bbf\u95ee\u534f\u8bae \u2003\u90ae\u4ef6\u4f20\u8f93\u8fc7\u7a0b: \u53d1\u9001\u65b9\u7528\u6237\u4ee3\u7406->\u53d1\u9001\u65b9\u90ae\u4ef6\u670d\u52a1\u5668->\u63a5\u6536\u65b9\u90ae\u4ef6\u670d\u52a1\u5668->\u63a5\u6536\u65b9\u7528\u6237\u4ee3\u7406 \u2003\u91c7\u7528\u53d1\u9001\u65b9\u90ae\u4ef6\u670d\u52a1\u5668\u4f5c\u4e3a\u4e2d\u7ee7\uff0c\u901a\u8fc7\u6d88\u606f\u961f\u5217\uff0c\u5b58\u50a8\u53d1\u9001\u65b9\u53d1\u51fa\u7684\u90ae\u4ef6\uff0c\u53ef\u4ee5\u907f\u514d\u63a5\u6536\u65b9\u90ae\u4ef6\u670d\u52a1\u5668\u4e0d\u5728\u7ebf\u65f6\uff0c\u76f4\u63a5\u901a\u8fc7\u7528\u6237\u4ee3\u7406\uff0c\u65e0\u6cd5\u5230\u8fbe\u63a5\u6536\u65b9\uff1b\u53d1\u9001\u65b9\u90ae\u4ef6\u670d\u52a1\u5668\u4f1a\u5b9a\u65f6\u67e5\u8be2\u8fde\u63a5\uff0c\u4e00\u65e6\u8fde\u63a5\uff0c\u5c31\u5c06\u90ae\u4ef6\u4f20\u8f93\u5230\u63a5\u6536\u65b9\u670d\u52a1\u5668\u3002 \u2003\u4f20\u8f93\u8fc7\u7a0b\u7684\u524d\u4e24\u90e8\u5206\u91c7\u7528SMTP\u534f\u8bae\uff0c\u800c\u6700\u540e\u4e00\u90e8\u5206\u4e0d\u80fd\u91c7\u7528SMTP\u534f\u8bae\uff0c\u56e0\u4e3a\u53ea\u80fd\u7531\u7528\u6237\u4ee3\u7406\u4e3b\u52a8\u63a5\u6536\u90ae\u4ef6\uff0c\u800c\u8fd9\u662f\u4e00\u4e2apull\u52a8\u4f5c\uff0c\u9700\u8981\u901a\u8fc7\u90ae\u4ef6\u8bbf\u95ee\u534f\u8bae\u6765\u4ece\u63a5\u6536\u65b9\u670d\u52a1\u5668\u63a5\u6536\u90ae\u4ef6\u3002 \u2003POP3(Post Office Protocol v3)\u534f\u8bae: authorization(\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u53e3\u4ee4)\u3001\u4e8b\u7269\u5904\u7406(\u53d6\u56de\u62a5\u6587\u5373\u90ae\u4ef6\uff0c\u5bf9\u62a5\u6587\u6dfb\u52a0\u5220\u9664\u6807\u8bb0)\u3001\u66f4\u65b0(\u4f1a\u8bdd\u7ed3\u675f\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u5220\u9664\u88ab\u6807\u8bb0\u4e3a\u5220\u9664\u7684\u62a5\u6587)\u3002 \u2003IMAP(Internet Mail Access Protocol)\u534f\u8bae \u4ee5\u53ca HTTP\u534f\u8bae(\u5982web mail, \u6d4f\u89c8\u5668\u5145\u5f53\u7528\u6237\u4ee3\u7406\uff0c\u901a\u8fc7HTTP\u4e0e\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u4e0d\u8fc7\u90ae\u4ef6\u670d\u52a1\u4e4b\u95f4\u4ecd\u662f\u901a\u8fc7SMTP\u534f\u8bae)\u3002 MMIE","title":"Email\u5e94\u7528"},{"location":"Network/1_application/#dnsdomain-name-system","text":"\u6307\u4e00\u4e2a\u7531\u591a\u5c42\u57df\u540d\u670d\u52a1\u5668\u6784\u6210\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u91c7\u7528\u96c6\u4e2d\u5f0fDNS\u7f3a\u70b9: \u5355\u70b9\u5931\u8d25(\u5373\u82e5\u552f\u4e00\u7684DNS\u670d\u52a1\u5668\u6545\u969c\uff0c\u5219\u6574\u4e2aINTERNET\u5c06\u5d29\u6e83)\u3001\u6d41\u91cf\u95ee\u9898(\u9ad8\u5e76\u53d1\u67e5\u8be2)\u3001\u8ddd\u79bb\u95ee\u9898(\u5355\u4e2aDNS server\u4e0d\u53ef\u80fd\u90bb\u8fd1\u6240\u6709\u67e5\u8be2\u5ba2\u6237)\u3001\u7ef4\u62a4\u6027\u95ee\u9898(\u5355\u4e00\u6570\u636e\u5e93\u7ef4\u62a4\u548c\u66f4\u65b0\u5de8\u5927\u7684\u67e5\u8be2\u8bb0\u5f55)\u3002 \u2003\u4e5f\u6307\u4e00\u4e2a\u4f7f\u5f97\u4e3b\u673a\u80fd\u591f\u67e5\u8be2\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7684\u5e94\u7528\u5c42\u534f\u8bae(DNS\u534f\u8bae)\u3002 \u2003DNS\u534f\u8bae\u5b8c\u6210Internet\u6838\u5fc3\u4efb\u52a1\uff0c\u5c06\u57df\u540d\u6620\u5c04\u4e3aIP\u5730\u5740\u3002 \u8fd0\u884c\u5728UDP\u4e0a\uff0c\u4f7f\u752853\u53f7\u7aef\u53e3 \u3002 DNS\u670d\u52a1 \u57df\u540d\u89e3\u6790\u3001\u4e3b\u673a\u522b\u540d\u3001\u90ae\u4ef6\u670d\u52a1\u5668\u522b\u540d\u3001\u8d1f\u8f7d\u5747\u8861\u3002 \u67e5\u8be2 \u8fed\u4ee3\u67e5\u8be2\u548c\u9012\u5f52\u67e5\u8be2 DNS\u7f13\u5b58 \u2003\u53ea\u8981DNS\u670d\u52a1\u5668\u63a5\u6536\u4e00\u4e2aDNS\u56de\u7b54(\u57df\u540d-IP\u7684\u6620\u5c04)\uff0c\u5373\u7f13\u5b58\u8be5\u56de\u7b54\uff1b\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u7f13\u5b58\u6761\u76ee\u4f1a\u5931\u6548(\u88ab\u5220\u9664)\uff1b\u672c\u5730DNS\u670d\u52a1\u5668\u4e00\u822c\u4f1a\u7f13\u5b58\u9876\u7ea7\u57df\u540d\u670d\u52a1\u5668\u7684\u6620\u5c04\uff0c\u56e0\u6b64DNS \u6839\u670d\u52a1\u5668\u5f88\u5c11\u88ab\u8bbf\u95ee\u3002 DNS\u8bb0\u5f55\u548c\u62a5\u6587 \u2003TTL\u4ee3\u8868\u8be5\u8bb0\u5f55\u7684\u751f\u5b58\u65f6\u95f4\uff0c\u5b83\u51b3\u5b9a\u4e86\u8d44\u6e90\u8bb0\u5f55(Resource Record)\u5e94\u5f53\u88ab\u5220\u9664\u7684\u65f6\u95f4","title":"DNS(Domain Name System)"},{"location":"Network/1_application/#p2p","text":"\u7ed3\u6784\u7279\u70b9 P2P\u7d22\u5f15 \u7d22\u5f15\u7ed3\u6784","title":"P2P\u5e94\u7528"},{"location":"Network/1_application/#socket","text":"socket socket API\u51fd\u6570 \u5ba2\u6237\u7aef/\u670d\u52a1\u5668\u7aef","title":"socket\u7f16\u7a0b\u57fa\u7840"},{"location":"Network/2_transport/","text":"\u4f20\u8f93\u5c42 \u4f20\u8f93\u5c42 v.s \u5e94\u7528\u5c42 \u2003 \u4f20\u8f93\u5c42\u534f\u8bae\u53ea\u5de5\u4f5c\u5728\u7aef\u7cfb\u7edf\uff0c\u5728\u7aef\u7cfb\u7edf\u4e2d\uff0c\u4f20\u8f93\u5c42\u534f\u8bae\u5c06\u6765\u81ea\u5e94\u7528\u8fdb\u7a0b\u7684\u62a5\u6587\u79fb\u52a8\u5230\u7f51\u7edc\u8fb9\u7f18(\u7f51\u7edc\u5c42)\uff1b\u7f51\u7edc\u8def\u7531\u5668\u4ec5\u4f5c\u7528\u5230\u6570\u636e\u6bb5\u7684\u7f51\u7edc\u5c42\u5b57\u6bb5\uff0c\u4e0d\u4f1a\u68c0\u67e5\u5c01\u88c5\u5728\u6570\u636e\u6bb5\u4e2d\u7684\u4f20\u8f93\u5c42\u5b57\u6bb5\u3002 \u591a\u8def\u590d\u7528/\u5206\u7528 \u2003 \u5c06\u4e3b\u673a\u95f4\u4ea4\u4ed8\u6269\u5c55\u5230\u8fdb\u7a0b\u95f4\u4ea4\u4ed8\u3002 \u5c06\u4f20\u8f93\u5c42\u62a5\u6587\u6bb5\u4e2d\u7684\u6570\u636e\u4ea4\u4ed8\u5230\u6b63\u786e\u7684socket\u7684\u5de5\u4f5c\u79f0\u4e3a\u591a\u8def\u5206\u7528 \uff1b \u5728\u6e90\u4e3b\u673a\u4e2d \u4ece\u4e0d\u540csocket\u6536\u96c6\u6570\u636e\u5757\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u6570\u636e\u5757\u5c01\u88c5\u9996\u90e8\u4fe1\u606f\u4ece\u800c\u751f\u6210\u62a5\u6587\u6bb5\uff0c\u7136\u540e\u4f20\u9012\u5230\u7f51\u7edc\u5c42 \u3002 \u5206\u7528 \u65e0\u8fde\u63a5\u5206\u7528 \u9762\u5411\u8fde\u63a5\u7684\u5206\u7528 UDP UDP\u534f\u8bae UDP\u62a5\u6587\u683c\u5f0f \u53ef\u9760\u6570\u636e\u4f20\u8f93(RDT) TCP MSS(Maximum Segment Size): TCP\u53ef\u4ece\u53d1\u9001\u7f13\u5b58\u4e2d\u53d6\u51fa\u5e76\u653e\u5165\u62a5\u6587\u6bb5\u4e2d\u7684\u6700\u5927\u6570\u636e\u91cf; MTU(Maximum Transmission Unit): \u6700\u5927\u94fe\u8def\u5e27\u957f\u5ea6 \u8003\u8651\u5230\u4ee5\u592a\u7f51\u548cPPP\u94fe\u8def\u5c42\u534f\u8bae\u90fd\u5177\u67091500\u5b57\u8282\u7684MTU\uff0c\u800cTCP\u6570\u636e\u6bb5header\u4e00\u822c\u4e3a20\u5b57\u8282\uff0c\u518d\u6709IP\u6570\u636e\u62a5\u7684header\u4e5f\u4e3a20\u5b57\u8282\uff0c \u56e0\u6b64MSS\u7684\u5178\u578b\u503c\u4e3a1460\u5b57\u8282\u3002 TCP\u6570\u636e\u6bb5 \u2003\u5e8f\u5217\u53f7\u548c\u786e\u8ba4\u53f7\u7528\u6765\u5b9e\u73b0\u53ef\u9760\u6570\u636e\u4f20\u8f93\u670d\u52a1\uff1b\u5176\u4e2d\u5e8f\u5217\u53f7\u662f\u62a5\u6587\u6bb5\u9996\u5b57\u8282\u7684\u5b57\u8282\u6d41\u7f16\u53f7\uff0c \u63a5\u6536\u65b9\u6839\u636e\u5e8f\u5217\u53f7\u53ef\u4ee5\u53bb\u9664\u91cd\u590d\u6570\u636e\uff0c\u4fdd\u8bc1\u6309\u5e8f\u63a5\u6536\u6570\u636e\u5305\uff1b\u53d1\u9001\u65b9\u5219\u53ef\u4ee5\u7528\u6765\u6807\u8bc6\u53d1\u9001\u51fa\u53bb\u7684\u6570\u636e\u5305\u54ea\u4e9b\u662f\u88ab\u6b63\u786e\u63a5\u6536\u4e86 \uff1b\u786e\u8ba4\u53f7\u662f\u63a5\u6536\u65b9\u671f\u671b\u63a5\u6536\u7684\u4e0b\u4e00\u5b57\u8282\u7684\u5e8f\u53f7\uff0c \u7528\u6765\u89e3\u51b3\u4e22\u5305\u7684\u95ee\u9898 \u3002 \u20036 bit\u7684\u6807\u5fd7\u4f4d: ACK\u4f4d\u7528\u6765\u6307\u793a\u786e\u8ba4\u53f7\u662f\u6709\u6548\u7684\uff0c\u5373\u5bf9\u4e00\u4e2a\u5df2\u88ab\u6210\u529f\u63a5\u6536\u62a5\u6587\u6bb5\u7684\u786e\u8ba4( TCP\u89c4\u5b9a\u9664\u4e86\u6700\u521d\u8bf7\u6c42\u5efa\u7acb\u8fde\u63a5\u65f6\u7684SYN\u62a5\u6587\u6bb5\u4e4b\u5916\u8be5\u4f4d\u5fc5\u987b\u8bbe\u7f6e\u4e3a1 )\uff1bRST( \u8868\u793aTCP\u8fde\u63a5\u4e2d\u51fa\u73b0\u5f02\u5e38\u5fc5\u987b\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5 )\u3001FIN( \u8868\u793a\u4e0d\u4f1a\u518d\u6709\u6570\u636e\u53d1\u9001\uff0c\u5e0c\u671b\u65ad\u5f00\u8fde\u63a5 )\u3001SYN( \u5e0c\u671b\u5efa\u7acb\u8fde\u63a5 )\u7528\u4e8e\u8fde\u63a5\u5efa\u7acb\u548c\u5220\u9664\uff1b PSH\u6307\u793a\u63a5\u6536\u65b9\u5e94\u7acb\u523b\u5c06\u6570\u636e\u4ea4\u7ed9\u4e0a\u5c42\uff1bURG\u6307\u793a\u62a5\u6587\u6bb5\u5b58\u5728\u88ab\u53d1\u9001\u7aef\u4e0a\u5c42\u5e94\u7528\u6807\u8bb0\u4e3a\u7d27\u6025\u7684\u6570\u636e\u3002(\u5b9e\u8df5\u4e2d\uff0cPSH\u3001URG\u4ee5\u53ca\u7d27\u6025\u6570\u636e\u6307\u9488\u5e76\u6ca1\u6709\u4f7f\u7528) TCP\u53ef\u9760\u6570\u636e\u4f20\u8f93 \u2003 \u6d41\u6c34\u7ebf\u673a\u5236 : \u51c6\u786e\u6765\u8bf4\u662f\u6ed1\u52a8\u7a97\u53e3\u673a\u5236\uff0c\u53d1\u9001\u65b9\u5728\u53d1\u9001\u4e00\u4e2a\u7f51\u7edc\u5305\u540e\uff0c\u4e0d\u7b49\u5f85ACK\u53f7\u8fd4\u56de\uff0c\u800c\u662f\u76f4\u63a5\u53d1\u9001\u540e\u7eed\u4e00\u7cfb\u5217\u7684\u5305\uff1b\u5f53\u63a5\u6536\u65b9\u6536\u5230\u7f51\u7edc\u5305\u540e\uff0c\u4f1a\u5148\u5c06\u6570\u636e\u5b58\u653e\u5230\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u3002\u7136\u540e\uff0c\u63a5\u6536\u65b9\u8ba1\u7b97ACK\u53f7\u548c\u5269\u4f59\u63a5\u6536\u7f13\u5b58\u533a\u5927\u5c0fRecvWindow\uff0c\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\uff0c\u53d1\u9001\u65b9\u6839\u636eRecvWindow\u5927\u5c0f\u5bf9\u6570\u636e\u53d1\u9001\u64cd\u4f5c\u8fdb\u884c\u63a7\u5236\uff0c\u8fd9\u5c31\u662f\u6ed1\u52a8\u7a97\u53e3\u65b9\u5f0f\u7684\u57fa\u672c\u601d\u8def\u3002 \u2003RecvWindow\u66f4\u65b0\u65f6\u673a\u53d1\u751f\u5728\u63a5\u6536\u65b9\u4e0a\u5c42\u5e94\u7528\u5c42\u4ece\u63a5\u6536\u7f13\u5b58\u533a\u4e2d\u53d6\u51fa\u6570\u636e\u540e\uff0c\u5bfc\u81f4\u7f13\u5b58\u533a\u5269\u4f59\u5bb9\u91cf\u589e\u52a0\u65f6\uff0c\u63a5\u6536\u65b9\u4f1a\u66f4\u65b0\u7a97\u53e3\u5927\u5c0f\u3002 \u2003\u63a5\u6536\u65b9\u5728\u53d1\u9001ACK\u53f7\u548c\u7a97\u53e3\u66f4\u65b0\u65f6\uff0c\u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u628a\u5305\u53d1\u9001\u51fa\u53bb\uff0c\u800c\u662f\u4f1a\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5f88\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u5176\u4ed6\u7684\u901a\u77e5\u64cd\u4f5c\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u4e24\u79cd\u901a\u77e5\u5408\u5e76\u5728\u4e00\u4e2a\u5305\u91cc\u9762\u53d1\u9001\u4e86\u3002\u4f8b\u5982\uff0c\u5728\u7b49\u5f85\u53d1\u9001ACK\u53f7\u7684\u65f6\u5019\u6b63\u597d\u9700\u8981\u66f4\u65b0\u7a97\u53e3\uff0c\u8fd9\u65f6\u5c31\u53ef\u4ee5\u628aACK\u53f7\u548c\u7a97\u53e3\u66f4\u65b0\u653e\u5728\u4e00\u4e2a\u5305\u91cc\u53d1\u9001\uff0c\u4ece\u800c\u51cf\u5c11\u5305\u7684\u6570\u91cf\u3002\u5f53\u9700\u8981\u8fde\u7eed\u53d1\u9001\u591a\u4e2aACK\u53f7\u65f6\uff0c\u4e5f\u53ef\u4ee5\u51cf\u5c11\u5305\u7684\u6570\u91cf\uff0c\u8fd9\u662f\u56e0\u4e3aACK\u53f7\u8868\u793a\u7684\u662f\u5df2\u6536\u5230\u7684\u6570\u636e\u91cf\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u662f\u544a\u8bc9\u53d1\u9001\u65b9\u76ee\u524d\u5df2\u63a5\u6536\u7684\u6570\u636e\u7684\u6700\u540e\u4f4d\u7f6e\u5728\u54ea\u91cc\uff0c\u56e0\u6b64 \u5f53\u9700\u8981\u8fde\u7eed\u53d1\u9001ACK\u53f7\u65f6\uff0c\u53ea\u8981\u53d1\u9001\u6700\u540e\u4e00\u4e2aACK\u53f7\u5c31\u53ef\u4ee5\u4e86 \uff0c\u4e2d\u95f4\u7684\u53ef\u4ee5\u5168\u90e8\u7701\u7565\u3002\u5f53\u9700\u8981\u8fde\u7eed\u53d1\u9001\u591a\u4e2a\u7a97\u53e3\u66f4\u65b0\u65f6\u4e5f\u53ef\u4ee5\u51cf\u5c11\u5305\u7684\u6570\u91cf\uff0c\u56e0\u4e3a\u8fde\u7eed\u53d1\u751f\u7a97\u53e3\u66f4\u65b0\u8bf4\u660e\u5e94\u7528\u7a0b\u5e8f\u8fde\u7eed\u8bf7\u6c42\u4e86\u6570\u636e\uff0c\u63a5\u6536\u7f13\u51b2\u533a\u7684\u5269\u4f59\u7a7a\u95f4\u8fde\u7eed\u589e\u52a0\u3002\u8fd9\u79cd\u60c5\u51b5\u548cACK\u53f7\u4e00\u6837\uff0c\u53ef\u4ee5\u7701\u7565\u4e2d\u95f4\u8fc7\u7a0b\uff0c\u53ea\u8981\u53d1\u9001\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u53ef\u4ee5\u4e86\u3002 \u2003 \u8d85\u65f6\u91cd\u4f20 : TCP\u534f\u8bae\u8981\u6c42\u5728\u53d1\u9001\u7aef\u6bcf\u53d1\u9001\u4e00\u4e2a\u62a5\u6587\u6bb5\uff0c\u5c31\u542f\u52a8\u4e00\u4e2a\u5b9a\u65f6\u5668\u5e76\u7b49\u5f85\u786e\u8ba4\u4fe1\u606f\uff1b\u63a5\u6536\u7aef\u6210\u529f\u63a5\u6536\u65b0\u6570\u636e\u540e\u8fd4\u56de\u786e\u8ba4\u4fe1\u606f\u3002\u82e5\u5728\u5b9a\u65f6\u5668\u8d85\u65f6\u524d\u6570\u636e\u672a\u80fd\u88ab\u786e\u8ba4\uff0cTCP\u5c31\u8ba4\u4e3a\u62a5\u6587\u6bb5\u4e2d\u7684\u6570\u636e\u5df2\u4e22\u5931\u6216\u635f\u574f\uff0c\u9700\u8981\u5bf9\u62a5\u6587\u6bb5\u4e2d\u7684\u6570\u636e\u91cd\u65b0\u7ec4\u7ec7\u548c\u91cd\u4f20\u3002 \u2003TCP\u91c7\u7528\u7684\u662f\u7d2f\u8ba1\u786e\u8ba4\u673a\u5236\uff0c\u5f53\u53d1\u9001\u65b9\u63a5\u6536\u52303\u4e2a\u5197\u4f59ACK(\u5047\u8bbeACK\u53f7\u4e3aK)\u65f6\uff0c\u610f\u5473\u7740\u5e8f\u5217\u53f7\u4e3aK\u7684\u6570\u636e\u5305\u53ef\u80fd\u5df2\u7ecf\u4e22\u5931\uff0cTCP\u5c31\u4f1a\u6267\u884c\u5feb\u901f\u91cd\u4f20\u4ece\u5e8f\u5217\u53f7K\u5f00\u59cb\u7684\u6570\u636e\u5305\u3002 TCP\u6d41\u91cf\u63a7\u5236 1.1 \u4ec0\u4e48\u662f\u6d41\u91cf\u63a7\u5236\uff1f\u6d41\u91cf\u63a7\u5236\u7684\u76ee\u7684\uff1f \u5982\u679c\u53d1\u9001\u8005\u53d1\u9001\u6570\u636e\u8fc7\u5feb\uff0c\u63a5\u6536\u8005\u6765\u4e0d\u53ca\u63a5\u6536\uff0c\u90a3\u4e48\u5c31\u4f1a\u6709\u5206\u7ec4\u4e22\u5931\u3002\u4e3a\u4e86\u907f\u514d\u5206\u7ec4\u4e22\u5931\uff0c \u63a7\u5236\u53d1\u9001\u8005\u7684\u53d1\u9001\u901f\u5ea6\uff0c\u4f7f\u5f97\u63a5\u6536\u8005\u6765\u5f97\u53ca\u63a5\u6536\uff0c\u8fd9\u5c31\u662f\u6d41\u91cf\u63a7\u5236\u3002 \u6d41\u91cf\u63a7\u5236\u6839\u672c\u76ee\u7684\u662f\u9632\u6b62\u5206\u7ec4\u4e22\u5931\uff0c\u5b83\u662f\u6784\u6210TCP\u53ef\u9760\u6027\u7684\u4e00\u65b9\u9762\u3002 1.2 \u5982\u4f55\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236\uff1f \u4e3b\u8981\u7684\u65b9\u5f0f\u5c31\u662f\u63a5\u6536\u65b9\u8fd4\u56de\u7684\u6570\u636e\u6bb5\u4e2d\u4f1a\u5305\u542b\u81ea\u5df1\u7684\u63a5\u6536\u7a97\u53e3\u7684\u5927\u5c0f\uff0c \u5e76\u4e14\u5229\u7528\u5927\u5c0f\u6765\u63a7\u5236\u53d1\u9001\u65b9\u7684\u6570\u636e\u53d1\u9001\u3002 1.3 \u6d41\u91cf\u63a7\u5236\u5f15\u53d1\u7684\u6b7b\u9501\uff1f\u600e\u4e48\u907f\u514d\u6b7b\u9501\u7684\u53d1\u751f\uff1f \u5f53\u53d1\u9001\u8005\u6536\u5230\u4e86\u4e00\u4e2a\u7a97\u53e3\u4e3a0\u7684\u5e94\u7b54\uff0c\u53d1\u9001\u8005\u4fbf\u505c\u6b62\u53d1\u9001\uff0c\u7b49\u5f85\u63a5\u6536\u8005\u7684\u4e0b\u4e00\u4e2a\u5e94\u7b54\u3002 \u4f46\u662f\u5982\u679c\u8fd9\u4e2a\u7a97\u53e3\u4e0d\u4e3a0\u7684\u5e94\u7b54\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e22\u5931\uff0c\u53d1\u9001\u8005\u4e00\u76f4\u7b49\u5f85\u4e0b\u53bb\uff0c\u800c\u63a5\u6536\u8005\u4ee5\u4e3a\u53d1\u9001\u8005\u5df2\u7ecf\u6536\u5230\u8be5\u5e94\u7b54\uff0c \u7b49\u5f85\u63a5\u6536\u65b0\u6570\u636e\uff0c\u8fd9\u6837\u53cc\u65b9\u5c31\u76f8\u4e92\u7b49\u5f85\uff0c\u4ece\u800c\u4ea7\u751f\u6b7b\u9501\u3002 \u4e3a\u4e86\u907f\u514d\u6d41\u91cf\u63a7\u5236\u5f15\u53d1\u7684\u6b7b\u9501\uff0cTCP\u4f7f\u7528\u4e86\u6301\u7eed\u8ba1\u65f6\u5668\u3002\u6bcf\u5f53\u53d1\u9001\u8005\u6536\u5230\u4e00\u4e2a\u96f6\u7a97\u53e3\u7684\u5e94\u7b54\u540e\u5c31\u542f\u52a8\u8be5\u8ba1\u65f6\u5668\u3002 \u65f6\u95f4\u4e00\u5230\u4fbf\u4e3b\u52a8\u53d1\u9001\u62a5\u6587\u8be2\u95ee\u63a5\u6536\u8005\u7684\u7a97\u53e3\u5927\u5c0f\u3002\u82e5\u63a5\u6536\u8005\u4ecd\u7136\u8fd4\u56de\u96f6\u7a97\u53e3\uff0c\u5219\u91cd\u7f6e\u8be5\u8ba1\u65f6\u5668\u7ee7\u7eed\u7b49\u5f85\uff1b \u82e5\u7a97\u53e3\u4e0d\u4e3a0\uff0c\u6b64\u65f6\u91cd\u7f6e\u53d1\u9001\u7a97\u53e3\u540e\u5f00\u59cb\u53d1\u9001\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u6b7b\u9501\u7684\u4ea7\u751f\u3002 \u4e09\u6b21\u63e1\u624b\u548c\u56db\u6b21\u6325\u624b \u4e09\u6b21\u63e1\u624b : \u7b2c\u4e00\u6b65\uff1a\u5ba2\u6237\u7aefTCP\u5411\u670d\u52a1\u7aefTCP\u53d1\u9001\u4e00\u4e2a\u7279\u6b8a\u62a5\u6587\u6bb5\uff0c\u8868\u793a\u5e0c\u671b\u5efa\u7acb\u8fde\u63a5\uff0c\u8be5\u62a5\u6587\u6bb5\u4e0d\u5305\u542b\u5e94\u7528\u5c42\u6570\u636e\uff0c\u968f\u673a\u521d\u59cb\u5316\u5e8f\u53f7\u5b57\u6bb5 \u6807\u5fd7\u4f4d\u4e2d\u7684SYN\u88ab\u7f6e\u4e3a1\uff0c\u88ab\u79f0\u4e3aSYN\u62a5\u6587\u6bb5\u3002 \u7b2c\u4e8c\u6b65\uff1a\u670d\u52a1\u7aef\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u9001\u7684SYN\u62a5\u6587\uff0c\u4e3a\u8be5TCP\u8fde\u63a5\u5206\u914dTCP\u7f13\u5b58\u548c\u53d8\u91cf\uff0c \u5e76\u5411\u5ba2\u6237\u7aefTCP\u53d1\u9001\u5141\u8bb8\u8fde\u63a5\u7684TCP\u62a5\u6587\u6bb5\uff0c\u8be5\u62a5\u6587\u6bb5\u968f\u673a\u521d\u59cb\u5316\u5e8f\u53f7\u5b57\u6bb5\uff0c\u786e\u8ba4\u53f7\u5b57\u6bb5\u4e3a\u6536\u5230\u7684\u5ba2\u6237\u7aef\u5e8f\u53f7\u503c+1\uff0c SYN\u6807\u5fd7\u4f4d\u548cACK\u6807\u5fd7\u4f4d\u88ab\u7f6e1\uff0c\u8be5\u62a5\u6587\u6bb5\u88ab\u79f0\u4e3aSYNACK\u62a5\u6587\u6bb5\u3002 \u7b2c\u4e09\u6b65\uff1a\u5728\u6536\u5230SYNACK\u62a5\u6587\u6bb5\u540e\uff0c\u5ba2\u6237\u7aef\u4e5f\u8981\u7ed9\u8fde\u63a5\u5206\u914d\u7f13\u5b58\u548c\u53d8\u91cf\uff0c\u7136\u540e\u5411\u670d\u52a1\u5668\u53d1\u9001\u5e94\u7b54\u62a5\u6587\uff0c \u8be5\u62a5\u6587ACK\u6807\u5fd7\u4f4d\u7f6e1\uff0cSYN\u6807\u5fd7\u4f4d\u7f6e0\uff0c\u786e\u8ba4\u53f7\u5b57\u6bb5\u4e3a\u6536\u5230\u7684\u670d\u52a1\u7aef\u5e8f\u53f7\u503c+1\uff0c\u7136\u540e\u5c06\u62a5\u6587\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\u3002 \u6b64\u6b21\u62a5\u6587\u53ef\u4ee5\u643a\u5e26\u5ba2\u6237\u5230\u670d\u52a1\u5668\u7684\u6570\u636e\u3002 \u4e3a\u4ec0\u4e48\u8981\u4e09\u6b21\u63e1\u624b : \u9996\u8981\u539f\u56e0\uff0c\u4e3a\u4e86\u9632\u6b62\u5df2\u5931\u6548\u7684\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u6bb5\u5728\u7f51\u7edc\u5ef6\u8fdf\u540e\u53c8\u5230\u8fbe\u4e86\u670d\u52a1\u7aef\uff0c\u4ea7\u751f\u9519\u8bef\u8fde\u63a5\u3002 client\u53d1\u51fa\u8fde\u63a5\u8bf7\u6c42\uff0c\u4f46\u56e0\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u672a\u88abserver\u63a5\u6536(\u53ef\u80fd\u4e22\u5931\u6216\u8005\u5ef6\u8fdf)\uff0c\u56e0\u6b64\u6ca1\u6709\u6536\u5230\u786e\u8ba4\u3002 \u4e8e\u662fA\u518d\u91cd\u4f20\u4e00\u6b21\u8bf7\u6c42\u8fde\u63a5\u3002\u540e\u6765\u6536\u5230\u4e86\u786e\u8ba4\uff0c\u5efa\u7acb\u4e86\u8fde\u63a5\u3002\u6570\u636e\u4f20\u8f93\u5b8c\u6bd5\u540e\uff0c\u5c31\u91ca\u653e\u4e86\u8fde\u63a5\u3002 \u4f46\u7b2c\u4e00\u6b21\u53d1\u9001\u7684\u8bf7\u6c42\u8fde\u63a5\u62a5\u6587\u5728\u8fde\u63a5\u91ca\u653e\u540e\u4e5f\u5230\u8fbeserver\uff0c\u867d\u7136\u8fd9\u662f\u4e00\u4e2a\u65e9\u5df2\u5931\u6548\u7684\u62a5\u6587\u6bb5\u3002 \u4f46server\u6536\u5230\u6b64\u5931\u6548\u7684\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u6bb5\u540e\uff0c\u8bef\u8ba4\u4e3a\u662fclient\u518d\u6b21\u53d1\u51fa\u7684\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42\u3002 \u4e8e\u662f\u5c31\u5411client\u53d1\u51fa\u786e\u8ba4\u62a5\u6587\u6bb5\uff0c\u540c\u610f\u5efa\u7acb\u8fde\u63a5\u3002\u5047\u8bbe\u4e0d\u91c7\u7528\u201c\u4e09\u6b21\u63e1\u624b\u201d\uff0c\u90a3\u4e48\u53ea\u8981server\u53d1\u51fa\u786e\u8ba4\uff0c \u65b0\u7684\u8fde\u63a5\u5c31\u5efa\u7acb\u4e86\u3002\u7531\u4e8e\u73b0\u5728client\u5e76\u6ca1\u6709\u53d1\u51fa\u5efa\u7acb\u8fde\u63a5\u7684\u8bf7\u6c42\uff0c\u4e0d\u4f1a\u5411server\u53d1\u9001\u6570\u636e\u3002 \u4f46server\u4e00\u76f4\u7b49\u5f85client\u53d1\u6765\u6570\u636e\u3002\u8fd9\u6837\uff0cserver\u5c06\u6d6a\u8d39\u8bb8\u591a\u8d44\u6e90\u5728\u7b49\u5f85\u3002 \u5982\u679c\u662f\u4e09\u6b21\u63e1\u624b\uff0c\u5ba2\u6237\u7aef\u5219\u53ef\u4ee5\u53d1\u9001RST\u62a5\u6587\u7ed9\u670d\u52a1\u7aef\uff0c\u4e2d\u6b62\u6b64\u6b21\u8fde\u63a5\u3002 \u7b2c\u4e8c\u4e2a\u539f\u56e0\uff0c\u662f\u4e3a\u4e86\u540c\u6b65\u53cc\u65b9\u521d\u59cb\u5e8f\u5217\u53f7\uff0c\u4e24\u6b21\u63e1\u624b\u867d\u7136\u8ba9\u53cc\u65b9\u5c31\u53d1\u9001\u7aef\u7684\u5e8f\u5217\u53f7\u8fbe\u6210\u540c\u6b65\uff0c \u4f46TCP\u8fde\u63a5\u662f\u53cc\u5411\u7684\uff0c\u56e0\u6b64\u4e5f\u9700\u8981\u5c31\u670d\u52a1\u7aef\u7684\u5e8f\u5217\u53f7\u8fbe\u6210\u540c\u6b65\uff1b \u4f46\u6b64\u65f6\u65e0\u6cd5\u786e\u4fddclient\u6536\u5230server\u8fd4\u56de\u7684\u786e\u8ba4\u62a5\u6587\uff0c\u56e0\u6b64\u53cc\u65b9\u65e0\u6cd5\u5c31\u670d\u52a1\u7aef\u5e8f\u5217\u53f7\u8fbe\u6210\u540c\u6b65\u3002 \u56db\u6b21\u63e1\u624b\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u76ee\u7684\uff0c\u4f46\u7531\u4e8e\u4e09\u6b21\u63e1\u624b\u5373\u53ef\u5b9e\u73b0\u9700\u6c42\uff0c\u6240\u4ee5\u65e0\u9700\u989d\u5916\u7684\u786e\u8ba4\u3002 \u56db\u6b21\u6325\u624b : 1\u3001\u5ba2\u6237\u7aef\u6253\u7b97\u5173\u95ed\u8fde\u63a5\uff0c\u4f1a\u53d1\u9001\u4e00\u4e2a\u7279\u6b8a\u62a5\u6587\uff0c\u8be5TCP\u62a5\u6587\u6bb5\u7684FIN\u6807\u5fd7\u4f4d\u7f6e1\uff1b 2\u3001\u670d\u52a1\u7aef\u63a5\u6536\u5230FIN\u62a5\u6587\uff0c\u4f1a\u5411\u5ba2\u6237\u7aef\u53d1\u9001ACK\u5e94\u7b54\u62a5\u6587\uff1b\u5ba2\u6237\u7aef\u63a5\u6536\u5230ACK\u62a5\u6587\uff0c\u4fbf\u4e0d\u4f1a\u518d\u91cd\u53d1FIN\u62a5\u6587 3\u3001\u670d\u52a1\u7aef\u5904\u7406\u5b8c\u6570\u636e\u540e\uff0c\u5411\u5ba2\u6237\u7aef\u53d1\u9001FIN\u62a5\u6587\uff1b 4\u3001\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u670d\u52a1\u7aef\u7684FIN\u62a5\u6587\u540e\uff0c\u4e5f\u4f1a\u56de\u590d\u4e00\u4e2aACK\u62a5\u6587\uff0c\u7136\u540e\u8fdb\u5165TIME_WAIT\u72b6\u6001\u3002 5\u3001\u670d\u52a1\u5668\u6536\u5230ACK\u62a5\u6587\u540e\uff0c\u5c31\u8fdb\u5165close\u72b6\u6001\uff0c\u5b8c\u6210\u8fde\u63a5\u7684\u5173\u95ed\u3002 \u5ba2\u6237\u7aef\u5728\u7b49\u5f852MSL\u540e\uff0c\u81ea\u52a8\u8fdb\u5165close\u72b6\u6001\uff0c\u5ba2\u6237\u7aef\u4e5f\u5b8c\u6210\u8fde\u63a5\u7684\u5173\u95ed\u3002 \u4e3a\u4ec0\u4e48\u9700\u8981\u56db\u6b21\u6325\u624b \u670d\u52a1\u7aef\u901a\u5e38\u9700\u8981\u7b49\u5f85\u5b8c\u6210\u6570\u636e\u7684\u53d1\u9001\u548c\u5904\u7406\uff0c\u56e0\u6b64\u670d\u52a1\u7aef\u7684ACK\u548cFIN\u62a5\u6587\u662f\u5206\u5f00\u53d1\u9001\u7684\uff0c \u4ece\u800c\u6bd4\u4e09\u6b21\u63e1\u624b\u591a\u4e00\u6b21\u3002 MSL\uff1amaximum segment lifetime, \u62a5\u6587\u6700\u5927\u751f\u5b58\u65f6\u95f4 \u4e3a\u4ec0\u4e48\u9700\u8981TIME_WAIT\u72b6\u6001 \uff1a 1\u3001\u786e\u4fdd\u4e3b\u52a8\u5173\u95ed\u65b9\u53d1\u9001\u7684ACK\u5e94\u7b54\u62a5\u6587\u88ab\u6b63\u786e\u63a5\u6536:\u901a\u5e38\u53ea\u6709\u4e3b\u52a8\u5173\u95ed\u65b9\u624d\u4f1a\u8fdb\u5165TIME_WAIT\u72b6\u6001\uff0c \u5047\u5982\u5ba2\u6237\u7aef\u662f\u4e3b\u52a8\u5173\u95ed\u65b9\uff0c\u800c\u5ba2\u6237\u7aef\u5728\u63a5\u53d7\u5230\u670d\u52a1\u7aef\u7684FIN\u62a5\u6587\u540e\uff0c\u5411\u670d\u52a1\u7aef\u53d1\u9001ACK\u62a5\u6587\u540e\uff0c\u76f4\u63a5\u8fdb\u5165close\u72b6\u6001\uff0c \u5220\u9664\u5957\u63a5\u5b57\uff1b\u800c\u8be5ACK\u62a5\u6587\u4e22\u5931\uff0c\u670d\u52a1\u7aef\u5728\u7b49\u5f85\u8d85\u65f6\u540e\uff0c\u5c31\u4f1a\u91cd\u53d1FIN\u62a5\u6587\uff1b \u5f53\u670d\u52a1\u7aef\u91cd\u53d1\u7684FIN\u62a5\u6587\u5230\u8fbe\u5ba2\u6237\u7aef\u65f6\uff0c\u5ba2\u6237\u7aef\u4f1a\u8ba4\u4e3a\u5176\u662f\u4e00\u4e2a\u975e\u6cd5\u62a5\u6587\u6bb5\uff0c\u4e8e\u662f\u8fd4\u56de\u4e00\u4e2aRST\u62a5\u6587\uff0c \u8868\u793a\u8fde\u63a5\u5f02\u5e38\uff0c\u5219\u670d\u52a1\u5668\u7aef\u5957\u63a5\u5b57\u4e0d\u80fd\u8fdb\u5165\u6b63\u5e38\u7684\u5173\u95ed\u72b6\u6001\u3002 2\u3001\u786e\u4fdd\u5386\u53f2\u8fde\u63a5\u8fc7\u7a0b\u7684\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e2d\u8fc7\u671f\u800c\u6d88\u5931: \u5728\u7b2c\u56db\u6b21\u6325\u624b\u540e\uff0c\u7ecf\u8fc72msl\u7684\u65f6\u95f4\u8db3\u4ee5\u8ba9\u672c\u6b21\u8fde\u63a5\u4ea7\u751f\u7684\u6240\u6709\u62a5\u6587\u6bb5\u90fd\u4ece\u7f51\u7edc\u4e2d\u6d88\u5931\uff0c \u8fd9\u6837\u4e0b\u4e00\u6b21\u65b0\u7684\u8fde\u63a5\u4e2d\u5c31\u80af\u5b9a\u4e0d\u4f1a\u51fa\u73b0\u65e7\u8fde\u63a5\u7684\u62a5\u6587\u6bb5\u4e86; \u6ca1\u6709time-wait, \u5982\u679c\u6b64\u65f6\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53c8\u5efa\u7acb\u4e86\u65b0\u7684TCP\u8fde\u63a5\uff0c\u4e14\u548c\u5386\u53f2\u8fde\u63a5\u91c7\u7528\u4e86\u76f8\u540c\u7684\u7aef\u53e3\uff0c \u800c\u5386\u53f2\u8fde\u63a5\u7684\u6570\u636e\u5305\u53ef\u80fd\u5728\u5ef6\u8fdf\u540e\u5230\u8fbe\u63a5\u6536\u7aef\uff0c\u4f1a\u88ab\u5f53\u6210\u6b64\u6b21\u8fde\u63a5\u4e2d\u7684\u6570\u636e\u5305\u800c\u6b63\u5e38\u63a5\u6536\uff0c\u4ece\u800c\u9020\u6210\u6570\u636e\u9519\u4e71\u3002 SYN cookie \u2003SYN Cookie\u662f\u5bf9TCP\u670d\u52a1\u5668\u7aef\u7684\u4e09\u6b21\u63e1\u624b\u534f\u8bae\u4f5c\u4e00\u4e9b\u4fee\u6539\uff0c\u4e13\u95e8\u7528\u6765\u9632\u8303SYN Flood\u653b\u51fb\u7684\u4e00\u79cd\u624b\u6bb5\u3002\u5b83\u7684\u539f\u7406\u662f\uff0c\u5728TCP\u670d\u52a1\u5668\u6536\u5230\u53d1\u9001\u65b9SYN\u6570\u636e\u5305\u5e76\u8fd4\u56deSYNACK\u6570\u636e\u5305\u65f6\uff0c\u4e0d\u4f1a\u5148\u4e3a\u8be5TCP\u8fde\u63a5\u5206\u914d\u7f13\u5b58\uff0c\u800c\u662f\u6839\u636e\u8fd9\u4e2aSYN\u6570\u636e\u5305\u8ba1\u7b97\u51fa\u4e00\u4e2acookie\u503c\u3002\u5728\u6536\u5230\u53d1\u9001\u65b9\u8fd4\u56de\u7684ACK\u6570\u636e\u5305\u65f6\uff0c\u670d\u52a1\u5668\u6839\u636ecookie\u503c\u68c0\u67e5\u8fd9\u4e2aACK\u6570\u636e\u5305\u7684\u5408\u6cd5\u6027\u3002\u5982\u679c\u5408\u6cd5\uff0c\u518d\u5206\u914d\u4e13\u95e8\u7684\u6570\u636e\u533a\u8fdb\u884c\u5904\u7406\u672a\u6765\u7684TCP\u8fde\u63a5\u3002 TCP\u62e5\u585e\u63a7\u5236 \u6d41\u91cf\u63a7\u5236\u4e0e\u62e5\u585e\u63a7\u5236 \u62e5\u585e\u63a7\u5236\uff1a\u62e5\u585e\u63a7\u5236\u662f\u4f5c\u7528\u4e8e\u7f51\u7edc\u7684\uff0c\u5b83\u662f\u9632\u6b62\u8fc7\u591a\u7684\u6570\u636e\u6ce8\u5165\u5230\u7f51\u7edc\u4e2d\uff0c\u907f\u514d\u51fa\u73b0\u7f51\u7edc\u8d1f\u8f7d\u8fc7\u5927\u7684\u60c5\u51b5\uff1b \u5e38\u7528\u7684\u65b9\u6cd5\u5c31\u662f\uff1a\uff08 1 \uff09\u6162\u5f00\u59cb\u3001\u62e5\u585e\u907f\u514d\uff08 2 \uff09\u5feb\u91cd\u4f20\u3001\u5feb\u6062\u590d\u3002 \u6d41\u91cf\u63a7\u5236\uff1a\u6d41\u91cf\u63a7\u5236\u662f\u4f5c\u7528\u4e8e\u63a5\u6536\u8005\u7684\uff0c\u5b83\u662f\u63a7\u5236\u53d1\u9001\u8005\u7684\u53d1\u9001\u901f\u5ea6\u4ece\u800c\u4f7f\u63a5\u6536\u8005\u6765\u5f97\u53ca\u63a5\u6536\uff0c\u9632\u6b62\u5206\u7ec4\u4e22\u5931\u3002 TCP\u4e0eUDP\u4e0d\u540c \u8fde\u63a5 TCP \u662f\u9762\u5411\u8fde\u63a5\u7684\u4f20\u8f93\u5c42\u534f\u8bae\uff0c\u4f20\u8f93\u6570\u636e\u524d\u5148\u8981\u5efa\u7acb\u8fde\u63a5\u3002 UDP \u662f\u4e0d\u9700\u8981\u8fde\u63a5\uff0c\u5373\u523b\u4f20\u8f93\u6570\u636e\u3002 \u670d\u52a1\u5bf9\u8c61 TCP \u662f\u4e00\u5bf9\u4e00\u7684\u4e24\u70b9\u670d\u52a1\uff0c\u5373\u4e00\u6761\u8fde\u63a5\u53ea\u6709\u4e24\u4e2a\u7aef\u70b9\u3002 UDP \u652f\u6301\u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a\u3001\u591a\u5bf9\u591a\u7684\u4ea4\u4e92\u901a\u4fe1 \u53ef\u9760\u6027 TCP \u662f\u53ef\u9760\u4ea4\u4ed8\u6570\u636e\u7684\uff0c\u6570\u636e\u53ef\u4ee5\u65e0\u5dee\u9519\u3001\u4e0d\u4e22\u5931\u3001\u4e0d\u91cd\u590d\u3001\u6309\u9700\u5230\u8fbe\u3002 UDP \u662f\u5c3d\u6700\u5927\u52aa\u529b\u4ea4\u4ed8\uff0c\u4e0d\u4fdd\u8bc1\u53ef\u9760\u4ea4\u4ed8\u6570\u636e\u3002 \u62e5\u585e\u63a7\u5236\u3001\u6d41\u91cf\u63a7\u5236 TCP \u6709\u62e5\u585e\u63a7\u5236\u548c\u6d41\u91cf\u63a7\u5236\u673a\u5236\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u6027\u3002 UDP \u5219\u6ca1\u6709\uff0c\u5373\u4f7f\u7f51\u7edc\u975e\u5e38\u62e5\u5835\u4e86\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd UDP \u7684\u53d1\u9001\u901f\u7387\u3002 \u9996\u90e8\u5f00\u9500 TCP \u9996\u90e8\u957f\u5ea6\u8f83\u957f\uff0c\u4f1a\u6709\u4e00\u5b9a\u7684\u5f00\u9500\uff0c\u9996\u90e8\u5728\u6ca1\u6709\u4f7f\u7528\u300c\u9009\u9879\u300d\u5b57\u6bb5\u65f6\u662f 20 \u4e2a\u5b57\u8282\uff0c\u5982\u679c\u4f7f\u7528\u4e86\u300c\u9009\u9879\u300d\u5b57\u6bb5\u5219\u4f1a\u53d8\u957f\u7684\u3002 UDP \u9996\u90e8\u53ea\u6709 8 \u4e2a\u5b57\u8282\uff0c\u5e76\u4e14\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0c\u5f00\u9500\u8f83\u5c0f\u3002 TCP\u662f\u9762\u5411\u5b57\u8282\u6d41\u7684 \uff0c\u5176\u5c06\u5e94\u7528\u5c42\u4f20\u9012\u7684\u6570\u636e\u770b\u6210\u65e0\u7ed3\u6784\u7684\u5b57\u8282\u6d41\uff0cTCP\u6709\u4e00\u4e2a\u7f13\u51b2\uff0c\u5f53\u5e94\u7528\u7a0b\u5e8f\u4f20\u9001\u7684\u6570\u636e\u5757\u592a\u957f\uff0cTCP\u5c31\u53ef\u4ee5\u628a\u5b83\u5212\u5206\u77ed\u4e00\u4e9b\u518d\u4f20\u9001\u3002\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u4e00\u6b21\u53ea\u53d1\u9001\u4e00\u4e2a\u5b57\u8282\uff0cTCP\u4e5f\u53ef\u4ee5\u7b49\u5f85\u79ef\u7d2f\u6709\u8db3\u591f\u591a\u7684\u5b57\u8282\u540e\u518d\u6784\u6210\u62a5\u6587\u6bb5\u53d1\u9001\u51fa\u53bb\u3002\u5e76\u4e14\u6839\u636e\u5f53\u524d\u7f51\u7edc\u7684\u62e5\u585e\u7a0b\u5ea6\u6765\u51b3\u5b9a\u6bcf\u4e2a\u62a5\u6587\u6bb5\u5927\u5c0f\uff1b UDP\u662f\u9762\u5411\u6570\u636e\u5305\u7684 \uff1a\u53d1\u9001\u65b9\u7684UDP\u5bf9\u5e94\u7528\u5c42\u4ea4\u4e0b\u6765\u7684\u62a5\u6587\uff0c\u4e0d\u5408\u5e76\uff0c\u4e0d\u62c6\u5206\uff0c\u53ea\u662f\u5728\u5176\u4e0a\u9762\u52a0\u4e0a\u9996\u90e8\u540e\u5c31\u4ea4\u7ed9\u4e86\u4e0b\u9762\u7684\u7f51\u7edc\u5c42\uff1b\u5bf9\u4e8e\u8fc7\u957f\u7684\u62a5\u6587\u6bb5\uff0c\u5728\u7f51\u7edc\u5c42\uff0c\u4f1a\u9488\u5bf9IP\u6570\u636e\u62a5\u8fdb\u884c\u5206\u7247\u3002","title":"transport"},{"location":"Network/2_transport/#_1","text":"","title":"\u4f20\u8f93\u5c42"},{"location":"Network/2_transport/#vs","text":"\u4f20\u8f93\u5c42\u534f\u8bae\u53ea\u5de5\u4f5c\u5728\u7aef\u7cfb\u7edf\uff0c\u5728\u7aef\u7cfb\u7edf\u4e2d\uff0c\u4f20\u8f93\u5c42\u534f\u8bae\u5c06\u6765\u81ea\u5e94\u7528\u8fdb\u7a0b\u7684\u62a5\u6587\u79fb\u52a8\u5230\u7f51\u7edc\u8fb9\u7f18(\u7f51\u7edc\u5c42)\uff1b\u7f51\u7edc\u8def\u7531\u5668\u4ec5\u4f5c\u7528\u5230\u6570\u636e\u6bb5\u7684\u7f51\u7edc\u5c42\u5b57\u6bb5\uff0c\u4e0d\u4f1a\u68c0\u67e5\u5c01\u88c5\u5728\u6570\u636e\u6bb5\u4e2d\u7684\u4f20\u8f93\u5c42\u5b57\u6bb5\u3002","title":"\u4f20\u8f93\u5c42 v.s \u5e94\u7528\u5c42"},{"location":"Network/2_transport/#_2","text":"\u5c06\u4e3b\u673a\u95f4\u4ea4\u4ed8\u6269\u5c55\u5230\u8fdb\u7a0b\u95f4\u4ea4\u4ed8\u3002 \u5c06\u4f20\u8f93\u5c42\u62a5\u6587\u6bb5\u4e2d\u7684\u6570\u636e\u4ea4\u4ed8\u5230\u6b63\u786e\u7684socket\u7684\u5de5\u4f5c\u79f0\u4e3a\u591a\u8def\u5206\u7528 \uff1b \u5728\u6e90\u4e3b\u673a\u4e2d \u4ece\u4e0d\u540csocket\u6536\u96c6\u6570\u636e\u5757\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u6570\u636e\u5757\u5c01\u88c5\u9996\u90e8\u4fe1\u606f\u4ece\u800c\u751f\u6210\u62a5\u6587\u6bb5\uff0c\u7136\u540e\u4f20\u9012\u5230\u7f51\u7edc\u5c42 \u3002 \u5206\u7528 \u65e0\u8fde\u63a5\u5206\u7528 \u9762\u5411\u8fde\u63a5\u7684\u5206\u7528","title":"\u591a\u8def\u590d\u7528/\u5206\u7528"},{"location":"Network/2_transport/#udp","text":"UDP\u534f\u8bae UDP\u62a5\u6587\u683c\u5f0f","title":"UDP"},{"location":"Network/2_transport/#rdt","text":"","title":"\u53ef\u9760\u6570\u636e\u4f20\u8f93(RDT)"},{"location":"Network/2_transport/#tcp","text":"MSS(Maximum Segment Size): TCP\u53ef\u4ece\u53d1\u9001\u7f13\u5b58\u4e2d\u53d6\u51fa\u5e76\u653e\u5165\u62a5\u6587\u6bb5\u4e2d\u7684\u6700\u5927\u6570\u636e\u91cf; MTU(Maximum Transmission Unit): \u6700\u5927\u94fe\u8def\u5e27\u957f\u5ea6 \u8003\u8651\u5230\u4ee5\u592a\u7f51\u548cPPP\u94fe\u8def\u5c42\u534f\u8bae\u90fd\u5177\u67091500\u5b57\u8282\u7684MTU\uff0c\u800cTCP\u6570\u636e\u6bb5header\u4e00\u822c\u4e3a20\u5b57\u8282\uff0c\u518d\u6709IP\u6570\u636e\u62a5\u7684header\u4e5f\u4e3a20\u5b57\u8282\uff0c \u56e0\u6b64MSS\u7684\u5178\u578b\u503c\u4e3a1460\u5b57\u8282\u3002 TCP\u6570\u636e\u6bb5 \u2003\u5e8f\u5217\u53f7\u548c\u786e\u8ba4\u53f7\u7528\u6765\u5b9e\u73b0\u53ef\u9760\u6570\u636e\u4f20\u8f93\u670d\u52a1\uff1b\u5176\u4e2d\u5e8f\u5217\u53f7\u662f\u62a5\u6587\u6bb5\u9996\u5b57\u8282\u7684\u5b57\u8282\u6d41\u7f16\u53f7\uff0c \u63a5\u6536\u65b9\u6839\u636e\u5e8f\u5217\u53f7\u53ef\u4ee5\u53bb\u9664\u91cd\u590d\u6570\u636e\uff0c\u4fdd\u8bc1\u6309\u5e8f\u63a5\u6536\u6570\u636e\u5305\uff1b\u53d1\u9001\u65b9\u5219\u53ef\u4ee5\u7528\u6765\u6807\u8bc6\u53d1\u9001\u51fa\u53bb\u7684\u6570\u636e\u5305\u54ea\u4e9b\u662f\u88ab\u6b63\u786e\u63a5\u6536\u4e86 \uff1b\u786e\u8ba4\u53f7\u662f\u63a5\u6536\u65b9\u671f\u671b\u63a5\u6536\u7684\u4e0b\u4e00\u5b57\u8282\u7684\u5e8f\u53f7\uff0c \u7528\u6765\u89e3\u51b3\u4e22\u5305\u7684\u95ee\u9898 \u3002 \u20036 bit\u7684\u6807\u5fd7\u4f4d: ACK\u4f4d\u7528\u6765\u6307\u793a\u786e\u8ba4\u53f7\u662f\u6709\u6548\u7684\uff0c\u5373\u5bf9\u4e00\u4e2a\u5df2\u88ab\u6210\u529f\u63a5\u6536\u62a5\u6587\u6bb5\u7684\u786e\u8ba4( TCP\u89c4\u5b9a\u9664\u4e86\u6700\u521d\u8bf7\u6c42\u5efa\u7acb\u8fde\u63a5\u65f6\u7684SYN\u62a5\u6587\u6bb5\u4e4b\u5916\u8be5\u4f4d\u5fc5\u987b\u8bbe\u7f6e\u4e3a1 )\uff1bRST( \u8868\u793aTCP\u8fde\u63a5\u4e2d\u51fa\u73b0\u5f02\u5e38\u5fc5\u987b\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5 )\u3001FIN( \u8868\u793a\u4e0d\u4f1a\u518d\u6709\u6570\u636e\u53d1\u9001\uff0c\u5e0c\u671b\u65ad\u5f00\u8fde\u63a5 )\u3001SYN( \u5e0c\u671b\u5efa\u7acb\u8fde\u63a5 )\u7528\u4e8e\u8fde\u63a5\u5efa\u7acb\u548c\u5220\u9664\uff1b PSH\u6307\u793a\u63a5\u6536\u65b9\u5e94\u7acb\u523b\u5c06\u6570\u636e\u4ea4\u7ed9\u4e0a\u5c42\uff1bURG\u6307\u793a\u62a5\u6587\u6bb5\u5b58\u5728\u88ab\u53d1\u9001\u7aef\u4e0a\u5c42\u5e94\u7528\u6807\u8bb0\u4e3a\u7d27\u6025\u7684\u6570\u636e\u3002(\u5b9e\u8df5\u4e2d\uff0cPSH\u3001URG\u4ee5\u53ca\u7d27\u6025\u6570\u636e\u6307\u9488\u5e76\u6ca1\u6709\u4f7f\u7528) TCP\u53ef\u9760\u6570\u636e\u4f20\u8f93 \u2003 \u6d41\u6c34\u7ebf\u673a\u5236 : \u51c6\u786e\u6765\u8bf4\u662f\u6ed1\u52a8\u7a97\u53e3\u673a\u5236\uff0c\u53d1\u9001\u65b9\u5728\u53d1\u9001\u4e00\u4e2a\u7f51\u7edc\u5305\u540e\uff0c\u4e0d\u7b49\u5f85ACK\u53f7\u8fd4\u56de\uff0c\u800c\u662f\u76f4\u63a5\u53d1\u9001\u540e\u7eed\u4e00\u7cfb\u5217\u7684\u5305\uff1b\u5f53\u63a5\u6536\u65b9\u6536\u5230\u7f51\u7edc\u5305\u540e\uff0c\u4f1a\u5148\u5c06\u6570\u636e\u5b58\u653e\u5230\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u3002\u7136\u540e\uff0c\u63a5\u6536\u65b9\u8ba1\u7b97ACK\u53f7\u548c\u5269\u4f59\u63a5\u6536\u7f13\u5b58\u533a\u5927\u5c0fRecvWindow\uff0c\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\uff0c\u53d1\u9001\u65b9\u6839\u636eRecvWindow\u5927\u5c0f\u5bf9\u6570\u636e\u53d1\u9001\u64cd\u4f5c\u8fdb\u884c\u63a7\u5236\uff0c\u8fd9\u5c31\u662f\u6ed1\u52a8\u7a97\u53e3\u65b9\u5f0f\u7684\u57fa\u672c\u601d\u8def\u3002 \u2003RecvWindow\u66f4\u65b0\u65f6\u673a\u53d1\u751f\u5728\u63a5\u6536\u65b9\u4e0a\u5c42\u5e94\u7528\u5c42\u4ece\u63a5\u6536\u7f13\u5b58\u533a\u4e2d\u53d6\u51fa\u6570\u636e\u540e\uff0c\u5bfc\u81f4\u7f13\u5b58\u533a\u5269\u4f59\u5bb9\u91cf\u589e\u52a0\u65f6\uff0c\u63a5\u6536\u65b9\u4f1a\u66f4\u65b0\u7a97\u53e3\u5927\u5c0f\u3002 \u2003\u63a5\u6536\u65b9\u5728\u53d1\u9001ACK\u53f7\u548c\u7a97\u53e3\u66f4\u65b0\u65f6\uff0c\u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u628a\u5305\u53d1\u9001\u51fa\u53bb\uff0c\u800c\u662f\u4f1a\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5f88\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u5176\u4ed6\u7684\u901a\u77e5\u64cd\u4f5c\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u4e24\u79cd\u901a\u77e5\u5408\u5e76\u5728\u4e00\u4e2a\u5305\u91cc\u9762\u53d1\u9001\u4e86\u3002\u4f8b\u5982\uff0c\u5728\u7b49\u5f85\u53d1\u9001ACK\u53f7\u7684\u65f6\u5019\u6b63\u597d\u9700\u8981\u66f4\u65b0\u7a97\u53e3\uff0c\u8fd9\u65f6\u5c31\u53ef\u4ee5\u628aACK\u53f7\u548c\u7a97\u53e3\u66f4\u65b0\u653e\u5728\u4e00\u4e2a\u5305\u91cc\u53d1\u9001\uff0c\u4ece\u800c\u51cf\u5c11\u5305\u7684\u6570\u91cf\u3002\u5f53\u9700\u8981\u8fde\u7eed\u53d1\u9001\u591a\u4e2aACK\u53f7\u65f6\uff0c\u4e5f\u53ef\u4ee5\u51cf\u5c11\u5305\u7684\u6570\u91cf\uff0c\u8fd9\u662f\u56e0\u4e3aACK\u53f7\u8868\u793a\u7684\u662f\u5df2\u6536\u5230\u7684\u6570\u636e\u91cf\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u662f\u544a\u8bc9\u53d1\u9001\u65b9\u76ee\u524d\u5df2\u63a5\u6536\u7684\u6570\u636e\u7684\u6700\u540e\u4f4d\u7f6e\u5728\u54ea\u91cc\uff0c\u56e0\u6b64 \u5f53\u9700\u8981\u8fde\u7eed\u53d1\u9001ACK\u53f7\u65f6\uff0c\u53ea\u8981\u53d1\u9001\u6700\u540e\u4e00\u4e2aACK\u53f7\u5c31\u53ef\u4ee5\u4e86 \uff0c\u4e2d\u95f4\u7684\u53ef\u4ee5\u5168\u90e8\u7701\u7565\u3002\u5f53\u9700\u8981\u8fde\u7eed\u53d1\u9001\u591a\u4e2a\u7a97\u53e3\u66f4\u65b0\u65f6\u4e5f\u53ef\u4ee5\u51cf\u5c11\u5305\u7684\u6570\u91cf\uff0c\u56e0\u4e3a\u8fde\u7eed\u53d1\u751f\u7a97\u53e3\u66f4\u65b0\u8bf4\u660e\u5e94\u7528\u7a0b\u5e8f\u8fde\u7eed\u8bf7\u6c42\u4e86\u6570\u636e\uff0c\u63a5\u6536\u7f13\u51b2\u533a\u7684\u5269\u4f59\u7a7a\u95f4\u8fde\u7eed\u589e\u52a0\u3002\u8fd9\u79cd\u60c5\u51b5\u548cACK\u53f7\u4e00\u6837\uff0c\u53ef\u4ee5\u7701\u7565\u4e2d\u95f4\u8fc7\u7a0b\uff0c\u53ea\u8981\u53d1\u9001\u6700\u7ec8\u7684\u7ed3\u679c\u5c31\u53ef\u4ee5\u4e86\u3002 \u2003 \u8d85\u65f6\u91cd\u4f20 : TCP\u534f\u8bae\u8981\u6c42\u5728\u53d1\u9001\u7aef\u6bcf\u53d1\u9001\u4e00\u4e2a\u62a5\u6587\u6bb5\uff0c\u5c31\u542f\u52a8\u4e00\u4e2a\u5b9a\u65f6\u5668\u5e76\u7b49\u5f85\u786e\u8ba4\u4fe1\u606f\uff1b\u63a5\u6536\u7aef\u6210\u529f\u63a5\u6536\u65b0\u6570\u636e\u540e\u8fd4\u56de\u786e\u8ba4\u4fe1\u606f\u3002\u82e5\u5728\u5b9a\u65f6\u5668\u8d85\u65f6\u524d\u6570\u636e\u672a\u80fd\u88ab\u786e\u8ba4\uff0cTCP\u5c31\u8ba4\u4e3a\u62a5\u6587\u6bb5\u4e2d\u7684\u6570\u636e\u5df2\u4e22\u5931\u6216\u635f\u574f\uff0c\u9700\u8981\u5bf9\u62a5\u6587\u6bb5\u4e2d\u7684\u6570\u636e\u91cd\u65b0\u7ec4\u7ec7\u548c\u91cd\u4f20\u3002 \u2003TCP\u91c7\u7528\u7684\u662f\u7d2f\u8ba1\u786e\u8ba4\u673a\u5236\uff0c\u5f53\u53d1\u9001\u65b9\u63a5\u6536\u52303\u4e2a\u5197\u4f59ACK(\u5047\u8bbeACK\u53f7\u4e3aK)\u65f6\uff0c\u610f\u5473\u7740\u5e8f\u5217\u53f7\u4e3aK\u7684\u6570\u636e\u5305\u53ef\u80fd\u5df2\u7ecf\u4e22\u5931\uff0cTCP\u5c31\u4f1a\u6267\u884c\u5feb\u901f\u91cd\u4f20\u4ece\u5e8f\u5217\u53f7K\u5f00\u59cb\u7684\u6570\u636e\u5305\u3002 TCP\u6d41\u91cf\u63a7\u5236 1.1 \u4ec0\u4e48\u662f\u6d41\u91cf\u63a7\u5236\uff1f\u6d41\u91cf\u63a7\u5236\u7684\u76ee\u7684\uff1f \u5982\u679c\u53d1\u9001\u8005\u53d1\u9001\u6570\u636e\u8fc7\u5feb\uff0c\u63a5\u6536\u8005\u6765\u4e0d\u53ca\u63a5\u6536\uff0c\u90a3\u4e48\u5c31\u4f1a\u6709\u5206\u7ec4\u4e22\u5931\u3002\u4e3a\u4e86\u907f\u514d\u5206\u7ec4\u4e22\u5931\uff0c \u63a7\u5236\u53d1\u9001\u8005\u7684\u53d1\u9001\u901f\u5ea6\uff0c\u4f7f\u5f97\u63a5\u6536\u8005\u6765\u5f97\u53ca\u63a5\u6536\uff0c\u8fd9\u5c31\u662f\u6d41\u91cf\u63a7\u5236\u3002 \u6d41\u91cf\u63a7\u5236\u6839\u672c\u76ee\u7684\u662f\u9632\u6b62\u5206\u7ec4\u4e22\u5931\uff0c\u5b83\u662f\u6784\u6210TCP\u53ef\u9760\u6027\u7684\u4e00\u65b9\u9762\u3002 1.2 \u5982\u4f55\u5b9e\u73b0\u6d41\u91cf\u63a7\u5236\uff1f \u4e3b\u8981\u7684\u65b9\u5f0f\u5c31\u662f\u63a5\u6536\u65b9\u8fd4\u56de\u7684\u6570\u636e\u6bb5\u4e2d\u4f1a\u5305\u542b\u81ea\u5df1\u7684\u63a5\u6536\u7a97\u53e3\u7684\u5927\u5c0f\uff0c \u5e76\u4e14\u5229\u7528\u5927\u5c0f\u6765\u63a7\u5236\u53d1\u9001\u65b9\u7684\u6570\u636e\u53d1\u9001\u3002 1.3 \u6d41\u91cf\u63a7\u5236\u5f15\u53d1\u7684\u6b7b\u9501\uff1f\u600e\u4e48\u907f\u514d\u6b7b\u9501\u7684\u53d1\u751f\uff1f \u5f53\u53d1\u9001\u8005\u6536\u5230\u4e86\u4e00\u4e2a\u7a97\u53e3\u4e3a0\u7684\u5e94\u7b54\uff0c\u53d1\u9001\u8005\u4fbf\u505c\u6b62\u53d1\u9001\uff0c\u7b49\u5f85\u63a5\u6536\u8005\u7684\u4e0b\u4e00\u4e2a\u5e94\u7b54\u3002 \u4f46\u662f\u5982\u679c\u8fd9\u4e2a\u7a97\u53e3\u4e0d\u4e3a0\u7684\u5e94\u7b54\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e22\u5931\uff0c\u53d1\u9001\u8005\u4e00\u76f4\u7b49\u5f85\u4e0b\u53bb\uff0c\u800c\u63a5\u6536\u8005\u4ee5\u4e3a\u53d1\u9001\u8005\u5df2\u7ecf\u6536\u5230\u8be5\u5e94\u7b54\uff0c \u7b49\u5f85\u63a5\u6536\u65b0\u6570\u636e\uff0c\u8fd9\u6837\u53cc\u65b9\u5c31\u76f8\u4e92\u7b49\u5f85\uff0c\u4ece\u800c\u4ea7\u751f\u6b7b\u9501\u3002 \u4e3a\u4e86\u907f\u514d\u6d41\u91cf\u63a7\u5236\u5f15\u53d1\u7684\u6b7b\u9501\uff0cTCP\u4f7f\u7528\u4e86\u6301\u7eed\u8ba1\u65f6\u5668\u3002\u6bcf\u5f53\u53d1\u9001\u8005\u6536\u5230\u4e00\u4e2a\u96f6\u7a97\u53e3\u7684\u5e94\u7b54\u540e\u5c31\u542f\u52a8\u8be5\u8ba1\u65f6\u5668\u3002 \u65f6\u95f4\u4e00\u5230\u4fbf\u4e3b\u52a8\u53d1\u9001\u62a5\u6587\u8be2\u95ee\u63a5\u6536\u8005\u7684\u7a97\u53e3\u5927\u5c0f\u3002\u82e5\u63a5\u6536\u8005\u4ecd\u7136\u8fd4\u56de\u96f6\u7a97\u53e3\uff0c\u5219\u91cd\u7f6e\u8be5\u8ba1\u65f6\u5668\u7ee7\u7eed\u7b49\u5f85\uff1b \u82e5\u7a97\u53e3\u4e0d\u4e3a0\uff0c\u6b64\u65f6\u91cd\u7f6e\u53d1\u9001\u7a97\u53e3\u540e\u5f00\u59cb\u53d1\u9001\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u6b7b\u9501\u7684\u4ea7\u751f\u3002 \u4e09\u6b21\u63e1\u624b\u548c\u56db\u6b21\u6325\u624b \u4e09\u6b21\u63e1\u624b : \u7b2c\u4e00\u6b65\uff1a\u5ba2\u6237\u7aefTCP\u5411\u670d\u52a1\u7aefTCP\u53d1\u9001\u4e00\u4e2a\u7279\u6b8a\u62a5\u6587\u6bb5\uff0c\u8868\u793a\u5e0c\u671b\u5efa\u7acb\u8fde\u63a5\uff0c\u8be5\u62a5\u6587\u6bb5\u4e0d\u5305\u542b\u5e94\u7528\u5c42\u6570\u636e\uff0c\u968f\u673a\u521d\u59cb\u5316\u5e8f\u53f7\u5b57\u6bb5 \u6807\u5fd7\u4f4d\u4e2d\u7684SYN\u88ab\u7f6e\u4e3a1\uff0c\u88ab\u79f0\u4e3aSYN\u62a5\u6587\u6bb5\u3002 \u7b2c\u4e8c\u6b65\uff1a\u670d\u52a1\u7aef\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u9001\u7684SYN\u62a5\u6587\uff0c\u4e3a\u8be5TCP\u8fde\u63a5\u5206\u914dTCP\u7f13\u5b58\u548c\u53d8\u91cf\uff0c \u5e76\u5411\u5ba2\u6237\u7aefTCP\u53d1\u9001\u5141\u8bb8\u8fde\u63a5\u7684TCP\u62a5\u6587\u6bb5\uff0c\u8be5\u62a5\u6587\u6bb5\u968f\u673a\u521d\u59cb\u5316\u5e8f\u53f7\u5b57\u6bb5\uff0c\u786e\u8ba4\u53f7\u5b57\u6bb5\u4e3a\u6536\u5230\u7684\u5ba2\u6237\u7aef\u5e8f\u53f7\u503c+1\uff0c SYN\u6807\u5fd7\u4f4d\u548cACK\u6807\u5fd7\u4f4d\u88ab\u7f6e1\uff0c\u8be5\u62a5\u6587\u6bb5\u88ab\u79f0\u4e3aSYNACK\u62a5\u6587\u6bb5\u3002 \u7b2c\u4e09\u6b65\uff1a\u5728\u6536\u5230SYNACK\u62a5\u6587\u6bb5\u540e\uff0c\u5ba2\u6237\u7aef\u4e5f\u8981\u7ed9\u8fde\u63a5\u5206\u914d\u7f13\u5b58\u548c\u53d8\u91cf\uff0c\u7136\u540e\u5411\u670d\u52a1\u5668\u53d1\u9001\u5e94\u7b54\u62a5\u6587\uff0c \u8be5\u62a5\u6587ACK\u6807\u5fd7\u4f4d\u7f6e1\uff0cSYN\u6807\u5fd7\u4f4d\u7f6e0\uff0c\u786e\u8ba4\u53f7\u5b57\u6bb5\u4e3a\u6536\u5230\u7684\u670d\u52a1\u7aef\u5e8f\u53f7\u503c+1\uff0c\u7136\u540e\u5c06\u62a5\u6587\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\u3002 \u6b64\u6b21\u62a5\u6587\u53ef\u4ee5\u643a\u5e26\u5ba2\u6237\u5230\u670d\u52a1\u5668\u7684\u6570\u636e\u3002 \u4e3a\u4ec0\u4e48\u8981\u4e09\u6b21\u63e1\u624b : \u9996\u8981\u539f\u56e0\uff0c\u4e3a\u4e86\u9632\u6b62\u5df2\u5931\u6548\u7684\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u6bb5\u5728\u7f51\u7edc\u5ef6\u8fdf\u540e\u53c8\u5230\u8fbe\u4e86\u670d\u52a1\u7aef\uff0c\u4ea7\u751f\u9519\u8bef\u8fde\u63a5\u3002 client\u53d1\u51fa\u8fde\u63a5\u8bf7\u6c42\uff0c\u4f46\u56e0\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u672a\u88abserver\u63a5\u6536(\u53ef\u80fd\u4e22\u5931\u6216\u8005\u5ef6\u8fdf)\uff0c\u56e0\u6b64\u6ca1\u6709\u6536\u5230\u786e\u8ba4\u3002 \u4e8e\u662fA\u518d\u91cd\u4f20\u4e00\u6b21\u8bf7\u6c42\u8fde\u63a5\u3002\u540e\u6765\u6536\u5230\u4e86\u786e\u8ba4\uff0c\u5efa\u7acb\u4e86\u8fde\u63a5\u3002\u6570\u636e\u4f20\u8f93\u5b8c\u6bd5\u540e\uff0c\u5c31\u91ca\u653e\u4e86\u8fde\u63a5\u3002 \u4f46\u7b2c\u4e00\u6b21\u53d1\u9001\u7684\u8bf7\u6c42\u8fde\u63a5\u62a5\u6587\u5728\u8fde\u63a5\u91ca\u653e\u540e\u4e5f\u5230\u8fbeserver\uff0c\u867d\u7136\u8fd9\u662f\u4e00\u4e2a\u65e9\u5df2\u5931\u6548\u7684\u62a5\u6587\u6bb5\u3002 \u4f46server\u6536\u5230\u6b64\u5931\u6548\u7684\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u6bb5\u540e\uff0c\u8bef\u8ba4\u4e3a\u662fclient\u518d\u6b21\u53d1\u51fa\u7684\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42\u3002 \u4e8e\u662f\u5c31\u5411client\u53d1\u51fa\u786e\u8ba4\u62a5\u6587\u6bb5\uff0c\u540c\u610f\u5efa\u7acb\u8fde\u63a5\u3002\u5047\u8bbe\u4e0d\u91c7\u7528\u201c\u4e09\u6b21\u63e1\u624b\u201d\uff0c\u90a3\u4e48\u53ea\u8981server\u53d1\u51fa\u786e\u8ba4\uff0c \u65b0\u7684\u8fde\u63a5\u5c31\u5efa\u7acb\u4e86\u3002\u7531\u4e8e\u73b0\u5728client\u5e76\u6ca1\u6709\u53d1\u51fa\u5efa\u7acb\u8fde\u63a5\u7684\u8bf7\u6c42\uff0c\u4e0d\u4f1a\u5411server\u53d1\u9001\u6570\u636e\u3002 \u4f46server\u4e00\u76f4\u7b49\u5f85client\u53d1\u6765\u6570\u636e\u3002\u8fd9\u6837\uff0cserver\u5c06\u6d6a\u8d39\u8bb8\u591a\u8d44\u6e90\u5728\u7b49\u5f85\u3002 \u5982\u679c\u662f\u4e09\u6b21\u63e1\u624b\uff0c\u5ba2\u6237\u7aef\u5219\u53ef\u4ee5\u53d1\u9001RST\u62a5\u6587\u7ed9\u670d\u52a1\u7aef\uff0c\u4e2d\u6b62\u6b64\u6b21\u8fde\u63a5\u3002 \u7b2c\u4e8c\u4e2a\u539f\u56e0\uff0c\u662f\u4e3a\u4e86\u540c\u6b65\u53cc\u65b9\u521d\u59cb\u5e8f\u5217\u53f7\uff0c\u4e24\u6b21\u63e1\u624b\u867d\u7136\u8ba9\u53cc\u65b9\u5c31\u53d1\u9001\u7aef\u7684\u5e8f\u5217\u53f7\u8fbe\u6210\u540c\u6b65\uff0c \u4f46TCP\u8fde\u63a5\u662f\u53cc\u5411\u7684\uff0c\u56e0\u6b64\u4e5f\u9700\u8981\u5c31\u670d\u52a1\u7aef\u7684\u5e8f\u5217\u53f7\u8fbe\u6210\u540c\u6b65\uff1b \u4f46\u6b64\u65f6\u65e0\u6cd5\u786e\u4fddclient\u6536\u5230server\u8fd4\u56de\u7684\u786e\u8ba4\u62a5\u6587\uff0c\u56e0\u6b64\u53cc\u65b9\u65e0\u6cd5\u5c31\u670d\u52a1\u7aef\u5e8f\u5217\u53f7\u8fbe\u6210\u540c\u6b65\u3002 \u56db\u6b21\u63e1\u624b\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u76ee\u7684\uff0c\u4f46\u7531\u4e8e\u4e09\u6b21\u63e1\u624b\u5373\u53ef\u5b9e\u73b0\u9700\u6c42\uff0c\u6240\u4ee5\u65e0\u9700\u989d\u5916\u7684\u786e\u8ba4\u3002 \u56db\u6b21\u6325\u624b : 1\u3001\u5ba2\u6237\u7aef\u6253\u7b97\u5173\u95ed\u8fde\u63a5\uff0c\u4f1a\u53d1\u9001\u4e00\u4e2a\u7279\u6b8a\u62a5\u6587\uff0c\u8be5TCP\u62a5\u6587\u6bb5\u7684FIN\u6807\u5fd7\u4f4d\u7f6e1\uff1b 2\u3001\u670d\u52a1\u7aef\u63a5\u6536\u5230FIN\u62a5\u6587\uff0c\u4f1a\u5411\u5ba2\u6237\u7aef\u53d1\u9001ACK\u5e94\u7b54\u62a5\u6587\uff1b\u5ba2\u6237\u7aef\u63a5\u6536\u5230ACK\u62a5\u6587\uff0c\u4fbf\u4e0d\u4f1a\u518d\u91cd\u53d1FIN\u62a5\u6587 3\u3001\u670d\u52a1\u7aef\u5904\u7406\u5b8c\u6570\u636e\u540e\uff0c\u5411\u5ba2\u6237\u7aef\u53d1\u9001FIN\u62a5\u6587\uff1b 4\u3001\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u670d\u52a1\u7aef\u7684FIN\u62a5\u6587\u540e\uff0c\u4e5f\u4f1a\u56de\u590d\u4e00\u4e2aACK\u62a5\u6587\uff0c\u7136\u540e\u8fdb\u5165TIME_WAIT\u72b6\u6001\u3002 5\u3001\u670d\u52a1\u5668\u6536\u5230ACK\u62a5\u6587\u540e\uff0c\u5c31\u8fdb\u5165close\u72b6\u6001\uff0c\u5b8c\u6210\u8fde\u63a5\u7684\u5173\u95ed\u3002 \u5ba2\u6237\u7aef\u5728\u7b49\u5f852MSL\u540e\uff0c\u81ea\u52a8\u8fdb\u5165close\u72b6\u6001\uff0c\u5ba2\u6237\u7aef\u4e5f\u5b8c\u6210\u8fde\u63a5\u7684\u5173\u95ed\u3002 \u4e3a\u4ec0\u4e48\u9700\u8981\u56db\u6b21\u6325\u624b \u670d\u52a1\u7aef\u901a\u5e38\u9700\u8981\u7b49\u5f85\u5b8c\u6210\u6570\u636e\u7684\u53d1\u9001\u548c\u5904\u7406\uff0c\u56e0\u6b64\u670d\u52a1\u7aef\u7684ACK\u548cFIN\u62a5\u6587\u662f\u5206\u5f00\u53d1\u9001\u7684\uff0c \u4ece\u800c\u6bd4\u4e09\u6b21\u63e1\u624b\u591a\u4e00\u6b21\u3002 MSL\uff1amaximum segment lifetime, \u62a5\u6587\u6700\u5927\u751f\u5b58\u65f6\u95f4 \u4e3a\u4ec0\u4e48\u9700\u8981TIME_WAIT\u72b6\u6001 \uff1a 1\u3001\u786e\u4fdd\u4e3b\u52a8\u5173\u95ed\u65b9\u53d1\u9001\u7684ACK\u5e94\u7b54\u62a5\u6587\u88ab\u6b63\u786e\u63a5\u6536:\u901a\u5e38\u53ea\u6709\u4e3b\u52a8\u5173\u95ed\u65b9\u624d\u4f1a\u8fdb\u5165TIME_WAIT\u72b6\u6001\uff0c \u5047\u5982\u5ba2\u6237\u7aef\u662f\u4e3b\u52a8\u5173\u95ed\u65b9\uff0c\u800c\u5ba2\u6237\u7aef\u5728\u63a5\u53d7\u5230\u670d\u52a1\u7aef\u7684FIN\u62a5\u6587\u540e\uff0c\u5411\u670d\u52a1\u7aef\u53d1\u9001ACK\u62a5\u6587\u540e\uff0c\u76f4\u63a5\u8fdb\u5165close\u72b6\u6001\uff0c \u5220\u9664\u5957\u63a5\u5b57\uff1b\u800c\u8be5ACK\u62a5\u6587\u4e22\u5931\uff0c\u670d\u52a1\u7aef\u5728\u7b49\u5f85\u8d85\u65f6\u540e\uff0c\u5c31\u4f1a\u91cd\u53d1FIN\u62a5\u6587\uff1b \u5f53\u670d\u52a1\u7aef\u91cd\u53d1\u7684FIN\u62a5\u6587\u5230\u8fbe\u5ba2\u6237\u7aef\u65f6\uff0c\u5ba2\u6237\u7aef\u4f1a\u8ba4\u4e3a\u5176\u662f\u4e00\u4e2a\u975e\u6cd5\u62a5\u6587\u6bb5\uff0c\u4e8e\u662f\u8fd4\u56de\u4e00\u4e2aRST\u62a5\u6587\uff0c \u8868\u793a\u8fde\u63a5\u5f02\u5e38\uff0c\u5219\u670d\u52a1\u5668\u7aef\u5957\u63a5\u5b57\u4e0d\u80fd\u8fdb\u5165\u6b63\u5e38\u7684\u5173\u95ed\u72b6\u6001\u3002 2\u3001\u786e\u4fdd\u5386\u53f2\u8fde\u63a5\u8fc7\u7a0b\u7684\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e2d\u8fc7\u671f\u800c\u6d88\u5931: \u5728\u7b2c\u56db\u6b21\u6325\u624b\u540e\uff0c\u7ecf\u8fc72msl\u7684\u65f6\u95f4\u8db3\u4ee5\u8ba9\u672c\u6b21\u8fde\u63a5\u4ea7\u751f\u7684\u6240\u6709\u62a5\u6587\u6bb5\u90fd\u4ece\u7f51\u7edc\u4e2d\u6d88\u5931\uff0c \u8fd9\u6837\u4e0b\u4e00\u6b21\u65b0\u7684\u8fde\u63a5\u4e2d\u5c31\u80af\u5b9a\u4e0d\u4f1a\u51fa\u73b0\u65e7\u8fde\u63a5\u7684\u62a5\u6587\u6bb5\u4e86; \u6ca1\u6709time-wait, \u5982\u679c\u6b64\u65f6\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53c8\u5efa\u7acb\u4e86\u65b0\u7684TCP\u8fde\u63a5\uff0c\u4e14\u548c\u5386\u53f2\u8fde\u63a5\u91c7\u7528\u4e86\u76f8\u540c\u7684\u7aef\u53e3\uff0c \u800c\u5386\u53f2\u8fde\u63a5\u7684\u6570\u636e\u5305\u53ef\u80fd\u5728\u5ef6\u8fdf\u540e\u5230\u8fbe\u63a5\u6536\u7aef\uff0c\u4f1a\u88ab\u5f53\u6210\u6b64\u6b21\u8fde\u63a5\u4e2d\u7684\u6570\u636e\u5305\u800c\u6b63\u5e38\u63a5\u6536\uff0c\u4ece\u800c\u9020\u6210\u6570\u636e\u9519\u4e71\u3002 SYN cookie \u2003SYN Cookie\u662f\u5bf9TCP\u670d\u52a1\u5668\u7aef\u7684\u4e09\u6b21\u63e1\u624b\u534f\u8bae\u4f5c\u4e00\u4e9b\u4fee\u6539\uff0c\u4e13\u95e8\u7528\u6765\u9632\u8303SYN Flood\u653b\u51fb\u7684\u4e00\u79cd\u624b\u6bb5\u3002\u5b83\u7684\u539f\u7406\u662f\uff0c\u5728TCP\u670d\u52a1\u5668\u6536\u5230\u53d1\u9001\u65b9SYN\u6570\u636e\u5305\u5e76\u8fd4\u56deSYNACK\u6570\u636e\u5305\u65f6\uff0c\u4e0d\u4f1a\u5148\u4e3a\u8be5TCP\u8fde\u63a5\u5206\u914d\u7f13\u5b58\uff0c\u800c\u662f\u6839\u636e\u8fd9\u4e2aSYN\u6570\u636e\u5305\u8ba1\u7b97\u51fa\u4e00\u4e2acookie\u503c\u3002\u5728\u6536\u5230\u53d1\u9001\u65b9\u8fd4\u56de\u7684ACK\u6570\u636e\u5305\u65f6\uff0c\u670d\u52a1\u5668\u6839\u636ecookie\u503c\u68c0\u67e5\u8fd9\u4e2aACK\u6570\u636e\u5305\u7684\u5408\u6cd5\u6027\u3002\u5982\u679c\u5408\u6cd5\uff0c\u518d\u5206\u914d\u4e13\u95e8\u7684\u6570\u636e\u533a\u8fdb\u884c\u5904\u7406\u672a\u6765\u7684TCP\u8fde\u63a5\u3002 TCP\u62e5\u585e\u63a7\u5236 \u6d41\u91cf\u63a7\u5236\u4e0e\u62e5\u585e\u63a7\u5236 \u62e5\u585e\u63a7\u5236\uff1a\u62e5\u585e\u63a7\u5236\u662f\u4f5c\u7528\u4e8e\u7f51\u7edc\u7684\uff0c\u5b83\u662f\u9632\u6b62\u8fc7\u591a\u7684\u6570\u636e\u6ce8\u5165\u5230\u7f51\u7edc\u4e2d\uff0c\u907f\u514d\u51fa\u73b0\u7f51\u7edc\u8d1f\u8f7d\u8fc7\u5927\u7684\u60c5\u51b5\uff1b \u5e38\u7528\u7684\u65b9\u6cd5\u5c31\u662f\uff1a\uff08 1 \uff09\u6162\u5f00\u59cb\u3001\u62e5\u585e\u907f\u514d\uff08 2 \uff09\u5feb\u91cd\u4f20\u3001\u5feb\u6062\u590d\u3002 \u6d41\u91cf\u63a7\u5236\uff1a\u6d41\u91cf\u63a7\u5236\u662f\u4f5c\u7528\u4e8e\u63a5\u6536\u8005\u7684\uff0c\u5b83\u662f\u63a7\u5236\u53d1\u9001\u8005\u7684\u53d1\u9001\u901f\u5ea6\u4ece\u800c\u4f7f\u63a5\u6536\u8005\u6765\u5f97\u53ca\u63a5\u6536\uff0c\u9632\u6b62\u5206\u7ec4\u4e22\u5931\u3002","title":"TCP"},{"location":"Network/2_transport/#tcpudp","text":"\u8fde\u63a5 TCP \u662f\u9762\u5411\u8fde\u63a5\u7684\u4f20\u8f93\u5c42\u534f\u8bae\uff0c\u4f20\u8f93\u6570\u636e\u524d\u5148\u8981\u5efa\u7acb\u8fde\u63a5\u3002 UDP \u662f\u4e0d\u9700\u8981\u8fde\u63a5\uff0c\u5373\u523b\u4f20\u8f93\u6570\u636e\u3002 \u670d\u52a1\u5bf9\u8c61 TCP \u662f\u4e00\u5bf9\u4e00\u7684\u4e24\u70b9\u670d\u52a1\uff0c\u5373\u4e00\u6761\u8fde\u63a5\u53ea\u6709\u4e24\u4e2a\u7aef\u70b9\u3002 UDP \u652f\u6301\u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a\u3001\u591a\u5bf9\u591a\u7684\u4ea4\u4e92\u901a\u4fe1 \u53ef\u9760\u6027 TCP \u662f\u53ef\u9760\u4ea4\u4ed8\u6570\u636e\u7684\uff0c\u6570\u636e\u53ef\u4ee5\u65e0\u5dee\u9519\u3001\u4e0d\u4e22\u5931\u3001\u4e0d\u91cd\u590d\u3001\u6309\u9700\u5230\u8fbe\u3002 UDP \u662f\u5c3d\u6700\u5927\u52aa\u529b\u4ea4\u4ed8\uff0c\u4e0d\u4fdd\u8bc1\u53ef\u9760\u4ea4\u4ed8\u6570\u636e\u3002 \u62e5\u585e\u63a7\u5236\u3001\u6d41\u91cf\u63a7\u5236 TCP \u6709\u62e5\u585e\u63a7\u5236\u548c\u6d41\u91cf\u63a7\u5236\u673a\u5236\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u6027\u3002 UDP \u5219\u6ca1\u6709\uff0c\u5373\u4f7f\u7f51\u7edc\u975e\u5e38\u62e5\u5835\u4e86\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd UDP \u7684\u53d1\u9001\u901f\u7387\u3002 \u9996\u90e8\u5f00\u9500 TCP \u9996\u90e8\u957f\u5ea6\u8f83\u957f\uff0c\u4f1a\u6709\u4e00\u5b9a\u7684\u5f00\u9500\uff0c\u9996\u90e8\u5728\u6ca1\u6709\u4f7f\u7528\u300c\u9009\u9879\u300d\u5b57\u6bb5\u65f6\u662f 20 \u4e2a\u5b57\u8282\uff0c\u5982\u679c\u4f7f\u7528\u4e86\u300c\u9009\u9879\u300d\u5b57\u6bb5\u5219\u4f1a\u53d8\u957f\u7684\u3002 UDP \u9996\u90e8\u53ea\u6709 8 \u4e2a\u5b57\u8282\uff0c\u5e76\u4e14\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0c\u5f00\u9500\u8f83\u5c0f\u3002 TCP\u662f\u9762\u5411\u5b57\u8282\u6d41\u7684 \uff0c\u5176\u5c06\u5e94\u7528\u5c42\u4f20\u9012\u7684\u6570\u636e\u770b\u6210\u65e0\u7ed3\u6784\u7684\u5b57\u8282\u6d41\uff0cTCP\u6709\u4e00\u4e2a\u7f13\u51b2\uff0c\u5f53\u5e94\u7528\u7a0b\u5e8f\u4f20\u9001\u7684\u6570\u636e\u5757\u592a\u957f\uff0cTCP\u5c31\u53ef\u4ee5\u628a\u5b83\u5212\u5206\u77ed\u4e00\u4e9b\u518d\u4f20\u9001\u3002\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u4e00\u6b21\u53ea\u53d1\u9001\u4e00\u4e2a\u5b57\u8282\uff0cTCP\u4e5f\u53ef\u4ee5\u7b49\u5f85\u79ef\u7d2f\u6709\u8db3\u591f\u591a\u7684\u5b57\u8282\u540e\u518d\u6784\u6210\u62a5\u6587\u6bb5\u53d1\u9001\u51fa\u53bb\u3002\u5e76\u4e14\u6839\u636e\u5f53\u524d\u7f51\u7edc\u7684\u62e5\u585e\u7a0b\u5ea6\u6765\u51b3\u5b9a\u6bcf\u4e2a\u62a5\u6587\u6bb5\u5927\u5c0f\uff1b UDP\u662f\u9762\u5411\u6570\u636e\u5305\u7684 \uff1a\u53d1\u9001\u65b9\u7684UDP\u5bf9\u5e94\u7528\u5c42\u4ea4\u4e0b\u6765\u7684\u62a5\u6587\uff0c\u4e0d\u5408\u5e76\uff0c\u4e0d\u62c6\u5206\uff0c\u53ea\u662f\u5728\u5176\u4e0a\u9762\u52a0\u4e0a\u9996\u90e8\u540e\u5c31\u4ea4\u7ed9\u4e86\u4e0b\u9762\u7684\u7f51\u7edc\u5c42\uff1b\u5bf9\u4e8e\u8fc7\u957f\u7684\u62a5\u6587\u6bb5\uff0c\u5728\u7f51\u7edc\u5c42\uff0c\u4f1a\u9488\u5bf9IP\u6570\u636e\u62a5\u8fdb\u884c\u5206\u7247\u3002","title":"TCP\u4e0eUDP\u4e0d\u540c"},{"location":"Network/3_network/","text":"\u7f51\u7edc\u5c42 \u7f51\u7edc\u5c42 \u7f51\u7edc\u5c42\u670d\u52a1\u6a21\u578b Internet\u7f51\u7edc\u5c42 \u2003 IP\u6570\u636e\u62a5\u9996\u90e8\u957f\u5ea6\u8303\u56f4\u4e3a20~60\u5b57\u8282\u3002\u53d1\u9001IP\u5206\u7247\u65f6\uff0c\u6bcf\u4e2a\u7247\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u7b49\u4e8eMTU\u51cf\u53bbIP\u6570\u636e\u62a5\u9996\u90e8\u957f\u5ea6\uff0c \u4e14\u5e94\u8be5\u662f8\u7684\u500d\u6570( \u8ba1\u7b97\u8fc7\u7a0b\u5982\u56fe )\u3002 \u2003 IPV4\u901a\u8fc7\u6807\u8bc6\u3001\u6807\u5fd7\u548c\u7247\u504f\u79fb\u5b57\u6bb5\u6765\u786e\u5b9a\u5206\u7247\u7684\u76f8\u5bf9\u987a\u5e8f\uff1b IP\u5730\u5740 \u79c1\u6709\u5730\u5740 : \u8fd9\u4e9b\u5730\u5740\u662f\u4e0d\u4f1a\u88abInternet\u5206\u914d\u7684\uff0c\u5b83\u4eec\u5728Internet\u4e0a\u4e5f\u4e0d\u4f1a\u88ab\u8def\u7531\uff0c\u867d\u7136\u5b83\u4eec\u4e0d\u80fd\u76f4\u63a5\u548cInternet\u7f51\u8fde\u63a5\uff0c \u4f46\u901a\u8fc7\u6280\u672f\u624b\u6bb5\u4ecd\u65e7\u53ef\u4ee5\u548c Internet\u901a\u8baf\uff08NAT\u6280\u672f\uff09\u3002 \u6211\u4eec\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6765\u9009\u62e9\u9002\u5f53\u7684\u5730\u5740\u7c7b\uff0c\u5728\u5185\u90e8\u5c40\u57df\u7f51\u4e2d\u5c06\u8fd9\u4e9b\u5730\u5740\u50cf\u516c\u7528IP\u5730\u5740\u4e00\u6837\u5730\u4f7f\u7528\u3002 A: 10.0.0.0~10.255.255.255 \u537310.0.0.0/8 B: 172.16.0.0~172.31.255.255\u5373172.16.0.0/12 C: 192.168.0.0~192.168.255.255 \u5373192.168.0.0/16 \u5e7f\u64ad : \u5728\u540c\u2f00\u4e2a\u94fe\u8def\u4e2d\u76f8\u4e92\u8fde\u63a5\u7684\u4e3b\u673a\u4e4b\u95f4\u53d1\u9001\u6570\u636e\u5305(\u5373\u672c\u5730\u5e7f\u64ad), \u4e14\u8def\u7531\u5668\u4e0d\u4f1a\u8f6c\u53d1\u5e7f\u64ad(\u5373\u4f1a\u5c4f\u853d\u6240\u6709IP\u5730\u5740\u5168\u4e3a1\u7684\u6570\u636e\u5305) \u76f4\u63a5\u5e7f\u64ad : \u5728\u4e0d\u540c\u2f79\u7edc\u4e4b\u95f4\u7684\u2f34\u64ad\u53eb\u505a\u76f4\u63a5\u2f34\u64ad, \u5bf9\u7279\u5b9a\u7f51\u7edc\u4e0a\u7684\u6240\u6709\u4e3b\u673a\u8fdb\u884c\u5e7f\u64ad \u7ec4\u64ad \u591a\u64ad\u2f64\u4e8e\u5c06\u5305\u53d1\u9001\u7ed9\u7279\u5b9a\u7ec4\u5185\u7684\u6240\u6709\u4e3b\u673a\u3002\u8fd9\u4e2a\u7279\u5b9a\u7ec4\u53ef\u4ee5\u5728\u672c\u7f51\u5185\uff0c\u4e5f\u53ef\u4ee5\u8de8\u8def\u7531\u5668\u3002 1\u3001\u5ba2\u6237\u673a\u901a\u8fc7UDP\u5206\u7ec4\u53d1\u9001DHCP\u53d1\u73b0\u62a5\u6587\uff0c\u5176\u4e2d\u6e90\u5730\u5740\u4e3a0.0.0.0\uff0c\u8868\u793a\u672c\u673a\uff0c \u76ee\u7684\u5730\u5740\u4e3a255.255.255.255\uff0c\u8868\u793a\u672c\u7f51\u5e7f\u64ad\u5730\u5740\uff0c\u56e0\u6b64\u4f1a\u5411\u672c\u7f51\u5185\u7684\u6240\u6709\u4e3b\u673a\u53d1\u9001\u62a5\u6587\u3002 2\u3001DHCP\u670d\u52a1\u5668\u63a5\u6536\u5230\u53d1\u73b0\u62a5\u6587\u540e\uff0c\u901a\u8fc7DHCP\u63d0\u4f9b\u62a5\u6587\u5411\u5ba2\u6237\u4f5c\u51fa\u54cd\u5e94\uff0c\u5176\u76ee\u7684\u5730\u5740\u4e3a255.255.255.255( \u56e0\u4e3a\u6b64\u65f6\u5ba2\u6237\u673a\u5c1a\u672a\u6709\u81ea\u5df1\u7684IP\u5730\u5740\uff0c\u6240\u4ee5\u901a\u8fc7\u5e7f\u64ad\u5f62\u5f0f)\u3002 \u65e0\u7c7b\u522b\u57df\u95f4\u8def\u7531\u9009\u62e9(Classes Interdomain Routing, CIDR) \u2003\u5f62\u5f0f\u4e3aa.b.c.d/x\uff0c\u5176\u4e2dx\u6307\u793a\u4e86NetId\u7684\u957f\u5ea6\uff0c\u5269\u4f59\u768432-x\u4f4d\u7528\u6765\u533a\u5206\u7ec4\u7ec7\u5185\u90e8\u8bbe\u5907\uff1b \u4e00\u4e2a\u7ec4\u7ec7\u901a\u5e38\u88ab\u5206\u914d\u4e00\u5757\u8fde\u7eed\u7684\u5730\u5740\uff0c\u5373\u5177\u6709\u76f8\u540c\u524d\u7f00\u7684\u7684\u4e00\u6bb5\u5730\u5740\uff1b \u8fd9\u6837\u8be5\u7ec4\u7ec7\u5185\u90e8\u7684\u8bbe\u5907\u7684IP\u5730\u5740\u5c06\u5171\u4eab\u5171\u540c\u7684\u524d\u7f00\u3002\u8fd9\u79cd\u4f7f\u7528\u5355\u4e2a\u7f51\u7edc\u524d\u7f00\u901a\u544a\u591a\u4e2a\u7f51\u7edc\u7684\u80fd\u529b\u79f0\u4e3a\u5730\u5740\u805a\u5408\u6216\u8005\u8def\u7531\u805a\u5408\u3002 \u7f51\u7edc\u5730\u5740\u8f6c\u6362 ICMP \u5e38\u89c1ICMP\u6d88\u606f\u7c7b\u578b traceroute: \u662f\u6545\u610f\u8bbe\u7f6e\u7279\u6b8a\u7684TTL\uff0c\u6765\u8ffd\u8e2a\u53bb\u5f80\u2f6c\u7684\u5730\u65f6\u6cbf\u9014\u7ecf\u8fc7\u7684\u8def\u7531\u5668\uff0c \u5229\u2f64IP\u5305\u7684\u2f63\u5b58\u671f\u9650\u4ece1\u5f00\u59cb\u6309\u7167\u987a\u5e8f\u9012\u589e\u7684\u540c\u65f6\u53d1\u9001UDP\u5305\uff0c\u5f3a\u5236\u63a5\u6536ICMP\u8d85\u65f6\u6d88\u606f\uff0c \u4f8b\u5982\u8bbe\u7f6eTTL\u4e3a5\uff0c\u5219\u5230\u8fbe\u7b2c\u4e94\u4e2a\u8def\u7531\u5668\u65f6\uff0c\u8be5\u62a5\u6587\u8d85\u65f6\u88ab\u4e22\u5f03\uff0c\u8be5\u8def\u7531\u5668\u4f1a\u5411\u53d1\u9001\u7aef\u8fd4\u56de\u4e00\u4e2aICMP\u8d85\u65f6\u62a5\u6587\uff0c \u53d1\u9001\u7aef\u6839\u636e\u63a5\u6536\u5230\u8be5\u62a5\u6587\u4e0e\u53d1\u9001\u8be5\u62a5\u6587\u7684\u65f6\u95f4\u5dee\uff0c\u53ef\u4ee5\u5f97\u5230\u5176\u4e0e\u7b2c\u4e94\u4e2a\u8def\u7531\u5668\u4e4b\u95f4\u7684RTT\u3002 traceroute \u5728\u53d1\u9001 UDP \u5305\u65f6\uff0c\u4f1a\u586b\u2f0a\u2f00\u4e2a\u4e0d\u53ef\u80fd\u7684\u7aef\u2f1d\u53f7\u503c\u4f5c\u4e3a UDP \u2f6c\u6807\u7aef\u2f1d\u53f7\uff08\u2f24\u4e8e 3000 \uff09\u3002 \u5f53\u2f6c\u7684\u4e3b\u673a\u6536\u5230 UDP \u5305\u540e\uff0c\u4f1a\u8fd4\u56de ICMP \u5dee\u9519\u62a5\u2f42\u6d88\u606f\uff0c\u4f46\u8fd9\u4e2a\u5dee\u9519\u62a5\u2f42\u6d88\u606f\u7684\u7c7b\u578b\u662f\u300c\u7aef\u2f1d\u4e0d\u53ef \u8fbe\u300d\u3002\u6240\u4ee5\uff0c\u5f53\u5dee\u9519\u62a5\u2f42\u7c7b\u578b\u662f\u7aef\u2f1d\u4e0d\u53ef\u8fbe\u65f6\uff0c\u8bf4\u660e\u53d1\u9001\u2f45\u53d1\u51fa\u7684 UDP \u5305\u5230\u8fbe\u4e86\u2f6c\u7684\u4e3b\u673a\u3002 IPV6 \u5c42\u6b21\u8def\u7531","title":"network"},{"location":"Network/3_network/#_1","text":"","title":"\u7f51\u7edc\u5c42"},{"location":"Network/3_network/#_2","text":"","title":"\u7f51\u7edc\u5c42"},{"location":"Network/3_network/#_3","text":"","title":"\u7f51\u7edc\u5c42\u670d\u52a1\u6a21\u578b"},{"location":"Network/3_network/#internet","text":"IP\u6570\u636e\u62a5\u9996\u90e8\u957f\u5ea6\u8303\u56f4\u4e3a20~60\u5b57\u8282\u3002\u53d1\u9001IP\u5206\u7247\u65f6\uff0c\u6bcf\u4e2a\u7247\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u7b49\u4e8eMTU\u51cf\u53bbIP\u6570\u636e\u62a5\u9996\u90e8\u957f\u5ea6\uff0c \u4e14\u5e94\u8be5\u662f8\u7684\u500d\u6570( \u8ba1\u7b97\u8fc7\u7a0b\u5982\u56fe )\u3002 \u2003 IPV4\u901a\u8fc7\u6807\u8bc6\u3001\u6807\u5fd7\u548c\u7247\u504f\u79fb\u5b57\u6bb5\u6765\u786e\u5b9a\u5206\u7247\u7684\u76f8\u5bf9\u987a\u5e8f\uff1b IP\u5730\u5740 \u79c1\u6709\u5730\u5740 : \u8fd9\u4e9b\u5730\u5740\u662f\u4e0d\u4f1a\u88abInternet\u5206\u914d\u7684\uff0c\u5b83\u4eec\u5728Internet\u4e0a\u4e5f\u4e0d\u4f1a\u88ab\u8def\u7531\uff0c\u867d\u7136\u5b83\u4eec\u4e0d\u80fd\u76f4\u63a5\u548cInternet\u7f51\u8fde\u63a5\uff0c \u4f46\u901a\u8fc7\u6280\u672f\u624b\u6bb5\u4ecd\u65e7\u53ef\u4ee5\u548c Internet\u901a\u8baf\uff08NAT\u6280\u672f\uff09\u3002 \u6211\u4eec\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6765\u9009\u62e9\u9002\u5f53\u7684\u5730\u5740\u7c7b\uff0c\u5728\u5185\u90e8\u5c40\u57df\u7f51\u4e2d\u5c06\u8fd9\u4e9b\u5730\u5740\u50cf\u516c\u7528IP\u5730\u5740\u4e00\u6837\u5730\u4f7f\u7528\u3002 A: 10.0.0.0~10.255.255.255 \u537310.0.0.0/8 B: 172.16.0.0~172.31.255.255\u5373172.16.0.0/12 C: 192.168.0.0~192.168.255.255 \u5373192.168.0.0/16 \u5e7f\u64ad : \u5728\u540c\u2f00\u4e2a\u94fe\u8def\u4e2d\u76f8\u4e92\u8fde\u63a5\u7684\u4e3b\u673a\u4e4b\u95f4\u53d1\u9001\u6570\u636e\u5305(\u5373\u672c\u5730\u5e7f\u64ad), \u4e14\u8def\u7531\u5668\u4e0d\u4f1a\u8f6c\u53d1\u5e7f\u64ad(\u5373\u4f1a\u5c4f\u853d\u6240\u6709IP\u5730\u5740\u5168\u4e3a1\u7684\u6570\u636e\u5305) \u76f4\u63a5\u5e7f\u64ad : \u5728\u4e0d\u540c\u2f79\u7edc\u4e4b\u95f4\u7684\u2f34\u64ad\u53eb\u505a\u76f4\u63a5\u2f34\u64ad, \u5bf9\u7279\u5b9a\u7f51\u7edc\u4e0a\u7684\u6240\u6709\u4e3b\u673a\u8fdb\u884c\u5e7f\u64ad \u7ec4\u64ad \u591a\u64ad\u2f64\u4e8e\u5c06\u5305\u53d1\u9001\u7ed9\u7279\u5b9a\u7ec4\u5185\u7684\u6240\u6709\u4e3b\u673a\u3002\u8fd9\u4e2a\u7279\u5b9a\u7ec4\u53ef\u4ee5\u5728\u672c\u7f51\u5185\uff0c\u4e5f\u53ef\u4ee5\u8de8\u8def\u7531\u5668\u3002 1\u3001\u5ba2\u6237\u673a\u901a\u8fc7UDP\u5206\u7ec4\u53d1\u9001DHCP\u53d1\u73b0\u62a5\u6587\uff0c\u5176\u4e2d\u6e90\u5730\u5740\u4e3a0.0.0.0\uff0c\u8868\u793a\u672c\u673a\uff0c \u76ee\u7684\u5730\u5740\u4e3a255.255.255.255\uff0c\u8868\u793a\u672c\u7f51\u5e7f\u64ad\u5730\u5740\uff0c\u56e0\u6b64\u4f1a\u5411\u672c\u7f51\u5185\u7684\u6240\u6709\u4e3b\u673a\u53d1\u9001\u62a5\u6587\u3002 2\u3001DHCP\u670d\u52a1\u5668\u63a5\u6536\u5230\u53d1\u73b0\u62a5\u6587\u540e\uff0c\u901a\u8fc7DHCP\u63d0\u4f9b\u62a5\u6587\u5411\u5ba2\u6237\u4f5c\u51fa\u54cd\u5e94\uff0c\u5176\u76ee\u7684\u5730\u5740\u4e3a255.255.255.255( \u56e0\u4e3a\u6b64\u65f6\u5ba2\u6237\u673a\u5c1a\u672a\u6709\u81ea\u5df1\u7684IP\u5730\u5740\uff0c\u6240\u4ee5\u901a\u8fc7\u5e7f\u64ad\u5f62\u5f0f)\u3002 \u65e0\u7c7b\u522b\u57df\u95f4\u8def\u7531\u9009\u62e9(Classes Interdomain Routing, CIDR) \u2003\u5f62\u5f0f\u4e3aa.b.c.d/x\uff0c\u5176\u4e2dx\u6307\u793a\u4e86NetId\u7684\u957f\u5ea6\uff0c\u5269\u4f59\u768432-x\u4f4d\u7528\u6765\u533a\u5206\u7ec4\u7ec7\u5185\u90e8\u8bbe\u5907\uff1b \u4e00\u4e2a\u7ec4\u7ec7\u901a\u5e38\u88ab\u5206\u914d\u4e00\u5757\u8fde\u7eed\u7684\u5730\u5740\uff0c\u5373\u5177\u6709\u76f8\u540c\u524d\u7f00\u7684\u7684\u4e00\u6bb5\u5730\u5740\uff1b \u8fd9\u6837\u8be5\u7ec4\u7ec7\u5185\u90e8\u7684\u8bbe\u5907\u7684IP\u5730\u5740\u5c06\u5171\u4eab\u5171\u540c\u7684\u524d\u7f00\u3002\u8fd9\u79cd\u4f7f\u7528\u5355\u4e2a\u7f51\u7edc\u524d\u7f00\u901a\u544a\u591a\u4e2a\u7f51\u7edc\u7684\u80fd\u529b\u79f0\u4e3a\u5730\u5740\u805a\u5408\u6216\u8005\u8def\u7531\u805a\u5408\u3002","title":"Internet\u7f51\u7edc\u5c42"},{"location":"Network/3_network/#_4","text":"","title":"\u7f51\u7edc\u5730\u5740\u8f6c\u6362"},{"location":"Network/3_network/#icmp","text":"\u5e38\u89c1ICMP\u6d88\u606f\u7c7b\u578b traceroute: \u662f\u6545\u610f\u8bbe\u7f6e\u7279\u6b8a\u7684TTL\uff0c\u6765\u8ffd\u8e2a\u53bb\u5f80\u2f6c\u7684\u5730\u65f6\u6cbf\u9014\u7ecf\u8fc7\u7684\u8def\u7531\u5668\uff0c \u5229\u2f64IP\u5305\u7684\u2f63\u5b58\u671f\u9650\u4ece1\u5f00\u59cb\u6309\u7167\u987a\u5e8f\u9012\u589e\u7684\u540c\u65f6\u53d1\u9001UDP\u5305\uff0c\u5f3a\u5236\u63a5\u6536ICMP\u8d85\u65f6\u6d88\u606f\uff0c \u4f8b\u5982\u8bbe\u7f6eTTL\u4e3a5\uff0c\u5219\u5230\u8fbe\u7b2c\u4e94\u4e2a\u8def\u7531\u5668\u65f6\uff0c\u8be5\u62a5\u6587\u8d85\u65f6\u88ab\u4e22\u5f03\uff0c\u8be5\u8def\u7531\u5668\u4f1a\u5411\u53d1\u9001\u7aef\u8fd4\u56de\u4e00\u4e2aICMP\u8d85\u65f6\u62a5\u6587\uff0c \u53d1\u9001\u7aef\u6839\u636e\u63a5\u6536\u5230\u8be5\u62a5\u6587\u4e0e\u53d1\u9001\u8be5\u62a5\u6587\u7684\u65f6\u95f4\u5dee\uff0c\u53ef\u4ee5\u5f97\u5230\u5176\u4e0e\u7b2c\u4e94\u4e2a\u8def\u7531\u5668\u4e4b\u95f4\u7684RTT\u3002 traceroute \u5728\u53d1\u9001 UDP \u5305\u65f6\uff0c\u4f1a\u586b\u2f0a\u2f00\u4e2a\u4e0d\u53ef\u80fd\u7684\u7aef\u2f1d\u53f7\u503c\u4f5c\u4e3a UDP \u2f6c\u6807\u7aef\u2f1d\u53f7\uff08\u2f24\u4e8e 3000 \uff09\u3002 \u5f53\u2f6c\u7684\u4e3b\u673a\u6536\u5230 UDP \u5305\u540e\uff0c\u4f1a\u8fd4\u56de ICMP \u5dee\u9519\u62a5\u2f42\u6d88\u606f\uff0c\u4f46\u8fd9\u4e2a\u5dee\u9519\u62a5\u2f42\u6d88\u606f\u7684\u7c7b\u578b\u662f\u300c\u7aef\u2f1d\u4e0d\u53ef \u8fbe\u300d\u3002\u6240\u4ee5\uff0c\u5f53\u5dee\u9519\u62a5\u2f42\u7c7b\u578b\u662f\u7aef\u2f1d\u4e0d\u53ef\u8fbe\u65f6\uff0c\u8bf4\u660e\u53d1\u9001\u2f45\u53d1\u51fa\u7684 UDP \u5305\u5230\u8fbe\u4e86\u2f6c\u7684\u4e3b\u673a\u3002","title":"ICMP"},{"location":"Network/3_network/#ipv6","text":"","title":"IPV6"},{"location":"Network/3_network/#_5","text":"","title":"\u5c42\u6b21\u8def\u7531"},{"location":"Network/4_link/","text":"\u94fe\u8def\u5c42 \u94fe\u8def\u5c42\u670d\u52a1 MAC\u5730\u5740\u4e0eARP\u534f\u8bae \u2003ARP\u534f\u8bae\u867d\u7136\u5de5\u4f5c\u5728\u94fe\u8def\u5c42\uff0c\u4f46\u5728TCP/IP\u534f\u8bae\u65cf\u4e2d\u5c5e\u4e8e\u7f51\u7edc\u5c42\u534f\u8bae \u4ee5\u592a\u7f51\u4e0eVLAN","title":"link"},{"location":"Network/4_link/#_1","text":"","title":"\u94fe\u8def\u5c42"},{"location":"Network/4_link/#_2","text":"","title":"\u94fe\u8def\u5c42\u670d\u52a1"},{"location":"Network/4_link/#macarp","text":"ARP\u534f\u8bae\u867d\u7136\u5de5\u4f5c\u5728\u94fe\u8def\u5c42\uff0c\u4f46\u5728TCP/IP\u534f\u8bae\u65cf\u4e2d\u5c5e\u4e8e\u7f51\u7edc\u5c42\u534f\u8bae","title":"MAC\u5730\u5740\u4e0eARP\u534f\u8bae"},{"location":"Network/4_link/#vlan","text":"","title":"\u4ee5\u592a\u7f51\u4e0eVLAN"},{"location":"Network/5_netsafe/","text":"\u7f51\u7edc\u5b89\u5168 Internet \u5b89\u5168\u5a01\u80c1 DDoS \u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff0c\u5e38\u89c1\u653b\u51fb\u65b9\u5f0f\u6709: \u8d44\u6e90\u6d88\u8017\u7c7b: \u5982Syn Flood\u3001Ack Flood\u3001UDP Flood,\u901a\u8fc7\u5927\u91cf\u8bf7\u6c42\u6d88\u8017\u6b63\u5e38\u7684\u5e26\u5bbd\u548c\u534f\u8bae\u6808\u5904\u7406\u8d44\u6e90\u7684\u80fd\u529b\uff0c \u4ece\u800c\u8fbe\u5230\u670d\u52a1\u7aef\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u7684\u76ee\u7684\u3002 Syn Flood: \u653b\u51fb\u8005\u5229\u7528\u53d7\u63a7\u4e3b\u673a\u53d1\u9001\u5927\u91cf\u7684TCP SYN\u62a5\u6587\uff0c\u4f7f\u670d\u52a1\u5668\u6253\u5f00\u5927\u91cf\u7684\u534a\u5f00\u8fde\u63a5\uff0c\u5360\u6ee1\u670d\u52a1\u5668\u7684\u8fde\u63a5\u8868\uff0c \u4ece\u800c\u5f71\u54cd\u6b63\u5e38\u7528\u6237\u4e0e\u670d\u52a1\u5668\u5efa\u7acb\u4f1a\u8bdd\uff0c\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002 ACK Flood\u53cd\u5c04\u653b\u51fb:\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u53d7\u63a7\u4e3b\u673a\u5411\u5927\u91cf\u4e0d\u540c\u7684\u670d\u52a1\u5668\u53d1\u9001\u4f2a\u9020\u6e90IP\u5730\u5740\u7684SYN\u8bf7\u6c42\uff0c \u4ece\u800c\u4f7f\u670d\u52a1\u5668\u54cd\u5e94\u7684\u5927\u91cfACK\u5e94\u7b54\u6570\u636e\u6d8c\u5411\u88ab\u653b\u51fb\u76ee\u6807\uff0c\u5360\u7528\u76ee\u6807\u7684\u7f51\u7edc\u5bbd\u5e26\u8d44\u6e90\u5e76\u62d2\u7edd\u670d\u52a1\u3002 UDP Flood\u4f7f\u7528\u5c0f\u5305\u548c\u5927\u5305\u4e24\u79cd\u65b9\u5f0f\u8fdb\u884c\u653b\u51fb\u3002 \u5c0f\u5305\u662f\u630764\u5b57\u8282\u5927\u5c0f\u7684\u6570\u636e\u5305\uff0c\u8fd9\u662f\u4ee5\u592a\u7f51\u4e0a\u4f20\u8f93\u6570\u636e\u5e27\u7684\u6700\u5c0f\u503c\uff0c\u5728\u76f8\u540c\u6d41\u91cf\u4e0b\uff0c\u5355\u5305\u4f53\u79ef\u8d8a\u5c0f\uff0c\u6570\u636e\u5305\u7684\u6570\u91cf\u5c31\u8d8a\u591a\u3002 \u7531\u4e8e\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u7b49\u7f51\u7edc\u8bbe\u5907\u9700\u8981\u5bf9\u6bcf\u4e00\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u68c0\u67e5\u548c\u6821\u9a8c\uff0c \u56e0\u6b64\u4f7f\u7528UDP\u5c0f\u5305\u653b\u51fb\u80fd\u591f\u6700\u6709\u6548\u7684\u589e\u5927\u7f51\u7edc\u8bbe\u5907\u5904\u7406\u6570\u636e\u5305\u7684\u538b\u529b\uff0c\u9020\u6210\u5904\u7406\u901f\u5ea6\u7684\u7f13\u6162\u548c\u4f20\u8f93\u5ef6\u8fdf\u7b49\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u7684\u6548\u679c\u3002 \u5927\u5305\u662f\u63071500\u5b57\u8282\u4ee5\u4e0a\u7684\u6570\u636e\u5305\uff0c\u5176\u5927\u5c0f\u8d85\u8fc7\u4e86\u4ee5\u592a\u7f51\u7684\u6700\u5927\u4f20\u8f93\u5355\u5143(MTU)\uff0c\u4f7f\u7528UDP\u5927\u5305\u653b\u51fb\uff0c \u80fd\u591f\u6709\u6548\u7684\u5360\u7528\u7f51\u7edc\u63a5\u53e3\u7684\u4f20\u8f93\u5bbd\u5e26\uff0c\u5e76\u8feb\u4f7f\u88ab\u653b\u51fb\u76ee\u6807\u5728\u63a5\u53d7\u5230UDP\u6570\u636e\u65f6\u8fdb\u884c\u5206\u7247\u91cd\u7ec4\uff0c\u9020\u6210\u7f51\u7edc\u62e5\u5835\uff0c \u670d\u52a1\u5668\u54cd\u5e94\u901f\u5ea6\u53d8\u6162\u3002 \u670d\u52a1\u6d88\u8017\u7c7b: \u5982Connection Flood\u548cHTTP GET\u653b\u51fb\uff0c\u524d\u8005\u5229\u7528\u771f\u5b9e\u7684IP\u5730\u5740\u5411\u670d\u52a1\u5668\u53d1\u8d77\u5927\u91cf\u7684\u8fde\u63a5\u3002 \u5e76\u4e14\u5efa\u7acb\u8fde\u63a5\u4e4b\u540e\u5f88\u957f\u65f6\u95f4\u4e0d\u91ca\u653e\uff0c\u5360\u7528\u670d\u52a1\u5668\u7684\u8d44\u6e90\uff0c\u9020\u6210\u670d\u52a1\u5668\u4e0a\u6b8b\u4f59\u8fde\u63a5(WAIT\u72b6\u6001)\u8fc7\u591a\uff0c\u6548\u7387\u964d\u4f4e\uff0c\u751a\u81f3\u8d44\u6e90\u8017\u5c3d\uff0c \u65e0\u6cd5\u54cd\u5e94\u5176\u4ed6\u5ba2\u6237\u6240\u53d1\u8d77\u7684\u94fe\u63a5\uff1b\u540e\u8005\u662f\u548c\u670d\u52a1\u5668\u5efa\u7acb\u6b63\u5e38\u7684TCP\u8fde\u63a5\uff0c \u5e76\u4e0d\u65ad\u5229\u7528\u811a\u672c\u7a0b\u5e8f\u63d0\u4ea4\u67e5\u8be2\u3001\u5217\u8868\u7b49\u5927\u91cf\u8017\u8d39\u670d\u52a1\u5668\u6570\u636e\u5e93\u8d44\u6e90\u7684\u8bf7\u6c42\u3002 \u53cd\u5c04\u653b\u51fb: \u653b\u51fb\u8005\u901a\u8fc7IP\u6b3a\u9a97\uff0c\u5c06\u5927\u91cf\u50f5\u5c38\u4e3b\u673a\u7684\u6e90IP\u5730\u5740\u4f2a\u88c5\u6210\u88ab\u653b\u51fb\u670d\u52a1\u5668\u7684IP\uff0c\u7136\u540e\u5411\u5f00\u653e\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\uff0c \u8fd9\u4e9b\u670d\u52a1\u5668\u5219\u4f1a\u5411\u88ab\u653b\u51fb\u670d\u52a1\u5668\u8fd4\u56de\u5e94\u7b54\u62a5\u6587\uff0c\u4ece\u800c\u95f4\u63a5\u9020\u6210DDoS\u653b\u51fb\u3002 \u9632\u5fa1\u63aa\u65bd\u6709: \u6269\u5bb9\uff0c\u63d0\u9ad8\u5e26\u5bbd\uff1b \u5f02\u5e38\u6d41\u91cf\u7684\u6e05\u6d17: \u901a\u8fc7DDoS\u786c\u4ef6\u9632\u706b\u5899\u5bf9\u5f02\u5e38\u6d41\u91cf\u7684\u6e05\u6d17\u8fc7\u6ee4\u3002 \u5206\u5e03\u5f0f\u96c6\u7fa4\u9632\u5fa1: \u5728\u6bcf\u4e2a\u8282\u70b9\u670d\u52a1\u5668\u914d\u7f6e\u591a\u4e2aIP\u5730\u5740\uff0c\u5e76\u4e14\u6bcf\u4e2a\u8282\u70b9\u80fd\u627f\u53d7\u4e0d\u4f4e\u4e8e10G\u7684DDoS\u653b\u51fb\uff0c \u5982\u4e00\u4e2a\u8282\u70b9\u53d7\u653b\u51fb\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\uff0c\u7cfb\u7edf\u5c06\u4f1a\u6839\u636e\u4f18\u5148\u7ea7\u8bbe\u7f6e\u81ea\u52a8\u5207\u6362\u53e6\u4e00\u4e2a\u8282\u70b9\uff0c \u5e76\u5c06\u653b\u51fb\u8005\u7684\u6570\u636e\u5305\u5168\u90e8\u8fd4\u56de\u53d1\u9001\u70b9\uff0c\u4f7f\u653b\u51fb\u6e90\u6210\u4e3a\u762b\u75ea\u72b6\u6001 \u52a0\u5bc6\u7b97\u6cd5 \u975e\u5bf9\u79f0\u52a0\u5bc6: \u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u76f8\u540c\u5bc6\u94a5\u7684\u52a0\u5bc6\u7b97\u6cd5 \u5bf9\u79f0\u52a0\u5bc6: \u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u4e5f\u79f0\u4e3a\u516c\u79c1\u94a5\u52a0\u5bc6 1.\u7531\u4e8e\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u8fd0\u884c\u901f\u5ea6\u6bd4\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u901f\u5ea6\u6162\u5f88\u591a\uff0c\u5f53\u6211\u4eec\u9700\u8981\u52a0\u5bc6\u5927\u91cf\u7684\u6570\u636e\u65f6\uff0c \u5efa\u8bae\u91c7\u7528\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff0c\u63d0\u9ad8\u52a0\u89e3\u5bc6\u901f\u5ea6\u3002 2.\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u4e0d\u80fd\u5b9e\u73b0\u7b7e\u540d\uff0c\u56e0\u6b64\u7b7e\u540d\u53ea\u80fd\u975e\u5bf9\u79f0\u7b97\u6cd5\u3002 3.\u7531\u4e8e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u5bc6\u94a5\u7ba1\u7406\u662f\u4e00\u4e2a\u590d\u6742\u7684\u8fc7\u7a0b\uff0c\u5bc6\u94a5\u7684\u7ba1\u7406\u76f4\u63a5\u51b3\u5b9a\u7740\u4ed6\u7684\u5b89\u5168\u6027\uff0c \u56e0\u6b64\u5f53\u6570\u636e\u91cf\u5f88\u5c0f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u3002 4.\u5728\u5b9e\u9645\u7684\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u91c7\u7528\u7684\u65b9\u5f0f\u662f\uff1a\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7ba1\u7406\u5bf9\u79f0\u7b97\u6cd5\u7684\u5bc6\u94a5\uff0c \u7136\u540e\u7528\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u52a0\u5bc6\u6570\u636e\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u96c6\u6210\u4e86\u4e24\u7c7b\u52a0\u5bc6\u7b97\u6cd5\u7684\u4f18\u70b9\uff0c\u65e2\u5b9e\u73b0\u4e86\u52a0\u5bc6\u901f\u5ea6\u5feb\u7684\u4f18\u70b9\uff0c \u53c8\u5b9e\u73b0\u4e86\u5b89\u5168\u65b9\u4fbf\u7ba1\u7406\u5bc6\u94a5\u7684\u4f18\u70b9\u3002 Web\u5b89\u5168 SSL VPN\u4e0e\u9632\u706b\u5899","title":"safe"},{"location":"Network/5_netsafe/#_1","text":"","title":"\u7f51\u7edc\u5b89\u5168"},{"location":"Network/5_netsafe/#internet","text":"DDoS \u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\uff0c\u5e38\u89c1\u653b\u51fb\u65b9\u5f0f\u6709: \u8d44\u6e90\u6d88\u8017\u7c7b: \u5982Syn Flood\u3001Ack Flood\u3001UDP Flood,\u901a\u8fc7\u5927\u91cf\u8bf7\u6c42\u6d88\u8017\u6b63\u5e38\u7684\u5e26\u5bbd\u548c\u534f\u8bae\u6808\u5904\u7406\u8d44\u6e90\u7684\u80fd\u529b\uff0c \u4ece\u800c\u8fbe\u5230\u670d\u52a1\u7aef\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u7684\u76ee\u7684\u3002 Syn Flood: \u653b\u51fb\u8005\u5229\u7528\u53d7\u63a7\u4e3b\u673a\u53d1\u9001\u5927\u91cf\u7684TCP SYN\u62a5\u6587\uff0c\u4f7f\u670d\u52a1\u5668\u6253\u5f00\u5927\u91cf\u7684\u534a\u5f00\u8fde\u63a5\uff0c\u5360\u6ee1\u670d\u52a1\u5668\u7684\u8fde\u63a5\u8868\uff0c \u4ece\u800c\u5f71\u54cd\u6b63\u5e38\u7528\u6237\u4e0e\u670d\u52a1\u5668\u5efa\u7acb\u4f1a\u8bdd\uff0c\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002 ACK Flood\u53cd\u5c04\u653b\u51fb:\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u53d7\u63a7\u4e3b\u673a\u5411\u5927\u91cf\u4e0d\u540c\u7684\u670d\u52a1\u5668\u53d1\u9001\u4f2a\u9020\u6e90IP\u5730\u5740\u7684SYN\u8bf7\u6c42\uff0c \u4ece\u800c\u4f7f\u670d\u52a1\u5668\u54cd\u5e94\u7684\u5927\u91cfACK\u5e94\u7b54\u6570\u636e\u6d8c\u5411\u88ab\u653b\u51fb\u76ee\u6807\uff0c\u5360\u7528\u76ee\u6807\u7684\u7f51\u7edc\u5bbd\u5e26\u8d44\u6e90\u5e76\u62d2\u7edd\u670d\u52a1\u3002 UDP Flood\u4f7f\u7528\u5c0f\u5305\u548c\u5927\u5305\u4e24\u79cd\u65b9\u5f0f\u8fdb\u884c\u653b\u51fb\u3002 \u5c0f\u5305\u662f\u630764\u5b57\u8282\u5927\u5c0f\u7684\u6570\u636e\u5305\uff0c\u8fd9\u662f\u4ee5\u592a\u7f51\u4e0a\u4f20\u8f93\u6570\u636e\u5e27\u7684\u6700\u5c0f\u503c\uff0c\u5728\u76f8\u540c\u6d41\u91cf\u4e0b\uff0c\u5355\u5305\u4f53\u79ef\u8d8a\u5c0f\uff0c\u6570\u636e\u5305\u7684\u6570\u91cf\u5c31\u8d8a\u591a\u3002 \u7531\u4e8e\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u7b49\u7f51\u7edc\u8bbe\u5907\u9700\u8981\u5bf9\u6bcf\u4e00\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u68c0\u67e5\u548c\u6821\u9a8c\uff0c \u56e0\u6b64\u4f7f\u7528UDP\u5c0f\u5305\u653b\u51fb\u80fd\u591f\u6700\u6709\u6548\u7684\u589e\u5927\u7f51\u7edc\u8bbe\u5907\u5904\u7406\u6570\u636e\u5305\u7684\u538b\u529b\uff0c\u9020\u6210\u5904\u7406\u901f\u5ea6\u7684\u7f13\u6162\u548c\u4f20\u8f93\u5ef6\u8fdf\u7b49\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u7684\u6548\u679c\u3002 \u5927\u5305\u662f\u63071500\u5b57\u8282\u4ee5\u4e0a\u7684\u6570\u636e\u5305\uff0c\u5176\u5927\u5c0f\u8d85\u8fc7\u4e86\u4ee5\u592a\u7f51\u7684\u6700\u5927\u4f20\u8f93\u5355\u5143(MTU)\uff0c\u4f7f\u7528UDP\u5927\u5305\u653b\u51fb\uff0c \u80fd\u591f\u6709\u6548\u7684\u5360\u7528\u7f51\u7edc\u63a5\u53e3\u7684\u4f20\u8f93\u5bbd\u5e26\uff0c\u5e76\u8feb\u4f7f\u88ab\u653b\u51fb\u76ee\u6807\u5728\u63a5\u53d7\u5230UDP\u6570\u636e\u65f6\u8fdb\u884c\u5206\u7247\u91cd\u7ec4\uff0c\u9020\u6210\u7f51\u7edc\u62e5\u5835\uff0c \u670d\u52a1\u5668\u54cd\u5e94\u901f\u5ea6\u53d8\u6162\u3002 \u670d\u52a1\u6d88\u8017\u7c7b: \u5982Connection Flood\u548cHTTP GET\u653b\u51fb\uff0c\u524d\u8005\u5229\u7528\u771f\u5b9e\u7684IP\u5730\u5740\u5411\u670d\u52a1\u5668\u53d1\u8d77\u5927\u91cf\u7684\u8fde\u63a5\u3002 \u5e76\u4e14\u5efa\u7acb\u8fde\u63a5\u4e4b\u540e\u5f88\u957f\u65f6\u95f4\u4e0d\u91ca\u653e\uff0c\u5360\u7528\u670d\u52a1\u5668\u7684\u8d44\u6e90\uff0c\u9020\u6210\u670d\u52a1\u5668\u4e0a\u6b8b\u4f59\u8fde\u63a5(WAIT\u72b6\u6001)\u8fc7\u591a\uff0c\u6548\u7387\u964d\u4f4e\uff0c\u751a\u81f3\u8d44\u6e90\u8017\u5c3d\uff0c \u65e0\u6cd5\u54cd\u5e94\u5176\u4ed6\u5ba2\u6237\u6240\u53d1\u8d77\u7684\u94fe\u63a5\uff1b\u540e\u8005\u662f\u548c\u670d\u52a1\u5668\u5efa\u7acb\u6b63\u5e38\u7684TCP\u8fde\u63a5\uff0c \u5e76\u4e0d\u65ad\u5229\u7528\u811a\u672c\u7a0b\u5e8f\u63d0\u4ea4\u67e5\u8be2\u3001\u5217\u8868\u7b49\u5927\u91cf\u8017\u8d39\u670d\u52a1\u5668\u6570\u636e\u5e93\u8d44\u6e90\u7684\u8bf7\u6c42\u3002 \u53cd\u5c04\u653b\u51fb: \u653b\u51fb\u8005\u901a\u8fc7IP\u6b3a\u9a97\uff0c\u5c06\u5927\u91cf\u50f5\u5c38\u4e3b\u673a\u7684\u6e90IP\u5730\u5740\u4f2a\u88c5\u6210\u88ab\u653b\u51fb\u670d\u52a1\u5668\u7684IP\uff0c\u7136\u540e\u5411\u5f00\u653e\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\uff0c \u8fd9\u4e9b\u670d\u52a1\u5668\u5219\u4f1a\u5411\u88ab\u653b\u51fb\u670d\u52a1\u5668\u8fd4\u56de\u5e94\u7b54\u62a5\u6587\uff0c\u4ece\u800c\u95f4\u63a5\u9020\u6210DDoS\u653b\u51fb\u3002 \u9632\u5fa1\u63aa\u65bd\u6709: \u6269\u5bb9\uff0c\u63d0\u9ad8\u5e26\u5bbd\uff1b \u5f02\u5e38\u6d41\u91cf\u7684\u6e05\u6d17: \u901a\u8fc7DDoS\u786c\u4ef6\u9632\u706b\u5899\u5bf9\u5f02\u5e38\u6d41\u91cf\u7684\u6e05\u6d17\u8fc7\u6ee4\u3002 \u5206\u5e03\u5f0f\u96c6\u7fa4\u9632\u5fa1: \u5728\u6bcf\u4e2a\u8282\u70b9\u670d\u52a1\u5668\u914d\u7f6e\u591a\u4e2aIP\u5730\u5740\uff0c\u5e76\u4e14\u6bcf\u4e2a\u8282\u70b9\u80fd\u627f\u53d7\u4e0d\u4f4e\u4e8e10G\u7684DDoS\u653b\u51fb\uff0c \u5982\u4e00\u4e2a\u8282\u70b9\u53d7\u653b\u51fb\u65e0\u6cd5\u63d0\u4f9b\u670d\u52a1\uff0c\u7cfb\u7edf\u5c06\u4f1a\u6839\u636e\u4f18\u5148\u7ea7\u8bbe\u7f6e\u81ea\u52a8\u5207\u6362\u53e6\u4e00\u4e2a\u8282\u70b9\uff0c \u5e76\u5c06\u653b\u51fb\u8005\u7684\u6570\u636e\u5305\u5168\u90e8\u8fd4\u56de\u53d1\u9001\u70b9\uff0c\u4f7f\u653b\u51fb\u6e90\u6210\u4e3a\u762b\u75ea\u72b6\u6001","title":"Internet \u5b89\u5168\u5a01\u80c1"},{"location":"Network/5_netsafe/#_2","text":"\u975e\u5bf9\u79f0\u52a0\u5bc6: \u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u76f8\u540c\u5bc6\u94a5\u7684\u52a0\u5bc6\u7b97\u6cd5 \u5bf9\u79f0\u52a0\u5bc6: \u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u4e5f\u79f0\u4e3a\u516c\u79c1\u94a5\u52a0\u5bc6 1.\u7531\u4e8e\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u8fd0\u884c\u901f\u5ea6\u6bd4\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u901f\u5ea6\u6162\u5f88\u591a\uff0c\u5f53\u6211\u4eec\u9700\u8981\u52a0\u5bc6\u5927\u91cf\u7684\u6570\u636e\u65f6\uff0c \u5efa\u8bae\u91c7\u7528\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff0c\u63d0\u9ad8\u52a0\u89e3\u5bc6\u901f\u5ea6\u3002 2.\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u4e0d\u80fd\u5b9e\u73b0\u7b7e\u540d\uff0c\u56e0\u6b64\u7b7e\u540d\u53ea\u80fd\u975e\u5bf9\u79f0\u7b97\u6cd5\u3002 3.\u7531\u4e8e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u5bc6\u94a5\u7ba1\u7406\u662f\u4e00\u4e2a\u590d\u6742\u7684\u8fc7\u7a0b\uff0c\u5bc6\u94a5\u7684\u7ba1\u7406\u76f4\u63a5\u51b3\u5b9a\u7740\u4ed6\u7684\u5b89\u5168\u6027\uff0c \u56e0\u6b64\u5f53\u6570\u636e\u91cf\u5f88\u5c0f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u3002 4.\u5728\u5b9e\u9645\u7684\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u91c7\u7528\u7684\u65b9\u5f0f\u662f\uff1a\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7ba1\u7406\u5bf9\u79f0\u7b97\u6cd5\u7684\u5bc6\u94a5\uff0c \u7136\u540e\u7528\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u52a0\u5bc6\u6570\u636e\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u96c6\u6210\u4e86\u4e24\u7c7b\u52a0\u5bc6\u7b97\u6cd5\u7684\u4f18\u70b9\uff0c\u65e2\u5b9e\u73b0\u4e86\u52a0\u5bc6\u901f\u5ea6\u5feb\u7684\u4f18\u70b9\uff0c \u53c8\u5b9e\u73b0\u4e86\u5b89\u5168\u65b9\u4fbf\u7ba1\u7406\u5bc6\u94a5\u7684\u4f18\u70b9\u3002","title":"\u52a0\u5bc6\u7b97\u6cd5"},{"location":"Network/5_netsafe/#web","text":"SSL","title":"Web\u5b89\u5168"},{"location":"Network/5_netsafe/#vpn","text":"","title":"VPN\u4e0e\u9632\u706b\u5899"},{"location":"Network/home/","text":"\u8ba1\u7b97\u673a\u7f51\u7edc base \u534f\u8bae: \u4e00\u4e2a\u534f\u8bae\u5b9a\u4e49\u4e86\u5728\u4e24\u4e2a\u6216\u591a\u4e2a\u901a\u4fe1\u5b9e\u4f53\u4e4b\u95f4\u4ea4\u6362\u7684\u62a5\u6587\u683c\u5f0f\u548c\u6b21\u5e8f\uff0c\u4ee5\u53ca\u62a5\u6587\u53d1\u9001\u548c/\u6216\u63a5\u6536\u4e00\u6761\u62a5\u6587\u6216\u5176\u4ed6\u4e8b\u4ef6\u6240\u91c7\u53d6\u7684\u52a8\u4f5c\u3002 \u5206\u7ec4\u4ea4\u6362: \u4e3a\u4e86\u4ece\u6e90\u7aef\u7cfb\u7edf\u5411\u76ee\u7684\u7aef\u7cfb\u7edf\u53d1\u9001\u4e00\u4e2a\u62a5\u6587\uff0c\u6e90\u5c06\u957f\u62a5\u6587\u5212\u5206\u6210\u8f83\u5c0f\u7684\u6570\u636e\u5757\uff0c\u79f0\u4e3a\u5206\u7ec4\uff1b\u5728\u6e90\u548c\u76ee\u7684\u4e4b\u95f4\uff0c\u5206\u7ec4\u901a\u8fc7\u901a\u4fe1\u94fe\u8def\u548c\u5206\u7ec4\u4ea4\u6362\u673a(\u8def\u7531\u5668\u548c\u94fe\u8def\u5c42\u4ea4\u6362\u673a)\u4f20\u9001\u3002 \u2003\u5b58\u50a8\u8f6c\u53d1\u4f20\u8f93: \u591a\u6570\u5206\u7ec4\u4ea4\u6362\u673a\u5728\u94fe\u8def\u8f93\u5165\u7aef\u4f7f\u7528\u5b58\u50a8\u8f6c\u53d1\u4f20\u8f93\u673a\u5236\uff0c \u6307\u5728\u4ea4\u6362\u673a\u80fd\u591f\u5f00\u59cb\u5411\u8f93\u51fa\u94fe\u8def\u4f20\u8f93\u5206\u7ec4\u7684\u7b2c\u4e00\u4e2abit\u4e4b\u524d\uff0c\u5fc5\u987b\u63a5\u6536\u6574\u4e2a\u5206\u7ec4 \u3002 \u2003\u5206\u7ec4\u4ea4\u6362\u76f8\u6bd4\u62a5\u6587\u4ea4\u6362\u6709\u66f4\u77ed\u7684\u4f20\u8f93\u65f6\u5ef6\uff0c\u5bf9\u4e8e\u4ea4\u6362\u673a\u7684\u7f13\u5b58\u5927\u5c0f\u8981\u6c42\u4e5f\u66f4\u5c0f(\u7406\u8bba\u4e0a\u4ec5\u4e3a\u4e00\u4e2a\u5206\u7ec4\u5927\u5c0f)\uff1b\u76f8\u6bd4\u7535\u8def\u4ea4\u6362\uff0c\u5219\u5141\u8bb8\u66f4\u591a\u7528\u6237\u540c\u65f6\u4f7f\u7528\u7f51\u7edc\uff0c\u7f51\u7edc\u8d44\u6e90\u5145\u5206\u5171\u4eab\uff0c \u9002\u5408\u7a81\u53d1\u6570\u636e\u4f20\u8f93\u7f51\u7edc \uff0c \u4e14\u65e0\u9700\u547c\u53eb\u5efa\u7acb\u8fde\u63a5\u3002 \u2003\u7f3a\u70b9: \u53ef\u80fd\u4ea7\u751f\u62e5\u585e: \u5206\u7ec4\u5ef6\u8fdf\u548c\u4e22\u5305\uff1b \u4e14\u7531\u4e8e\u6e90\u548c\u76ee\u4e4b\u95f4\u4e0d\u50cf\u7535\u8def\u4ea4\u6362\u6709\u4e00\u6761\u72ec\u5360\u7684\u8fde\u63a5\uff0c\u5b58\u5728\u4e0d\u53ef\u9884\u6d4b\u7684\u6392\u961f\u5ef6\u8fdf\uff0c\u56e0\u6b64\u5728\u5b9e\u65f6\u6027\u4efb\u52a1\u4e0a\u6027\u80fd\u6b20\u7f3a\u3002 \u541e\u5410\u91cf: \u7aef\u5230\u7aef\u4f20\u8f93\u6570\u636e\u7684\u5e73\u5747\u901f\u7387\uff0c\u901a\u5e38\u53d6\u51b3\u4e8e\u6cbf\u7740\u6e90\u5230\u76ee\u7684\u5730\u4e4b\u95f4\u8def\u5f84\u7684\u6700\u5c0f\u4f20\u8f93\u901f\u7387(\u5373\u74f6\u9888\u94fe\u8def\u7684\u4f20\u8f93\u901f\u7387)\u3002 \u7f51\u7edc\u4f53\u7cfb\u7ed3\u6784 \u5206\u5c42\u7ed3\u6784 \u62a5\u6587:\u4f4d\u4e8e\u5e94\u7528\u5c42\u7684\u4fe1\u606f\u5206\u7ec4 \u62a5\u6587\u6bb5: \u8fd0\u8f93\u5c42\u5206\u7ec4 \u6570\u636e\u62a5: \u7f51\u7edc\u5c42\u5206\u7ec4 \u5e27: \u94fe\u8def\u5c42\u5206\u7ec4 OSI\u6a21\u578b \u2003\u5404\u5c42\u7684\u6240\u6709\u534f\u8bae\u88ab\u79f0\u4e3a\u534f\u8bae\u6808\uff0cOSI(Open System Interconnection,\u5f00\u653e\u7cfb\u7edf\u4e92\u8fde)\u6a21\u578b\u7684\u534f\u8bae\u6808\u5206\u4e3a7\u4e2a\u5c42\u6b21 \u56e0\u7279\u7f51\u534f\u8bae\u6808(\u4e94\u5c42\u53c2\u8003\u6a21\u578b) \u5728\u6d4f\u89c8\u5668\u8f93\u5165URL\u6309\u4e0b\u56de\u8f66\u540e \u6d4f\u89c8\u5668\u5148\u8981\u89e3\u6790URL \u2003\u6839\u636eURL\u683c\u5f0f\u89e3\u6790\u5f97\u5230\u6240\u91c7\u7528\u7684\u534f\u8bae(\u5982HTTP)\u3001\u670d\u52a1\u5668\u57df\u540d\u3001\u6587\u4ef6\u8def\u5f84\u540d\uff0c\u6587\u4ef6\u8def\u5f84\u540d\u53ef\u7701\u7565\uff0c\u8fd9\u6837\u8bbf\u95ee\u7684\u5c06\u662f\u670d\u52a1\u5668\u6839\u76ee\u5f55\u4e0b\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u9875\u9762(\u4e3b\u9875) \u2003 URL(\u7edf\u4e00\u8d44\u6e90\u5b9a\u4f4d\u7b26) and URI(\u7edf\u4e00\u8d44\u6e90\u6807\u8bc6\u7b26): URI\u8868\u793a\u7684\u662fweb\u4e0a\u6bcf\u4e00\u79cd\u53ef\u7528\u7684\u8d44\u6e90\uff0c\u5982 HTML\u6587\u6863\u3001\u56fe\u50cf\u3001\u89c6\u9891\u7247\u6bb5\u3001\u7a0b\u5e8f\u7b49\u90fd\u7531\u4e00\u4e2aURI\u8fdb\u884c\u6807\u8bc6\uff0c \u5176\u4e0d\u4e00\u5b9a\u5305\u542b\u7edd\u5bf9\u7684\u8bbf\u95ee\u8def\u5f84\uff1b URL\u7528\u4e00\u79cd\u7edf\u4e00\u7684\u683c\u5f0f\u6765\u63cf\u8ff0\u5404\u79cd\u4fe1\u606f\u8d44\u6e90\uff0c\u5305\u62ec\u6587\u4ef6\u3001\u670d\u52a1\u5668\u7684\u5730\u5740\u548c\u76ee\u5f55\u7b49\u3002 URL\u662fURI\u6982\u5ff5\u7684\u4e00\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5176\u5305\u542b\u7684\u662f\u8d44\u6e90\u7684\u7edd\u5bf9\u8bbf\u95ee\u8def\u5f84\u3002 \u6d4f\u89c8\u5668\u751f\u6210HTTP\u8bf7\u6c42\u6d88\u606f \u20031\u6761\u8bf7\u6c42\u6d88\u606f\u4e2d\u53ea\u80fd\u5305\u542b1\u4e2aURI\u3002\u5982\u679c\u9700\u8981\u83b7\u53d6\u591a\u4e2a\u6587\u4ef6\uff0c\u5fc5\u987b\u5bf9\u6bcf\u4e2a\u6587\u4ef6\u5355\u72ec\u53d1\u90011\u6761\u8bf7\u6c42\u3002\u91c7\u7528\u6301\u4e45\u6027\u8fde\u63a5\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aTCP\u8fde\u63a5\u4f20\u8f93\uff1b\u800c\u975e\u6301\u4e45\u6027\u8fde\u63a5\uff0c\u5219\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u8981\u91cd\u65b0\u5efa\u7acb\u4e00\u4e2aTCP\u8fde\u63a5\u3002 \u5411DNS\u670d\u52a1\u5668\u67e5\u8be2Web\u670d\u52a1\u5668\u7684IP\u5730\u5740 \u2003\u6d4f\u89c8\u5668\u4f1a\u8c03\u7528Socket\u5e93\u4e2d\u7684gethostbyname\u51fd\u6570\uff0c\u63d0\u4f9b\u57df\u540d\u4f5c\u4e3a\u53c2\u6570\uff0c\u5411DNS\u670d\u52a1\u5668\u53d1\u9001\u67e5\u8be2\u6d88\u606f(\u4e00\u4e2aUDP\u62a5\u6587)\uff0c\u7136\u540e\u4eceDNS\u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u6d88\u606f\u4e2d\u53d6\u51faIP\u5730\u5740\u3002\u672c\u5730DNS\u670d\u52a1\u5668\u7684IP\u662f\u9884\u5148\u914d\u7f6e\u597d\u7684\u3002 \u2003\u67e5\u8be2\u7684\u8fc7\u7a0b\u4ece\u672c\u5730DNS\u670d\u52a1\u5668\u5f00\u59cb\uff0c\u82e5\u5176\u6ca1\u6709\u76f8\u5e94\u7684\u7f13\u5b58\u8bb0\u5f55\uff0c\u5219\u5176\u4f1a\u5411\u9876\u7ea7DNS\u670d\u52a1\u5668\u8f6c\u53d1\u8bf7\u6c42\u6d88\u606f(\u9012\u5f52\u67e5\u8be2)\uff1b\u6216\u8005\u9876\u7ea7DNS\u670d\u52a1\u5668\u4f1a\u5411\u672c\u5730DNS\u670d\u52a1\u5668\u8fd4\u56de\u9876\u7ea7\u57df\u540d\u670d\u52a1\u5668\u7684IP\u5730\u5740(\u8fed\u4ee3\u67e5\u8be2)\uff0c\u672c\u5730DNS\u670d\u52a1\u5668\u518d\u5411\u9876\u7ea7DNS\u670d\u52a1\u5668\u53d1\u9001\u67e5\u8be2\u8bf7\u6c42\uff0c\u540e\u8005\u5982\u679c\u4f9d\u65e7\u67e5\u8be2\u4e0d\u5230\uff0c\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684\u6743\u5a01\u57df\u540d\u670d\u52a1\u5668IP\u5730\u5740\u3002 \u2003\u901a\u8fc7DNS\u83b7\u53d6\u5230IP\u540e\uff0cHTTP\u7684\u4f20\u8f93\u5de5\u4f5c\u5219\u4ea4\u7531\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u534f\u8bae\u6808\u6765\u5b8c\u6210\u3002 \u5efa\u7acbTCP\u8fde\u63a5 \u2003\u91c7\u7528Socket\u5957\u63a5\u5b57\u6765\u5efa\u7acb\u8fde\u63a5\uff0c\u5177\u4f53\u8fc7\u7a0b\u89c1\u4e09\u6b21\u63e1\u624b \u65ad\u5f00\u8fde\u63a5 \u2003 \u56db\u6b21\u6325\u624b","title":"home"},{"location":"Network/home/#_1","text":"","title":"\u8ba1\u7b97\u673a\u7f51\u7edc"},{"location":"Network/home/#base","text":"\u534f\u8bae: \u4e00\u4e2a\u534f\u8bae\u5b9a\u4e49\u4e86\u5728\u4e24\u4e2a\u6216\u591a\u4e2a\u901a\u4fe1\u5b9e\u4f53\u4e4b\u95f4\u4ea4\u6362\u7684\u62a5\u6587\u683c\u5f0f\u548c\u6b21\u5e8f\uff0c\u4ee5\u53ca\u62a5\u6587\u53d1\u9001\u548c/\u6216\u63a5\u6536\u4e00\u6761\u62a5\u6587\u6216\u5176\u4ed6\u4e8b\u4ef6\u6240\u91c7\u53d6\u7684\u52a8\u4f5c\u3002 \u5206\u7ec4\u4ea4\u6362: \u4e3a\u4e86\u4ece\u6e90\u7aef\u7cfb\u7edf\u5411\u76ee\u7684\u7aef\u7cfb\u7edf\u53d1\u9001\u4e00\u4e2a\u62a5\u6587\uff0c\u6e90\u5c06\u957f\u62a5\u6587\u5212\u5206\u6210\u8f83\u5c0f\u7684\u6570\u636e\u5757\uff0c\u79f0\u4e3a\u5206\u7ec4\uff1b\u5728\u6e90\u548c\u76ee\u7684\u4e4b\u95f4\uff0c\u5206\u7ec4\u901a\u8fc7\u901a\u4fe1\u94fe\u8def\u548c\u5206\u7ec4\u4ea4\u6362\u673a(\u8def\u7531\u5668\u548c\u94fe\u8def\u5c42\u4ea4\u6362\u673a)\u4f20\u9001\u3002 \u2003\u5b58\u50a8\u8f6c\u53d1\u4f20\u8f93: \u591a\u6570\u5206\u7ec4\u4ea4\u6362\u673a\u5728\u94fe\u8def\u8f93\u5165\u7aef\u4f7f\u7528\u5b58\u50a8\u8f6c\u53d1\u4f20\u8f93\u673a\u5236\uff0c \u6307\u5728\u4ea4\u6362\u673a\u80fd\u591f\u5f00\u59cb\u5411\u8f93\u51fa\u94fe\u8def\u4f20\u8f93\u5206\u7ec4\u7684\u7b2c\u4e00\u4e2abit\u4e4b\u524d\uff0c\u5fc5\u987b\u63a5\u6536\u6574\u4e2a\u5206\u7ec4 \u3002 \u2003\u5206\u7ec4\u4ea4\u6362\u76f8\u6bd4\u62a5\u6587\u4ea4\u6362\u6709\u66f4\u77ed\u7684\u4f20\u8f93\u65f6\u5ef6\uff0c\u5bf9\u4e8e\u4ea4\u6362\u673a\u7684\u7f13\u5b58\u5927\u5c0f\u8981\u6c42\u4e5f\u66f4\u5c0f(\u7406\u8bba\u4e0a\u4ec5\u4e3a\u4e00\u4e2a\u5206\u7ec4\u5927\u5c0f)\uff1b\u76f8\u6bd4\u7535\u8def\u4ea4\u6362\uff0c\u5219\u5141\u8bb8\u66f4\u591a\u7528\u6237\u540c\u65f6\u4f7f\u7528\u7f51\u7edc\uff0c\u7f51\u7edc\u8d44\u6e90\u5145\u5206\u5171\u4eab\uff0c \u9002\u5408\u7a81\u53d1\u6570\u636e\u4f20\u8f93\u7f51\u7edc \uff0c \u4e14\u65e0\u9700\u547c\u53eb\u5efa\u7acb\u8fde\u63a5\u3002 \u2003\u7f3a\u70b9: \u53ef\u80fd\u4ea7\u751f\u62e5\u585e: \u5206\u7ec4\u5ef6\u8fdf\u548c\u4e22\u5305\uff1b \u4e14\u7531\u4e8e\u6e90\u548c\u76ee\u4e4b\u95f4\u4e0d\u50cf\u7535\u8def\u4ea4\u6362\u6709\u4e00\u6761\u72ec\u5360\u7684\u8fde\u63a5\uff0c\u5b58\u5728\u4e0d\u53ef\u9884\u6d4b\u7684\u6392\u961f\u5ef6\u8fdf\uff0c\u56e0\u6b64\u5728\u5b9e\u65f6\u6027\u4efb\u52a1\u4e0a\u6027\u80fd\u6b20\u7f3a\u3002 \u541e\u5410\u91cf: \u7aef\u5230\u7aef\u4f20\u8f93\u6570\u636e\u7684\u5e73\u5747\u901f\u7387\uff0c\u901a\u5e38\u53d6\u51b3\u4e8e\u6cbf\u7740\u6e90\u5230\u76ee\u7684\u5730\u4e4b\u95f4\u8def\u5f84\u7684\u6700\u5c0f\u4f20\u8f93\u901f\u7387(\u5373\u74f6\u9888\u94fe\u8def\u7684\u4f20\u8f93\u901f\u7387)\u3002","title":"base"},{"location":"Network/home/#_2","text":"\u5206\u5c42\u7ed3\u6784 \u62a5\u6587:\u4f4d\u4e8e\u5e94\u7528\u5c42\u7684\u4fe1\u606f\u5206\u7ec4 \u62a5\u6587\u6bb5: \u8fd0\u8f93\u5c42\u5206\u7ec4 \u6570\u636e\u62a5: \u7f51\u7edc\u5c42\u5206\u7ec4 \u5e27: \u94fe\u8def\u5c42\u5206\u7ec4 OSI\u6a21\u578b \u2003\u5404\u5c42\u7684\u6240\u6709\u534f\u8bae\u88ab\u79f0\u4e3a\u534f\u8bae\u6808\uff0cOSI(Open System Interconnection,\u5f00\u653e\u7cfb\u7edf\u4e92\u8fde)\u6a21\u578b\u7684\u534f\u8bae\u6808\u5206\u4e3a7\u4e2a\u5c42\u6b21 \u56e0\u7279\u7f51\u534f\u8bae\u6808(\u4e94\u5c42\u53c2\u8003\u6a21\u578b)","title":"\u7f51\u7edc\u4f53\u7cfb\u7ed3\u6784"},{"location":"Network/home/#url","text":"\u6d4f\u89c8\u5668\u5148\u8981\u89e3\u6790URL \u2003\u6839\u636eURL\u683c\u5f0f\u89e3\u6790\u5f97\u5230\u6240\u91c7\u7528\u7684\u534f\u8bae(\u5982HTTP)\u3001\u670d\u52a1\u5668\u57df\u540d\u3001\u6587\u4ef6\u8def\u5f84\u540d\uff0c\u6587\u4ef6\u8def\u5f84\u540d\u53ef\u7701\u7565\uff0c\u8fd9\u6837\u8bbf\u95ee\u7684\u5c06\u662f\u670d\u52a1\u5668\u6839\u76ee\u5f55\u4e0b\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u9875\u9762(\u4e3b\u9875) \u2003 URL(\u7edf\u4e00\u8d44\u6e90\u5b9a\u4f4d\u7b26) and URI(\u7edf\u4e00\u8d44\u6e90\u6807\u8bc6\u7b26): URI\u8868\u793a\u7684\u662fweb\u4e0a\u6bcf\u4e00\u79cd\u53ef\u7528\u7684\u8d44\u6e90\uff0c\u5982 HTML\u6587\u6863\u3001\u56fe\u50cf\u3001\u89c6\u9891\u7247\u6bb5\u3001\u7a0b\u5e8f\u7b49\u90fd\u7531\u4e00\u4e2aURI\u8fdb\u884c\u6807\u8bc6\uff0c \u5176\u4e0d\u4e00\u5b9a\u5305\u542b\u7edd\u5bf9\u7684\u8bbf\u95ee\u8def\u5f84\uff1b URL\u7528\u4e00\u79cd\u7edf\u4e00\u7684\u683c\u5f0f\u6765\u63cf\u8ff0\u5404\u79cd\u4fe1\u606f\u8d44\u6e90\uff0c\u5305\u62ec\u6587\u4ef6\u3001\u670d\u52a1\u5668\u7684\u5730\u5740\u548c\u76ee\u5f55\u7b49\u3002 URL\u662fURI\u6982\u5ff5\u7684\u4e00\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5176\u5305\u542b\u7684\u662f\u8d44\u6e90\u7684\u7edd\u5bf9\u8bbf\u95ee\u8def\u5f84\u3002 \u6d4f\u89c8\u5668\u751f\u6210HTTP\u8bf7\u6c42\u6d88\u606f \u20031\u6761\u8bf7\u6c42\u6d88\u606f\u4e2d\u53ea\u80fd\u5305\u542b1\u4e2aURI\u3002\u5982\u679c\u9700\u8981\u83b7\u53d6\u591a\u4e2a\u6587\u4ef6\uff0c\u5fc5\u987b\u5bf9\u6bcf\u4e2a\u6587\u4ef6\u5355\u72ec\u53d1\u90011\u6761\u8bf7\u6c42\u3002\u91c7\u7528\u6301\u4e45\u6027\u8fde\u63a5\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aTCP\u8fde\u63a5\u4f20\u8f93\uff1b\u800c\u975e\u6301\u4e45\u6027\u8fde\u63a5\uff0c\u5219\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u8981\u91cd\u65b0\u5efa\u7acb\u4e00\u4e2aTCP\u8fde\u63a5\u3002 \u5411DNS\u670d\u52a1\u5668\u67e5\u8be2Web\u670d\u52a1\u5668\u7684IP\u5730\u5740 \u2003\u6d4f\u89c8\u5668\u4f1a\u8c03\u7528Socket\u5e93\u4e2d\u7684gethostbyname\u51fd\u6570\uff0c\u63d0\u4f9b\u57df\u540d\u4f5c\u4e3a\u53c2\u6570\uff0c\u5411DNS\u670d\u52a1\u5668\u53d1\u9001\u67e5\u8be2\u6d88\u606f(\u4e00\u4e2aUDP\u62a5\u6587)\uff0c\u7136\u540e\u4eceDNS\u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u6d88\u606f\u4e2d\u53d6\u51faIP\u5730\u5740\u3002\u672c\u5730DNS\u670d\u52a1\u5668\u7684IP\u662f\u9884\u5148\u914d\u7f6e\u597d\u7684\u3002 \u2003\u67e5\u8be2\u7684\u8fc7\u7a0b\u4ece\u672c\u5730DNS\u670d\u52a1\u5668\u5f00\u59cb\uff0c\u82e5\u5176\u6ca1\u6709\u76f8\u5e94\u7684\u7f13\u5b58\u8bb0\u5f55\uff0c\u5219\u5176\u4f1a\u5411\u9876\u7ea7DNS\u670d\u52a1\u5668\u8f6c\u53d1\u8bf7\u6c42\u6d88\u606f(\u9012\u5f52\u67e5\u8be2)\uff1b\u6216\u8005\u9876\u7ea7DNS\u670d\u52a1\u5668\u4f1a\u5411\u672c\u5730DNS\u670d\u52a1\u5668\u8fd4\u56de\u9876\u7ea7\u57df\u540d\u670d\u52a1\u5668\u7684IP\u5730\u5740(\u8fed\u4ee3\u67e5\u8be2)\uff0c\u672c\u5730DNS\u670d\u52a1\u5668\u518d\u5411\u9876\u7ea7DNS\u670d\u52a1\u5668\u53d1\u9001\u67e5\u8be2\u8bf7\u6c42\uff0c\u540e\u8005\u5982\u679c\u4f9d\u65e7\u67e5\u8be2\u4e0d\u5230\uff0c\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684\u6743\u5a01\u57df\u540d\u670d\u52a1\u5668IP\u5730\u5740\u3002 \u2003\u901a\u8fc7DNS\u83b7\u53d6\u5230IP\u540e\uff0cHTTP\u7684\u4f20\u8f93\u5de5\u4f5c\u5219\u4ea4\u7531\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u534f\u8bae\u6808\u6765\u5b8c\u6210\u3002 \u5efa\u7acbTCP\u8fde\u63a5 \u2003\u91c7\u7528Socket\u5957\u63a5\u5b57\u6765\u5efa\u7acb\u8fde\u63a5\uff0c\u5177\u4f53\u8fc7\u7a0b\u89c1\u4e09\u6b21\u63e1\u624b \u65ad\u5f00\u8fde\u63a5 \u2003 \u56db\u6b21\u6325\u624b","title":"\u5728\u6d4f\u89c8\u5668\u8f93\u5165URL\u6309\u4e0b\u56de\u8f66\u540e"},{"location":"c_base/Complementary/","text":"\u8865\u5145 \u7c7b\u578b\u8f6c\u6362 reinterpret_cast \u2003\u53ef\u4ee5\u63d0\u4f9b\u4e24\u4e2a\u5b8c\u5168\u65e0\u5173\u7c7b\u578b\u7684\u6307\u9488/\u5f15\u7528\u4e4b\u95f4\u6216\u6307\u9488\u548c\u6574\u6570\u8fdb\u884c\u4e92\u8f6c\uff0c\u6bd4\u5982\u5c06char*\u8f6c\u6362\u4e3adouble*\u3002\u5b83\u5bf9\u539f\u59cb\u5bf9\u8c61\u7684\u4f4d\u6a21\u5f0f\u63d0\u4f9b\u8f83\u4f4e\u5c42\u6b21\u4e0a\u7684\u91cd\u65b0\u89e3\u91ca\uff08\u5373reinterpret\uff09\uff0c\u5b8c\u5168\u590d\u5236\u4e8c\u8fdb\u5236\u6bd4\u7279\u4f4d\u5230\u76ee\u6807\u5bf9\u8c61\uff0c\u8f6c\u6362\u540e\u7684\u503c\u4e0e\u539f\u59cb\u5bf9\u8c61\u65e0\u5173\u4f46\u6bd4\u7279\u4f4d\u4e00\u81f4\uff0c\u524d\u540e\u65e0\u7cbe\u5ea6\u635f\u5931\u3002(\u6ce8\u610freinterpre\u5bf9\u4e24\u79cd\u975e\u6307\u9488/\u5f15\u7528\u7c7b\u578b\u662f\u4e0d\u80fd\u4e92\u8f6c\u7684\uff0c\u7c7b\u4f3cint\u548cdouble) int* i; char *p = new char('c'); i = reinterpret_cast<int*> (p); cout<<i<<endl; //0x3f43d0 cout<<p<<endl; //0x3f4sd0 \u2003\u7528\u5904: \u6bd4\u5982\u5f00\u8f9f\u4e86\u7cfb\u7edf\u5168\u5c40\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u9700\u8981\u5728\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u4f20\u9012\u8fd9\u4e2a\u7a7a\u95f4\u7684\u6307\u9488\u65f6\uff0c\u5c31\u53ef\u4ee5\u5c06\u6307\u9488\u8f6c\u6362\u6210\u6574\u6570\u503c\uff0c\u5f97\u5230\u4ee5\u540e\u518d\u5c06\u503c\u8f6c\u6210\u6307\u9488\u8fdb\u884c\u5bf9\u5e94\u7684\u64cd\u4f5c\u3002 static_cast: \u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\uff0c\u53ef\u4ee5\u5c06expression\u8f6c\u6362\u4e3a\u67d0\u79cd\u5408\u7406\u7c7b\u578b\uff0c\u4f46\u6ca1\u6709\u8fd0\u884c\u65f6\u7c7b\u578b\u68c0\u67e5\u6765\u4fdd\u8bc1\u8f6c\u6362\u7684\u5b89\u5168\u6027\u3002 \u2003\u8fdb\u884c\u4e0a\u884c\u8f6c\u6362\uff08\u628a\u6d3e\u751f\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u8f6c\u6362\u6210\u57fa\u7c7b\u8868\u793a\uff09\u662f\u5b89\u5168\u7684; \u2003\u8fdb\u884c\u4e0b\u884c\u8f6c\u6362\uff08\u628a\u57fa\u7c7b\u6307\u9488\u6216\u5f15\u7528\u8f6c\u6362\u6210\u6d3e\u751f\u7c7b\u8868\u793a\uff09\u65f6\uff0c\u7531\u4e8e\u6ca1\u6709\u52a8\u6001\u7c7b\u578b\u68c0\u67e5\uff0c\u6240\u4ee5\u662f\u4e0d\u5b89\u5168\u7684; \u2003\u7528\u4e8e\u57fa\u672c\u6570\u636e\u7c7b\u578b\u4e4b\u95f4\u7684\u8f6c\u6362\uff0c\u5982\u628aint\u8f6c\u6362\u6210char\uff0c\u628aint\u8f6c\u6362\u6210enum; \u2003\u628a\u7a7a\u6307\u9488\u8f6c\u6362\u6210\u76ee\u6807\u7c7b\u578b\u7684\u7a7a\u6307\u9488; \u2003\u628a\u4efb\u4f55\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\u8f6c\u6362\u6210void\u7c7b\u578b\u3002 \u2003static_cast\u4e0d\u80fd\u8f6c\u6362\u6389expression\u7684const\u3001volatile\u3001\u6216\u8005__unaligned\u5c5e\u6027\u3002 const_cast: \u4ec5\u7528\u4e8e\u8fdb\u884c\u53bb\u9664 const \u5c5e\u6027\u7684\u8f6c\u6362\uff0c\u5b83\u4e5f\u662f\u56db\u4e2a\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u8fd0\u7b97\u7b26\u4e2d\u552f\u4e00\u80fd\u591f\u53bb\u9664 const \u5c5e\u6027\u7684\u8fd0\u7b97\u7b26\u3002 dynamic_cast: dynamic_cast< type* >(e); dynamic_cast< type& > (e); dynamic< type&& >(e); \u2003\u7b2c\u4e00\u79cd\u5f62\u5f0f\uff0ce\u5fc5\u987b\u662f\u4e00\u4e2a\u6709\u6548\u6307\u9488\uff1b\u7b2c\u4e8c\u79cd\u5f62\u5f0f\uff0ce\u5fc5\u987b\u662f\u4e00\u4e2a\u5de6\u503c\uff1b\u7b2c\u4e09\u79cd\u5f62\u5f0f\uff0ce\u5fc5\u987b\u662f\u53f3\u503c\uff1b \u2003e\u662f\u76ee\u6807type\u7684\u516c\u6709\u6d3e\u751f\u7c7b\u6216\u8005\u516c\u6709\u57fa\u7c7b\uff0c\u6216\u8005\u5c31\u662ftype\u7c7b\u578b\uff0c\u5982\u679c\u7b26\u5408\u6761\u4ef6\uff0c\u4e14\u8f6c\u6362\u5b89\u5168\uff0c\u5219\u8f6c\u6362\u6210\u529f\uff1b \u2003\u82e5\u8f6c\u6362\u76ee\u6807\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u8f6c\u6362\u5931\u8d25\u65f6\uff0c\u4f1a\u8fd4\u56deNULL\uff1b\u82e5\u8f6c\u6362\u76ee\u6807\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u5219\u629b\u51fabad_cast\u5f02\u5e38\u3002 \u2003dynamic_cast\u8fd0\u7b97\u7b26\u53ef\u4ee5\u5728\u8fd0\u884c\u671f\u51b3\u5b9a\u771f\u6b63\u7684\u7c7b\u578b\u3002\u5982\u679c downcast \u662f\u5b89\u5168\u7684\uff08\u4e5f\u5c31\u8bf4\uff0c\u5982\u679c\u57fa\u7c7b\u6307\u9488\u6216\u8005\u5f15\u7528\u786e\u5b9e\u6307\u5411\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff09\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u4f1a\u4f20\u56de\u9002\u5f53\u8f6c\u578b\u8fc7\u7684\u6307\u9488\u3002\u5982\u679c downcast \u4e0d\u5b89\u5168\uff0c\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u4f1a\u4f20\u56de\u7a7a\u6307\u9488\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u57fa\u7c7b\u6307\u9488\u6216\u8005\u5f15\u7528\u6ca1\u6709\u6307\u5411\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff09\u3002 RTTI \u2003\u8fd0\u884c\u65f6\u7c7b\u578b\u8bc6\u522b\uff08Run-time type identification, RTTI\uff09\u7684\u529f\u80fd\u7531\u4e24\u4e2a\u8fd0\u7b97\u7b26\u5b9e\u73b0\uff1a typeid \u2003\u8fd4\u56de\u8868\u8fbe\u5f0f\u7684\u7c7b\u578b, typeid(e)\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8be5\u5bf9\u8c61\u7684\u7c7b\u578b\u662f\u6807\u51c6\u5e93\u7c7b\u578btype_info\u6216\u8005type_info\u7684\u516c\u6709\u6d3e\u751f\u7c7b\u578b\u3002typeid(e).name()\u5c06\u7c7b\u578b\u540d\u8f6c\u6362\u4e3astring. \u2003\u5f53\u8fd0\u7b97\u5bf9\u8c61\u4e0d\u662f\u7c7b\u7c7b\u578b\u6216\u8005\u662f\u4e00\u4e2a\u4e0d\u5305\u542b\u4efb\u4f55\u865a\u51fd\u6570\u7684\u7c7b\u65f6\uff0ctypeid\u8fd0\u7b97\u7b26\u6307\u793a\u7684\u662f\u8fd0\u7b97\u5bf9\u8c61\u7684\u9759\u6001\u7c7b\u578b\uff1b\u800c\u8fd0\u7b97\u5bf9\u8c61\u662f\u5b9a\u4e49\u4e86\u81f3\u5c11\u4e00\u4e2a\u865a\u51fd\u6570\u7684\u7c7b\u7684\u5de6\u503c\u65f6\uff0ctypeid\u7684\u7ed3\u679c\u76f4\u5230\u8fd0\u884c\u65f6\u624d\u4f1a\u77e5\u9053\u3002 \u2003typeid\u4f5c\u7528\u4e8e\u51fd\u6570\u6216\u8005\u6570\u7ec4\u65f6\uff0c\u4e0d\u4f1a\u6267\u884c\u5411\u6307\u9488\u7684\u6807\u51c6\u7c7b\u578b\u8f6c\u6362; \u5f53typeid\u4f5c\u7528\u4e8e\u6307\u9488\u65f6\uff0c\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u8be5\u6307\u9488\u7684\u9759\u6001\u7f16\u8bd1\u7c7b\u578b\u3002(\u6307\u9488\u5e76\u975e\u662f\u4e00\u4e2a\u7c7b\u7c7b\u578b\u5bf9\u8c61) dynamic_cast \u2003\u7528\u4e8e\u5c06\u57fa\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u5b89\u5168\u5730\u8f6c\u6362\u6210\u6d3e\u751f\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u3002 \u5f53\u6211\u4eec\u5c06\u8fd9\u4e24\u4e2a\u8fd0\u7b97\u7b26\u7528\u4e8e\u67d0\u79cd\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff0c\u5e76\u4e14\u8be5\u7c7b\u578b\u542b\u6709\u865a\u51fd\u6570\uff0c\u8fd0\u7b97\u7b26\u5c06\u4f7f\u7528\u6307\u9488\u6216\u5f15\u7528\u7ed1\u5b9a\u7684\u5bf9\u8c61\u7684\u52a8\u6001\u7c7b\u578b\u3002 type_info\uff1a\u5176\u62f7\u8d1d\u548c\u79fb\u52a8\u6784\u9020\u51fd\u6570\u4ee5\u53ca\u8d4b\u503c\u8fd0\u7b97\u7b26\u90fd\u88ab\u5b9a\u4e49\u6210\u5220\u9664\u7684\uff0c\u521b\u5efatype_info\u5bf9\u8c61\u7684\u552f\u4e00\u9014\u5f84\u662f\u4f7f\u7528typeid\u8fd0\u7b97\u7b26\u3002 IO\u6d41 IO\u5bf9\u8c61\u65e0\u62f7\u8d1d\u6216\u8d4b\u503c\uff0c\u901a\u5e38\u4ee5\u5f15\u7528\u65b9\u5f0f\u4f20\u9012\u548c\u8fd4\u56de\u6d41\u3002 _istream >> word; getline(_istream, line); \u7b2c\u4e00\u4e2astring\u4f1a\u5b58\u5230word; \u5269\u4f59\u7684\u5185\u5bb9\u4f1a\u5b58\u5230line\uff0c \u5305\u542b\u7a7a\u683c\u3002 ostringstream \u2003\u4f7f\u7528\u524d\u5148\u5305\u542b\u6807\u51c6\u5934\u6587\u4ef6sstream, \u5176\u63d0\u4f9b\"\u5185\u5b58\u5185\u7684\u7684\u8f93\u51fa\u64cd\u4f5c\"\uff0c\u8f93\u51fa\u5230\u4e00\u4e2astring\u5bf9\u8c61\u4e0a\uff0c\u5f53\u6211\u4eec\u9700\u8981\u5c06\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u683c\u5f0f\u5316\u4e3a\u5b57\u7b26\u4e32\u683c\u5f0f\u65f6\uff0c\u5b83\u53ef\u4ee5\u5c06int\u3001float\u7b49\u7c7b\u578b\u7684\u6570\u503c\u81ea\u52a8\u8f6c\u5316\u4e3a\u76f8\u5e94\u7684string\u683c\u5f0f\uff0c\u800c\u4e0d\u5fc5\u8003\u8651\u5b58\u50a8\u7a7a\u95f4\u3001\u8f6c\u6362\u7b97\u6cd5\u7b49\u95ee\u9898\u3002\u5f53\u5b58\u5728\u672a\u77e5\u6570\u636e\u5927\u5c0f\u7684\u65f6\u5019,\u53ef\u4ee5\u4f7f\u7528 ostringstream \u6765\u4ee3\u66ff sprintf , \u907f\u514d\u603b\u662f\u7533\u8bf7\u5927\u91cf\u7684\u7f13\u51b2\u533a\uff0c ostringstream\u63d0\u4f9b\u7684\u7684\u4e00\u4e2amember function str()\uff0c\u4f1a\u8fd4\u56de\"\u4e0eostringstream\u5bf9\u8c61\u76f8\u547c\u5e94\"\u7684string\u5bf9\u8c61\u3002 eg\uff1a ostringstream oss; string str; oss << \u201chello\u201d<<1; str = oss.str(); //\u8403\u53d6\u51fastring\u5bf9\u8c61 auto \u2003\u7531\u7f16\u8bd1\u5668\u901a\u8fc7\u521d\u59cb\u503c\u6765\u63a8\u7b97\u53d8\u91cf\u7684\u7c7b\u578b\uff0c \u663e\u7136auto\u5b9a\u4e49\u7684\u53d8\u91cf\u5fc5\u987b\u6709\u521d\u59cb\u503c \u3002\u4f7f\u7528auto\u5728\u4e00\u6761\u8bed\u53e5\u4e2d\u540c\u65f6\u58f0\u660e\u591a\u4e2a\u53d8\u91cf\u65f6\uff0c\u6240\u6709\u53d8\u91cf\u7684\u521d\u59cb\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u4e00\u81f4\u3002 \u2003 Using auto is especially useful where the type is a pretty long or complicated expression, such as lambda. \u2003\u7f16\u8bd1\u5668\u63a8\u65ad\u51fa\u7684auto\u7c7b\u578b\u548c\u521d\u59cb\u503c\u7c7b\u578b\u4e0d\u4e00\u5b9a\u5b8c\u5168\u4e00\u81f4: int i=0, &r=i; auto a=r; //a\u7c7b\u578b\u662fint\uff0c\u800c\u975e\u5f15\u7528\uff0c\u56e0\u4e3ar\u5373\u53ea\u662fi\u7684\u4e00\u4e2a\u522b\u540d, \u5176\u6b21\uff0cauto\u4e00\u822c\u4f1a\u5ffd\u7565\u6389\u9876\u5c42const, \u800c\u5e95\u5c42const\u4f1a\u88ab\u4fdd\u7559\u3002 const int ci = i, &cr=ci; auto b = ci; // b\u662f\u4e00\u4e2a\u6574\u6570 auto d = &i; //d\u662f\u4e00\u4e2a\u6574\u6570\u6307\u9488 auto e = &ci; //e\u662f\u4e00\u4e2a\u6307\u5411\u6574\u6570\u5e38\u91cf\u7684\u6307\u9488\u3002 // \u82e5\u8bbe\u7f6e\u4e00\u4e2a\u7c7b\u578b\u4e3aauto\u7684\u5f15\u7528\u65f6\uff0c\u5219\u9876\u5c42const\u5c5e\u6027\u4f1a\u88ab\u4fdd\u7559\uff0c auto &g = ci; //g\u662f\u4e00\u4e2a\u6574\u578b\u5e38\u91cf\u5f15\u7528\u3002 auto *p = &ci; //p\u662f\u4e00\u4e2a\u6307\u5411\u6574\u578b\u5e38\u91cf\u7684\u6307\u9488 decltype \u2003find out the type of expression decltype(fun()) a; //\u4ee5\u51fd\u6570fun\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u4f5c\u4e3aa\u7684\u6570\u636e\u7c7b\u578b // decltype\u5728\u5904\u7406\u9876\u5c42const\u65f6\uff0c\u4e0eauto\u4e0d\u540c\uff0c\u4f1a\u4fdd\u7559\u9876\u5c42const\u5c5e\u6027\u548c\u5f15\u7528\u3002 const int ci =0, &cj = ci; decltype(ci) x = 0; // x\u7c7b\u578b\u4e3aconst int; delctype(cj) y = x; // y\u7c7b\u578b\u4e3aconst int &; \u2003decltype\u5bf9\u4e8e\u89e3\u5f15\u7528\u64cd\u4f5c\u5f97\u5230\u7684\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u5373decltype(*p)\u7684\u7ed3\u679c\u7c7b\u578b\u662f type&. \u5bf9\u4e8edecltype\u6240\u7528\u7684\u8868\u8fbe\u5f0f\u6765\u8bf4\uff0c\u5982\u679c\u53d8\u91cf\u540d\u5916\u52a0\u4e0a\u4e00\u5bf9\u62ec\u53f7\uff0c\u5219\u7c7b\u578b\u4e0e\u4e0d\u52a0\u62ec\u53f7\u4f1a\u6709\u6240\u533a\u522b\u3002 delcltype(i)\u7ed3\u679c\u7c7b\u578b\u4e3atype, \u5219decltype((i))\u7ed3\u679c\u7c7b\u578b\u4e3atype&. \u2003auto\u4e0edecltype\u5728\u5904\u7406\u6570\u7ec4\u7c7b\u578b\u65f6\u4e5f\u6709\u533a\u522b int a[] = {1, 2}; decltype(a) b = {1, 2}; //b\u662f\u4e00\u4e2a\u75312\u4e2a\u5143\u7d20\u7ec4\u6210\u7684\u6570\u7ec4\uff0c auto c(a); //c \u662f\u4e00\u4e2a\u6574\u578b\u6307\u9488\uff0c\u6307\u5411\u6570\u7ec4a\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 \u2003 Three applications of decltype, first is to declare return types; second is to use in metaprogramming; third is to pass the type of lambda\u3002 //eg. 3. \u9762\u5bf9lambda\uff0c\u53ea\u6709object\uff0c\u9700\u8981\u901a\u8fc7decltype\u83b7\u5f97\u5176\u7c7b\u578b auto cmp = [](const Persion& p1, const Persion& p2){ return p1.lastname()<p2.lastname || (p1.lastname() == p2.lastname() && p1.firstname()<p2.firstname()); }; std::set<Persion, decltype(cmp)> coll(cmp); //cmp\u4f5c\u4e3a\u6bd4\u8f83\u5668\u4f20\u5165 string \u52a0\u6cd5\u64cd\u4f5c\uff0c\u5fc5\u987b\u786e\u4fdd\u6bcf\u4e2a\u201d+\u201d\u4e24\u4fa7\u7684\u8fd0\u7b97\u5bf9\u8c61\u81f3\u5c11\u4e00\u4e2a\u662fstring\uff0c\u53e6\u4e00\u4e2a\u53ef\u4ee5\u662fstring\u3001\u5b57\u7b26\u5b57\u9762\u503c\u3001\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u3002 \u5173\u4e8e\u6570\u7ec4 \u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012 \u2003\u6709\u4e24\u79cd\u4f20\u9012\u65b9\u6cd5\uff0c\u4e00\u79cd\u662ffunction(int a[]); \u53e6\u4e00\u79cd\u662ffunction(int *a)\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u5728\u51fd\u6570\u4e2d\u5bf9\u6570\u7ec4\u53c2\u6570\u7684\u4fee\u6539\u90fd\u4f1a\u5f71\u54cd\u5230\u5b9e\u53c2\u672c\u8eab\u7684\u503c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u6570\u7ec4\u5f62\u53c2\u524d\u52a0\u4e0aconst\uff0c\u8868\u793a\u6574\u4e2a\u6570\u7ec4\u53ea\u8bfb\u3002 \u2003\u4f20\u9012\u6570\u7ec4\uff0c\u867d\u7136\u4f20\u9012\u7684\u662f\u9996\u5730\u5740\u5730\u5740\uff0c\u4f46\u662f\u53c2\u6570\u5230\u4e86\u51fd\u6570\u5185\u5c31\u6210\u4e86\u666e\u901a\u6307\u9488\uff0c\u4e0d\u518d\u662f\u6570\u7ec4\u9996\u5730\u5740\u4e86\uff0c\u6240\u4ee5\u8bd5\u56fe\u5728\u522b\u7684\u51fd\u6570\u4e2d\u5f97\u5230\u4f20\u9012\u6570\u7ec4\u7684\u957f\u5ea6\u662f\u884c\u4e0d\u901a\u7684\u3002\u53ea\u80fd\u5148\u8ba1\u7b97\u597d\u957f\u5ea6\u540e\u518d\u4f20\u8fc7\u53bb\uff0c\u8fdb\u884c\u5176\u4ed6\u7684\u8fd0\u7b97\u3002 \u8ba1\u7b97 :\u2003 sizeof(array)/sizeof(array[0]) \u2003\u82e5\u4ee5\u6570\u7ec4\u5f15\u7528\u4f5c\u4e3a\u53c2\u6570\uff0c\u5f62\u5f0f\u5982\u4e0b\uff1a void test(int (&array)[16]); //\u5219\u4f20\u9012\u53c2\u6570\u65f6\uff0c\u5927\u5c0f\u4e5f\u662f\u6570\u7ec4\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c\u82e5\u6570\u7ec4\u957f\u5ea6\u4e0d\u7b49\u4e8e16\uff0c\u662f\u65e0\u6cd5\u4f20\u9012\u7684\u3002 \u5b57\u7b26\u6570\u7ec4 \u53ef\u4ee5\u7528\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u5bf9\u6b64\u7c7b\u6570\u7ec4\u521d\u59cb\u5316\uff0c\u4e14\u9700\u8bb0\u4f4f\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u5f97\u7ed3\u5c3e\u5904\u6709\u4e00\u4e2a\u7a7a\u5b57\u7b26\uff0c\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u6dfb\u52a0\uff0c\u56e0\u6b64\u6570\u7ec4\u5927\u5c0f\u5e94\u80fd\u591f\u5305\u542b\u8be5\u7a7a\u5b57\u7b26\u3002 \u6570\u7ec4\u4e0d\u5141\u8bb8\u62f7\u8d1d\u548c\u8d4b\u503c \u5185\u7f6e\u7684\u4e0b\u6807\u8fd0\u7b97\u7b26\u7c7b\u578b\u4e0d\u662f\u65e0\u7b26\u53f7\u7c7b\u578b\uff0c\u800cstring\u3001vector\u7b49\u6807\u51c6\u5e93\u7c7b\u578b\u4f7f\u7528\u7684\u4e0b\u6807\u8fd0\u7b97\u7b26\u7c7b\u578b\u5fc5\u987b\u662f\u65e0\u7b26\u53f7\u7c7b\u578b\u3002 int a[]={1, 2, 3, 4}; int *p = &a[3]; cout << p[-2]; //\u8f93\u51fa2 \u4f7f\u7528\u8303\u56f4for\u8bed\u53e5\u5904\u7406\u591a\u7ef4\u6570\u7ec4\uff0c\u9664\u4e86\u6700\u5185\u5c42\u7684\u5faa\u73af\u5916\uff0c\u5176\u4ed6\u6240\u6709\u5faa\u73af\u7684\u63a7\u5236\u53d8\u91cf\u90fd\u5e94\u8be5\u662f\u5f15\u7528\u7c7b\u578b\u3002 \u6307\u5411\u6570\u7ec4\u7684\u6307\u9488 \u683c\u5f0f: int (*p)[4] = ia; //p\u662f\u4e00\u4e2a\u6307\u5411\u542b\u67094\u4e2a\u6574\u6570\u7684\u6570\u7ec4 sizeof \u2003sizeof \u8fd4\u56de\u4e00\u6761\u8868\u8fbe\u5f0f\u6216\u8005\u4e00\u4e2a\u7c7b\u578b\u540d\u5b57\u6240\u5360\u7684\u5b57\u8282\u6570 sizeof (type); sizeof(expr); \u2003 sizeof(Class_name)\u5f97\u5230\u7684\u662f\u6240\u6709\u975e\u9759\u6001\u6210\u5458\u5927\u5c0f\u4e4b\u548c\uff0c\u5982\u679c\u8be5\u7c7b\u5305\u542b\u865a\u51fd\u6570\uff0c\u8fd8\u9700\u52a0\u4e0a4\u4e2a\u5b57\u8282(32\u4f4d\u673a\u5668)\u7684\u865a\u6307\u9488\u5927\u5c0f\uff1b \u5bf9\u4e8e\u7a7a\u7c7b(\u4e0d\u542b\u4efb\u4f55\u6570\u636e\u6210\u5458\u6216\u8005\u865a\u51fd\u6570)\uff0csizeof\u8fd4\u56de\u7684\u7ed3\u679c\u4e3a1\uff0cC++\u6807\u51c6\u89c4\u5b9a\u4e0d\u540c\u7684\u5bf9\u8c61\u4e0d\u80fd\u62e5\u6709\u76f8\u540c\u7684\u5730\u5740\uff0c\u6240\u6709\u5373\u4f7f\u662f\u7a7a\u7c7b\u5728\u5b9e\u4f8b\u5316\u65f6\u4e5f\u9700\u8981\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684\u5730\u5740\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u4f1a\u4e3a\u7a7a\u7c7b\u6dfb\u52a0\u4e00\u4e2a\u9690\u542b\u7684\u5b57\u8282 \u2003sizeof\u5e76\u4e0d\u5b9e\u9645\u8ba1\u7b97\u5176\u8fd0\u7b97\u5bf9\u8c61\u7684\u503c\uff0c\u56e0\u6b64\u5728sizeof\u7684\u8fd0\u7b97\u5bf9\u8c61\u4e2d\u89e3\u5f15\u7528\u4e00\u4e2a\u65e0\u6548\u6307\u9488\u4ecd\u662f\u4e00\u79cd\u5b89\u5168\u7684\u884c\u4e3a\uff0c\u56e0\u4e3a\u6307\u9488\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u88ab\u8c03\u7528\uff1b\u6216\u8005\u4f7f\u7528\u4f5c\u7528\u57df\u8fd0\u7b97\u7b26\u6765\u83b7\u53d6\u975e\u79c1\u6709\u7c7b\u6210\u5458\u7684\u5927\u5c0f\uff0c\u56e0\u4e3a\u65e0\u9700\u63d0\u4f9b\u4e00\u4e2a\u5177\u4f53\u7684\u5bf9\u8c61\u3002 sizeof(*p); sizeof(Class::private_data); \u2003\u5bf9char\u6216\u8005\u7c7b\u578b\u4e3achar\u7684\u8868\u8fbe\u5f0f\u6267\u884csizeof\uff0c\u7ed3\u679c\u4e3a1\uff1b \u5bf9\u5f15\u7528\u7c7b\u578b\u6267\u884csizeof\u8fd0\u7b97\u5f97\u5230\u88ab\u5f15\u7528\u5bf9\u8c61\u6240\u5360\u7a7a\u95f4\u7684\u5927\u5c0f\uff1b \u5bf9\u6307\u9488\u7c7b\u578b\u5219\u662f\u5f97\u5230\u6307\u9488\u672c\u8eab\u6240\u5360\u7a7a\u95f4\u7684\u5927\u5c0f\uff1b \u5bf9\u89e3\u5f15\u7528\u6307\u9488\u5219\u662f\u5f97\u5230\u6307\u9488\u6240\u6307\u5bf9\u8c61\u6240\u5360\u7a7a\u95f4\u7684\u5927\u5c0f\uff1b return \u2003\u4e0d\u8981\u8fd4\u56de\u5c40\u90e8\u5bf9\u8c61\u7684\u5f15\u7528\u548c\u6307\u9488\uff0c\u56e0\u4e3a\u51fd\u6570\u5b8c\u6210\u540e\uff0c\u5b83\u6240\u5360\u7528\u7684\u5b58\u50a8\u7a7a\u95f4\u4e5f\u968f\u4e4b\u88ab\u91ca\u653e\u6389\uff0c\u56e0\u6b64\u5c40\u90e8\u53d8\u91cf\u7684\u5f15\u7528\u6216\u6307\u9488\u5c06\u6307\u5411\u4e0d\u518d\u6709\u6548\u7684\u5185\u5b58\u533a\u57df\u3002 \u2003\u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u51b3\u5b9a\u51fd\u6570\u8c03\u7528\u662f\u5426\u662f\u5de6\u503c\uff0c\u8c03\u7528\u4e00\u4e2a\u8fd4\u56de\u5f15\u7528\u7684\u51fd\u6570\u5f97\u5230\u5de6\u503c\uff0c\u5176\u4ed6\u8fd4\u56de\u7c7b\u578b\u5f97\u5230\u53f3\u503c\uff0c\u56e0\u6b64\u53ef\u4ee5\u4e3a\u8fd4\u56de\u7c7b\u578b\u662f\u975e\u5e38\u91cf\u5f15\u7528\u7684\u51fd\u6570\u7684\u7ed3\u679c\u8d4b\u503c\u3002 \u2003\u58f0\u660e\u4e00\u4e2a\u8fd4\u56de\u6570\u7ec4\u6307\u9488\u7684\u51fd\u6570: \u2003 type (*func(param_list))[dimension]; //\u4f7f\u7528\u5c3e\u7f6e\u8fd4\u56de\u7c7b\u578b, \u8fd9\u91cc\u7684auto\u662f\u4e3a\u4e86\u8868\u793a\u51fd\u6570\u771f\u6b63\u7684\u8fd4\u56de\u7c7b\u578b\u8ddf\u5728\u5f62\u53c2\u5217\u8868\u4e4b\u540e auto func(param_list) -> int( * )[dimension]; volatile \u2003volatile \u5173\u952e\u5b57\u662f\u4e00\u79cd\u7c7b\u578b\u4fee\u9970\u7b26 \u2003volatile \u5173\u952e\u5b57\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u6bcf\u6b21\u8bbf\u95ee\u65f6\u90fd\u5fc5\u987b\u4ece\u5185\u5b58\u4e2d\u53d6\u51fa\u503c\uff08\u6ca1\u6709\u88ab volatile \u4fee\u9970\u7684\u53d8\u91cf\uff0c\u53ef\u80fd\u7531\u4e8e\u7f16\u8bd1\u5668\u7684\u4f18\u5316\uff0c\u4ece CPU \u5bc4\u5b58\u5668\u4e2d\u53d6\u503c\uff0c\u800c\u5b9e\u9645\u7684\u53d8\u91cf\u7531\u4e8e\u67d0\u4e9b\u7f16\u8bd1\u5668\u672a\u77e5\u7684\u56e0\u7d20\uff08\u64cd\u4f5c\u7cfb\u7edf\u3001\u786c\u4ef6\u3001\u5176\u5b83\u7ebf\u7a0b\u7b49\uff09\u53d1\u9001\u66f4\u6539\uff0c \u56e0\u6b64\u4f7f\u7528 volatile \u544a\u8bc9\u7f16\u8bd1\u5668\u4e0d\u5e94\u5bf9\u8fd9\u6837\u7684\u5bf9\u8c61\u8fdb\u884c\u4f18\u5316\u3002 \u2003const \u53ef\u4ee5\u662f volatile \uff08\u5982\u53ea\u8bfb\u7684\u72b6\u6001\u5bc4\u5b58\u5668\uff09; \u6307\u9488\u53ef\u4ee5\u662f volatile. \u94fe\u63a5\u6307\u793a:extern C \u2003 C++\u4f7f\u7528\u94fe\u63a5\u6307\u793a\u6307\u51fa\u4efb\u610f\u975eC++\u51fd\u6570\u4f7f\u7528\u7684\u8bed\u8a00 //\u5355\u8bed\u53e5\u94fe\u63a5\u6307\u793a\uff0c extern \"C\" size_t strlen(const char*); //\u590d\u5408\u8bed\u53e5\u94fe\u63a5\u6307\u793a extern \"C\"{ #include <string.h> //\u6b64\u65f6\u8ba4\u4e3a\u8be5\u5934\u6587\u4ef6\u5305\u542b\u7684\u6240\u6709\u51fd\u6570\u90fd\u662f\u7531C\u8bed\u8a00\u7f16\u5199\u7684 int strcmp(const char*); } //\u6307\u5411C\u51fd\u6570\u7684\u6307\u9488\u4e0e\u6307\u5411C++\u51fd\u6570\u7684\u6307\u9488\u662f\u4e0d\u540c\u7684 extern \"C\" void(*pf)(int); //\u4f7f\u7528pf\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u8ba4\u4e3a\u8c03\u7528\u7684\u662f\u4e00\u4e2aC\u51fd\u6570\uff0c\u4e14\u4e0d\u80fd\u7528\u6765\u6307\u5411\u4e00\u4e2aC++\u51fd\u6570 //\u6307\u5411C++\u51fd\u6570\u7684\u6307\u9488\u548c\u6307\u5411C\u51fd\u6570\u7684\u6307\u9488\u4e0d\u80fd\u4e92\u76f8\u8f6c\u6362 //\u94fe\u63a5\u6307\u793a\u5bf9\u6574\u4e2a\u58f0\u660e\u6709\u6548 // f1\u662f\u4e00\u4e2aC\u51fd\u6570\uff0c\u63a5\u6536\u4e00\u4e2a\u51fd\u6570\u6307\u9488\u53c2\u6570\uff0c\u4e14\u8be5\u51fd\u6570\u6307\u9488\u6307\u5411\u7684\u5fc5\u987b\u662f\u4e00\u4e2aC\u51fd\u6570 extern \"C\" void fun(void(*)(int)); \u2003C\u8bed\u8a00\u4e0d\u652f\u6301\u51fd\u6570\u91cd\u8f7d\uff0c\u56e0\u6b64\u4e00\u4e2aC\u94fe\u63a5\u6307\u793a\u53ea\u80fd\u7528\u6765\u8bf4\u660e\u91cd\u8f7d\u51fd\u6570\u4e2d\u7684\u67d0\u4e00\u4e2a\u3002 \u5b57\u8282\u5bf9\u9f50 1) \u6570\u636e\u7c7b\u578b\u81ea\u8eab\u7684\u5bf9\u9f50\u503c\uff1achar\u578b\u6570\u636e\u81ea\u8eab\u5bf9\u9f50\u503c\u4e3a1\u5b57\u8282\uff0cshort\u578b\u6570\u636e\u4e3a2\u5b57\u8282\uff0cint/float\u578b\u4e3a4\u5b57\u8282\uff0cdouble\u578b\u4e3a8\u5b57\u8282\u3002 2) \u7ed3\u6784\u4f53\u6216\u7c7b\u7684\u81ea\u8eab\u5bf9\u9f50\u503c\uff1a\u5176\u6210\u5458\u4e2d\u81ea\u8eab\u5bf9\u9f50\u503c\u6700\u5927\u7684\u90a3\u4e2a\u503c\u3002 3) \u6307\u5b9a\u5bf9\u9f50\u503c\uff1a#pragma pack (value)\u65f6\u7684\u6307\u5b9a\u5bf9\u9f50\u503cvalue\u3002 4) \u6570\u636e\u6210\u5458\u3001\u7ed3\u6784\u4f53\u548c\u7c7b\u7684\u6709\u6548\u5bf9\u9f50\u503c\uff1a\u81ea\u8eab\u5bf9\u9f50\u503c\u548c\u6307\u5b9a\u5bf9\u9f50\u503c\u4e2d\u8f83\u5c0f\u8005\uff0c\u5373\u6709\u6548\u5bf9\u9f50\u503c=min{\u81ea\u8eab\u5bf9\u9f50\u503c\uff0c\u5f53\u524d\u6307\u5b9a\u7684pack\u503c}\u3002 Class A{int i; char c;} sizeof(A) = 4+4=8; Class B{int i; char c; char c2; double d;} sizeof(B) = 8+8=16; Class C{int i; char c; char c2; int i2;} sizeof(C) = 4+4+4=12; // \u4e24\u4e2achar\u5171\u5360\u75282\u4e2a\u5b57\u8282\uff0c\u5bf9\u9f50\u540e\uff0c\u5360\u75284\u4e2a\u5b57\u8282 Class D {int i; char c2; int i2; char c;} sizeof(D)=4+4+4+4=16; \u5b57\u9762\u503c\u7c7b\u578b \u2003\u7528\u6765\u58f0\u660econstexpr\u65f6\u7528\u5230\u7684\u7c7b\u578b\uff1b \u7b97\u672f\u7c7b\u578b\u3001\u5f15\u7528\u3001\u6307\u9488\u548c\u5b57\u9762\u503c\u5e38\u91cf\u7c7b\u90fd\u5c5e\u4e8e\u5b57\u9762\u503c\u7c7b\u578b \uff0c\u81ea\u5b9a\u4e49\u7684\u7c7b\u3001IO\u5e93\u3001string\u7c7b\u578b\u90fd\u4e0d\u5c5e\u4e8e\u5b57\u9762\u503c\u7c7b\u578b\uff0c\u4e5f\u5c31\u4e0d\u80fd\u88ab\u5b9a\u4e49\u4e3aconstexpr\u3002 using using-directives for namespaces and using-declarations for namespace members. using namespace std; using std::string; \u2003\u2003\u5934\u6587\u4ef6\u5982\u679c\u5728\u5176\u9876\u5c42\u4f5c\u7528\u57df\u4e2d\u542b\u6709\u6b64\u7c7b\u8bf4\u660e\uff0c\u5219\u4f1a\u5c06\u76f8\u5e94\u7684\u547d\u540d\u7a7a\u95f4\u6216name\u6ce8\u5165\u5230\u6240\u6709\u5305\u542b\u4e86\u8be5\u5934\u6587\u4ef6\u7684\u6587\u4ef6\u4e2d\u3002 using-declarations for class members \u2003\u5728\u6d3e\u751f\u7c7b\u5185\u90e8\u4f7f\u7528using\u8bf4\u660e\uff0c\u53ef\u4ee5\u5c06\u5176\u76f4\u63a5\u6216\u95f4\u63a5\u57fa\u7c7b\u4e2d\u7684 \u4efb\u4f55\u53ef\u8bbf\u95ee\u6210\u5458 \u6807\u8bb0\u51fa\u6765\uff0c using\u58f0\u660e\u8bed\u53e5\u4e2d\u540d\u5b57\u7684\u8bbf\u95ee\u6743\u9650\u7531\u8be5using\u58f0\u660e\u8bed\u53e5\u524d\u7684\u8bbf\u95ee\u8bf4\u660e\u7b26\u51b3\u5b9a\uff0c\u4e0e\u6d3e\u751f\u8bbf\u95ee\u8bf4\u660e\u7b26\u65e0\u5173\u3002 type alias and alias template declaration // type alias using func = void(*)(int, int); // \u7b49\u4ef7\u4e8e typedef void(*func)(int, int); template<typename T> class C{ using value_type=T; } // alias template template<class CharT> using myString=std::basic_string<Chart, std::char_traits<CharT>> \u547d\u540d\u7a7a\u95f4 namespace(\u547d\u540d\u7a7a\u95f4)\uff1a\u5373\u53ef\u5b9a\u4e49\u5728\u5168\u5c40\u4f5c\u7528\u57df\u5185\uff0c\u4e5f\u53ef\u5b9a\u4e49\u5728\u5176\u4ed6\u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u4f46\u4e0d\u80fd\u5b9a\u4e49\u5728\u51fd\u6570\u6216\u7c7b\u7684\u5185\u90e8\u3002\u547d\u540d\u7a7a\u95f4\u4f5c\u7528\u57df\u540e\u65e0\u987b\u5206\u53f7\u3002 namespace\u7684\u522b\u540d\uff1a namespace primer = cplusplus_primer; primer\u662f\u547d\u540d\u7a7a\u95f4cplusplus_primer\u7684\u522b\u540d\uff0c\u4e24\u8005\u7b49\u4ef7\u3002\u4e14\u53ef\u4ee5\u5b58\u5728\u591a\u4e2a\u522b\u540d\u3002 \u5185\u8054\u547d\u540d\u7a7a\u95f4\uff1ac++11\u65b0\u5f15\u5165\u7684\u4e00\u79cd\u5d4c\u5957\u547d\u540d\u7a7a\u95f4\uff0c\u5185\u8054\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u540d\u5b57\u53ef\u4ee5\u88ab\u5916\u5c42\u547d\u540d\u7a7a\u95f4\u76f4\u63a5\u4f7f\u7528\u3002 \u672a\u547d\u540d\u7684\u547d\u540d\u7a7a\u95f4\uff1a\u4ec5\u5728\u7279\u5b9a\u6587\u4ef6\u5185\u90e8\u6709\u6548\uff0c\u4f5c\u7528\u8303\u56f4\u4e0d\u4f1a\u8de8\u8d8a\u591a\u4e2a\u4e0d\u540c\u6587\u4ef6\uff1b \u5176\u4e2d\u5b9a\u4e49\u7684\u540d\u5b57\u7684\u4f5c\u7528\u57df\u4e0e\u8be5\u547d\u540d\u7a7a\u95f4\u6240\u5728\u7684\u4f5c\u7528\u57df\u76f8\u540c\uff0c\u56e0\u6b64\u672a\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u540d\u5b57\u8981\u4e0e\u5168\u5c40\u4f5c\u7528\u57df\u4e2d\u7684\u540d\u5b57\u6709\u6240\u533a\u522b\u3002 \u91cd\u8f7d\u4e0e\u547d\u540d\u7a7a\u95f4\uff1a\u4e00\u4e2ausing\u8bf4\u660e\u5305\u542b\u4e86\u8be5\u51fd\u6570\u7684\u6240\u6709\u7248\u672c\uff0c\u5e76\u4e14\u4f1a\u91cd\u8f7d\u8be5\u58f0\u660e\u8bed\u53e5\u6240\u5c5e\u4f5c\u7528\u57df\u4e2d\u5df2\u6709\u7684\u5176\u4ed6\u540c\u540d\u51fd\u6570\uff1b\u82e5\u6240\u5c5e\u4f5c\u7528\u57df\u4e2d\u5df2\u7ecf\u6709\u4e00\u4e2a\u51fd\u6570\u4e0e\u65b0\u5f15\u5165\u7684\u51fd\u6570\u540c\u540d\u4e14\u5f62\u53c2\u5217\u8868\u76f8\u540c\uff0c\u5219\u8be5using\u58f0\u660e\u5c06\u5f15\u53d1\u9519\u8bef\u3002 \u5bf9\u4e8eusing\u6307\u793a\u6765\u8bf4\uff0c\u5f15\u5165\u4e00\u4e2a\u4e0e\u5df2\u6709\u51fd\u6570\u5f62\u53c2\u5217\u8868\u5b8c\u5168\u76f8\u540c\u7684\u51fd\u6570\u5e76\u4e0d\u4f1a\u4ea7\u751f\u9519\u8bef\u3002 tips \u5546\u53d6\u6574 \u2003c++11\u6807\u51c6\u89c4\u5b9a\u5546\u4e00\u5f8b\u54110\u53d6\u6574\uff1bm%n\u5982\u679c\u4e0d\u7b49\u4e8e0\uff0c\u5219\u7b26\u53f7\u4e0em\u76f8\u540c\uff0c\u5373\u9664\u4e86-m\u6ea2\u51fa\u7684\u7279\u6b8a\u60c5\u51b5\uff0c\uff08-m\uff09%n \u7b49\u4e8e-\uff08m%n\uff09\uff0cm%(-n)\u7b49\u4e8em%n\u3002 \u4ea4\u6362\u4e24\u4e2aint\u53d8\u91cf a=(b^=a^=b)^a; \u524d\u7f6e/\u540e\u7f6e \u81ea\u589e/\u81ea\u51cf\u8fd0\u7b97\u53ca\u89e3\u5f15\u7528 * iter++ \u7b49\u4ef7\u4e8e *(iter++); //\u540e\u81ea\u589e\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u9ad8\u4e8e\u89e3\u5f15\u7528\u7b26\uff0c\u4f46\u7531\u4e8e\u540e\u7f6e\u8fd0\u7b97\u7b26\u8fd4\u56de\u7684iter\u539f\u503c\u7684\u526f\u672c\uff0c\u56e0\u6b64 auto a = iter++; auto b = iter , \u5176\u4e2da==b\uff0c\u4f46\u524d\u8005\u6b64\u65f6iter\u5df2\u7ecf\u6307\u5411\u4e0b\u4e00\u4f4d\u5143\u7d20\u3002 \u800c\u524d\u7f6e\u8fd0\u7b97\u7b26\u5219\u8fd4\u56de\u7684\u662f\u6539\u53d8\u540e\u7684iter. object based: \u9762\u5bf9\u7684\u662f\u5355\u4e00\u7684class\u7684\u8bbe\u8ba1; object oriented: \u9762\u5bf9\u7684\u662f\u591a\u91cdclass\u4e4b\u95f4\u7684\u8bbe\u8ba1, classes \u548c classes\u4e4b\u95f4\u7684\u5173\u7cfb\u3002","title":"complementary"},{"location":"c_base/Complementary/#_1","text":"","title":"\u8865\u5145"},{"location":"c_base/Complementary/#_2","text":"reinterpret_cast \u2003\u53ef\u4ee5\u63d0\u4f9b\u4e24\u4e2a\u5b8c\u5168\u65e0\u5173\u7c7b\u578b\u7684\u6307\u9488/\u5f15\u7528\u4e4b\u95f4\u6216\u6307\u9488\u548c\u6574\u6570\u8fdb\u884c\u4e92\u8f6c\uff0c\u6bd4\u5982\u5c06char*\u8f6c\u6362\u4e3adouble*\u3002\u5b83\u5bf9\u539f\u59cb\u5bf9\u8c61\u7684\u4f4d\u6a21\u5f0f\u63d0\u4f9b\u8f83\u4f4e\u5c42\u6b21\u4e0a\u7684\u91cd\u65b0\u89e3\u91ca\uff08\u5373reinterpret\uff09\uff0c\u5b8c\u5168\u590d\u5236\u4e8c\u8fdb\u5236\u6bd4\u7279\u4f4d\u5230\u76ee\u6807\u5bf9\u8c61\uff0c\u8f6c\u6362\u540e\u7684\u503c\u4e0e\u539f\u59cb\u5bf9\u8c61\u65e0\u5173\u4f46\u6bd4\u7279\u4f4d\u4e00\u81f4\uff0c\u524d\u540e\u65e0\u7cbe\u5ea6\u635f\u5931\u3002(\u6ce8\u610freinterpre\u5bf9\u4e24\u79cd\u975e\u6307\u9488/\u5f15\u7528\u7c7b\u578b\u662f\u4e0d\u80fd\u4e92\u8f6c\u7684\uff0c\u7c7b\u4f3cint\u548cdouble) int* i; char *p = new char('c'); i = reinterpret_cast<int*> (p); cout<<i<<endl; //0x3f43d0 cout<<p<<endl; //0x3f4sd0 \u2003\u7528\u5904: \u6bd4\u5982\u5f00\u8f9f\u4e86\u7cfb\u7edf\u5168\u5c40\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u9700\u8981\u5728\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u4f20\u9012\u8fd9\u4e2a\u7a7a\u95f4\u7684\u6307\u9488\u65f6\uff0c\u5c31\u53ef\u4ee5\u5c06\u6307\u9488\u8f6c\u6362\u6210\u6574\u6570\u503c\uff0c\u5f97\u5230\u4ee5\u540e\u518d\u5c06\u503c\u8f6c\u6210\u6307\u9488\u8fdb\u884c\u5bf9\u5e94\u7684\u64cd\u4f5c\u3002 static_cast: \u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\uff0c\u53ef\u4ee5\u5c06expression\u8f6c\u6362\u4e3a\u67d0\u79cd\u5408\u7406\u7c7b\u578b\uff0c\u4f46\u6ca1\u6709\u8fd0\u884c\u65f6\u7c7b\u578b\u68c0\u67e5\u6765\u4fdd\u8bc1\u8f6c\u6362\u7684\u5b89\u5168\u6027\u3002 \u2003\u8fdb\u884c\u4e0a\u884c\u8f6c\u6362\uff08\u628a\u6d3e\u751f\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u8f6c\u6362\u6210\u57fa\u7c7b\u8868\u793a\uff09\u662f\u5b89\u5168\u7684; \u2003\u8fdb\u884c\u4e0b\u884c\u8f6c\u6362\uff08\u628a\u57fa\u7c7b\u6307\u9488\u6216\u5f15\u7528\u8f6c\u6362\u6210\u6d3e\u751f\u7c7b\u8868\u793a\uff09\u65f6\uff0c\u7531\u4e8e\u6ca1\u6709\u52a8\u6001\u7c7b\u578b\u68c0\u67e5\uff0c\u6240\u4ee5\u662f\u4e0d\u5b89\u5168\u7684; \u2003\u7528\u4e8e\u57fa\u672c\u6570\u636e\u7c7b\u578b\u4e4b\u95f4\u7684\u8f6c\u6362\uff0c\u5982\u628aint\u8f6c\u6362\u6210char\uff0c\u628aint\u8f6c\u6362\u6210enum; \u2003\u628a\u7a7a\u6307\u9488\u8f6c\u6362\u6210\u76ee\u6807\u7c7b\u578b\u7684\u7a7a\u6307\u9488; \u2003\u628a\u4efb\u4f55\u7c7b\u578b\u7684\u8868\u8fbe\u5f0f\u8f6c\u6362\u6210void\u7c7b\u578b\u3002 \u2003static_cast\u4e0d\u80fd\u8f6c\u6362\u6389expression\u7684const\u3001volatile\u3001\u6216\u8005__unaligned\u5c5e\u6027\u3002 const_cast: \u4ec5\u7528\u4e8e\u8fdb\u884c\u53bb\u9664 const \u5c5e\u6027\u7684\u8f6c\u6362\uff0c\u5b83\u4e5f\u662f\u56db\u4e2a\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u8fd0\u7b97\u7b26\u4e2d\u552f\u4e00\u80fd\u591f\u53bb\u9664 const \u5c5e\u6027\u7684\u8fd0\u7b97\u7b26\u3002 dynamic_cast: dynamic_cast< type* >(e); dynamic_cast< type& > (e); dynamic< type&& >(e); \u2003\u7b2c\u4e00\u79cd\u5f62\u5f0f\uff0ce\u5fc5\u987b\u662f\u4e00\u4e2a\u6709\u6548\u6307\u9488\uff1b\u7b2c\u4e8c\u79cd\u5f62\u5f0f\uff0ce\u5fc5\u987b\u662f\u4e00\u4e2a\u5de6\u503c\uff1b\u7b2c\u4e09\u79cd\u5f62\u5f0f\uff0ce\u5fc5\u987b\u662f\u53f3\u503c\uff1b \u2003e\u662f\u76ee\u6807type\u7684\u516c\u6709\u6d3e\u751f\u7c7b\u6216\u8005\u516c\u6709\u57fa\u7c7b\uff0c\u6216\u8005\u5c31\u662ftype\u7c7b\u578b\uff0c\u5982\u679c\u7b26\u5408\u6761\u4ef6\uff0c\u4e14\u8f6c\u6362\u5b89\u5168\uff0c\u5219\u8f6c\u6362\u6210\u529f\uff1b \u2003\u82e5\u8f6c\u6362\u76ee\u6807\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u8f6c\u6362\u5931\u8d25\u65f6\uff0c\u4f1a\u8fd4\u56deNULL\uff1b\u82e5\u8f6c\u6362\u76ee\u6807\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u5219\u629b\u51fabad_cast\u5f02\u5e38\u3002 \u2003dynamic_cast\u8fd0\u7b97\u7b26\u53ef\u4ee5\u5728\u8fd0\u884c\u671f\u51b3\u5b9a\u771f\u6b63\u7684\u7c7b\u578b\u3002\u5982\u679c downcast \u662f\u5b89\u5168\u7684\uff08\u4e5f\u5c31\u8bf4\uff0c\u5982\u679c\u57fa\u7c7b\u6307\u9488\u6216\u8005\u5f15\u7528\u786e\u5b9e\u6307\u5411\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff09\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u4f1a\u4f20\u56de\u9002\u5f53\u8f6c\u578b\u8fc7\u7684\u6307\u9488\u3002\u5982\u679c downcast \u4e0d\u5b89\u5168\uff0c\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u4f1a\u4f20\u56de\u7a7a\u6307\u9488\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u57fa\u7c7b\u6307\u9488\u6216\u8005\u5f15\u7528\u6ca1\u6709\u6307\u5411\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff09\u3002","title":"\u7c7b\u578b\u8f6c\u6362"},{"location":"c_base/Complementary/#rtti","text":"\u8fd0\u884c\u65f6\u7c7b\u578b\u8bc6\u522b\uff08Run-time type identification, RTTI\uff09\u7684\u529f\u80fd\u7531\u4e24\u4e2a\u8fd0\u7b97\u7b26\u5b9e\u73b0\uff1a typeid \u2003\u8fd4\u56de\u8868\u8fbe\u5f0f\u7684\u7c7b\u578b, typeid(e)\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8be5\u5bf9\u8c61\u7684\u7c7b\u578b\u662f\u6807\u51c6\u5e93\u7c7b\u578btype_info\u6216\u8005type_info\u7684\u516c\u6709\u6d3e\u751f\u7c7b\u578b\u3002typeid(e).name()\u5c06\u7c7b\u578b\u540d\u8f6c\u6362\u4e3astring. \u2003\u5f53\u8fd0\u7b97\u5bf9\u8c61\u4e0d\u662f\u7c7b\u7c7b\u578b\u6216\u8005\u662f\u4e00\u4e2a\u4e0d\u5305\u542b\u4efb\u4f55\u865a\u51fd\u6570\u7684\u7c7b\u65f6\uff0ctypeid\u8fd0\u7b97\u7b26\u6307\u793a\u7684\u662f\u8fd0\u7b97\u5bf9\u8c61\u7684\u9759\u6001\u7c7b\u578b\uff1b\u800c\u8fd0\u7b97\u5bf9\u8c61\u662f\u5b9a\u4e49\u4e86\u81f3\u5c11\u4e00\u4e2a\u865a\u51fd\u6570\u7684\u7c7b\u7684\u5de6\u503c\u65f6\uff0ctypeid\u7684\u7ed3\u679c\u76f4\u5230\u8fd0\u884c\u65f6\u624d\u4f1a\u77e5\u9053\u3002 \u2003typeid\u4f5c\u7528\u4e8e\u51fd\u6570\u6216\u8005\u6570\u7ec4\u65f6\uff0c\u4e0d\u4f1a\u6267\u884c\u5411\u6307\u9488\u7684\u6807\u51c6\u7c7b\u578b\u8f6c\u6362; \u5f53typeid\u4f5c\u7528\u4e8e\u6307\u9488\u65f6\uff0c\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u8be5\u6307\u9488\u7684\u9759\u6001\u7f16\u8bd1\u7c7b\u578b\u3002(\u6307\u9488\u5e76\u975e\u662f\u4e00\u4e2a\u7c7b\u7c7b\u578b\u5bf9\u8c61) dynamic_cast \u2003\u7528\u4e8e\u5c06\u57fa\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u5b89\u5168\u5730\u8f6c\u6362\u6210\u6d3e\u751f\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u3002 \u5f53\u6211\u4eec\u5c06\u8fd9\u4e24\u4e2a\u8fd0\u7b97\u7b26\u7528\u4e8e\u67d0\u79cd\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff0c\u5e76\u4e14\u8be5\u7c7b\u578b\u542b\u6709\u865a\u51fd\u6570\uff0c\u8fd0\u7b97\u7b26\u5c06\u4f7f\u7528\u6307\u9488\u6216\u5f15\u7528\u7ed1\u5b9a\u7684\u5bf9\u8c61\u7684\u52a8\u6001\u7c7b\u578b\u3002 type_info\uff1a\u5176\u62f7\u8d1d\u548c\u79fb\u52a8\u6784\u9020\u51fd\u6570\u4ee5\u53ca\u8d4b\u503c\u8fd0\u7b97\u7b26\u90fd\u88ab\u5b9a\u4e49\u6210\u5220\u9664\u7684\uff0c\u521b\u5efatype_info\u5bf9\u8c61\u7684\u552f\u4e00\u9014\u5f84\u662f\u4f7f\u7528typeid\u8fd0\u7b97\u7b26\u3002","title":"RTTI"},{"location":"c_base/Complementary/#io","text":"IO\u5bf9\u8c61\u65e0\u62f7\u8d1d\u6216\u8d4b\u503c\uff0c\u901a\u5e38\u4ee5\u5f15\u7528\u65b9\u5f0f\u4f20\u9012\u548c\u8fd4\u56de\u6d41\u3002 _istream >> word; getline(_istream, line); \u7b2c\u4e00\u4e2astring\u4f1a\u5b58\u5230word; \u5269\u4f59\u7684\u5185\u5bb9\u4f1a\u5b58\u5230line\uff0c \u5305\u542b\u7a7a\u683c\u3002","title":"IO\u6d41"},{"location":"c_base/Complementary/#ostringstream","text":"\u4f7f\u7528\u524d\u5148\u5305\u542b\u6807\u51c6\u5934\u6587\u4ef6sstream, \u5176\u63d0\u4f9b\"\u5185\u5b58\u5185\u7684\u7684\u8f93\u51fa\u64cd\u4f5c\"\uff0c\u8f93\u51fa\u5230\u4e00\u4e2astring\u5bf9\u8c61\u4e0a\uff0c\u5f53\u6211\u4eec\u9700\u8981\u5c06\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u683c\u5f0f\u5316\u4e3a\u5b57\u7b26\u4e32\u683c\u5f0f\u65f6\uff0c\u5b83\u53ef\u4ee5\u5c06int\u3001float\u7b49\u7c7b\u578b\u7684\u6570\u503c\u81ea\u52a8\u8f6c\u5316\u4e3a\u76f8\u5e94\u7684string\u683c\u5f0f\uff0c\u800c\u4e0d\u5fc5\u8003\u8651\u5b58\u50a8\u7a7a\u95f4\u3001\u8f6c\u6362\u7b97\u6cd5\u7b49\u95ee\u9898\u3002\u5f53\u5b58\u5728\u672a\u77e5\u6570\u636e\u5927\u5c0f\u7684\u65f6\u5019,\u53ef\u4ee5\u4f7f\u7528 ostringstream \u6765\u4ee3\u66ff sprintf , \u907f\u514d\u603b\u662f\u7533\u8bf7\u5927\u91cf\u7684\u7f13\u51b2\u533a\uff0c ostringstream\u63d0\u4f9b\u7684\u7684\u4e00\u4e2amember function str()\uff0c\u4f1a\u8fd4\u56de\"\u4e0eostringstream\u5bf9\u8c61\u76f8\u547c\u5e94\"\u7684string\u5bf9\u8c61\u3002 eg\uff1a ostringstream oss; string str; oss << \u201chello\u201d<<1; str = oss.str(); //\u8403\u53d6\u51fastring\u5bf9\u8c61","title":"ostringstream"},{"location":"c_base/Complementary/#auto","text":"\u7531\u7f16\u8bd1\u5668\u901a\u8fc7\u521d\u59cb\u503c\u6765\u63a8\u7b97\u53d8\u91cf\u7684\u7c7b\u578b\uff0c \u663e\u7136auto\u5b9a\u4e49\u7684\u53d8\u91cf\u5fc5\u987b\u6709\u521d\u59cb\u503c \u3002\u4f7f\u7528auto\u5728\u4e00\u6761\u8bed\u53e5\u4e2d\u540c\u65f6\u58f0\u660e\u591a\u4e2a\u53d8\u91cf\u65f6\uff0c\u6240\u6709\u53d8\u91cf\u7684\u521d\u59cb\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u4e00\u81f4\u3002 \u2003 Using auto is especially useful where the type is a pretty long or complicated expression, such as lambda. \u2003\u7f16\u8bd1\u5668\u63a8\u65ad\u51fa\u7684auto\u7c7b\u578b\u548c\u521d\u59cb\u503c\u7c7b\u578b\u4e0d\u4e00\u5b9a\u5b8c\u5168\u4e00\u81f4: int i=0, &r=i; auto a=r; //a\u7c7b\u578b\u662fint\uff0c\u800c\u975e\u5f15\u7528\uff0c\u56e0\u4e3ar\u5373\u53ea\u662fi\u7684\u4e00\u4e2a\u522b\u540d, \u5176\u6b21\uff0cauto\u4e00\u822c\u4f1a\u5ffd\u7565\u6389\u9876\u5c42const, \u800c\u5e95\u5c42const\u4f1a\u88ab\u4fdd\u7559\u3002 const int ci = i, &cr=ci; auto b = ci; // b\u662f\u4e00\u4e2a\u6574\u6570 auto d = &i; //d\u662f\u4e00\u4e2a\u6574\u6570\u6307\u9488 auto e = &ci; //e\u662f\u4e00\u4e2a\u6307\u5411\u6574\u6570\u5e38\u91cf\u7684\u6307\u9488\u3002 // \u82e5\u8bbe\u7f6e\u4e00\u4e2a\u7c7b\u578b\u4e3aauto\u7684\u5f15\u7528\u65f6\uff0c\u5219\u9876\u5c42const\u5c5e\u6027\u4f1a\u88ab\u4fdd\u7559\uff0c auto &g = ci; //g\u662f\u4e00\u4e2a\u6574\u578b\u5e38\u91cf\u5f15\u7528\u3002 auto *p = &ci; //p\u662f\u4e00\u4e2a\u6307\u5411\u6574\u578b\u5e38\u91cf\u7684\u6307\u9488","title":"auto"},{"location":"c_base/Complementary/#decltype","text":"find out the type of expression decltype(fun()) a; //\u4ee5\u51fd\u6570fun\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u4f5c\u4e3aa\u7684\u6570\u636e\u7c7b\u578b // decltype\u5728\u5904\u7406\u9876\u5c42const\u65f6\uff0c\u4e0eauto\u4e0d\u540c\uff0c\u4f1a\u4fdd\u7559\u9876\u5c42const\u5c5e\u6027\u548c\u5f15\u7528\u3002 const int ci =0, &cj = ci; decltype(ci) x = 0; // x\u7c7b\u578b\u4e3aconst int; delctype(cj) y = x; // y\u7c7b\u578b\u4e3aconst int &; \u2003decltype\u5bf9\u4e8e\u89e3\u5f15\u7528\u64cd\u4f5c\u5f97\u5230\u7684\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u5373decltype(*p)\u7684\u7ed3\u679c\u7c7b\u578b\u662f type&. \u5bf9\u4e8edecltype\u6240\u7528\u7684\u8868\u8fbe\u5f0f\u6765\u8bf4\uff0c\u5982\u679c\u53d8\u91cf\u540d\u5916\u52a0\u4e0a\u4e00\u5bf9\u62ec\u53f7\uff0c\u5219\u7c7b\u578b\u4e0e\u4e0d\u52a0\u62ec\u53f7\u4f1a\u6709\u6240\u533a\u522b\u3002 delcltype(i)\u7ed3\u679c\u7c7b\u578b\u4e3atype, \u5219decltype((i))\u7ed3\u679c\u7c7b\u578b\u4e3atype&. \u2003auto\u4e0edecltype\u5728\u5904\u7406\u6570\u7ec4\u7c7b\u578b\u65f6\u4e5f\u6709\u533a\u522b int a[] = {1, 2}; decltype(a) b = {1, 2}; //b\u662f\u4e00\u4e2a\u75312\u4e2a\u5143\u7d20\u7ec4\u6210\u7684\u6570\u7ec4\uff0c auto c(a); //c \u662f\u4e00\u4e2a\u6574\u578b\u6307\u9488\uff0c\u6307\u5411\u6570\u7ec4a\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 \u2003 Three applications of decltype, first is to declare return types; second is to use in metaprogramming; third is to pass the type of lambda\u3002 //eg. 3. \u9762\u5bf9lambda\uff0c\u53ea\u6709object\uff0c\u9700\u8981\u901a\u8fc7decltype\u83b7\u5f97\u5176\u7c7b\u578b auto cmp = [](const Persion& p1, const Persion& p2){ return p1.lastname()<p2.lastname || (p1.lastname() == p2.lastname() && p1.firstname()<p2.firstname()); }; std::set<Persion, decltype(cmp)> coll(cmp); //cmp\u4f5c\u4e3a\u6bd4\u8f83\u5668\u4f20\u5165","title":"decltype"},{"location":"c_base/Complementary/#string","text":"\u52a0\u6cd5\u64cd\u4f5c\uff0c\u5fc5\u987b\u786e\u4fdd\u6bcf\u4e2a\u201d+\u201d\u4e24\u4fa7\u7684\u8fd0\u7b97\u5bf9\u8c61\u81f3\u5c11\u4e00\u4e2a\u662fstring\uff0c\u53e6\u4e00\u4e2a\u53ef\u4ee5\u662fstring\u3001\u5b57\u7b26\u5b57\u9762\u503c\u3001\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u3002","title":"string"},{"location":"c_base/Complementary/#_3","text":"\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012 \u2003\u6709\u4e24\u79cd\u4f20\u9012\u65b9\u6cd5\uff0c\u4e00\u79cd\u662ffunction(int a[]); \u53e6\u4e00\u79cd\u662ffunction(int *a)\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u5728\u51fd\u6570\u4e2d\u5bf9\u6570\u7ec4\u53c2\u6570\u7684\u4fee\u6539\u90fd\u4f1a\u5f71\u54cd\u5230\u5b9e\u53c2\u672c\u8eab\u7684\u503c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u6570\u7ec4\u5f62\u53c2\u524d\u52a0\u4e0aconst\uff0c\u8868\u793a\u6574\u4e2a\u6570\u7ec4\u53ea\u8bfb\u3002 \u2003\u4f20\u9012\u6570\u7ec4\uff0c\u867d\u7136\u4f20\u9012\u7684\u662f\u9996\u5730\u5740\u5730\u5740\uff0c\u4f46\u662f\u53c2\u6570\u5230\u4e86\u51fd\u6570\u5185\u5c31\u6210\u4e86\u666e\u901a\u6307\u9488\uff0c\u4e0d\u518d\u662f\u6570\u7ec4\u9996\u5730\u5740\u4e86\uff0c\u6240\u4ee5\u8bd5\u56fe\u5728\u522b\u7684\u51fd\u6570\u4e2d\u5f97\u5230\u4f20\u9012\u6570\u7ec4\u7684\u957f\u5ea6\u662f\u884c\u4e0d\u901a\u7684\u3002\u53ea\u80fd\u5148\u8ba1\u7b97\u597d\u957f\u5ea6\u540e\u518d\u4f20\u8fc7\u53bb\uff0c\u8fdb\u884c\u5176\u4ed6\u7684\u8fd0\u7b97\u3002 \u8ba1\u7b97 :\u2003 sizeof(array)/sizeof(array[0]) \u2003\u82e5\u4ee5\u6570\u7ec4\u5f15\u7528\u4f5c\u4e3a\u53c2\u6570\uff0c\u5f62\u5f0f\u5982\u4e0b\uff1a void test(int (&array)[16]); //\u5219\u4f20\u9012\u53c2\u6570\u65f6\uff0c\u5927\u5c0f\u4e5f\u662f\u6570\u7ec4\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c\u82e5\u6570\u7ec4\u957f\u5ea6\u4e0d\u7b49\u4e8e16\uff0c\u662f\u65e0\u6cd5\u4f20\u9012\u7684\u3002 \u5b57\u7b26\u6570\u7ec4 \u53ef\u4ee5\u7528\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u5bf9\u6b64\u7c7b\u6570\u7ec4\u521d\u59cb\u5316\uff0c\u4e14\u9700\u8bb0\u4f4f\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u5f97\u7ed3\u5c3e\u5904\u6709\u4e00\u4e2a\u7a7a\u5b57\u7b26\uff0c\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u6dfb\u52a0\uff0c\u56e0\u6b64\u6570\u7ec4\u5927\u5c0f\u5e94\u80fd\u591f\u5305\u542b\u8be5\u7a7a\u5b57\u7b26\u3002 \u6570\u7ec4\u4e0d\u5141\u8bb8\u62f7\u8d1d\u548c\u8d4b\u503c \u5185\u7f6e\u7684\u4e0b\u6807\u8fd0\u7b97\u7b26\u7c7b\u578b\u4e0d\u662f\u65e0\u7b26\u53f7\u7c7b\u578b\uff0c\u800cstring\u3001vector\u7b49\u6807\u51c6\u5e93\u7c7b\u578b\u4f7f\u7528\u7684\u4e0b\u6807\u8fd0\u7b97\u7b26\u7c7b\u578b\u5fc5\u987b\u662f\u65e0\u7b26\u53f7\u7c7b\u578b\u3002 int a[]={1, 2, 3, 4}; int *p = &a[3]; cout << p[-2]; //\u8f93\u51fa2 \u4f7f\u7528\u8303\u56f4for\u8bed\u53e5\u5904\u7406\u591a\u7ef4\u6570\u7ec4\uff0c\u9664\u4e86\u6700\u5185\u5c42\u7684\u5faa\u73af\u5916\uff0c\u5176\u4ed6\u6240\u6709\u5faa\u73af\u7684\u63a7\u5236\u53d8\u91cf\u90fd\u5e94\u8be5\u662f\u5f15\u7528\u7c7b\u578b\u3002 \u6307\u5411\u6570\u7ec4\u7684\u6307\u9488 \u683c\u5f0f: int (*p)[4] = ia; //p\u662f\u4e00\u4e2a\u6307\u5411\u542b\u67094\u4e2a\u6574\u6570\u7684\u6570\u7ec4","title":"\u5173\u4e8e\u6570\u7ec4"},{"location":"c_base/Complementary/#sizeof","text":"sizeof \u8fd4\u56de\u4e00\u6761\u8868\u8fbe\u5f0f\u6216\u8005\u4e00\u4e2a\u7c7b\u578b\u540d\u5b57\u6240\u5360\u7684\u5b57\u8282\u6570 sizeof (type); sizeof(expr); \u2003 sizeof(Class_name)\u5f97\u5230\u7684\u662f\u6240\u6709\u975e\u9759\u6001\u6210\u5458\u5927\u5c0f\u4e4b\u548c\uff0c\u5982\u679c\u8be5\u7c7b\u5305\u542b\u865a\u51fd\u6570\uff0c\u8fd8\u9700\u52a0\u4e0a4\u4e2a\u5b57\u8282(32\u4f4d\u673a\u5668)\u7684\u865a\u6307\u9488\u5927\u5c0f\uff1b \u5bf9\u4e8e\u7a7a\u7c7b(\u4e0d\u542b\u4efb\u4f55\u6570\u636e\u6210\u5458\u6216\u8005\u865a\u51fd\u6570)\uff0csizeof\u8fd4\u56de\u7684\u7ed3\u679c\u4e3a1\uff0cC++\u6807\u51c6\u89c4\u5b9a\u4e0d\u540c\u7684\u5bf9\u8c61\u4e0d\u80fd\u62e5\u6709\u76f8\u540c\u7684\u5730\u5740\uff0c\u6240\u6709\u5373\u4f7f\u662f\u7a7a\u7c7b\u5728\u5b9e\u4f8b\u5316\u65f6\u4e5f\u9700\u8981\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684\u5730\u5740\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u4f1a\u4e3a\u7a7a\u7c7b\u6dfb\u52a0\u4e00\u4e2a\u9690\u542b\u7684\u5b57\u8282 \u2003sizeof\u5e76\u4e0d\u5b9e\u9645\u8ba1\u7b97\u5176\u8fd0\u7b97\u5bf9\u8c61\u7684\u503c\uff0c\u56e0\u6b64\u5728sizeof\u7684\u8fd0\u7b97\u5bf9\u8c61\u4e2d\u89e3\u5f15\u7528\u4e00\u4e2a\u65e0\u6548\u6307\u9488\u4ecd\u662f\u4e00\u79cd\u5b89\u5168\u7684\u884c\u4e3a\uff0c\u56e0\u4e3a\u6307\u9488\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u88ab\u8c03\u7528\uff1b\u6216\u8005\u4f7f\u7528\u4f5c\u7528\u57df\u8fd0\u7b97\u7b26\u6765\u83b7\u53d6\u975e\u79c1\u6709\u7c7b\u6210\u5458\u7684\u5927\u5c0f\uff0c\u56e0\u4e3a\u65e0\u9700\u63d0\u4f9b\u4e00\u4e2a\u5177\u4f53\u7684\u5bf9\u8c61\u3002 sizeof(*p); sizeof(Class::private_data); \u2003\u5bf9char\u6216\u8005\u7c7b\u578b\u4e3achar\u7684\u8868\u8fbe\u5f0f\u6267\u884csizeof\uff0c\u7ed3\u679c\u4e3a1\uff1b \u5bf9\u5f15\u7528\u7c7b\u578b\u6267\u884csizeof\u8fd0\u7b97\u5f97\u5230\u88ab\u5f15\u7528\u5bf9\u8c61\u6240\u5360\u7a7a\u95f4\u7684\u5927\u5c0f\uff1b \u5bf9\u6307\u9488\u7c7b\u578b\u5219\u662f\u5f97\u5230\u6307\u9488\u672c\u8eab\u6240\u5360\u7a7a\u95f4\u7684\u5927\u5c0f\uff1b \u5bf9\u89e3\u5f15\u7528\u6307\u9488\u5219\u662f\u5f97\u5230\u6307\u9488\u6240\u6307\u5bf9\u8c61\u6240\u5360\u7a7a\u95f4\u7684\u5927\u5c0f\uff1b","title":"sizeof"},{"location":"c_base/Complementary/#return","text":"\u4e0d\u8981\u8fd4\u56de\u5c40\u90e8\u5bf9\u8c61\u7684\u5f15\u7528\u548c\u6307\u9488\uff0c\u56e0\u4e3a\u51fd\u6570\u5b8c\u6210\u540e\uff0c\u5b83\u6240\u5360\u7528\u7684\u5b58\u50a8\u7a7a\u95f4\u4e5f\u968f\u4e4b\u88ab\u91ca\u653e\u6389\uff0c\u56e0\u6b64\u5c40\u90e8\u53d8\u91cf\u7684\u5f15\u7528\u6216\u6307\u9488\u5c06\u6307\u5411\u4e0d\u518d\u6709\u6548\u7684\u5185\u5b58\u533a\u57df\u3002 \u2003\u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u51b3\u5b9a\u51fd\u6570\u8c03\u7528\u662f\u5426\u662f\u5de6\u503c\uff0c\u8c03\u7528\u4e00\u4e2a\u8fd4\u56de\u5f15\u7528\u7684\u51fd\u6570\u5f97\u5230\u5de6\u503c\uff0c\u5176\u4ed6\u8fd4\u56de\u7c7b\u578b\u5f97\u5230\u53f3\u503c\uff0c\u56e0\u6b64\u53ef\u4ee5\u4e3a\u8fd4\u56de\u7c7b\u578b\u662f\u975e\u5e38\u91cf\u5f15\u7528\u7684\u51fd\u6570\u7684\u7ed3\u679c\u8d4b\u503c\u3002 \u2003\u58f0\u660e\u4e00\u4e2a\u8fd4\u56de\u6570\u7ec4\u6307\u9488\u7684\u51fd\u6570: \u2003 type (*func(param_list))[dimension]; //\u4f7f\u7528\u5c3e\u7f6e\u8fd4\u56de\u7c7b\u578b, \u8fd9\u91cc\u7684auto\u662f\u4e3a\u4e86\u8868\u793a\u51fd\u6570\u771f\u6b63\u7684\u8fd4\u56de\u7c7b\u578b\u8ddf\u5728\u5f62\u53c2\u5217\u8868\u4e4b\u540e auto func(param_list) -> int( * )[dimension];","title":"return"},{"location":"c_base/Complementary/#volatile","text":"volatile \u5173\u952e\u5b57\u662f\u4e00\u79cd\u7c7b\u578b\u4fee\u9970\u7b26 \u2003volatile \u5173\u952e\u5b57\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u6bcf\u6b21\u8bbf\u95ee\u65f6\u90fd\u5fc5\u987b\u4ece\u5185\u5b58\u4e2d\u53d6\u51fa\u503c\uff08\u6ca1\u6709\u88ab volatile \u4fee\u9970\u7684\u53d8\u91cf\uff0c\u53ef\u80fd\u7531\u4e8e\u7f16\u8bd1\u5668\u7684\u4f18\u5316\uff0c\u4ece CPU \u5bc4\u5b58\u5668\u4e2d\u53d6\u503c\uff0c\u800c\u5b9e\u9645\u7684\u53d8\u91cf\u7531\u4e8e\u67d0\u4e9b\u7f16\u8bd1\u5668\u672a\u77e5\u7684\u56e0\u7d20\uff08\u64cd\u4f5c\u7cfb\u7edf\u3001\u786c\u4ef6\u3001\u5176\u5b83\u7ebf\u7a0b\u7b49\uff09\u53d1\u9001\u66f4\u6539\uff0c \u56e0\u6b64\u4f7f\u7528 volatile \u544a\u8bc9\u7f16\u8bd1\u5668\u4e0d\u5e94\u5bf9\u8fd9\u6837\u7684\u5bf9\u8c61\u8fdb\u884c\u4f18\u5316\u3002 \u2003const \u53ef\u4ee5\u662f volatile \uff08\u5982\u53ea\u8bfb\u7684\u72b6\u6001\u5bc4\u5b58\u5668\uff09; \u6307\u9488\u53ef\u4ee5\u662f volatile.","title":"volatile"},{"location":"c_base/Complementary/#extern-c","text":"C++\u4f7f\u7528\u94fe\u63a5\u6307\u793a\u6307\u51fa\u4efb\u610f\u975eC++\u51fd\u6570\u4f7f\u7528\u7684\u8bed\u8a00 //\u5355\u8bed\u53e5\u94fe\u63a5\u6307\u793a\uff0c extern \"C\" size_t strlen(const char*); //\u590d\u5408\u8bed\u53e5\u94fe\u63a5\u6307\u793a extern \"C\"{ #include <string.h> //\u6b64\u65f6\u8ba4\u4e3a\u8be5\u5934\u6587\u4ef6\u5305\u542b\u7684\u6240\u6709\u51fd\u6570\u90fd\u662f\u7531C\u8bed\u8a00\u7f16\u5199\u7684 int strcmp(const char*); } //\u6307\u5411C\u51fd\u6570\u7684\u6307\u9488\u4e0e\u6307\u5411C++\u51fd\u6570\u7684\u6307\u9488\u662f\u4e0d\u540c\u7684 extern \"C\" void(*pf)(int); //\u4f7f\u7528pf\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u8ba4\u4e3a\u8c03\u7528\u7684\u662f\u4e00\u4e2aC\u51fd\u6570\uff0c\u4e14\u4e0d\u80fd\u7528\u6765\u6307\u5411\u4e00\u4e2aC++\u51fd\u6570 //\u6307\u5411C++\u51fd\u6570\u7684\u6307\u9488\u548c\u6307\u5411C\u51fd\u6570\u7684\u6307\u9488\u4e0d\u80fd\u4e92\u76f8\u8f6c\u6362 //\u94fe\u63a5\u6307\u793a\u5bf9\u6574\u4e2a\u58f0\u660e\u6709\u6548 // f1\u662f\u4e00\u4e2aC\u51fd\u6570\uff0c\u63a5\u6536\u4e00\u4e2a\u51fd\u6570\u6307\u9488\u53c2\u6570\uff0c\u4e14\u8be5\u51fd\u6570\u6307\u9488\u6307\u5411\u7684\u5fc5\u987b\u662f\u4e00\u4e2aC\u51fd\u6570 extern \"C\" void fun(void(*)(int)); \u2003C\u8bed\u8a00\u4e0d\u652f\u6301\u51fd\u6570\u91cd\u8f7d\uff0c\u56e0\u6b64\u4e00\u4e2aC\u94fe\u63a5\u6307\u793a\u53ea\u80fd\u7528\u6765\u8bf4\u660e\u91cd\u8f7d\u51fd\u6570\u4e2d\u7684\u67d0\u4e00\u4e2a\u3002","title":"\u94fe\u63a5\u6307\u793a:extern C"},{"location":"c_base/Complementary/#_4","text":"1) \u6570\u636e\u7c7b\u578b\u81ea\u8eab\u7684\u5bf9\u9f50\u503c\uff1achar\u578b\u6570\u636e\u81ea\u8eab\u5bf9\u9f50\u503c\u4e3a1\u5b57\u8282\uff0cshort\u578b\u6570\u636e\u4e3a2\u5b57\u8282\uff0cint/float\u578b\u4e3a4\u5b57\u8282\uff0cdouble\u578b\u4e3a8\u5b57\u8282\u3002 2) \u7ed3\u6784\u4f53\u6216\u7c7b\u7684\u81ea\u8eab\u5bf9\u9f50\u503c\uff1a\u5176\u6210\u5458\u4e2d\u81ea\u8eab\u5bf9\u9f50\u503c\u6700\u5927\u7684\u90a3\u4e2a\u503c\u3002 3) \u6307\u5b9a\u5bf9\u9f50\u503c\uff1a#pragma pack (value)\u65f6\u7684\u6307\u5b9a\u5bf9\u9f50\u503cvalue\u3002 4) \u6570\u636e\u6210\u5458\u3001\u7ed3\u6784\u4f53\u548c\u7c7b\u7684\u6709\u6548\u5bf9\u9f50\u503c\uff1a\u81ea\u8eab\u5bf9\u9f50\u503c\u548c\u6307\u5b9a\u5bf9\u9f50\u503c\u4e2d\u8f83\u5c0f\u8005\uff0c\u5373\u6709\u6548\u5bf9\u9f50\u503c=min{\u81ea\u8eab\u5bf9\u9f50\u503c\uff0c\u5f53\u524d\u6307\u5b9a\u7684pack\u503c}\u3002 Class A{int i; char c;} sizeof(A) = 4+4=8; Class B{int i; char c; char c2; double d;} sizeof(B) = 8+8=16; Class C{int i; char c; char c2; int i2;} sizeof(C) = 4+4+4=12; // \u4e24\u4e2achar\u5171\u5360\u75282\u4e2a\u5b57\u8282\uff0c\u5bf9\u9f50\u540e\uff0c\u5360\u75284\u4e2a\u5b57\u8282 Class D {int i; char c2; int i2; char c;} sizeof(D)=4+4+4+4=16;","title":"\u5b57\u8282\u5bf9\u9f50"},{"location":"c_base/Complementary/#_5","text":"\u7528\u6765\u58f0\u660econstexpr\u65f6\u7528\u5230\u7684\u7c7b\u578b\uff1b \u7b97\u672f\u7c7b\u578b\u3001\u5f15\u7528\u3001\u6307\u9488\u548c\u5b57\u9762\u503c\u5e38\u91cf\u7c7b\u90fd\u5c5e\u4e8e\u5b57\u9762\u503c\u7c7b\u578b \uff0c\u81ea\u5b9a\u4e49\u7684\u7c7b\u3001IO\u5e93\u3001string\u7c7b\u578b\u90fd\u4e0d\u5c5e\u4e8e\u5b57\u9762\u503c\u7c7b\u578b\uff0c\u4e5f\u5c31\u4e0d\u80fd\u88ab\u5b9a\u4e49\u4e3aconstexpr\u3002","title":"\u5b57\u9762\u503c\u7c7b\u578b"},{"location":"c_base/Complementary/#using","text":"using-directives for namespaces and using-declarations for namespace members. using namespace std; using std::string; \u2003\u2003\u5934\u6587\u4ef6\u5982\u679c\u5728\u5176\u9876\u5c42\u4f5c\u7528\u57df\u4e2d\u542b\u6709\u6b64\u7c7b\u8bf4\u660e\uff0c\u5219\u4f1a\u5c06\u76f8\u5e94\u7684\u547d\u540d\u7a7a\u95f4\u6216name\u6ce8\u5165\u5230\u6240\u6709\u5305\u542b\u4e86\u8be5\u5934\u6587\u4ef6\u7684\u6587\u4ef6\u4e2d\u3002 using-declarations for class members \u2003\u5728\u6d3e\u751f\u7c7b\u5185\u90e8\u4f7f\u7528using\u8bf4\u660e\uff0c\u53ef\u4ee5\u5c06\u5176\u76f4\u63a5\u6216\u95f4\u63a5\u57fa\u7c7b\u4e2d\u7684 \u4efb\u4f55\u53ef\u8bbf\u95ee\u6210\u5458 \u6807\u8bb0\u51fa\u6765\uff0c using\u58f0\u660e\u8bed\u53e5\u4e2d\u540d\u5b57\u7684\u8bbf\u95ee\u6743\u9650\u7531\u8be5using\u58f0\u660e\u8bed\u53e5\u524d\u7684\u8bbf\u95ee\u8bf4\u660e\u7b26\u51b3\u5b9a\uff0c\u4e0e\u6d3e\u751f\u8bbf\u95ee\u8bf4\u660e\u7b26\u65e0\u5173\u3002 type alias and alias template declaration // type alias using func = void(*)(int, int); // \u7b49\u4ef7\u4e8e typedef void(*func)(int, int); template<typename T> class C{ using value_type=T; } // alias template template<class CharT> using myString=std::basic_string<Chart, std::char_traits<CharT>>","title":"using"},{"location":"c_base/Complementary/#_6","text":"namespace(\u547d\u540d\u7a7a\u95f4)\uff1a\u5373\u53ef\u5b9a\u4e49\u5728\u5168\u5c40\u4f5c\u7528\u57df\u5185\uff0c\u4e5f\u53ef\u5b9a\u4e49\u5728\u5176\u4ed6\u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u4f46\u4e0d\u80fd\u5b9a\u4e49\u5728\u51fd\u6570\u6216\u7c7b\u7684\u5185\u90e8\u3002\u547d\u540d\u7a7a\u95f4\u4f5c\u7528\u57df\u540e\u65e0\u987b\u5206\u53f7\u3002 namespace\u7684\u522b\u540d\uff1a namespace primer = cplusplus_primer; primer\u662f\u547d\u540d\u7a7a\u95f4cplusplus_primer\u7684\u522b\u540d\uff0c\u4e24\u8005\u7b49\u4ef7\u3002\u4e14\u53ef\u4ee5\u5b58\u5728\u591a\u4e2a\u522b\u540d\u3002 \u5185\u8054\u547d\u540d\u7a7a\u95f4\uff1ac++11\u65b0\u5f15\u5165\u7684\u4e00\u79cd\u5d4c\u5957\u547d\u540d\u7a7a\u95f4\uff0c\u5185\u8054\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u540d\u5b57\u53ef\u4ee5\u88ab\u5916\u5c42\u547d\u540d\u7a7a\u95f4\u76f4\u63a5\u4f7f\u7528\u3002 \u672a\u547d\u540d\u7684\u547d\u540d\u7a7a\u95f4\uff1a\u4ec5\u5728\u7279\u5b9a\u6587\u4ef6\u5185\u90e8\u6709\u6548\uff0c\u4f5c\u7528\u8303\u56f4\u4e0d\u4f1a\u8de8\u8d8a\u591a\u4e2a\u4e0d\u540c\u6587\u4ef6\uff1b \u5176\u4e2d\u5b9a\u4e49\u7684\u540d\u5b57\u7684\u4f5c\u7528\u57df\u4e0e\u8be5\u547d\u540d\u7a7a\u95f4\u6240\u5728\u7684\u4f5c\u7528\u57df\u76f8\u540c\uff0c\u56e0\u6b64\u672a\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u540d\u5b57\u8981\u4e0e\u5168\u5c40\u4f5c\u7528\u57df\u4e2d\u7684\u540d\u5b57\u6709\u6240\u533a\u522b\u3002 \u91cd\u8f7d\u4e0e\u547d\u540d\u7a7a\u95f4\uff1a\u4e00\u4e2ausing\u8bf4\u660e\u5305\u542b\u4e86\u8be5\u51fd\u6570\u7684\u6240\u6709\u7248\u672c\uff0c\u5e76\u4e14\u4f1a\u91cd\u8f7d\u8be5\u58f0\u660e\u8bed\u53e5\u6240\u5c5e\u4f5c\u7528\u57df\u4e2d\u5df2\u6709\u7684\u5176\u4ed6\u540c\u540d\u51fd\u6570\uff1b\u82e5\u6240\u5c5e\u4f5c\u7528\u57df\u4e2d\u5df2\u7ecf\u6709\u4e00\u4e2a\u51fd\u6570\u4e0e\u65b0\u5f15\u5165\u7684\u51fd\u6570\u540c\u540d\u4e14\u5f62\u53c2\u5217\u8868\u76f8\u540c\uff0c\u5219\u8be5using\u58f0\u660e\u5c06\u5f15\u53d1\u9519\u8bef\u3002 \u5bf9\u4e8eusing\u6307\u793a\u6765\u8bf4\uff0c\u5f15\u5165\u4e00\u4e2a\u4e0e\u5df2\u6709\u51fd\u6570\u5f62\u53c2\u5217\u8868\u5b8c\u5168\u76f8\u540c\u7684\u51fd\u6570\u5e76\u4e0d\u4f1a\u4ea7\u751f\u9519\u8bef\u3002","title":"\u547d\u540d\u7a7a\u95f4"},{"location":"c_base/Complementary/#tips","text":"\u5546\u53d6\u6574 \u2003c++11\u6807\u51c6\u89c4\u5b9a\u5546\u4e00\u5f8b\u54110\u53d6\u6574\uff1bm%n\u5982\u679c\u4e0d\u7b49\u4e8e0\uff0c\u5219\u7b26\u53f7\u4e0em\u76f8\u540c\uff0c\u5373\u9664\u4e86-m\u6ea2\u51fa\u7684\u7279\u6b8a\u60c5\u51b5\uff0c\uff08-m\uff09%n \u7b49\u4e8e-\uff08m%n\uff09\uff0cm%(-n)\u7b49\u4e8em%n\u3002 \u4ea4\u6362\u4e24\u4e2aint\u53d8\u91cf a=(b^=a^=b)^a; \u524d\u7f6e/\u540e\u7f6e \u81ea\u589e/\u81ea\u51cf\u8fd0\u7b97\u53ca\u89e3\u5f15\u7528 * iter++ \u7b49\u4ef7\u4e8e *(iter++); //\u540e\u81ea\u589e\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u9ad8\u4e8e\u89e3\u5f15\u7528\u7b26\uff0c\u4f46\u7531\u4e8e\u540e\u7f6e\u8fd0\u7b97\u7b26\u8fd4\u56de\u7684iter\u539f\u503c\u7684\u526f\u672c\uff0c\u56e0\u6b64 auto a = iter++; auto b = iter , \u5176\u4e2da==b\uff0c\u4f46\u524d\u8005\u6b64\u65f6iter\u5df2\u7ecf\u6307\u5411\u4e0b\u4e00\u4f4d\u5143\u7d20\u3002 \u800c\u524d\u7f6e\u8fd0\u7b97\u7b26\u5219\u8fd4\u56de\u7684\u662f\u6539\u53d8\u540e\u7684iter. object based: \u9762\u5bf9\u7684\u662f\u5355\u4e00\u7684class\u7684\u8bbe\u8ba1; object oriented: \u9762\u5bf9\u7684\u662f\u591a\u91cdclass\u4e4b\u95f4\u7684\u8bbe\u8ba1, classes \u548c classes\u4e4b\u95f4\u7684\u5173\u7cfb\u3002","title":"tips"},{"location":"c_base/callable/","text":"About Callble Object \u2003\u53ef\u8c03\u7528\u5bf9\u8c61\u7c7b\u578b\u5305\u62ec: \u51fd\u6570\u3001\u51fd\u6570\u6307\u9488\u3001lambda\u8868\u8fbe\u5f0f\u3001bind\u521b\u5efa\u7684\u5bf9\u8c61\u4ee5\u53ca\u91cd\u8f7d\u4e86\u51fd\u6570\u8c03\u7528\u8fd0\u7b97\u7b26\u7684\u7c7b(function object)\u3002 \u2003 std::function : \u4e3a\u4e86\u5b58\u50a8\u4e00\u7cfb\u5217\u6709\u76f8\u540c\u8c03\u7528\u5f62\u5f0f\u7684\u53ef\u8c03\u7528\u5bf9\u8c61\uff0c C++11 \u63d0\u4f9b\u4e86function\u6a21\u677f\u7c7b\uff0c \u521b\u5efafunction\u7c7b\u578b\u5bf9\u8c61\u65f6\uff0c\u6307\u5b9a\u8c03\u7528\u5f62\u5f0f\uff0c\u4f8b\u5982 function<int (int, int)> f=add; //add\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488 function<int (int, int)> f2=divide(); //\u4e00\u4e2a function object function<int (int, int)> f3= [](int i, int j) {return i*j;} //lambda\u8868\u8fbe\u5f0f function object \u63d0\u4f9b\u4e86 function call \u8fd0\u7b97\u7b26\u7684class, lambda \u2003C++ 11 introduces lambdas , allowing the definition of inline functionality, which can be used as a parameter or a local object. \u53ef\u8c03\u7528\u5bf9\u8c61, \u5176\u5f62\u5f0f\u4e3a\uff1a [\u6355\u83b7\u5217\u8868]\uff08\u53c2\u6570\u5217\u8868\uff09mutable opt throwSpec opt -> \u8fd4\u56de\u7c7b\u578b {\u51fd\u6570\u4f53}: \u2003\u6355\u83b7\u5217\u8868:lambda\u7684\u51fd\u6570\u4f53\u4e2d\u53ea\u80fd\u4f7f\u7528\u90a3\u4e9b\u5728\u6355\u83b7\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u53d8\u91cf\u6216\u8005\u6240\u5728\u51fd\u6570\u4e2d\u7684\u9759\u6001\u53d8\u91cf\u6216\u8005\u5728\u6240\u5728\u51fd\u6570\u4e4b\u5916\u58f0\u660e\u7684\u5168\u5c40\u53d8\u91cf\u3002 \u2003\u53ef\u53d8lambda\uff0c\u5728\u53c2\u6570\u5217\u8868\u540e\u52a0\u4e0amutable\u5173\u952e\u5b57\uff0c\u8868\u660e\u53ef\u4ee5\u5728\u51fd\u6570\u4f53\u4e2d\u6539\u53d8\u6355\u83b7\u53d8\u91cf\u7684\u503c\uff1b\u56e0\u6b64\u6b64\u65f6\u53c2\u6570\u5217\u8868\u4e0d\u80fd\u7701\u7565\uff1b throwSpec\u5219\u662f\u5f02\u5e38\u629b\u51fa\u8868\u8fbe\u5f0f\u3002 \u2003\u5b9e\u9645\u4e2d\u53ef\u4ee5\u5ffd\u7565\"(\u53c2\u6570\u5217\u8868)\"\u4ee5\u53ca\"-> \u8fd4\u56de\u7c7b\u578b\"\uff0c\u4f46\u5fc5\u987b\u5305\u542b\u6355\u83b7\u5217\u8868\uff08\u53ef\u4ee5\u4e3a\u7a7a\uff09\u548c\u51fd\u6570\u4f53\u3002\u4f46\u5f53mutable\u6216throwSpec\u3001\u8fd4\u56de\u7c7b\u578b\u5b58\u5728\u65f6\uff0c\u5219\u4e0d\u80fd\u7701\u7565\"()\"\u3002 //the minimal lambda function []{ //do something } \u2003lambda\u7684\u53c2\u6570\u5217\u8868\u4e0d\u80fd\u6709\u9ed8\u8ba4\u53c2\u6570\u3002\u53c2\u6570\u662f\u5728lambda\u8c03\u7528\u65f6\u62f7\u8d1d\uff0c\u800c\u6355\u83b7\u5217\u8868\u4e2d\u7684\u53d8\u91cf\u5219\u662f\u5728\u521b\u5efa\u65f6\u62f7\u8d1d\u7684\u3002 \u5b9a\u4e49\u4e00\u4e2alambda\u672c\u8d28\u662f\u751f\u6210\u4e00\u4e2a\u4e0elambda\u5bf9\u5e94\u7684\u65b0\u7684\uff08\u533f\u540d\u7684\uff09\u7c7b\u7c7b\u578b( \u4f46\u5176\u5e76\u6ca1\u6709\u53ef\u88ab\u8c03\u7528\u7684\u6784\u9020\u51fd\u6570\u548cassignment operator ),\u56e0\u6b64\u4f20\u9012\u4e00\u4e2alambda\u5b9e\u9645\u4e0a\u662f\u4f20\u9012\u4e00\u4e2a\u7c7b\u5bf9\u8c61\uff0c\u6545\u4f7f\u7528auto\u5b9a\u4e49\u4e00\u4e2a\u7528lambda\u521d\u59cb\u5316\u7684\u53d8\u91cf\u65f6\uff0c\u4fbf\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4ecelambda\u751f\u6210\u7684\u7c7b\u578b\u7684\u5bf9\u8c61\u3002 \u2003\u9690\u5f0f\u6355\u83b7\uff1a\u5728\u6355\u83b7\u5217\u8868\u4e2d\u4f7f\u7528\u201c=\u201d\u3001\u201c&\u201d\u5206\u522b\u8868\u793a\u503c\u6355\u83b7\u548c\u5f15\u7528\u6355\u83b7; \u4e5f\u53ef\u4ee5\u6df7\u5408\u4f7f\u7528\u9690\u5f0f\u6355\u83b7\u548c\u663e\u5f0f\u6355\u83b7\uff0c[=\uff0c &variable]\uff0c\u8868\u793a\u9664variable\u91c7\u7528\u5f15\u7528\u6355\u83b7\uff0c\u5176\u4f59\u53d8\u91cf\u91c7\u7528\u503c\u6355\u83b7; \u5bf9\u4e8e\u91c7\u7528\u503c\u6355\u83b7\u7684\u53d8\u91cf\uff0c\u6bcf\u4e2a\u5b9a\u4e49\u7684lambda\u5185\u5c06\u5b58\u5728\u4e00\u4e2a\u5355\u72ec\u7248\u672c\uff0c\u4ee5\u5b9a\u4e49\u65f6\u6355\u83b7\u7684\u53d8\u91cf\u503c\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u6b64\u540e\u6bcf\u6b21\u8c03\u7528\u8be5lambda object\uff0c\u5728\u6b64\u521d\u59cb\u503c\u57fa\u7840\u4e0a\u6539\u53d8\uff0c\u4e0d\u4f1a\u6539\u53d8\u539f\u6709\u53d8\u91cf\u3002 int id=0; auto f=[id]()mutable{ cout<<\"in lambda:\"<<id<<endl; id++; }; id = 22; f(); // in lambda:0 f(); // in lambda:1 f(); // in lambda:2 cout<<\"in main:\"<<id<<endl; // in main:22 \u2003\u6307\u5b9alambda\u8fd4\u56de\u7c7b\u578b\uff1a\u5982\u679clambda\u7684\u51fd\u6570\u4f53\u5305\u542b\u9664return\u4ee5\u5916\u7684\u5176\u4ed6\u8bed\u53e5\uff0c\u5219\u7f16\u8bd1\u5668\u5047\u5b9a\u8be5lambda\u8fd4\u56devoid\uff0c\u5373\u4e0d\u80fd\u8fd4\u56de\u503c\uff0c\u6b64\u65f6\u53ea\u80fd\u901a\u8fc7\u5c3e\u7f6e\u8fd4\u56de\u7c7b\u578b\u201c-> type\u201d\u6307\u5b9alambda\u7684\u8fd4\u56de\u7c7b\u578b\u3002 bind1st\u4e0ebind2nd \u2003\u4e24\u8005\u662f\u5c06\u4e8c\u5143\u51fd\u6570\u8f6c\u6362\u4e3a\u4e00\u5143\u51fd\u6570\uff0c\u5373\u5bf9\u4e0e\u67d0\u4e9b\u51fd\u6570\uff0c\u5176\u5305\u542b\u4e24\u4e2a\u53c2\u6570\uff0c\u901a\u8fc7bind1st\u53ef\u4ee5\u7ed1\u5b9a\u7b2c\u4e00\u4e2a\u53c2\u6570\u503c\uff0c\u901a\u8fc7bind2nd\u53ef\u4ee5\u7ed1\u5b9a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\uff0c\u5219\u8be5\u51fd\u6570\u6b64\u65f6\u5373\u53ef\u89c6\u4e3a\u4e00\u5143\u51fd\u6570\uff0c\u53ef\u4ee5\u88ab\u7528\u4f5c\u5176\u4ed6\u9700\u8981\u4e00\u5143\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u7684\u51fd\u6570\u7684\u53c2\u6570\u3002 eg. #include <iostream> #include <vector> #include <algorithm> #include <functional> using namespace std; int main() { vector<int> vec ; vec.push_back(40);vec.push_back(50); vec.push_back(60);vec.push_back(70); vec.push_back(80);vec.push_back(90); //\u7edf\u8ba1\u53ca\u683c\u4e2a\u6570 binder1st<less_equal<int>> binder1 = bind1st(less_equal<int>(),60); //==>binder1st(less,60); int nPassCnt = count_if(vec.begin(), vec.end(), binder1 ); //==>less_equal(60,x)==> 60 <= x //\u7edf\u8ba1\u4e0d\u53ca\u683c\u4e2a\u6570 binder2nd<less<int> > binder2 = bind2nd(less<int>(), 60); //==>binder2nd(less,60); int nFailCnt = count_if(vec.begin(), vec.end(), binder2 ); //==>less(x,60);==> x < 60 cout << \"nPassCnt:\" << nPassCnt << endl; cout << \"nFailCnt:\" << nFailCnt << endl; return 0; } \u2003\u65b0\u7248\u7248\u5df2\u7ecf\u5f03\u7528\u4e0a\u8ff0\u4e24\u4e2a\u51fd\u6570\uff0c\u6539\u7528bind\u3002 auto newCallable = bind(callable\uff0c arg_list) auto nf = bind(f, a, b, c, _1, _2); /*\u8868\u793a\u628anf\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\u7ed9f\u7684\u7b2c4\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u9012\u7ed9f\u7684\u7b2c5\u4e2a\u53c2\u6570\uff0cf\u7684\u524d\u4e09\u4e2a\u53c2\u6570\u5206\u522b\u7ed1\u5b9a\u4e86a\u3001b\u3001c.*/ \u2003_n\u5373\u5360\u4f4d\u7b26\uff0c\u5b9a\u4e49\u5728placeholder\u547d\u540d\u7a7a\u95f4\u91cc\uff08placeholder\u4e5f\u5b9a\u4e49\u5728std\u547d\u540d\u7a7a\u95f4\u4e2d\uff09\uff0c\u5176\u548cbind\u51fd\u6570\u90fd\u5b9a\u4e49\u5728functional\u5934\u6587\u4ef6\u4e2d\u3002 \u2003\u4f7f\u7528\u5360\u4f4d\u7b26\u524d\uff0c\u9700\u8981\u5bf9\u5e94\u7684\u58f0\u660e\uff0c using namespace std::placeholders; \u5bf9\u4e8e\u975e\u5360\u4f4d\u7b26\u7684\u53c2\u6570\u662f\u88ab\u62f7\u8d1d\u5230bind\u8fd4\u56de\u7684\u53ef\u8c03\u7528\u5bf9\u8c61\u4e2d\u7684\uff0c\u56e0\u6b64\u90a3\u4e9b\u65e0\u6cd5\u62f7\u8d1d\u6216\u8005\u9700\u8981\u5f15\u7528\u4f20\u9012\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7\u6807\u51c6\u5e93\u7684ref\u51fd\u6570\uff0c\u5176\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5305\u542b\u7ed9\u5b9a\u7684\u5f15\u7528\uff0c\u4e14\u6b64\u5bf9\u8c61\u662f\u53ef\u4ee5\u62f7\u8d1d\u7684\u3002","title":"callable"},{"location":"c_base/callable/#about-callble-object","text":"\u53ef\u8c03\u7528\u5bf9\u8c61\u7c7b\u578b\u5305\u62ec: \u51fd\u6570\u3001\u51fd\u6570\u6307\u9488\u3001lambda\u8868\u8fbe\u5f0f\u3001bind\u521b\u5efa\u7684\u5bf9\u8c61\u4ee5\u53ca\u91cd\u8f7d\u4e86\u51fd\u6570\u8c03\u7528\u8fd0\u7b97\u7b26\u7684\u7c7b(function object)\u3002 \u2003 std::function : \u4e3a\u4e86\u5b58\u50a8\u4e00\u7cfb\u5217\u6709\u76f8\u540c\u8c03\u7528\u5f62\u5f0f\u7684\u53ef\u8c03\u7528\u5bf9\u8c61\uff0c C++11 \u63d0\u4f9b\u4e86function\u6a21\u677f\u7c7b\uff0c \u521b\u5efafunction\u7c7b\u578b\u5bf9\u8c61\u65f6\uff0c\u6307\u5b9a\u8c03\u7528\u5f62\u5f0f\uff0c\u4f8b\u5982 function<int (int, int)> f=add; //add\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488 function<int (int, int)> f2=divide(); //\u4e00\u4e2a function object function<int (int, int)> f3= [](int i, int j) {return i*j;} //lambda\u8868\u8fbe\u5f0f","title":"About Callble Object"},{"location":"c_base/callable/#function-object","text":"\u63d0\u4f9b\u4e86 function call \u8fd0\u7b97\u7b26\u7684class,","title":"function object"},{"location":"c_base/callable/#lambda","text":"C++ 11 introduces lambdas , allowing the definition of inline functionality, which can be used as a parameter or a local object. \u53ef\u8c03\u7528\u5bf9\u8c61, \u5176\u5f62\u5f0f\u4e3a\uff1a [\u6355\u83b7\u5217\u8868]\uff08\u53c2\u6570\u5217\u8868\uff09mutable opt throwSpec opt -> \u8fd4\u56de\u7c7b\u578b {\u51fd\u6570\u4f53}: \u2003\u6355\u83b7\u5217\u8868:lambda\u7684\u51fd\u6570\u4f53\u4e2d\u53ea\u80fd\u4f7f\u7528\u90a3\u4e9b\u5728\u6355\u83b7\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u53d8\u91cf\u6216\u8005\u6240\u5728\u51fd\u6570\u4e2d\u7684\u9759\u6001\u53d8\u91cf\u6216\u8005\u5728\u6240\u5728\u51fd\u6570\u4e4b\u5916\u58f0\u660e\u7684\u5168\u5c40\u53d8\u91cf\u3002 \u2003\u53ef\u53d8lambda\uff0c\u5728\u53c2\u6570\u5217\u8868\u540e\u52a0\u4e0amutable\u5173\u952e\u5b57\uff0c\u8868\u660e\u53ef\u4ee5\u5728\u51fd\u6570\u4f53\u4e2d\u6539\u53d8\u6355\u83b7\u53d8\u91cf\u7684\u503c\uff1b\u56e0\u6b64\u6b64\u65f6\u53c2\u6570\u5217\u8868\u4e0d\u80fd\u7701\u7565\uff1b throwSpec\u5219\u662f\u5f02\u5e38\u629b\u51fa\u8868\u8fbe\u5f0f\u3002 \u2003\u5b9e\u9645\u4e2d\u53ef\u4ee5\u5ffd\u7565\"(\u53c2\u6570\u5217\u8868)\"\u4ee5\u53ca\"-> \u8fd4\u56de\u7c7b\u578b\"\uff0c\u4f46\u5fc5\u987b\u5305\u542b\u6355\u83b7\u5217\u8868\uff08\u53ef\u4ee5\u4e3a\u7a7a\uff09\u548c\u51fd\u6570\u4f53\u3002\u4f46\u5f53mutable\u6216throwSpec\u3001\u8fd4\u56de\u7c7b\u578b\u5b58\u5728\u65f6\uff0c\u5219\u4e0d\u80fd\u7701\u7565\"()\"\u3002 //the minimal lambda function []{ //do something } \u2003lambda\u7684\u53c2\u6570\u5217\u8868\u4e0d\u80fd\u6709\u9ed8\u8ba4\u53c2\u6570\u3002\u53c2\u6570\u662f\u5728lambda\u8c03\u7528\u65f6\u62f7\u8d1d\uff0c\u800c\u6355\u83b7\u5217\u8868\u4e2d\u7684\u53d8\u91cf\u5219\u662f\u5728\u521b\u5efa\u65f6\u62f7\u8d1d\u7684\u3002 \u5b9a\u4e49\u4e00\u4e2alambda\u672c\u8d28\u662f\u751f\u6210\u4e00\u4e2a\u4e0elambda\u5bf9\u5e94\u7684\u65b0\u7684\uff08\u533f\u540d\u7684\uff09\u7c7b\u7c7b\u578b( \u4f46\u5176\u5e76\u6ca1\u6709\u53ef\u88ab\u8c03\u7528\u7684\u6784\u9020\u51fd\u6570\u548cassignment operator ),\u56e0\u6b64\u4f20\u9012\u4e00\u4e2alambda\u5b9e\u9645\u4e0a\u662f\u4f20\u9012\u4e00\u4e2a\u7c7b\u5bf9\u8c61\uff0c\u6545\u4f7f\u7528auto\u5b9a\u4e49\u4e00\u4e2a\u7528lambda\u521d\u59cb\u5316\u7684\u53d8\u91cf\u65f6\uff0c\u4fbf\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4ecelambda\u751f\u6210\u7684\u7c7b\u578b\u7684\u5bf9\u8c61\u3002 \u2003\u9690\u5f0f\u6355\u83b7\uff1a\u5728\u6355\u83b7\u5217\u8868\u4e2d\u4f7f\u7528\u201c=\u201d\u3001\u201c&\u201d\u5206\u522b\u8868\u793a\u503c\u6355\u83b7\u548c\u5f15\u7528\u6355\u83b7; \u4e5f\u53ef\u4ee5\u6df7\u5408\u4f7f\u7528\u9690\u5f0f\u6355\u83b7\u548c\u663e\u5f0f\u6355\u83b7\uff0c[=\uff0c &variable]\uff0c\u8868\u793a\u9664variable\u91c7\u7528\u5f15\u7528\u6355\u83b7\uff0c\u5176\u4f59\u53d8\u91cf\u91c7\u7528\u503c\u6355\u83b7; \u5bf9\u4e8e\u91c7\u7528\u503c\u6355\u83b7\u7684\u53d8\u91cf\uff0c\u6bcf\u4e2a\u5b9a\u4e49\u7684lambda\u5185\u5c06\u5b58\u5728\u4e00\u4e2a\u5355\u72ec\u7248\u672c\uff0c\u4ee5\u5b9a\u4e49\u65f6\u6355\u83b7\u7684\u53d8\u91cf\u503c\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u6b64\u540e\u6bcf\u6b21\u8c03\u7528\u8be5lambda object\uff0c\u5728\u6b64\u521d\u59cb\u503c\u57fa\u7840\u4e0a\u6539\u53d8\uff0c\u4e0d\u4f1a\u6539\u53d8\u539f\u6709\u53d8\u91cf\u3002 int id=0; auto f=[id]()mutable{ cout<<\"in lambda:\"<<id<<endl; id++; }; id = 22; f(); // in lambda:0 f(); // in lambda:1 f(); // in lambda:2 cout<<\"in main:\"<<id<<endl; // in main:22 \u2003\u6307\u5b9alambda\u8fd4\u56de\u7c7b\u578b\uff1a\u5982\u679clambda\u7684\u51fd\u6570\u4f53\u5305\u542b\u9664return\u4ee5\u5916\u7684\u5176\u4ed6\u8bed\u53e5\uff0c\u5219\u7f16\u8bd1\u5668\u5047\u5b9a\u8be5lambda\u8fd4\u56devoid\uff0c\u5373\u4e0d\u80fd\u8fd4\u56de\u503c\uff0c\u6b64\u65f6\u53ea\u80fd\u901a\u8fc7\u5c3e\u7f6e\u8fd4\u56de\u7c7b\u578b\u201c-> type\u201d\u6307\u5b9alambda\u7684\u8fd4\u56de\u7c7b\u578b\u3002","title":"lambda"},{"location":"c_base/callable/#bind1stbind2nd","text":"\u4e24\u8005\u662f\u5c06\u4e8c\u5143\u51fd\u6570\u8f6c\u6362\u4e3a\u4e00\u5143\u51fd\u6570\uff0c\u5373\u5bf9\u4e0e\u67d0\u4e9b\u51fd\u6570\uff0c\u5176\u5305\u542b\u4e24\u4e2a\u53c2\u6570\uff0c\u901a\u8fc7bind1st\u53ef\u4ee5\u7ed1\u5b9a\u7b2c\u4e00\u4e2a\u53c2\u6570\u503c\uff0c\u901a\u8fc7bind2nd\u53ef\u4ee5\u7ed1\u5b9a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\uff0c\u5219\u8be5\u51fd\u6570\u6b64\u65f6\u5373\u53ef\u89c6\u4e3a\u4e00\u5143\u51fd\u6570\uff0c\u53ef\u4ee5\u88ab\u7528\u4f5c\u5176\u4ed6\u9700\u8981\u4e00\u5143\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u7684\u51fd\u6570\u7684\u53c2\u6570\u3002 eg. #include <iostream> #include <vector> #include <algorithm> #include <functional> using namespace std; int main() { vector<int> vec ; vec.push_back(40);vec.push_back(50); vec.push_back(60);vec.push_back(70); vec.push_back(80);vec.push_back(90); //\u7edf\u8ba1\u53ca\u683c\u4e2a\u6570 binder1st<less_equal<int>> binder1 = bind1st(less_equal<int>(),60); //==>binder1st(less,60); int nPassCnt = count_if(vec.begin(), vec.end(), binder1 ); //==>less_equal(60,x)==> 60 <= x //\u7edf\u8ba1\u4e0d\u53ca\u683c\u4e2a\u6570 binder2nd<less<int> > binder2 = bind2nd(less<int>(), 60); //==>binder2nd(less,60); int nFailCnt = count_if(vec.begin(), vec.end(), binder2 ); //==>less(x,60);==> x < 60 cout << \"nPassCnt:\" << nPassCnt << endl; cout << \"nFailCnt:\" << nFailCnt << endl; return 0; } \u2003\u65b0\u7248\u7248\u5df2\u7ecf\u5f03\u7528\u4e0a\u8ff0\u4e24\u4e2a\u51fd\u6570\uff0c\u6539\u7528bind\u3002 auto newCallable = bind(callable\uff0c arg_list) auto nf = bind(f, a, b, c, _1, _2); /*\u8868\u793a\u628anf\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\u7ed9f\u7684\u7b2c4\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u9012\u7ed9f\u7684\u7b2c5\u4e2a\u53c2\u6570\uff0cf\u7684\u524d\u4e09\u4e2a\u53c2\u6570\u5206\u522b\u7ed1\u5b9a\u4e86a\u3001b\u3001c.*/ \u2003_n\u5373\u5360\u4f4d\u7b26\uff0c\u5b9a\u4e49\u5728placeholder\u547d\u540d\u7a7a\u95f4\u91cc\uff08placeholder\u4e5f\u5b9a\u4e49\u5728std\u547d\u540d\u7a7a\u95f4\u4e2d\uff09\uff0c\u5176\u548cbind\u51fd\u6570\u90fd\u5b9a\u4e49\u5728functional\u5934\u6587\u4ef6\u4e2d\u3002 \u2003\u4f7f\u7528\u5360\u4f4d\u7b26\u524d\uff0c\u9700\u8981\u5bf9\u5e94\u7684\u58f0\u660e\uff0c using namespace std::placeholders; \u5bf9\u4e8e\u975e\u5360\u4f4d\u7b26\u7684\u53c2\u6570\u662f\u88ab\u62f7\u8d1d\u5230bind\u8fd4\u56de\u7684\u53ef\u8c03\u7528\u5bf9\u8c61\u4e2d\u7684\uff0c\u56e0\u6b64\u90a3\u4e9b\u65e0\u6cd5\u62f7\u8d1d\u6216\u8005\u9700\u8981\u5f15\u7528\u4f20\u9012\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7\u6807\u51c6\u5e93\u7684ref\u51fd\u6570\uff0c\u5176\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5305\u542b\u7ed9\u5b9a\u7684\u5f15\u7528\uff0c\u4e14\u6b64\u5bf9\u8c61\u662f\u53ef\u4ee5\u62f7\u8d1d\u7684\u3002","title":"bind1st\u4e0ebind2nd"},{"location":"c_base/class/","text":"About class \u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4e0e\u62f7\u8d1d\u8d4b\u503c class Test{ public: Test(){}; Test& operator=(const Test&){ std::cout << \"\u6267\u884c\u4e86\u8d4b\u503c\u64cd\u4f5c\" << std::endl; return *this; }; Test(const Test&){ std::cout << \"\u6267\u884c\u4e86\u62f7\u8d1d\u64cd\u4f5c\" << std::endl; } ~Test(){}; }; int main(){ //\u521d\u59cb\u5316 Test t1; Test t2(t1); Test t3 = t1; Test t4, t5; // \u8d4b\u503c t5 = t4 = t1; return 0; } \u2003Test t2(t1); \u5c5e\u4e8e\u76f4\u63a5\u521d\u59cb\u5316\uff1a\u8981\u6c42\u7f16\u8bd1\u5668\u4f7f\u7528\u666e\u901a\u7684\u51fd\u6570\u5339\u914d\u6765\u9009\u62e9\u4e0e\u6211\u4eec\u63d0\u4f9b\u7684\u53c2\u6570\u6700\u5339\u914d\u7684\u6784\u9020\u51fd\u6570,\u56e0\u6b64\u76f4\u63a5\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u6765\u521d\u59cb\u5316\u5bf9\u8c61\u4e5f\u5c5e\u4e8e\u76f4\u63a5\u521d\u59cb\u5316\u3002 \u2003Test t3 = t1; \u5c5e\u4e8e\u62f7\u8d1d\u521d\u59cb\u5316\uff0c\u62f7\u8d1d\u521d\u59cb\u5316\u9996\u5148\u4f7f\u7528\u6307\u5b9a\u6784\u9020\u51fd\u6570\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\uff0c\u7136\u540e\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u5c06\u90a3\u4e2a\u4e34\u65f6\u5bf9\u8c61\u590d\u5236\u5230\u6b63\u5728\u521b\u5efa\u7684\u5bf9\u8c61\u3002\uff08\u6240\u4ee5\u5f53\u590d\u5236\u6784\u9020\u51fd\u6570\u88ab\u58f0\u660e\u4e3a\u79c1\u6709\u65f6\uff0c\u6240\u6709\u7684\u590d\u5236\u521d\u59cb\u5316\u90fd\u4e0d\u80fd\u4f7f\u7528\u3002\uff09 \u8fd9\u91cct1\u5df2\u7ecf\u5b58\u5728\uff0c\u56e0\u6b64\u7701\u7565\u4e86\u6784\u9020\u4e34\u65f6\u5bf9\u8c61\u7684\u4e00\u6b65\u3002 \u2003\u4f7f\u7528=\u62f7\u8d1d\u521d\u59cb\u5316\u65f6\uff0c\u8981\u6c42\u7f16\u7ece\u5668\u5c06\u53f3\u4fa7\u8fd0\u7b97\u5bf9\u8c61\u62f7\u8d1d\u5230\u6b63\u5728\u521b\u5efa\u7684\u5bf9\u8c61\u4e2d\uff0c\u53ef\u80fd\u9700\u8981\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff0c\u56e0\u6b64 \u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4e0d\u5e94\u8be5\u662fexplicit \u3002 \u2003\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4ec0\u4e48\u65f6\u5019\u4f1a\u88ab\u8c03\u7528\uff1a \u7528 = \u5b9a\u4e49\u53d8\u91cf\u65f6; \u5c06\u4e00\u4e2a\u5bf9\u8c61\u4f5c\u4e3a\u5b9e\u53c2\u4f20\u9012\u7ed9\u4e00\u4e2a\u975e\u5f15\u7528\u7c7b\u578b\u7684\u5f62\u53c2; \u4ece\u4e00\u4e2a\u8fd4\u56de\u7c7b\u578b\u4e3a\u975e\u5f15\u7528\u7c7b\u578b\u7684\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61; \u7528\u82b1\u62ec\u53f7\u5217\u8868\u521d\u59cb\u5316\u4e00\u4e2a\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u6216\u4e00\u4e2a\u805a\u5408\u7c7b\u4e2d\u7684\u6210\u5458; \u67d0\u4e9b\u7c7b\u7c7b\u578b\u8fd8\u4f1a\u5bf9\u5b83\u4eec\u6240\u5206\u914d\u7684\u5bf9\u8c61\u4f7f\u7528\u62f7\u8d1d\u521d\u59cb\u5316\u3002\u4f8b\u5982\uff0c\u5f53\u6211\u4eec\u521d\u59cb\u5316\u6807\u51c6\u5e93\u5bb9\u5668\u6216\u662f\u8c03\u7528insert\u6216push\u6210\u5458\uff0c\u5bb9\u5668\u4f1a\u5bf9\u5176\u5143\u7d20\u8fdb\u884c\u62f7\u8d1d\u521d\u59cb\u5316\u3002\u4e0e\u4e4b\u76f8\u53cd\uff0c\u7528emplace\u6210\u5458\u521b\u5efa\u7684\u5143\u7d20\u90fd\u8fdb\u884c\u76f4\u63a5\u521d\u59cb\u5316\u3002 \u2003\u8d4b\u503c\u64cd\u4f5c\u7b26\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u64cd\u4f5c\u7b26\u5de6\u4fa7\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b9e\u73b0\u94fe\u5f0f\u64cd\u4f5c\uff0c\u201ct5=t4=t1\u201d\u3002 \u2003\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u53c2\u6570\u5fc5\u987b\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u4e0d\u4e00\u5b9a\u662fconst\u7c7b\u578b\uff0c\u4f46\u5728\u4f7f\u7528\u5bb9\u5668\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7c7b\u578b\u65f6\uff0c \u5982\u679c\u81ea\u5b9a\u4e49\u7c7b\u6ca1\u6709\u5b9e\u73b0\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff0c\u5219\u8981\u6c42\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u53c2\u6570\u5fc5\u987b\u662fconst\u5f15\u7528\u7c7b\u578b . class CExample { int m_nTest; public: CExample(int x):m_nTest(x) //\u5e26\u53c2\u6570\u6784\u9020\u51fd\u6570 { cout << \"constructor with argument/n\"; } CExample(const CExample & ex) //\u62f7\u8d1d\u6784\u9020\u51fd\u6570 { m_nTest = ex.m_nTest; cout << \"copy constructor/n\"; } CExample& operator = (const CExample &ex)//\u8d4b\u503c\u51fd\u6570(\u8d4b\u503c\u8fd0\u7b97\u7b26\u91cd\u8f7d) { cout << \"assignment operator/n\"; m_nTest = ex.m_nTest; return *this; } void myTestFunc(CExample ex) {} }; int main() { CExample aaa(2); // constructor with argument CExample bbb(3); // constructor with argument bbb = aaa; // assignment operator CExample ccc = aaa; // copy constructor bbb.myTestFunc(aaa); // copy constructor return 0; } \u2003\u6784\u9020ccc\uff0c\u5b9e\u8d28\u4e0a\u662fccc.CExample(aaa); \u6211\u4eec\u5047\u5982\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u53c2\u6570\u4e0d\u662f\u5f15\u7528\u7c7b\u578b\u7684\u8bdd\uff0c \u90a3\u4e48\u5c06\u4f7f\u5f97 ccc.CExample(aaa)\u53d8\u6210aaa\u4f20\u503c\u7ed9ccc.CExample(CExample ex)\uff0c\u5373CExample ex = aaa\uff0c\u56e0\u4e3a ex \u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c \u6240\u4ee5 CExample ex = aaa \u7ee7\u7eed\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\uff0c\u63a5\u4e0b\u6765\u7684\u662f\u6784\u9020ex\uff0c\u4e5f\u5c31\u662f ex.CExample(aaa)\uff0c\u5fc5\u7136\u53c8\u4f1a\u6709aaa\u4f20\u7ed9CExample(CExample ex), \u5373 CExample ex = aaa;\u90a3\u4e48\u53c8\u4f1a\u89e6\u53d1\u62f7\u8d1d\u6784\u9020\u51fd\u6570\uff0c\u5c31\u8fd9\u4e0b\u6c38\u8fdc\u7684\u9012\u5f52\u4e0b\u53bb\u3002 \u6240\u4ee5\uff0c \u4e3a\u4e86\u907f\u514d\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u65e0\u9650\u9012\u5f52\uff0c\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u662f\u5fc5\u987b\u8981\u5e26\u5f15\u7528\u7c7b\u578b\u7684\u53c2\u6570\u7684\uff0c \u800c\u4e14\u8fd9\u4e5f\u662f\u7f16\u8bd1\u5668\u5f3a\u5236\u6027\u8981\u6c42\u7684\u3002 \u2003\u9700\u8981\u6790\u6784\u51fd\u6570 =>> \u9700\u8981\u81ea\u5b9a\u4e49\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u548c\u62f7\u8d1d\u590d\u5236\u8fd0\u7b97\u7b26; \u9700\u8981\u62f7\u8d1d\u6784\u9020\u51fd\u6570<<=>>\u9700\u8981\u8d4b\u503c\u64cd\u4f5c \u79fb\u52a8\u6784\u9020\u51fd\u6570\u4e0e\u79fb\u52a8\u8d4b\u503c \u2003\u6240\u8c13\u79fb\u52a8\u8bed\u4e49\uff0c\u6307\u7684\u5c31\u662f\u4ee5\u79fb\u52a8\u800c\u975e\u6df1\u62f7\u8d1d\u7684\u65b9\u5f0f\u521d\u59cb\u5316\u542b\u6709\u6307\u9488\u6210\u5458\u7684\u7c7b\u5bf9\u8c61\u3002\u7b80\u5355\u7684\u7406\u89e3\uff0c\u79fb\u52a8\u8bed\u4e49\u6307\u7684\u5c31\u662f\u5c06\u5176\u4ed6\u5bf9\u8c61\uff08\u901a\u5e38\u662f\u4e34\u65f6\u5bf9\u8c61\uff09\u62e5\u6709\u7684\u5185\u5b58\u8d44\u6e90\u201c\u79fb\u4e3a\u5df2\u7528\u201d, \u63d0\u9ad8\u521d\u59cb\u5316\u6548\u7387 \u3002\u5bf9\u4e8e\u4e00\u4e2a\u5305\u542b\u6307\u9488\u6210\u5458\u7684\u5bf9\u8c61\uff0c\u79fb\u52a8\u8bed\u4e49\u5373\u662f\u5bf9\u4e8e\u8be5\u6307\u9488\u6210\u5458\u7684\u6d45\u62f7\u8d1d\uff0c\u5e76\u4e14 \u8ba9\u6e90\u5bf9\u8c61\u4e2d\u7684\u6307\u9488\u6307\u5411nullptr (\u56e0\u4e3a\u6b64\u65f6\u65b0\u5bf9\u8c61\u7684\u6307\u9488\u548c\u6e90\u5bf9\u8c61\u7684\u6307\u9488\u6210\u5458\u76f8\u540c\uff0c\u5982\u679c\u6e90\u5bf9\u8c61\u8c03\u7528\u6790\u6784\u51fd\u6570\u91ca\u653e\u8d44\u6e90\uff0c\u4f1a\u5bfc\u81f4\u65b0\u5bf9\u8c61\u7684\u6307\u9488\u6210\u5458\u5931\u53bb\u610f\u4e49)\u3002 \u2003\u5f53\u7c7b\u4e2d\u540c\u65f6\u5305\u542b\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u548c\u79fb\u52a8\u6784\u9020\u51fd\u6570\u65f6\uff0c\u5982\u679c\u4f7f\u7528\u4e34\u65f6\u5bf9\u8c61\u521d\u59cb\u5316\u5f53\u524d\u7c7b\u7684\u5bf9\u8c61\uff0c\u7f16\u8bd1\u5668\u4f1a\u4f18\u5148\u8c03\u7528\u79fb\u52a8\u6784\u9020\u51fd\u6570\u6765\u5b8c\u6210\u6b64\u64cd\u4f5c\u3002\u53ea\u6709\u5f53\u7c7b\u4e2d\u6ca1\u6709\u5408\u9002\u7684\u79fb\u52a8\u6784\u9020\u51fd\u6570\u65f6\uff0c\u7f16\u8bd1\u5668\u624d\u4f1a\u9000\u800c\u6c42\u5176\u6b21\uff0c\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u3002 \u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u901a\u5e38\u5728\u7c7b\u4e2d\u81ea\u5b9a\u4e49\u79fb\u52a8\u6784\u9020\u51fd\u6570\u7684\u540c\u65f6\uff0c\u4f1a\u518d\u4e3a\u5176\u81ea\u5b9a\u4e49\u4e00\u4e2a\u9002\u5f53\u7684\u62f7\u8d1d\u6784\u9020\u51fd\u6570\uff0c\u7531\u6b64\u5f53\u7528\u6237\u5229\u7528\u53f3\u503c\u521d\u59cb\u5316\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4f1a\u8c03\u7528\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1b\u4f7f\u7528\u5de6\u503c\uff08\u975e\u53f3\u503c\uff09\u521d\u59cb\u5316\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4f1a\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u3002 // move constructor MyString(MyString&& rhs)noexcept :_len(rhs._len), _data(rhs._data){ ++MCtor; rhs._data=nullptr; rhs._len=0; } // move assignment MyString& operator = (MyString&& rhs) noexcept{ ++MAsign; if(this!=&rhs){ if(_data)delete[] _data; _data=rhs._data; _len = rhs._len; rhs._data=nullptr; rhs._len=0; } return *this; } noexcept : \u2003\u79fb\u52a8\u6784\u9020\u51fd\u6570\u5728\u5bf9\u8c61\u8fdb\u884c\u590d\u5236\u65f6\u901a\u8fc7\u76f4\u63a5\u79fb\u52a8\u539f\u5bf9\u8c61\u5df2\u7ecf\u5206\u914d\u597d\u7684\u8d44\u6e90\uff0c\u53ef\u7701\u53bb\u5206\u914d\u5185\u5b58\u518d\u62f7\u8d1d\u7684\u8fc7\u7a0b\u3002\u5728STL\u4e2d\u5927\u591a\u6570\u5bb9\u5668\u7c7b\u578b\u90fd\u4f1a\u5728\u8c03\u6574\u5bb9\u5668\u5927\u5c0f\uff08resize\uff09\u65f6\u8c03\u7528\u5bb9\u5668\u5143\u7d20\u7684\u79fb\u52a8\u6784\u9020\u51fd\u6570\u6765\u79fb\u52a8\u8d44\u6e90\uff0c\u4f46 STL\u4e3a\u4e86\u4fdd\u8bc1\u5bb9\u5668\u7c7b\u578b\u7684\u5185\u5b58\u5b89\u5168\uff0c\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u53ea\u4f1a\u8c03\u7528\u88ab\u6807\u8bb0\u4e3a\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\u7684\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff0c\u5426\u5219\u4f1a\u8c03\u7528\u5176\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u6765\u4f5c\u4e3a\u66ff\u4ee3\u3002\u8fd9\u662f\u56e0\u4e3a\u5728\u8d44\u6e90\u7684\u79fb\u52a8\u8fc7\u7a0b\u4e2d\u5982\u679c\u629b\u51fa\u4e86\u5f02\u5e38\uff0c\u90a3\u4e48\u90a3\u4e9b\u6b63\u5728\u88ab\u5904\u7406\u7684\u539f\u59cb\u5bf9\u8c61\u6570\u636e\u53ef\u80fd\u56e0\u4e3a\u5f02\u5e38\u800c\u4e22\u5931\uff0c\u800c\u5728\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4e2d\uff0c\u7531\u4e8e\u8fdb\u884c\u7684\u662f\u8d44\u6e90\u62f7\u8d1d\u64cd\u4f5c\uff0c\u539f\u59cb\u6570\u636e\u4e0d\u4f1a\u88ab\u66f4\u6539\uff0c\u56e0\u6b64\u5373\u4f7f\u629b\u51fa\u5f02\u5e38\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u6570\u636e\u6700\u7ec8\u7684\u6b63\u786e\u6027 \u3002 struct\u4e0eclass\u533a\u522b \u2003\u5728c++\u4e2d\u4f7f\u7528struct\u548cclass\u5b9a\u4e49\u7c7b\u7684\u533a\u522b\u5728\u4e8e\u9ed8\u8ba4\u7684\u8bbf\u95ee\u6743\u9650\uff1a\u7c7b\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u8bf4\u660e\u7b26\u4e4b\u524d\u5b9a\u4e49\u6210\u5458\uff0c\u82e5\u4f7f\u7528struct\u5173\u952e\u5b57\uff0c\u5219\u8fd9\u4e9b\u6210\u5458\u5c5e\u4e8epublic\uff1b\u82e5\u4f7f\u7528class\uff0c\u5219\u5c5e\u4e8eprivate\u3002 \u2003\u6b64\u5916class\u5173\u952e\u5b57\u5b9a\u4e49\u7684\u6d3e\u751f\u7c7b\u9ed8\u8ba4\u662f\u79c1\u6709\u7ee7\u627f\uff0c\u800cstruct\u5b9a\u4e49\u7684\u5219\u9ed8\u8ba4\u662f\u516c\u6709\u7ee7\u627f\u3002 \u9690\u5f0f\u7c7b\u7c7b\u578b\u8f6c\u6362(\u8f6c\u6362\u6784\u9020\u51fd\u6570) \u2003\u5982\u679c\u7c7b\u7684\u6784\u9020\u51fd\u6570\u53ea\u6709\u4e00\u4e2a\u5b9e\u53c2\uff0c\u5219\u5b83\u5b9e\u9645\u4e0a\u5b9a\u4e49\u4e86\u8f6c\u6362\u4e3a\u6b64\u7c7b\u7c7b\u578b\u7684\u9690\u5f0f\u8f6c\u6362\u673a\u5236\uff1b\u800c\u5173\u952e\u5b57explicit\u5219\u53ef\u4ee5\u6291\u5236\u8fd9\u79cd\u9690\u5f0f\u8f6c\u6362\uff0c\u4e14\u5176\u53ea\u5bf9\u4e00\u4e2a\u5b9e\u53c2\u7684\u6784\u9020\u51fd\u6570\u6709\u6548\uff1b\u7528explicit\u58f0\u660e\u6784\u9020\u51fd\u6570\u65f6\uff0c\u5b83\u5c06\u53ea\u80fd\u4ee5\u76f4\u63a5\u521d\u59cb\u5316\u7684\u5f62\u5f0f\u4f7f\u7528\u3002 \u2003\u4f46\u662f\u7531\u4e8einitializer_list\u7684\u5f15\u5165\uff0c\u5bf9\u4e8emulti-arg\u7684\u6784\u9020\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u53d1\u751f\u4e0a\u8ff0\u7684\u9690\u5f0f\u7c7b\u7c7b\u578b\u8f6c\u6362\uff1b\u6b64\u65f6\u5982\u679c\u7528explicit\u58f0\u660e\u6784\u9020\u51fd\u6570\uff0c\u5219\u8981\u6c42\u53ea\u80fd\u901a\u8fc7\u76f4\u63a5\u521d\u59cb\u5316\u624d\u6784\u9020\u5bf9\u8c61\u3002 class C{ public: explicit C (int a, int b){cout << \"C(int), a=\"<<a<<\" ,b=\"<<b<<endl;} C (const C& c){cout<<\" copy ctor \" << endl; } }; int main(int argc, char const *argv[]) { C c{1, 2}; C c2 = {1, 2}; // error! copy-list-initialization cannot use a constructor marked 'explicit return 0; } OOP Object Oriented Programming \u6d3e\u751f\u7c7b\u5728\u58f0\u660e\u65f6\u65e0\u9700\u5305\u542b\u7c7b\u6d3e\u751f\u5217\u8868\uff1b \u5982\u679c\u6211\u4eec\u60f3\u5c06\u67d0\u4e2a\u7c7b\u7528\u4f5c\u57fa\u7c7b\uff0c\u5219\u8be5\u7c7b\u5fc5\u987b\u5df2\u7ecf\u5b9a\u4e49\u800c\u975e\u4ec5\u4ec5\u58f0\u660e\u3002 final : \u5728\u7c7b\u540d\u540e\u52a0\u4e0afinla\u5173\u952e\u5b57\uff0c\u8868\u660e\u8be5\u7c7b\u4e0d\u53ef\u88ab\u7ee7\u627f\uff1b\u82e5\u628a\u51fd\u6570\u6307\u5b9a\u4e3afinal\uff0c\u5219\u8be5\u51fd\u6570\u4e0d\u80fd\u88ab\u6d3e\u751f\u7c7b\u8986\u76d6\u3002 \u9759\u6001\u7c7b\u578b\uff1a\u8868\u8fbe\u5f0f\u7684\u9759\u6001\u7c7b\u578b\u5728\u7f16\u8bd1\u65f6\u603b\u662f\u5df2\u77e5\u7684\uff0c\u5b83\u662f\u53d8\u91cf\u58f0\u660e\u65f6\u7684\u7c7b\u578b\u6216\u8005\u8868\u8fbe\u5f0f\u751f\u6210\u7684\u7c7b\u578b\uff1b \u52a8\u6001\u7c7b\u578b\u5219\u662f\u53d8\u91cf\u6216\u8868\u8fbe\u5f0f\u8868\u793a\u7684\u5185\u5b58\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u52a8\u6001\u7c7b\u578b\u76f4\u5230\u8fd0\u884c\u65f6\u624d\u53ef\u77e5\u3002 \u82e5\u8868\u8fbe\u5f0f\u65e2\u4e0d\u662f\u5f15\u7528\u4e5f\u4e0d\u662f\u6307\u9488\uff0c\u5219\u5b83\u7684\u52a8\u6001\u7c7b\u578b\u6c38\u8fdc\u4e0e\u9759\u6001\u7c7b\u578b\u4e00\u81f4\u3002 \u4ece\u6d3e\u751f\u7c7b\u5411\u57fa\u7c7b\u7684\u7c7b\u578b\u8f6c\u6362\u53ea\u5bf9\u6307\u9488\u6216\u8005\u5f15\u7528\u7c7b\u578b\u6709\u6548\uff1b \u4e0d\u5b58\u5728\u4ece\u57fa\u7c7b\u5411\u6d3e\u751f\u7c7b\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff0c\u56e0\u4e3a\u4e00\u4e2a\u57fa\u7c7b\u7684\u5bf9\u8c61\u53ef\u80fd\u662f\u6d3e\u751f\u7c7b\u5bf9\u8c61\u7684\u4e00\u90e8\u5206\uff0c\u4e5f\u53ef\u80fd\u4e0d\u662f\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728\u4ece\u57fa\u7c7b\u5411\u6d3e\u751f\u7c7b\u7684\u81ea\u52a8\u7c7b\u578b\u8f6c\u6362\u3002 \u5982\u679c\u7528\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e3a\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u521d\u59cb\u5316\u6216\u8d4b\u503c\u65f6\uff0c\u53ea\u6709\u8be5\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e2d\u8fc7\u7684\u57fa\u7c7b\u90e8\u5206\u4f1a\u88ab\u62f7\u8d1d\u3001\u79fb\u52a8\u3001\u8d4b\u503c\uff0c\u5b83\u7684\u6d3e\u751f\u7c7b\u90e8\u5206\u4f1a\u88ab\u5ffd\u7565\u3002 class derive: public base{...} \u5176\u4e2dpublic\u79f0\u4e3a\u6d3e\u751f\u8bbf\u95ee\u8bf4\u660e\u7b26\uff0c\u5176\u63a7\u5236\u6d3e\u751f\u7c7b\u7528\u6237\uff08\u5373\u6d3e\u751f\u7c7b\u5bf9\u8c61\u548c\u6d3e\u751f\u7c7b\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff09\u5bf9\u4e8e\u57fa\u7c7b\u6210\u5458\u7684\u8bbf\u95ee\u6743\u9650\uff1b \u6b64\u5916\u8fd8\u53ef\u4ee5\u63a7\u5236\u7ee7\u627f\u81ea\u6d3e\u751f\u7c7b\u7684\u65b0\u7c7b\u7684\u5bf9\u4e8e\u57fa\u7c7b\u6210\u5458\u7684\u8bbf\u95ee\u6743\u9650\u3002\uff08\u89c1inherit/\u7ee7\u627f\u5173\u7cfb\uff09 \u6539\u53d8\u4e2a\u522b\u6210\u5458\u7684\u53ef\u8bbf\u95ee\u6027\uff1a\u5728\u6d3e\u751f\u7c7b\u5185\u90e8\u4f7f\u7528using\u8bf4\u660e\uff0c\u53ef\u4ee5\u5c06\u5176\u76f4\u63a5\u6216\u95f4\u63a5\u57fa\u7c7b\u4e2d\u7684\u4efb\u4f55\u53ef\u8bbf\u95ee\u6210\u5458\u6807\u8bb0\u51fa\u6765\uff0c using\u58f0\u660e\u8bed\u53e5\u4e2d\u540d\u5b57\u7684\u8bbf\u95ee\u6743\u9650\u7531\u8be5using\u58f0\u660e\u8bed\u53e5\u524d\u7684\u8bbf\u95ee\u8bf4\u660e\u7b26\u51b3\u5b9a\uff0c\u4e0e\u6d3e\u751f\u8bbf\u95ee\u8bf4\u660e\u7b26\u65e0\u5173\u3002 class derived: private base{ public: using base::var1; private: using base::var2; } \u2003\u867d\u7136derived\u4f7f\u7528\u4e86\u79c1\u6709\u7ee7\u627f\uff0c\u4f46var1 \u4ecd\u7136\u53ef\u4ee5\u88abderived\u7684\u6240\u6709\u7528\u6237\u8bbf\u95ee\uff1b\u800cvar2\u5219\u53ea\u80fd\u88abderived\u7684\u6210\u5458\u548c\u53cb\u5143\u8bbf\u95ee\u3002 \u4e00\u4e2a\u5bf9\u8c61\u3001\u5f15\u7528\u6216\u8005\u6307\u9488\u7684\u9759\u6001\u7c7b\u578b\u51b3\u5b9a\u4e86\u8be5\u5bf9\u8c61\u7684\u54ea\u4e9b\u6210\u5458\u662f\u53ef\u89c1\u7684 \u3002 \u5373\u4f7f\u9759\u6001\u7c7b\u578b\u4e0e\u52a8\u6001\u7c7b\u578b\u53ef\u80fd\u4e0d\u4e00\u81f4(\u4f8b\u5982\u4f7f\u7528\u57fa\u7c7b\u7684\u5f15\u7528\u6216\u6307\u9488)\uff0c\u4f46\u662f\u6211\u4eec\u80fd\u4f7f\u7528\u54ea\u4e9b\u6210\u5458\u4ecd\u7136\u662f\u7531\u9759\u6001\u7c7b\u578b\u51b3\u5b9a\u7684\u3002 \u5b9a\u4e49\u6d3e\u751f\u7c7b\u4e2d\u7684\u51fd\u6570\u4e0d\u4f1a\u91cd\u8f7d\u5176\u57fa\u7c7b\u4e2d\u7684\u6210\u5458\uff0c\u548c\u5176\u4ed6\u4f5c\u7528\u4e8e\u57df\u4e00\u6837\uff0c\u5982\u679c\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u4e0e\u57fa\u7c7b\u7684\u67d0\u4e2a\u6210\u5458\u540c\u540d\uff0c\u5219\u6d3e\u751f\u7c7b\u5c06\u5728\u5176\u4f5c\u7528\u57df\u5185\u9690\u85cf\u8be5\u57fa\u7c7b\u6210\u5458\u3002\u5373\u4f7f\u6d3e\u751f\u7c7b\u6210\u5458\u51fd\u6570\u548c\u57fa\u7c7b\u6210\u5458\u51fd\u6570\u7684\u5f62\u53c2\u5217\u8868\u4e0d\u4e00\u81f4\uff0c\u57fa\u7c7b\u6210\u5458\u4e5f\u4ecd\u7136\u4f1a\u88ab\u9690\u85cf\u3002 \u5b9a\u4e49\u6d3e\u751f\u7c7b\u7684\u62f7\u8d1d\u6216\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1a\u9700\u8981\u4f7f\u7528\u5bf9\u5e94\u7684\u57fa\u7c7b\u6784\u9020\u51fd\u6570\u521d\u59cb\u5316\u5bf9\u8c61\u7684\u57fa\u7c7b\u90e8\u5206\uff0c\u82e5\u4e0d\u63d0\u4f9b\u521d\u59cb\u503c\uff0c\u5219\u57fa\u7c7b\u90e8\u5206\u662f\u88ab\u9ed8\u8ba4\u521d\u59cb\u5316\uff0c\u800c\u975e\u62f7\u8d1d\u6216\u79fb\u52a8\u3002 // correct usage: class Base{...}; class derived{ derived(const derived& d): Base(d){} } =delete: \u5728\u51fd\u6570\u53c2\u6570\u5217\u8868\u540e\u52a0\u4e0a=delete\u6765\u6307\u51fa\u6211\u4eec\u5e0c\u671b\u5c06\u5b83\u5b9a\u4e49\u4e3a\u5220\u9664\u7684\uff0c\u5176\u5c06\u4e0d\u80fd\u4ee5\u4efb\u4f55\u65b9\u5f0f\u4f7f\u7528\uff0c\u53ef\u4ee5\u7528\u6765\u963b\u6b62\u62f7\u8d1d\u3001\u8d4b\u503c\uff08\u5982iostream\u7c7b\uff09\u3002 \u5982\u679c\u4e00\u4e2a\u7c7b\u6709\u6570\u636e\u6210\u5458\u4e0d\u80fd\u9ed8\u8ba4\u6784\u9020\u3001\u62f7\u8d1d\u3001\u590d\u5236\u6216\u9500\u6bc1\uff0c\u5219\u5bf9\u5e94\u7684\u6210\u5458\u51fd\u6570\u5c06\u5b9a\u4e49\u4e3a\u5220\u9664\u7684\u3002 \u8d4b\u503c\u8fd0\u7b97\u7b26(operator=)\uff1a\u5c06\u4e00\u4e2a\u5bf9\u8c61\u8d4b\u4e88\u5b83\u81ea\u8eab\u65f6\uff0c\u5fc5\u987b\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u56e0\u6b64\u4e00\u5b9a\u8981\u5728operator=\u91cd\u8f7d\u5b9e\u73b0\u4e2d\u68c0\u6d4b\u662f\u5426\u662f\u81ea\u6211\u8d4b\u503c(self assignment)\uff1b \u5927\u591a\u6570\u8d4b\u503c\u8fd0\u7b97\u7b26\u7ec4\u5408\u4e86\u6790\u6784\u51fd\u6570\u548c\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u5de5\u4f5c\uff1a\u5373\u9500\u6bc1\u5de6\u4fa7\u8fd0\u7b97\u5bf9\u8c61\u7684\u8d44\u6e90\u548c\u4ece\u53f3\u4fa7\u8fd0\u7b97\u5bf9\u8c61\u62f7\u8d1d\u6570\u636e\u3002 swap:\u5bf9\u4e8e\u81ea\u5b9a\u4e49\u7c7b\u4e0a\u5b9a\u4e49\u7684swap\uff0c\u5176\u4f18\u5148\u7ea7\u9ad8\u4e8estd\u4e2d\u5b9a\u4e49\u7684\u7248\u672c\u3002 \u5408\u6210\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1a\u53ea\u6709\u5f53\u4e00\u4e2a\u7c7b\u6ca1\u6709\u5b9a\u4e49\u4efb\u4f55\u81ea\u5df1\u7248\u672c\u7684\u62f7\u8d1d\u63a7\u5236\u6210\u5458\uff0c\u4e14\u5b83\u7684\u6240\u6709\u6570\u636e\u6210\u5458\u90fd\u80fd\u79fb\u52a8\u6784\u9020\u6216\u79fb\u52a8\u8d4b\u503c\u65f6\uff0c\u7f16\u8bd1\u5668\u624d\u4f1a\u4e3a\u5b83\u5408\u6210\u79fb\u52a8\u6784\u9020\u51fd\u6570\u6216\u79fb\u52a8\u8d4b\u503c\u8fd0\u7b97\u7b26\u3002 \u5982\u679c\u4e00\u4e2a\u7c7b\u6ca1\u6709\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff0c\u901a\u8fc7\u6b63\u5e38\u7684\u51fd\u6570\u5339\u914d\uff0c\u7c7b\u4f1a\u4f7f\u7528\u5bf9\u5e94\u62f7\u8d1d\u64cd\u4f5c\u6765\u4ee3\u66ff\u79fb\u52a8\uff0c\u5373\u4f7f\u6211\u4eec\u8bd5\u56fe\u8c03\u7528move\u6765\u79fb\u52a8\u5b83\u4eec\u65f6\u4e5f\u662f\u5982\u6b64\u3002 \u533a\u5206\u79fb\u52a8\u548c\u62f7\u8d1d\u7684\u91cd\u8f7d\u51fd\u6570\uff1a\u901a\u5e38\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u63a5\u6536\u4e00\u4e2aconst T&, \u800c\u79fb\u52a8\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u63a5\u6536\u4e00\u4e2aT&&\u3002 \u8865\u5145 \u679a\u4e3e\u7c7b\u578b enum class open_modes {x, xx}; //\u9650\u5b9a\u4f5c\u7528\u57df\u7684\u679a\u4e3e\u7c7b\u578b\uff0c \u679a\u4e3e\u6210\u5458\u7684\u540d\u5b57\u5728\u679a\u4e3e\u7c7b\u578b\u4f5c\u7528\u57df\u5916\u4e0d\u53ef\u89c1 enum color {red, yellow}; //\u4e0d\u9650\u5b9a\u4f5c\u7528\u57df\u7684\u679a\u4e3e\u7c7b\u578b\uff0c\u679a\u4e3e\u6210\u5458\u4f5c\u7528\u57df\u4e0e\u679a\u4e3e\u7c7b\u578b\u672c\u8eab\u7684\u4f5c\u7528\u57df\u76f8\u540c\u3002 //\u672a\u547d\u540denum: \u53ea\u80fd\u5728\u5b9a\u4e49\u8be5enum\u65f6\u5b9a\u4e49\u5b83\u7684\u5bf9\u8c61\u3002 enum {xxx} obj; \u5d4c\u5957\u7c7b:\u5b9a\u4e49\u5728\u5176\u4ed6\u7c7b\u5185\u90e8\u7684\u7c7b\uff0c\u4e0e\u5916\u5c42\u7c7b\u7684\u5bf9\u8c61\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff1b\u5d4c\u5957\u7c7b\u7684\u540d\u5b57\u5728\u5916\u5c42\u7c7b\u4f5c\u7528\u57df\u4e2d\u662f\u53ef\u89c1\u7684\uff0c\u5728\u5916\u5c42\u4f5c\u7528\u57df\u4e4b\u5916\u4e0d\u53ef\u89c1\uff1b\u82e5\u5728\u5d4c\u5957\u7c7b\u4e2d\u58f0\u660e\u9759\u6001\u6210\u5458\uff0c\u5219\u8be5\u6210\u5458\u7684\u5b9a\u4e49\u5c06\u4f4d\u4e8e\u5916\u5c42\u7c7b\u7684\u4f5c\u7528\u57df\u4e4b\u5916\u3002 Type outer_class::inner_class::static_memb = xx; \u5c40\u90e8\u7c7b:\u5b9a\u4e49\u5728\u67d0\u4e2a\u51fd\u6570\u7684\u5185\u90e8\uff0c\u53ea\u5728\u5b9a\u4e49\u5b83\u7684\u4f5c\u7528\u57df\u53ef\u89c1\uff0c\u4e14\u4e0d\u5141\u8bb8\u58f0\u660e\u9759\u6001\u6570\u636e\u6210\u5458\u3002\u5c40\u90e8\u7c7b\u53ea\u80fd\u8bbf\u95ee\u5916\u5c42\u4f5c\u7528\u57df\u5b9a\u4e49\u7684\u7c7b\u578b\u540d\u3001\u9759\u6001\u53d8\u91cf\u3001\u679a\u4e3e\u6210\u5458\uff0c\u4e0d\u80fd\u8bbf\u95ee\u51fd\u6570\u7684\u666e\u901a\u5c40\u90e8\u53d8\u91cf\u3002\u540c\u65f6\u5916\u5c42\u51fd\u6570\u4e0d\u80fd\u8bbf\u95ee\u5c40\u90e8\u7c7b\u7684private member\uff1b \u5c40\u90e8\u7c7b\u7684\u5d4c\u5957\u7c7b\u4e5f\u5c5e\u4e8e\u5c40\u90e8\u7c7b\u3002 \u805a\u5408\u7c7b\uff1a\u6240\u6709\u6210\u5458\u90fd\u662fpublic; \u6ca1\u6709\u5b9a\u4e49\u4efb\u4f55\u6784\u9020\u51fd\u6570\uff1b\u6ca1\u6709\u7c7b\u5185\u521d\u59cb\u503c\uff1b\u6ca1\u6709\u57fa\u7c7b\uff0c\u4e5f\u6ca1\u6709virtual\u51fd\u6570\u3002 union:\u4e00\u79cd\u7279\u6b8a\u7684\u7c7b\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\u6570\u636e\u6210\u5458\uff0c\u4f46\u662f\u5728\u4efb\u610f\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u6210\u5458\u53ef\u4ee5\u6709\u503c\u3002\u5f53\u5bf9\u67d0\u4e2a\u6210\u5458\u8d4b\u503c\u540e\uff0c\u5176\u4ed6\u6210\u5458\u5c31\u53d8\u6210\u672a\u5b9a\u4e49\u7684\u72b6\u6001\u3002","title":"class"},{"location":"c_base/class/#about-class","text":"","title":"About class"},{"location":"c_base/class/#_1","text":"class Test{ public: Test(){}; Test& operator=(const Test&){ std::cout << \"\u6267\u884c\u4e86\u8d4b\u503c\u64cd\u4f5c\" << std::endl; return *this; }; Test(const Test&){ std::cout << \"\u6267\u884c\u4e86\u62f7\u8d1d\u64cd\u4f5c\" << std::endl; } ~Test(){}; }; int main(){ //\u521d\u59cb\u5316 Test t1; Test t2(t1); Test t3 = t1; Test t4, t5; // \u8d4b\u503c t5 = t4 = t1; return 0; } \u2003Test t2(t1); \u5c5e\u4e8e\u76f4\u63a5\u521d\u59cb\u5316\uff1a\u8981\u6c42\u7f16\u8bd1\u5668\u4f7f\u7528\u666e\u901a\u7684\u51fd\u6570\u5339\u914d\u6765\u9009\u62e9\u4e0e\u6211\u4eec\u63d0\u4f9b\u7684\u53c2\u6570\u6700\u5339\u914d\u7684\u6784\u9020\u51fd\u6570,\u56e0\u6b64\u76f4\u63a5\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u6765\u521d\u59cb\u5316\u5bf9\u8c61\u4e5f\u5c5e\u4e8e\u76f4\u63a5\u521d\u59cb\u5316\u3002 \u2003Test t3 = t1; \u5c5e\u4e8e\u62f7\u8d1d\u521d\u59cb\u5316\uff0c\u62f7\u8d1d\u521d\u59cb\u5316\u9996\u5148\u4f7f\u7528\u6307\u5b9a\u6784\u9020\u51fd\u6570\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\uff0c\u7136\u540e\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u5c06\u90a3\u4e2a\u4e34\u65f6\u5bf9\u8c61\u590d\u5236\u5230\u6b63\u5728\u521b\u5efa\u7684\u5bf9\u8c61\u3002\uff08\u6240\u4ee5\u5f53\u590d\u5236\u6784\u9020\u51fd\u6570\u88ab\u58f0\u660e\u4e3a\u79c1\u6709\u65f6\uff0c\u6240\u6709\u7684\u590d\u5236\u521d\u59cb\u5316\u90fd\u4e0d\u80fd\u4f7f\u7528\u3002\uff09 \u8fd9\u91cct1\u5df2\u7ecf\u5b58\u5728\uff0c\u56e0\u6b64\u7701\u7565\u4e86\u6784\u9020\u4e34\u65f6\u5bf9\u8c61\u7684\u4e00\u6b65\u3002 \u2003\u4f7f\u7528=\u62f7\u8d1d\u521d\u59cb\u5316\u65f6\uff0c\u8981\u6c42\u7f16\u7ece\u5668\u5c06\u53f3\u4fa7\u8fd0\u7b97\u5bf9\u8c61\u62f7\u8d1d\u5230\u6b63\u5728\u521b\u5efa\u7684\u5bf9\u8c61\u4e2d\uff0c\u53ef\u80fd\u9700\u8981\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff0c\u56e0\u6b64 \u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4e0d\u5e94\u8be5\u662fexplicit \u3002 \u2003\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4ec0\u4e48\u65f6\u5019\u4f1a\u88ab\u8c03\u7528\uff1a \u7528 = \u5b9a\u4e49\u53d8\u91cf\u65f6; \u5c06\u4e00\u4e2a\u5bf9\u8c61\u4f5c\u4e3a\u5b9e\u53c2\u4f20\u9012\u7ed9\u4e00\u4e2a\u975e\u5f15\u7528\u7c7b\u578b\u7684\u5f62\u53c2; \u4ece\u4e00\u4e2a\u8fd4\u56de\u7c7b\u578b\u4e3a\u975e\u5f15\u7528\u7c7b\u578b\u7684\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61; \u7528\u82b1\u62ec\u53f7\u5217\u8868\u521d\u59cb\u5316\u4e00\u4e2a\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u6216\u4e00\u4e2a\u805a\u5408\u7c7b\u4e2d\u7684\u6210\u5458; \u67d0\u4e9b\u7c7b\u7c7b\u578b\u8fd8\u4f1a\u5bf9\u5b83\u4eec\u6240\u5206\u914d\u7684\u5bf9\u8c61\u4f7f\u7528\u62f7\u8d1d\u521d\u59cb\u5316\u3002\u4f8b\u5982\uff0c\u5f53\u6211\u4eec\u521d\u59cb\u5316\u6807\u51c6\u5e93\u5bb9\u5668\u6216\u662f\u8c03\u7528insert\u6216push\u6210\u5458\uff0c\u5bb9\u5668\u4f1a\u5bf9\u5176\u5143\u7d20\u8fdb\u884c\u62f7\u8d1d\u521d\u59cb\u5316\u3002\u4e0e\u4e4b\u76f8\u53cd\uff0c\u7528emplace\u6210\u5458\u521b\u5efa\u7684\u5143\u7d20\u90fd\u8fdb\u884c\u76f4\u63a5\u521d\u59cb\u5316\u3002 \u2003\u8d4b\u503c\u64cd\u4f5c\u7b26\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u64cd\u4f5c\u7b26\u5de6\u4fa7\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b9e\u73b0\u94fe\u5f0f\u64cd\u4f5c\uff0c\u201ct5=t4=t1\u201d\u3002 \u2003\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u53c2\u6570\u5fc5\u987b\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u4e0d\u4e00\u5b9a\u662fconst\u7c7b\u578b\uff0c\u4f46\u5728\u4f7f\u7528\u5bb9\u5668\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7c7b\u578b\u65f6\uff0c \u5982\u679c\u81ea\u5b9a\u4e49\u7c7b\u6ca1\u6709\u5b9e\u73b0\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff0c\u5219\u8981\u6c42\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u53c2\u6570\u5fc5\u987b\u662fconst\u5f15\u7528\u7c7b\u578b . class CExample { int m_nTest; public: CExample(int x):m_nTest(x) //\u5e26\u53c2\u6570\u6784\u9020\u51fd\u6570 { cout << \"constructor with argument/n\"; } CExample(const CExample & ex) //\u62f7\u8d1d\u6784\u9020\u51fd\u6570 { m_nTest = ex.m_nTest; cout << \"copy constructor/n\"; } CExample& operator = (const CExample &ex)//\u8d4b\u503c\u51fd\u6570(\u8d4b\u503c\u8fd0\u7b97\u7b26\u91cd\u8f7d) { cout << \"assignment operator/n\"; m_nTest = ex.m_nTest; return *this; } void myTestFunc(CExample ex) {} }; int main() { CExample aaa(2); // constructor with argument CExample bbb(3); // constructor with argument bbb = aaa; // assignment operator CExample ccc = aaa; // copy constructor bbb.myTestFunc(aaa); // copy constructor return 0; } \u2003\u6784\u9020ccc\uff0c\u5b9e\u8d28\u4e0a\u662fccc.CExample(aaa); \u6211\u4eec\u5047\u5982\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u53c2\u6570\u4e0d\u662f\u5f15\u7528\u7c7b\u578b\u7684\u8bdd\uff0c \u90a3\u4e48\u5c06\u4f7f\u5f97 ccc.CExample(aaa)\u53d8\u6210aaa\u4f20\u503c\u7ed9ccc.CExample(CExample ex)\uff0c\u5373CExample ex = aaa\uff0c\u56e0\u4e3a ex \u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c \u6240\u4ee5 CExample ex = aaa \u7ee7\u7eed\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\uff0c\u63a5\u4e0b\u6765\u7684\u662f\u6784\u9020ex\uff0c\u4e5f\u5c31\u662f ex.CExample(aaa)\uff0c\u5fc5\u7136\u53c8\u4f1a\u6709aaa\u4f20\u7ed9CExample(CExample ex), \u5373 CExample ex = aaa;\u90a3\u4e48\u53c8\u4f1a\u89e6\u53d1\u62f7\u8d1d\u6784\u9020\u51fd\u6570\uff0c\u5c31\u8fd9\u4e0b\u6c38\u8fdc\u7684\u9012\u5f52\u4e0b\u53bb\u3002 \u6240\u4ee5\uff0c \u4e3a\u4e86\u907f\u514d\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u65e0\u9650\u9012\u5f52\uff0c\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u662f\u5fc5\u987b\u8981\u5e26\u5f15\u7528\u7c7b\u578b\u7684\u53c2\u6570\u7684\uff0c \u800c\u4e14\u8fd9\u4e5f\u662f\u7f16\u8bd1\u5668\u5f3a\u5236\u6027\u8981\u6c42\u7684\u3002 \u2003\u9700\u8981\u6790\u6784\u51fd\u6570 =>> \u9700\u8981\u81ea\u5b9a\u4e49\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u548c\u62f7\u8d1d\u590d\u5236\u8fd0\u7b97\u7b26; \u9700\u8981\u62f7\u8d1d\u6784\u9020\u51fd\u6570<<=>>\u9700\u8981\u8d4b\u503c\u64cd\u4f5c","title":"\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4e0e\u62f7\u8d1d\u8d4b\u503c"},{"location":"c_base/class/#_2","text":"\u6240\u8c13\u79fb\u52a8\u8bed\u4e49\uff0c\u6307\u7684\u5c31\u662f\u4ee5\u79fb\u52a8\u800c\u975e\u6df1\u62f7\u8d1d\u7684\u65b9\u5f0f\u521d\u59cb\u5316\u542b\u6709\u6307\u9488\u6210\u5458\u7684\u7c7b\u5bf9\u8c61\u3002\u7b80\u5355\u7684\u7406\u89e3\uff0c\u79fb\u52a8\u8bed\u4e49\u6307\u7684\u5c31\u662f\u5c06\u5176\u4ed6\u5bf9\u8c61\uff08\u901a\u5e38\u662f\u4e34\u65f6\u5bf9\u8c61\uff09\u62e5\u6709\u7684\u5185\u5b58\u8d44\u6e90\u201c\u79fb\u4e3a\u5df2\u7528\u201d, \u63d0\u9ad8\u521d\u59cb\u5316\u6548\u7387 \u3002\u5bf9\u4e8e\u4e00\u4e2a\u5305\u542b\u6307\u9488\u6210\u5458\u7684\u5bf9\u8c61\uff0c\u79fb\u52a8\u8bed\u4e49\u5373\u662f\u5bf9\u4e8e\u8be5\u6307\u9488\u6210\u5458\u7684\u6d45\u62f7\u8d1d\uff0c\u5e76\u4e14 \u8ba9\u6e90\u5bf9\u8c61\u4e2d\u7684\u6307\u9488\u6307\u5411nullptr (\u56e0\u4e3a\u6b64\u65f6\u65b0\u5bf9\u8c61\u7684\u6307\u9488\u548c\u6e90\u5bf9\u8c61\u7684\u6307\u9488\u6210\u5458\u76f8\u540c\uff0c\u5982\u679c\u6e90\u5bf9\u8c61\u8c03\u7528\u6790\u6784\u51fd\u6570\u91ca\u653e\u8d44\u6e90\uff0c\u4f1a\u5bfc\u81f4\u65b0\u5bf9\u8c61\u7684\u6307\u9488\u6210\u5458\u5931\u53bb\u610f\u4e49)\u3002 \u2003\u5f53\u7c7b\u4e2d\u540c\u65f6\u5305\u542b\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u548c\u79fb\u52a8\u6784\u9020\u51fd\u6570\u65f6\uff0c\u5982\u679c\u4f7f\u7528\u4e34\u65f6\u5bf9\u8c61\u521d\u59cb\u5316\u5f53\u524d\u7c7b\u7684\u5bf9\u8c61\uff0c\u7f16\u8bd1\u5668\u4f1a\u4f18\u5148\u8c03\u7528\u79fb\u52a8\u6784\u9020\u51fd\u6570\u6765\u5b8c\u6210\u6b64\u64cd\u4f5c\u3002\u53ea\u6709\u5f53\u7c7b\u4e2d\u6ca1\u6709\u5408\u9002\u7684\u79fb\u52a8\u6784\u9020\u51fd\u6570\u65f6\uff0c\u7f16\u8bd1\u5668\u624d\u4f1a\u9000\u800c\u6c42\u5176\u6b21\uff0c\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u3002 \u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u901a\u5e38\u5728\u7c7b\u4e2d\u81ea\u5b9a\u4e49\u79fb\u52a8\u6784\u9020\u51fd\u6570\u7684\u540c\u65f6\uff0c\u4f1a\u518d\u4e3a\u5176\u81ea\u5b9a\u4e49\u4e00\u4e2a\u9002\u5f53\u7684\u62f7\u8d1d\u6784\u9020\u51fd\u6570\uff0c\u7531\u6b64\u5f53\u7528\u6237\u5229\u7528\u53f3\u503c\u521d\u59cb\u5316\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4f1a\u8c03\u7528\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1b\u4f7f\u7528\u5de6\u503c\uff08\u975e\u53f3\u503c\uff09\u521d\u59cb\u5316\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4f1a\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u3002 // move constructor MyString(MyString&& rhs)noexcept :_len(rhs._len), _data(rhs._data){ ++MCtor; rhs._data=nullptr; rhs._len=0; } // move assignment MyString& operator = (MyString&& rhs) noexcept{ ++MAsign; if(this!=&rhs){ if(_data)delete[] _data; _data=rhs._data; _len = rhs._len; rhs._data=nullptr; rhs._len=0; } return *this; } noexcept : \u2003\u79fb\u52a8\u6784\u9020\u51fd\u6570\u5728\u5bf9\u8c61\u8fdb\u884c\u590d\u5236\u65f6\u901a\u8fc7\u76f4\u63a5\u79fb\u52a8\u539f\u5bf9\u8c61\u5df2\u7ecf\u5206\u914d\u597d\u7684\u8d44\u6e90\uff0c\u53ef\u7701\u53bb\u5206\u914d\u5185\u5b58\u518d\u62f7\u8d1d\u7684\u8fc7\u7a0b\u3002\u5728STL\u4e2d\u5927\u591a\u6570\u5bb9\u5668\u7c7b\u578b\u90fd\u4f1a\u5728\u8c03\u6574\u5bb9\u5668\u5927\u5c0f\uff08resize\uff09\u65f6\u8c03\u7528\u5bb9\u5668\u5143\u7d20\u7684\u79fb\u52a8\u6784\u9020\u51fd\u6570\u6765\u79fb\u52a8\u8d44\u6e90\uff0c\u4f46 STL\u4e3a\u4e86\u4fdd\u8bc1\u5bb9\u5668\u7c7b\u578b\u7684\u5185\u5b58\u5b89\u5168\uff0c\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u53ea\u4f1a\u8c03\u7528\u88ab\u6807\u8bb0\u4e3a\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\u7684\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff0c\u5426\u5219\u4f1a\u8c03\u7528\u5176\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u6765\u4f5c\u4e3a\u66ff\u4ee3\u3002\u8fd9\u662f\u56e0\u4e3a\u5728\u8d44\u6e90\u7684\u79fb\u52a8\u8fc7\u7a0b\u4e2d\u5982\u679c\u629b\u51fa\u4e86\u5f02\u5e38\uff0c\u90a3\u4e48\u90a3\u4e9b\u6b63\u5728\u88ab\u5904\u7406\u7684\u539f\u59cb\u5bf9\u8c61\u6570\u636e\u53ef\u80fd\u56e0\u4e3a\u5f02\u5e38\u800c\u4e22\u5931\uff0c\u800c\u5728\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u4e2d\uff0c\u7531\u4e8e\u8fdb\u884c\u7684\u662f\u8d44\u6e90\u62f7\u8d1d\u64cd\u4f5c\uff0c\u539f\u59cb\u6570\u636e\u4e0d\u4f1a\u88ab\u66f4\u6539\uff0c\u56e0\u6b64\u5373\u4f7f\u629b\u51fa\u5f02\u5e38\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u6570\u636e\u6700\u7ec8\u7684\u6b63\u786e\u6027 \u3002","title":"\u79fb\u52a8\u6784\u9020\u51fd\u6570\u4e0e\u79fb\u52a8\u8d4b\u503c"},{"location":"c_base/class/#structclass","text":"\u5728c++\u4e2d\u4f7f\u7528struct\u548cclass\u5b9a\u4e49\u7c7b\u7684\u533a\u522b\u5728\u4e8e\u9ed8\u8ba4\u7684\u8bbf\u95ee\u6743\u9650\uff1a\u7c7b\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u8bf4\u660e\u7b26\u4e4b\u524d\u5b9a\u4e49\u6210\u5458\uff0c\u82e5\u4f7f\u7528struct\u5173\u952e\u5b57\uff0c\u5219\u8fd9\u4e9b\u6210\u5458\u5c5e\u4e8epublic\uff1b\u82e5\u4f7f\u7528class\uff0c\u5219\u5c5e\u4e8eprivate\u3002 \u2003\u6b64\u5916class\u5173\u952e\u5b57\u5b9a\u4e49\u7684\u6d3e\u751f\u7c7b\u9ed8\u8ba4\u662f\u79c1\u6709\u7ee7\u627f\uff0c\u800cstruct\u5b9a\u4e49\u7684\u5219\u9ed8\u8ba4\u662f\u516c\u6709\u7ee7\u627f\u3002","title":"struct\u4e0eclass\u533a\u522b"},{"location":"c_base/class/#_3","text":"\u5982\u679c\u7c7b\u7684\u6784\u9020\u51fd\u6570\u53ea\u6709\u4e00\u4e2a\u5b9e\u53c2\uff0c\u5219\u5b83\u5b9e\u9645\u4e0a\u5b9a\u4e49\u4e86\u8f6c\u6362\u4e3a\u6b64\u7c7b\u7c7b\u578b\u7684\u9690\u5f0f\u8f6c\u6362\u673a\u5236\uff1b\u800c\u5173\u952e\u5b57explicit\u5219\u53ef\u4ee5\u6291\u5236\u8fd9\u79cd\u9690\u5f0f\u8f6c\u6362\uff0c\u4e14\u5176\u53ea\u5bf9\u4e00\u4e2a\u5b9e\u53c2\u7684\u6784\u9020\u51fd\u6570\u6709\u6548\uff1b\u7528explicit\u58f0\u660e\u6784\u9020\u51fd\u6570\u65f6\uff0c\u5b83\u5c06\u53ea\u80fd\u4ee5\u76f4\u63a5\u521d\u59cb\u5316\u7684\u5f62\u5f0f\u4f7f\u7528\u3002 \u2003\u4f46\u662f\u7531\u4e8einitializer_list\u7684\u5f15\u5165\uff0c\u5bf9\u4e8emulti-arg\u7684\u6784\u9020\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u53d1\u751f\u4e0a\u8ff0\u7684\u9690\u5f0f\u7c7b\u7c7b\u578b\u8f6c\u6362\uff1b\u6b64\u65f6\u5982\u679c\u7528explicit\u58f0\u660e\u6784\u9020\u51fd\u6570\uff0c\u5219\u8981\u6c42\u53ea\u80fd\u901a\u8fc7\u76f4\u63a5\u521d\u59cb\u5316\u624d\u6784\u9020\u5bf9\u8c61\u3002 class C{ public: explicit C (int a, int b){cout << \"C(int), a=\"<<a<<\" ,b=\"<<b<<endl;} C (const C& c){cout<<\" copy ctor \" << endl; } }; int main(int argc, char const *argv[]) { C c{1, 2}; C c2 = {1, 2}; // error! copy-list-initialization cannot use a constructor marked 'explicit return 0; }","title":"\u9690\u5f0f\u7c7b\u7c7b\u578b\u8f6c\u6362(\u8f6c\u6362\u6784\u9020\u51fd\u6570)"},{"location":"c_base/class/#oop","text":"Object Oriented Programming \u6d3e\u751f\u7c7b\u5728\u58f0\u660e\u65f6\u65e0\u9700\u5305\u542b\u7c7b\u6d3e\u751f\u5217\u8868\uff1b \u5982\u679c\u6211\u4eec\u60f3\u5c06\u67d0\u4e2a\u7c7b\u7528\u4f5c\u57fa\u7c7b\uff0c\u5219\u8be5\u7c7b\u5fc5\u987b\u5df2\u7ecf\u5b9a\u4e49\u800c\u975e\u4ec5\u4ec5\u58f0\u660e\u3002 final : \u5728\u7c7b\u540d\u540e\u52a0\u4e0afinla\u5173\u952e\u5b57\uff0c\u8868\u660e\u8be5\u7c7b\u4e0d\u53ef\u88ab\u7ee7\u627f\uff1b\u82e5\u628a\u51fd\u6570\u6307\u5b9a\u4e3afinal\uff0c\u5219\u8be5\u51fd\u6570\u4e0d\u80fd\u88ab\u6d3e\u751f\u7c7b\u8986\u76d6\u3002 \u9759\u6001\u7c7b\u578b\uff1a\u8868\u8fbe\u5f0f\u7684\u9759\u6001\u7c7b\u578b\u5728\u7f16\u8bd1\u65f6\u603b\u662f\u5df2\u77e5\u7684\uff0c\u5b83\u662f\u53d8\u91cf\u58f0\u660e\u65f6\u7684\u7c7b\u578b\u6216\u8005\u8868\u8fbe\u5f0f\u751f\u6210\u7684\u7c7b\u578b\uff1b \u52a8\u6001\u7c7b\u578b\u5219\u662f\u53d8\u91cf\u6216\u8868\u8fbe\u5f0f\u8868\u793a\u7684\u5185\u5b58\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u52a8\u6001\u7c7b\u578b\u76f4\u5230\u8fd0\u884c\u65f6\u624d\u53ef\u77e5\u3002 \u82e5\u8868\u8fbe\u5f0f\u65e2\u4e0d\u662f\u5f15\u7528\u4e5f\u4e0d\u662f\u6307\u9488\uff0c\u5219\u5b83\u7684\u52a8\u6001\u7c7b\u578b\u6c38\u8fdc\u4e0e\u9759\u6001\u7c7b\u578b\u4e00\u81f4\u3002 \u4ece\u6d3e\u751f\u7c7b\u5411\u57fa\u7c7b\u7684\u7c7b\u578b\u8f6c\u6362\u53ea\u5bf9\u6307\u9488\u6216\u8005\u5f15\u7528\u7c7b\u578b\u6709\u6548\uff1b \u4e0d\u5b58\u5728\u4ece\u57fa\u7c7b\u5411\u6d3e\u751f\u7c7b\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff0c\u56e0\u4e3a\u4e00\u4e2a\u57fa\u7c7b\u7684\u5bf9\u8c61\u53ef\u80fd\u662f\u6d3e\u751f\u7c7b\u5bf9\u8c61\u7684\u4e00\u90e8\u5206\uff0c\u4e5f\u53ef\u80fd\u4e0d\u662f\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728\u4ece\u57fa\u7c7b\u5411\u6d3e\u751f\u7c7b\u7684\u81ea\u52a8\u7c7b\u578b\u8f6c\u6362\u3002 \u5982\u679c\u7528\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e3a\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u521d\u59cb\u5316\u6216\u8d4b\u503c\u65f6\uff0c\u53ea\u6709\u8be5\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e2d\u8fc7\u7684\u57fa\u7c7b\u90e8\u5206\u4f1a\u88ab\u62f7\u8d1d\u3001\u79fb\u52a8\u3001\u8d4b\u503c\uff0c\u5b83\u7684\u6d3e\u751f\u7c7b\u90e8\u5206\u4f1a\u88ab\u5ffd\u7565\u3002 class derive: public base{...} \u5176\u4e2dpublic\u79f0\u4e3a\u6d3e\u751f\u8bbf\u95ee\u8bf4\u660e\u7b26\uff0c\u5176\u63a7\u5236\u6d3e\u751f\u7c7b\u7528\u6237\uff08\u5373\u6d3e\u751f\u7c7b\u5bf9\u8c61\u548c\u6d3e\u751f\u7c7b\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff09\u5bf9\u4e8e\u57fa\u7c7b\u6210\u5458\u7684\u8bbf\u95ee\u6743\u9650\uff1b \u6b64\u5916\u8fd8\u53ef\u4ee5\u63a7\u5236\u7ee7\u627f\u81ea\u6d3e\u751f\u7c7b\u7684\u65b0\u7c7b\u7684\u5bf9\u4e8e\u57fa\u7c7b\u6210\u5458\u7684\u8bbf\u95ee\u6743\u9650\u3002\uff08\u89c1inherit/\u7ee7\u627f\u5173\u7cfb\uff09 \u6539\u53d8\u4e2a\u522b\u6210\u5458\u7684\u53ef\u8bbf\u95ee\u6027\uff1a\u5728\u6d3e\u751f\u7c7b\u5185\u90e8\u4f7f\u7528using\u8bf4\u660e\uff0c\u53ef\u4ee5\u5c06\u5176\u76f4\u63a5\u6216\u95f4\u63a5\u57fa\u7c7b\u4e2d\u7684\u4efb\u4f55\u53ef\u8bbf\u95ee\u6210\u5458\u6807\u8bb0\u51fa\u6765\uff0c using\u58f0\u660e\u8bed\u53e5\u4e2d\u540d\u5b57\u7684\u8bbf\u95ee\u6743\u9650\u7531\u8be5using\u58f0\u660e\u8bed\u53e5\u524d\u7684\u8bbf\u95ee\u8bf4\u660e\u7b26\u51b3\u5b9a\uff0c\u4e0e\u6d3e\u751f\u8bbf\u95ee\u8bf4\u660e\u7b26\u65e0\u5173\u3002 class derived: private base{ public: using base::var1; private: using base::var2; } \u2003\u867d\u7136derived\u4f7f\u7528\u4e86\u79c1\u6709\u7ee7\u627f\uff0c\u4f46var1 \u4ecd\u7136\u53ef\u4ee5\u88abderived\u7684\u6240\u6709\u7528\u6237\u8bbf\u95ee\uff1b\u800cvar2\u5219\u53ea\u80fd\u88abderived\u7684\u6210\u5458\u548c\u53cb\u5143\u8bbf\u95ee\u3002 \u4e00\u4e2a\u5bf9\u8c61\u3001\u5f15\u7528\u6216\u8005\u6307\u9488\u7684\u9759\u6001\u7c7b\u578b\u51b3\u5b9a\u4e86\u8be5\u5bf9\u8c61\u7684\u54ea\u4e9b\u6210\u5458\u662f\u53ef\u89c1\u7684 \u3002 \u5373\u4f7f\u9759\u6001\u7c7b\u578b\u4e0e\u52a8\u6001\u7c7b\u578b\u53ef\u80fd\u4e0d\u4e00\u81f4(\u4f8b\u5982\u4f7f\u7528\u57fa\u7c7b\u7684\u5f15\u7528\u6216\u6307\u9488)\uff0c\u4f46\u662f\u6211\u4eec\u80fd\u4f7f\u7528\u54ea\u4e9b\u6210\u5458\u4ecd\u7136\u662f\u7531\u9759\u6001\u7c7b\u578b\u51b3\u5b9a\u7684\u3002 \u5b9a\u4e49\u6d3e\u751f\u7c7b\u4e2d\u7684\u51fd\u6570\u4e0d\u4f1a\u91cd\u8f7d\u5176\u57fa\u7c7b\u4e2d\u7684\u6210\u5458\uff0c\u548c\u5176\u4ed6\u4f5c\u7528\u4e8e\u57df\u4e00\u6837\uff0c\u5982\u679c\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u4e0e\u57fa\u7c7b\u7684\u67d0\u4e2a\u6210\u5458\u540c\u540d\uff0c\u5219\u6d3e\u751f\u7c7b\u5c06\u5728\u5176\u4f5c\u7528\u57df\u5185\u9690\u85cf\u8be5\u57fa\u7c7b\u6210\u5458\u3002\u5373\u4f7f\u6d3e\u751f\u7c7b\u6210\u5458\u51fd\u6570\u548c\u57fa\u7c7b\u6210\u5458\u51fd\u6570\u7684\u5f62\u53c2\u5217\u8868\u4e0d\u4e00\u81f4\uff0c\u57fa\u7c7b\u6210\u5458\u4e5f\u4ecd\u7136\u4f1a\u88ab\u9690\u85cf\u3002 \u5b9a\u4e49\u6d3e\u751f\u7c7b\u7684\u62f7\u8d1d\u6216\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1a\u9700\u8981\u4f7f\u7528\u5bf9\u5e94\u7684\u57fa\u7c7b\u6784\u9020\u51fd\u6570\u521d\u59cb\u5316\u5bf9\u8c61\u7684\u57fa\u7c7b\u90e8\u5206\uff0c\u82e5\u4e0d\u63d0\u4f9b\u521d\u59cb\u503c\uff0c\u5219\u57fa\u7c7b\u90e8\u5206\u662f\u88ab\u9ed8\u8ba4\u521d\u59cb\u5316\uff0c\u800c\u975e\u62f7\u8d1d\u6216\u79fb\u52a8\u3002 // correct usage: class Base{...}; class derived{ derived(const derived& d): Base(d){} } =delete: \u5728\u51fd\u6570\u53c2\u6570\u5217\u8868\u540e\u52a0\u4e0a=delete\u6765\u6307\u51fa\u6211\u4eec\u5e0c\u671b\u5c06\u5b83\u5b9a\u4e49\u4e3a\u5220\u9664\u7684\uff0c\u5176\u5c06\u4e0d\u80fd\u4ee5\u4efb\u4f55\u65b9\u5f0f\u4f7f\u7528\uff0c\u53ef\u4ee5\u7528\u6765\u963b\u6b62\u62f7\u8d1d\u3001\u8d4b\u503c\uff08\u5982iostream\u7c7b\uff09\u3002 \u5982\u679c\u4e00\u4e2a\u7c7b\u6709\u6570\u636e\u6210\u5458\u4e0d\u80fd\u9ed8\u8ba4\u6784\u9020\u3001\u62f7\u8d1d\u3001\u590d\u5236\u6216\u9500\u6bc1\uff0c\u5219\u5bf9\u5e94\u7684\u6210\u5458\u51fd\u6570\u5c06\u5b9a\u4e49\u4e3a\u5220\u9664\u7684\u3002 \u8d4b\u503c\u8fd0\u7b97\u7b26(operator=)\uff1a\u5c06\u4e00\u4e2a\u5bf9\u8c61\u8d4b\u4e88\u5b83\u81ea\u8eab\u65f6\uff0c\u5fc5\u987b\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u56e0\u6b64\u4e00\u5b9a\u8981\u5728operator=\u91cd\u8f7d\u5b9e\u73b0\u4e2d\u68c0\u6d4b\u662f\u5426\u662f\u81ea\u6211\u8d4b\u503c(self assignment)\uff1b \u5927\u591a\u6570\u8d4b\u503c\u8fd0\u7b97\u7b26\u7ec4\u5408\u4e86\u6790\u6784\u51fd\u6570\u548c\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u7684\u5de5\u4f5c\uff1a\u5373\u9500\u6bc1\u5de6\u4fa7\u8fd0\u7b97\u5bf9\u8c61\u7684\u8d44\u6e90\u548c\u4ece\u53f3\u4fa7\u8fd0\u7b97\u5bf9\u8c61\u62f7\u8d1d\u6570\u636e\u3002 swap:\u5bf9\u4e8e\u81ea\u5b9a\u4e49\u7c7b\u4e0a\u5b9a\u4e49\u7684swap\uff0c\u5176\u4f18\u5148\u7ea7\u9ad8\u4e8estd\u4e2d\u5b9a\u4e49\u7684\u7248\u672c\u3002 \u5408\u6210\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1a\u53ea\u6709\u5f53\u4e00\u4e2a\u7c7b\u6ca1\u6709\u5b9a\u4e49\u4efb\u4f55\u81ea\u5df1\u7248\u672c\u7684\u62f7\u8d1d\u63a7\u5236\u6210\u5458\uff0c\u4e14\u5b83\u7684\u6240\u6709\u6570\u636e\u6210\u5458\u90fd\u80fd\u79fb\u52a8\u6784\u9020\u6216\u79fb\u52a8\u8d4b\u503c\u65f6\uff0c\u7f16\u8bd1\u5668\u624d\u4f1a\u4e3a\u5b83\u5408\u6210\u79fb\u52a8\u6784\u9020\u51fd\u6570\u6216\u79fb\u52a8\u8d4b\u503c\u8fd0\u7b97\u7b26\u3002 \u5982\u679c\u4e00\u4e2a\u7c7b\u6ca1\u6709\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff0c\u901a\u8fc7\u6b63\u5e38\u7684\u51fd\u6570\u5339\u914d\uff0c\u7c7b\u4f1a\u4f7f\u7528\u5bf9\u5e94\u62f7\u8d1d\u64cd\u4f5c\u6765\u4ee3\u66ff\u79fb\u52a8\uff0c\u5373\u4f7f\u6211\u4eec\u8bd5\u56fe\u8c03\u7528move\u6765\u79fb\u52a8\u5b83\u4eec\u65f6\u4e5f\u662f\u5982\u6b64\u3002 \u533a\u5206\u79fb\u52a8\u548c\u62f7\u8d1d\u7684\u91cd\u8f7d\u51fd\u6570\uff1a\u901a\u5e38\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u63a5\u6536\u4e00\u4e2aconst T&, \u800c\u79fb\u52a8\u62f7\u8d1d\u6784\u9020\u51fd\u6570\u63a5\u6536\u4e00\u4e2aT&&\u3002","title":"OOP"},{"location":"c_base/class/#_4","text":"\u679a\u4e3e\u7c7b\u578b enum class open_modes {x, xx}; //\u9650\u5b9a\u4f5c\u7528\u57df\u7684\u679a\u4e3e\u7c7b\u578b\uff0c \u679a\u4e3e\u6210\u5458\u7684\u540d\u5b57\u5728\u679a\u4e3e\u7c7b\u578b\u4f5c\u7528\u57df\u5916\u4e0d\u53ef\u89c1 enum color {red, yellow}; //\u4e0d\u9650\u5b9a\u4f5c\u7528\u57df\u7684\u679a\u4e3e\u7c7b\u578b\uff0c\u679a\u4e3e\u6210\u5458\u4f5c\u7528\u57df\u4e0e\u679a\u4e3e\u7c7b\u578b\u672c\u8eab\u7684\u4f5c\u7528\u57df\u76f8\u540c\u3002 //\u672a\u547d\u540denum: \u53ea\u80fd\u5728\u5b9a\u4e49\u8be5enum\u65f6\u5b9a\u4e49\u5b83\u7684\u5bf9\u8c61\u3002 enum {xxx} obj; \u5d4c\u5957\u7c7b:\u5b9a\u4e49\u5728\u5176\u4ed6\u7c7b\u5185\u90e8\u7684\u7c7b\uff0c\u4e0e\u5916\u5c42\u7c7b\u7684\u5bf9\u8c61\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff1b\u5d4c\u5957\u7c7b\u7684\u540d\u5b57\u5728\u5916\u5c42\u7c7b\u4f5c\u7528\u57df\u4e2d\u662f\u53ef\u89c1\u7684\uff0c\u5728\u5916\u5c42\u4f5c\u7528\u57df\u4e4b\u5916\u4e0d\u53ef\u89c1\uff1b\u82e5\u5728\u5d4c\u5957\u7c7b\u4e2d\u58f0\u660e\u9759\u6001\u6210\u5458\uff0c\u5219\u8be5\u6210\u5458\u7684\u5b9a\u4e49\u5c06\u4f4d\u4e8e\u5916\u5c42\u7c7b\u7684\u4f5c\u7528\u57df\u4e4b\u5916\u3002 Type outer_class::inner_class::static_memb = xx; \u5c40\u90e8\u7c7b:\u5b9a\u4e49\u5728\u67d0\u4e2a\u51fd\u6570\u7684\u5185\u90e8\uff0c\u53ea\u5728\u5b9a\u4e49\u5b83\u7684\u4f5c\u7528\u57df\u53ef\u89c1\uff0c\u4e14\u4e0d\u5141\u8bb8\u58f0\u660e\u9759\u6001\u6570\u636e\u6210\u5458\u3002\u5c40\u90e8\u7c7b\u53ea\u80fd\u8bbf\u95ee\u5916\u5c42\u4f5c\u7528\u57df\u5b9a\u4e49\u7684\u7c7b\u578b\u540d\u3001\u9759\u6001\u53d8\u91cf\u3001\u679a\u4e3e\u6210\u5458\uff0c\u4e0d\u80fd\u8bbf\u95ee\u51fd\u6570\u7684\u666e\u901a\u5c40\u90e8\u53d8\u91cf\u3002\u540c\u65f6\u5916\u5c42\u51fd\u6570\u4e0d\u80fd\u8bbf\u95ee\u5c40\u90e8\u7c7b\u7684private member\uff1b \u5c40\u90e8\u7c7b\u7684\u5d4c\u5957\u7c7b\u4e5f\u5c5e\u4e8e\u5c40\u90e8\u7c7b\u3002 \u805a\u5408\u7c7b\uff1a\u6240\u6709\u6210\u5458\u90fd\u662fpublic; \u6ca1\u6709\u5b9a\u4e49\u4efb\u4f55\u6784\u9020\u51fd\u6570\uff1b\u6ca1\u6709\u7c7b\u5185\u521d\u59cb\u503c\uff1b\u6ca1\u6709\u57fa\u7c7b\uff0c\u4e5f\u6ca1\u6709virtual\u51fd\u6570\u3002 union:\u4e00\u79cd\u7279\u6b8a\u7684\u7c7b\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\u6570\u636e\u6210\u5458\uff0c\u4f46\u662f\u5728\u4efb\u610f\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u6210\u5458\u53ef\u4ee5\u6709\u503c\u3002\u5f53\u5bf9\u67d0\u4e2a\u6210\u5458\u8d4b\u503c\u540e\uff0c\u5176\u4ed6\u6210\u5458\u5c31\u53d8\u6210\u672a\u5b9a\u4e49\u7684\u72b6\u6001\u3002","title":"\u8865\u5145"},{"location":"c_base/const/","text":"About Const \u521d\u59cb\u5316 \u2003\u5728\u521d\u59cb\u5316const\u5f15\u7528\u65f6\u5141\u8bb8\u7528\u4efb\u610f\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u5176\u521d\u59cb\u503c\uff0c\u53ea\u8981\u8be5\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u80fd\u8f6c\u6362\u6210\u5f15\u7528\u7684\u7c7b\u578b\u5373\u53ef\uff0c\u5c24\u5176\u5141\u8bb8\u4e3a\u4e00\u4e2a\u5e38\u91cf\u5f15\u7528\u7ed1\u5b9a\u975e\u5e38\u91cf\u7684\u5bf9\u8c61\u3001\u5b57\u9762\u503c\u3001\u4e00\u822c\u8868\u8fbe\u5f0f\uff0c\u6216\u8005\u4e3a\u4e00\u4e2a\u6307\u5411\u5e38\u91cf\u7684\u6307\u9488\u8d4b\u503c\u975e\u5e38\u91cf\u5bf9\u8c61\u7684\u5730\u5740\uff0c\u4f46\u4e0d\u80fd\u901a\u8fc7\u8be5\u5f15\u7528\u6216\u8005\u6307\u9488\u4fee\u6539\u5176\u7ed1\u5b9a\u6216\u8005\u6307\u5411\u7684\u5bf9\u8c61\u3002 cosnt member fucntion \u2003\u7f16\u8bd1\u5668\u4f1a\u786e\u4fddconst member function\u4e0d\u4f1a\u66f4\u6539\u5176\u8c03\u7528\u8005; \"const\"\u4e5f\u5c5e\u4e8e\u51fd\u6570\u7b7e\u540d\u7684\u4e00\u90e8\u5206 int elem(int) const; \u2003const\u653e\u5728\u53c2\u6570\u5217\u8868\u540e\u9762\uff0c\u4e0e\u653e\u5728\u8fd4\u56de\u503c\u7c7b\u578b\u524d\u9762\u610f\u4e49\u5927\u4e0d\u76f8\u540c\uff0c\u524d\u8005\u8868\u660e\u8be5\u51fd\u6570\u8c03\u7528\u65f6\u4e0d\u4f1a\u4fee\u6539\u4efb\u4f55data member; \u800c\u540e\u8005\u5219\u8868\u660e\u8be5\u51fd\u6570\u8fd4\u56de\u503c\u7c7b\u578b\u4e3aconst\u3002 \u2003\u4e24\u4e2a\u6210\u5458\u51fd\u6570\uff0c\u540d\u5b57\u548c\u53c2\u6570\u8868\u90fd\u4e00\u6837\uff0c\u4f46\u662f\u4e00\u4e2a\u662fconst\uff0c\u4e00\u4e2a\u4e0d\u662f\uff0c\u90a3\u4e48\u7b97\u662f\u91cd\u8f7d\u3002 \u2003\u5f53\u6210\u5458\u51fd\u6570\u7684const\u548cnon-const\u7248\u672c\u540c\u65f6\u5b58\u5728\u65f6(\u51fd\u6570\u91cd\u8f7d)\uff0cconst object\u53ea\u4f1a(\u53ea\u80fd)\u8c03\u7528const\u7248\u672c\uff1b\u800cnon-const object\u4e5f\u53ea\u4f1a(\u53ea\u80fd)\u8c03\u7528non-const\u7248\u672c\uff1b\u82e5\u65e0\u91cd\u8f7d\uff0c\u975e\u5e38\u91cf\u5bf9\u8c61\u53ef\u4ee5\u8c03\u7528\u7c7b\u5b9a\u4e49\u4e2d\u5e38\u91cf\u6210\u5458\u51fd\u6570\u548c\u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570\u3002 \u2003\u5e38\u91cf\u6210\u5458\u51fd\u6570\u4e0d\u80fd\u8c03\u7528\u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570\uff0c\u4f46\u53ef\u4ee5\u8c03\u7528\u9759\u6001\u6210\u5458\u53d8\u91cf\u548c\u51fd\u6570\u3002 \u2003 \u5982\u679c\u7c7b\u7684\u6210\u5458\u51fd\u6570\u4e0d\u4f1a\u6539\u53d8\u5bf9\u8c61\u7684\u72b6\u6001\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6210\u5458\u51fd\u6570\u4e00\u822c\u4f1a\u58f0\u660e\u6210const\u7684\u3002\u4f46\u662f\uff0c\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u5728const\u7684\u51fd\u6570\u91cc\u9762\u4fee\u6539\u4e00\u4e9b\u8ddf\u7c7b\u72b6\u6001\u65e0\u5173\u7684\u6570\u636e\u6210\u5458\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u636e\u6210\u5458\u5c31\u5e94\u8be5\u88ab mutalbe \u6765\u4fee\u9970\u3002 const\u5f62\u53c2 \u2003 \u5f53\u7528\u5b9e\u53c2\u521d\u59cb\u5316\u5f62\u53c2\u65f6\u4f1a\u5ffd\u7565\u9876\u5c42const, \u5373\u4f20\u9012\u7ed9\u8be5\u5f62\u53c2\u5e38\u91cf\u5bf9\u8c61\u6216\u975e\u5e38\u91cf\u5bf9\u8c61\u5747\u53ef \u3002\u56e0\u6b64void fcn(const int i)\u3001void fcn(int i)\u672c\u8d28\u4e0a\u662f\u540c\u4e00\u4e2a\u51fd\u6570\uff0c\u4e24\u8005\u4e0d\u80fd\u5171\u5b58\u3002 \u2003 \u5982\u679c\u5f62\u53c2\u662f\u67d0\u79cd\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff0c\u5219\u901a\u8fc7\u533a\u5206\u5176\u6307\u5411\u7684\u662f\u5e38\u91cf\u5bf9\u8c61\u8fd8\u662f\u975e\u5e38\u91cf\u5bf9\u8c61\u53ef\u4ee5\u5b9e\u73b0\u51fd\u6570\u91cd\u8f7d\uff0c\u6b64\u65f6\u7684const\u662f\u5e95\u5c42\u7684. const and constexpr \u2003\u5bf9\u4e8e\u4fee\u9970Object\u6765\u8bf4\uff0cconst\u5e76\u672a\u533a\u5206\u51fa\u7f16\u8bd1\u671f\u5e38\u91cf\u548c\u8fd0\u884c\u671f\u5e38\u91cf; constexpr\u9650\u5b9a\u5728\u4e86\u7f16\u8bd1\u671f\u5e38\u91cf; \u2003\u5bf9\u4e8e\u4fee\u9970\u51fd\u6570\u6765\u8bf4\uff1a constexpr, \u5982\u679c\u5176\u4f20\u5165\u7684\u53c2\u6570\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u671f\u8ba1\u7b97\u51fa\u6765\uff0c\u90a3\u4e48\u8fd9\u4e2a\u51fd\u6570\u5c31\u4f1a\u4ea7\u751f\u7f16\u8bd1\u65f6\u671f\u7684\u503c\u3002\u4f46\u662f\u4f20\u5165\u7684\u53c2\u6570\u5982\u679c\u4e0d\u80fd\u5728\u7f16\u8bd1\u65f6\u671f\u8ba1\u7b97\u51fa\u6765\uff0c\u90a3\u4e48constexpr\u4fee\u9970\u7684\u51fd\u6570\u5c31\u548c\u666e\u901a\u51fd\u6570\u4e00\u6837\u4e86\u3002 const \u4e00\u822c\u4fee\u9970\u6210\u5458\u51fd\u6570\uff0c\u8868\u793a\u4e0d\u4f1a\u4fee\u6539\u7c7b\u7684\u6210\u5458\u53d8\u91cf\uff08\u9664\u975e\u8be5\u53d8\u91cf\u6709mutable\u4fee\u9970\uff09\u3002 \u8865\u5145 \u9876\u5c42const, \u8868\u793a\u4efb\u610f\u7684\u5bf9\u8c61\u662f\u5e38\u91cf\uff1b\u5e95\u5c42const\u5219\u4e0e\u6307\u9488\u3001\u5f15\u7528\u7b49\u590d\u5408\u7c7b\u578b\u7684\u57fa\u672c\u7c7b\u578b\u90e8\u5206\u6709\u5173.","title":"const"},{"location":"c_base/const/#about-const","text":"","title":"About Const"},{"location":"c_base/const/#_1","text":"\u5728\u521d\u59cb\u5316const\u5f15\u7528\u65f6\u5141\u8bb8\u7528\u4efb\u610f\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u5176\u521d\u59cb\u503c\uff0c\u53ea\u8981\u8be5\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u80fd\u8f6c\u6362\u6210\u5f15\u7528\u7684\u7c7b\u578b\u5373\u53ef\uff0c\u5c24\u5176\u5141\u8bb8\u4e3a\u4e00\u4e2a\u5e38\u91cf\u5f15\u7528\u7ed1\u5b9a\u975e\u5e38\u91cf\u7684\u5bf9\u8c61\u3001\u5b57\u9762\u503c\u3001\u4e00\u822c\u8868\u8fbe\u5f0f\uff0c\u6216\u8005\u4e3a\u4e00\u4e2a\u6307\u5411\u5e38\u91cf\u7684\u6307\u9488\u8d4b\u503c\u975e\u5e38\u91cf\u5bf9\u8c61\u7684\u5730\u5740\uff0c\u4f46\u4e0d\u80fd\u901a\u8fc7\u8be5\u5f15\u7528\u6216\u8005\u6307\u9488\u4fee\u6539\u5176\u7ed1\u5b9a\u6216\u8005\u6307\u5411\u7684\u5bf9\u8c61\u3002","title":"\u521d\u59cb\u5316"},{"location":"c_base/const/#cosnt-member-fucntion","text":"\u7f16\u8bd1\u5668\u4f1a\u786e\u4fddconst member function\u4e0d\u4f1a\u66f4\u6539\u5176\u8c03\u7528\u8005; \"const\"\u4e5f\u5c5e\u4e8e\u51fd\u6570\u7b7e\u540d\u7684\u4e00\u90e8\u5206 int elem(int) const; \u2003const\u653e\u5728\u53c2\u6570\u5217\u8868\u540e\u9762\uff0c\u4e0e\u653e\u5728\u8fd4\u56de\u503c\u7c7b\u578b\u524d\u9762\u610f\u4e49\u5927\u4e0d\u76f8\u540c\uff0c\u524d\u8005\u8868\u660e\u8be5\u51fd\u6570\u8c03\u7528\u65f6\u4e0d\u4f1a\u4fee\u6539\u4efb\u4f55data member; \u800c\u540e\u8005\u5219\u8868\u660e\u8be5\u51fd\u6570\u8fd4\u56de\u503c\u7c7b\u578b\u4e3aconst\u3002 \u2003\u4e24\u4e2a\u6210\u5458\u51fd\u6570\uff0c\u540d\u5b57\u548c\u53c2\u6570\u8868\u90fd\u4e00\u6837\uff0c\u4f46\u662f\u4e00\u4e2a\u662fconst\uff0c\u4e00\u4e2a\u4e0d\u662f\uff0c\u90a3\u4e48\u7b97\u662f\u91cd\u8f7d\u3002 \u2003\u5f53\u6210\u5458\u51fd\u6570\u7684const\u548cnon-const\u7248\u672c\u540c\u65f6\u5b58\u5728\u65f6(\u51fd\u6570\u91cd\u8f7d)\uff0cconst object\u53ea\u4f1a(\u53ea\u80fd)\u8c03\u7528const\u7248\u672c\uff1b\u800cnon-const object\u4e5f\u53ea\u4f1a(\u53ea\u80fd)\u8c03\u7528non-const\u7248\u672c\uff1b\u82e5\u65e0\u91cd\u8f7d\uff0c\u975e\u5e38\u91cf\u5bf9\u8c61\u53ef\u4ee5\u8c03\u7528\u7c7b\u5b9a\u4e49\u4e2d\u5e38\u91cf\u6210\u5458\u51fd\u6570\u548c\u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570\u3002 \u2003\u5e38\u91cf\u6210\u5458\u51fd\u6570\u4e0d\u80fd\u8c03\u7528\u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570\uff0c\u4f46\u53ef\u4ee5\u8c03\u7528\u9759\u6001\u6210\u5458\u53d8\u91cf\u548c\u51fd\u6570\u3002 \u2003 \u5982\u679c\u7c7b\u7684\u6210\u5458\u51fd\u6570\u4e0d\u4f1a\u6539\u53d8\u5bf9\u8c61\u7684\u72b6\u6001\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6210\u5458\u51fd\u6570\u4e00\u822c\u4f1a\u58f0\u660e\u6210const\u7684\u3002\u4f46\u662f\uff0c\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u5728const\u7684\u51fd\u6570\u91cc\u9762\u4fee\u6539\u4e00\u4e9b\u8ddf\u7c7b\u72b6\u6001\u65e0\u5173\u7684\u6570\u636e\u6210\u5458\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u636e\u6210\u5458\u5c31\u5e94\u8be5\u88ab mutalbe \u6765\u4fee\u9970\u3002","title":"cosnt member fucntion"},{"location":"c_base/const/#const","text":"\u5f53\u7528\u5b9e\u53c2\u521d\u59cb\u5316\u5f62\u53c2\u65f6\u4f1a\u5ffd\u7565\u9876\u5c42const, \u5373\u4f20\u9012\u7ed9\u8be5\u5f62\u53c2\u5e38\u91cf\u5bf9\u8c61\u6216\u975e\u5e38\u91cf\u5bf9\u8c61\u5747\u53ef \u3002\u56e0\u6b64void fcn(const int i)\u3001void fcn(int i)\u672c\u8d28\u4e0a\u662f\u540c\u4e00\u4e2a\u51fd\u6570\uff0c\u4e24\u8005\u4e0d\u80fd\u5171\u5b58\u3002 \u2003 \u5982\u679c\u5f62\u53c2\u662f\u67d0\u79cd\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff0c\u5219\u901a\u8fc7\u533a\u5206\u5176\u6307\u5411\u7684\u662f\u5e38\u91cf\u5bf9\u8c61\u8fd8\u662f\u975e\u5e38\u91cf\u5bf9\u8c61\u53ef\u4ee5\u5b9e\u73b0\u51fd\u6570\u91cd\u8f7d\uff0c\u6b64\u65f6\u7684const\u662f\u5e95\u5c42\u7684.","title":"const\u5f62\u53c2"},{"location":"c_base/const/#const-and-constexpr","text":"\u5bf9\u4e8e\u4fee\u9970Object\u6765\u8bf4\uff0cconst\u5e76\u672a\u533a\u5206\u51fa\u7f16\u8bd1\u671f\u5e38\u91cf\u548c\u8fd0\u884c\u671f\u5e38\u91cf; constexpr\u9650\u5b9a\u5728\u4e86\u7f16\u8bd1\u671f\u5e38\u91cf; \u2003\u5bf9\u4e8e\u4fee\u9970\u51fd\u6570\u6765\u8bf4\uff1a constexpr, \u5982\u679c\u5176\u4f20\u5165\u7684\u53c2\u6570\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u671f\u8ba1\u7b97\u51fa\u6765\uff0c\u90a3\u4e48\u8fd9\u4e2a\u51fd\u6570\u5c31\u4f1a\u4ea7\u751f\u7f16\u8bd1\u65f6\u671f\u7684\u503c\u3002\u4f46\u662f\u4f20\u5165\u7684\u53c2\u6570\u5982\u679c\u4e0d\u80fd\u5728\u7f16\u8bd1\u65f6\u671f\u8ba1\u7b97\u51fa\u6765\uff0c\u90a3\u4e48constexpr\u4fee\u9970\u7684\u51fd\u6570\u5c31\u548c\u666e\u901a\u51fd\u6570\u4e00\u6837\u4e86\u3002 const \u4e00\u822c\u4fee\u9970\u6210\u5458\u51fd\u6570\uff0c\u8868\u793a\u4e0d\u4f1a\u4fee\u6539\u7c7b\u7684\u6210\u5458\u53d8\u91cf\uff08\u9664\u975e\u8be5\u53d8\u91cf\u6709mutable\u4fee\u9970\uff09\u3002","title":"const and constexpr"},{"location":"c_base/const/#_2","text":"\u9876\u5c42const, \u8868\u793a\u4efb\u610f\u7684\u5bf9\u8c61\u662f\u5e38\u91cf\uff1b\u5e95\u5c42const\u5219\u4e0e\u6307\u9488\u3001\u5f15\u7528\u7b49\u590d\u5408\u7c7b\u578b\u7684\u57fa\u672c\u7c7b\u578b\u90e8\u5206\u6709\u5173.","title":"\u8865\u5145"},{"location":"c_base/constructor_destructor/","text":"About Constructor and Destructor Constructor function \u2003constructors\u51fd\u6570\u540d\u79f0\u5fc5\u987b\u4e0eclass\u76f8\u540c\uff0c\u4e0d\u80fd\u6307\u5b9a\u8fd4\u56de\u7c7b\u578b\uff0c\u4ea6\u4e0d\u9700\u4efb\u4f55\u8fd4\u56de\u503c\uff0c\u53ef\u4ee5\u88ab\u91cd\u8f7d\uff1b \u2003\u6784\u9020\u539f\u5219\u5982\u4e0b\uff1a 1. \u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u5b9a\u4e49\u6784\u9020\u65b9\u6cd5\uff0c\u5219\u8c03\u7528\u7236\u7c7b\u7684\u65e0\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u3002 2. \u5982\u679c\u5b50\u7c7b\u5b9a\u4e49\u4e86\u6784\u9020\u65b9\u6cd5\uff0c\u4e0d\u8bba\u662f\u65e0\u53c2\u6570\u8fd8\u662f\u5e26\u53c2\u6570\uff0c\u5728\u521b\u5efa\u5b50\u7c7b\u7684\u5bf9\u8c61\u7684\u65f6\u5019,\u9996\u5148\u6267\u884c\u7236\u7c7b\u65e0\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c \u7136\u540e\u6267\u884c\u81ea\u5df1\u7684\u6784\u9020\u65b9\u6cd5\u3002 3. \u5728\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\u5019\uff0c\u5982\u679c\u5b50\u7c7b\u7684\u6784\u9020\u51fd\u6570\u6ca1\u6709\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u5219\u4f1a\u8c03\u7528\u7236\u7c7b\u7684\u9ed8\u8ba4\u65e0\u53c2\u6784\u9020\u51fd\u6570\u3002 4. \u5728\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\u5019\uff0c\u5982\u679c\u5b50\u7c7b\u7684\u6784\u9020\u51fd\u6570\u6ca1\u6709\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\u4e14\u7236\u7c7b\u81ea\u5df1\u63d0\u4f9b\u4e86\u65e0\u53c2\u6784\u9020\u51fd\u6570\uff0c \u5219\u4f1a\u8c03\u7528\u7236\u7c7b\u81ea\u5df1\u7684\u65e0\u53c2\u6784\u9020\u51fd\u6570\u3002 5. \u5728\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\u5019\uff0c\u5982\u679c\u5b50\u7c7b\u7684\u6784\u9020\u51fd\u6570\u6ca1\u6709\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\u4e14\u7236\u7c7b\u53ea\u5b9a\u4e49\u4e86\u81ea\u5df1\u7684\u6709\u53c2\u6784\u9020\u51fd\u6570\uff0c \u5219\u4f1a\u51fa\u9519\uff08\u5982\u679c\u7236\u7c7b\u53ea\u6709\u6709\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u5219\u5b50\u7c7b\u5fc5\u987b\u663e\u793a\u8c03\u7528\u6b64\u5e26\u53c2\u6784\u9020\u65b9\u6cd5\uff09\u3002 6. \u5982\u679c\u5b50\u7c7b\u8c03\u7528\u7236\u7c7b\u5e26\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u9700\u8981\u5728\u521d\u59cb\u5316\u5217\u8868\u4e2d\u8c03\u7528\u7236\u7c7b\u6784\u9020\u51fd\u6570\u6765\u521d\u59cb\u5316\u7236\u7c7b\u6210\u5458\u5bf9\u8c61\uff0c\u6bd4\u5982\uff1a child(int arg): father(int arg, ...) {xx;}; destructor \u2003\u6790\u6784\u51fd\u6570\uff0c\u5f53object\u7ed3\u675f\u751f\u547d\u65f6\uff0c\u4fbf\u4f1a\u81ea\u52a8\u8c03\u7528destructor\u91ca\u653e\u6784\u9020\u51fd\u6570\u6216\u5bf9\u8c61\u751f\u547d\u5468\u671f\u4e2d\u914d\u7f6e\u7684\u8d44\u6e90\u3002\u6790\u6784\u51fd\u6570\u7684\u540d\u79f0\u4e0e\u7c7b\u7684\u540d\u79f0\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u53ea\u662f\u5728\u524d\u9762\u52a0\u4e86\u4e2a\u6ce2\u6d6a\u53f7\uff08~\uff09\u4f5c\u4e3a\u524d\u7f00\uff0c\u5b83\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u503c\uff0c\u4e5f\u4e0d\u80fd\u5e26\u6709\u4efb\u4f55\u53c2\u6570\uff0c\u56e0\u6b64 \u6790\u6784\u51fd\u6570\u4e0d\u80fd\u88ab\u91cd\u8f7d \u3002 \u2003\u6790\u6784\u51fd\u6570\u81ea\u8eab\u5e76\u4e0d\u76f4\u63a5\u9500\u6bc1\u6210\u5458\uff0c\u6210\u5458\u662f\u5728\u6790\u6784\u51fd\u6570\u4f53\u4e4b\u540e\u9690\u542b\u7684\u6790\u6784\u9636\u6bb5\u4e2d\u88ab\u9500\u6bc1\u7684\u3002\u6790\u6784\u51fd\u6570\u4f53\u4e00\u822c\u6267\u884c\u8bbe\u8ba1\u8005\u6240\u9700\u7684\u6536\u5c3e\u5de5\u4f5c\u3002","title":"constructor_destructor"},{"location":"c_base/constructor_destructor/#about-constructor-and-destructor","text":"","title":"About Constructor and Destructor"},{"location":"c_base/constructor_destructor/#constructor-function","text":"constructors\u51fd\u6570\u540d\u79f0\u5fc5\u987b\u4e0eclass\u76f8\u540c\uff0c\u4e0d\u80fd\u6307\u5b9a\u8fd4\u56de\u7c7b\u578b\uff0c\u4ea6\u4e0d\u9700\u4efb\u4f55\u8fd4\u56de\u503c\uff0c\u53ef\u4ee5\u88ab\u91cd\u8f7d\uff1b \u2003\u6784\u9020\u539f\u5219\u5982\u4e0b\uff1a 1. \u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u5b9a\u4e49\u6784\u9020\u65b9\u6cd5\uff0c\u5219\u8c03\u7528\u7236\u7c7b\u7684\u65e0\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u3002 2. \u5982\u679c\u5b50\u7c7b\u5b9a\u4e49\u4e86\u6784\u9020\u65b9\u6cd5\uff0c\u4e0d\u8bba\u662f\u65e0\u53c2\u6570\u8fd8\u662f\u5e26\u53c2\u6570\uff0c\u5728\u521b\u5efa\u5b50\u7c7b\u7684\u5bf9\u8c61\u7684\u65f6\u5019,\u9996\u5148\u6267\u884c\u7236\u7c7b\u65e0\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c \u7136\u540e\u6267\u884c\u81ea\u5df1\u7684\u6784\u9020\u65b9\u6cd5\u3002 3. \u5728\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\u5019\uff0c\u5982\u679c\u5b50\u7c7b\u7684\u6784\u9020\u51fd\u6570\u6ca1\u6709\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u5219\u4f1a\u8c03\u7528\u7236\u7c7b\u7684\u9ed8\u8ba4\u65e0\u53c2\u6784\u9020\u51fd\u6570\u3002 4. \u5728\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\u5019\uff0c\u5982\u679c\u5b50\u7c7b\u7684\u6784\u9020\u51fd\u6570\u6ca1\u6709\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\u4e14\u7236\u7c7b\u81ea\u5df1\u63d0\u4f9b\u4e86\u65e0\u53c2\u6784\u9020\u51fd\u6570\uff0c \u5219\u4f1a\u8c03\u7528\u7236\u7c7b\u81ea\u5df1\u7684\u65e0\u53c2\u6784\u9020\u51fd\u6570\u3002 5. \u5728\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\u5019\uff0c\u5982\u679c\u5b50\u7c7b\u7684\u6784\u9020\u51fd\u6570\u6ca1\u6709\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\u4e14\u7236\u7c7b\u53ea\u5b9a\u4e49\u4e86\u81ea\u5df1\u7684\u6709\u53c2\u6784\u9020\u51fd\u6570\uff0c \u5219\u4f1a\u51fa\u9519\uff08\u5982\u679c\u7236\u7c7b\u53ea\u6709\u6709\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u5219\u5b50\u7c7b\u5fc5\u987b\u663e\u793a\u8c03\u7528\u6b64\u5e26\u53c2\u6784\u9020\u65b9\u6cd5\uff09\u3002 6. \u5982\u679c\u5b50\u7c7b\u8c03\u7528\u7236\u7c7b\u5e26\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u9700\u8981\u5728\u521d\u59cb\u5316\u5217\u8868\u4e2d\u8c03\u7528\u7236\u7c7b\u6784\u9020\u51fd\u6570\u6765\u521d\u59cb\u5316\u7236\u7c7b\u6210\u5458\u5bf9\u8c61\uff0c\u6bd4\u5982\uff1a child(int arg): father(int arg, ...) {xx;};","title":"Constructor function"},{"location":"c_base/constructor_destructor/#destructor","text":"\u6790\u6784\u51fd\u6570\uff0c\u5f53object\u7ed3\u675f\u751f\u547d\u65f6\uff0c\u4fbf\u4f1a\u81ea\u52a8\u8c03\u7528destructor\u91ca\u653e\u6784\u9020\u51fd\u6570\u6216\u5bf9\u8c61\u751f\u547d\u5468\u671f\u4e2d\u914d\u7f6e\u7684\u8d44\u6e90\u3002\u6790\u6784\u51fd\u6570\u7684\u540d\u79f0\u4e0e\u7c7b\u7684\u540d\u79f0\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u53ea\u662f\u5728\u524d\u9762\u52a0\u4e86\u4e2a\u6ce2\u6d6a\u53f7\uff08~\uff09\u4f5c\u4e3a\u524d\u7f00\uff0c\u5b83\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u503c\uff0c\u4e5f\u4e0d\u80fd\u5e26\u6709\u4efb\u4f55\u53c2\u6570\uff0c\u56e0\u6b64 \u6790\u6784\u51fd\u6570\u4e0d\u80fd\u88ab\u91cd\u8f7d \u3002 \u2003\u6790\u6784\u51fd\u6570\u81ea\u8eab\u5e76\u4e0d\u76f4\u63a5\u9500\u6bc1\u6210\u5458\uff0c\u6210\u5458\u662f\u5728\u6790\u6784\u51fd\u6570\u4f53\u4e4b\u540e\u9690\u542b\u7684\u6790\u6784\u9636\u6bb5\u4e2d\u88ab\u9500\u6bc1\u7684\u3002\u6790\u6784\u51fd\u6570\u4f53\u4e00\u822c\u6267\u884c\u8bbe\u8ba1\u8005\u6240\u9700\u7684\u6536\u5c3e\u5de5\u4f5c\u3002","title":"destructor"},{"location":"c_base/container/","text":"About Container \u987a\u5e8f\u5bb9\u5668 \u987a\u5e8f\u5bb9\u5668\u7684\u5143\u7d20\u6392\u5217\u548c\u5143\u7d20\u503c\u5927\u5c0f\u65e0\u5173\uff0c\u800c\u662f\u7531\u5143\u7d20\u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d\u7684\u6b21\u5e8f\u51b3\u5b9a\u7684\u3002 \uff08vector, list, deque, forward_list, array\uff09 \u2003\u521d\u59cb\u5316\uff1a\u5f53\u5c06\u4e00\u4e2a\u5bb9\u5668\u521d\u59cb\u5316\u4e3a\u53e6\u4e00\u4e2a\u5bb9\u5668\u7684\u62f7\u8d1d\u65f6\uff0c\u4e24\u4e2a\u5bb9\u5668\u7684\u5bb9\u5668\u7c7b\u578b\u548c\u5143\u7d20\u7c7b\u578b\u90fd\u5fc5\u987b\u76f8\u540c\uff1b\u82e5\u4f20\u9012\u8fed\u4ee3\u5668\u53c2\u6570\u6765\u62f7\u8d1d\u4e00\u4e2a\u8303\u56f4\u65f6\uff0c\u5219\u4e0d\u8981\u6c42\u5bb9\u5668\u7c7b\u578b\u548c\u5143\u7d20\u7c7b\u578b\u76f8\u540c\uff0c\u53ea\u8981\u80fd\u5c06\u62f7\u8d1d\u7684\u5143\u7d20\u8f6c\u6362\u4e3a\u8981\u521d\u59cb\u5316\u7684\u5bb9\u5668\u7684\u5143\u7d20\u7c7b\u578b\u5373\u53ef\u3002 \u2003emplace: \u8c03\u7528\u4e00\u4e2aemplace/emplace_back/emplace_front\u6210\u5458\u51fd\u6570\u65f6\uff0c\u662f\u5c06\u53c2\u6570\u4f20\u9012\u7ed9\u5143\u7d20\u7c7b\u578b\u7684\u6784\u9020\u51fd\u6570\uff0cemplace\u6210\u5458\u4f7f\u7528\u8fd9\u4e9b\u53c2\u6570\u5728\u5bb9\u5668\u7ba1\u7406\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\u76f4\u63a5\u6784\u9020\u5143\u7d20\u3002 \u2003\u6539\u53d8\u5bb9\u5668\u5927\u5c0f\uff1a\uff08\u4e0d\u9002\u7528\u4e8earray\uff09 resize:\u589e\u5927\u6216\u51cf\u5c0f\u5bb9\u5668\uff0c\u65b0\u52a0\u7684\u5143\u7d20\u4f1a\u81ea\u52a8\u8fdb\u884c\u503c\u521d\u59cb\u5316/\u591a\u4f59\u7684\u5143\u7d20\u4f1a\u88ab\u5220\u9664\u3002 reserve: \u6539\u53d8\u5bb9\u5668\u7684\u5bb9\u91cf\u5927\u5c0f\uff0c\u5e76\u4e14\u53ea\u6709\u5f53\u6240\u9700\u5185\u5b58\u7a7a\u95f4\u5927\u5c0f\u5927\u4e8e\u5f53\u524d\u5bb9\u91cf\u65f6\uff0c\u624d\u4f1a\u6539\u53d8\u5bb9\u5668\u7684\u5bb9\u91cf,\u82e5\u5c0f\u4e8e\uff0c\u5e76\u4e0d\u4f1a\u9000\u56de\u5185\u5b58\u7a7a\u95f4\u3002resize\u540c\u7406\uff0c\u53ea\u80fd\u6539\u53d8\u5bb9\u5668\u5185\u5143\u7d20\u4e2a\u6570\uff0c\u4e0d\u6539\u53d8\u5bb9\u5668\u9884\u7559\u7684\u5185\u5b58\u7a7a\u95f4\u3002 \u2003\u5bb9\u5668\u64cd\u4f5c\u53ef\u80fd\u4f7f\u8fed\u4ee3\u5668\u5931\u6548 array \u2003\u867d\u7136\u4e0d\u80fd\u5bf9\u5185\u7f6e\u6570\u7ec4\u7c7b\u578b\u8fdb\u884c\u62f7\u8d1d\u6216\u8005\u5bf9\u8c61\u8d4b\u503c\u64cd\u4f5c\uff0c\u4f46\u5bb9\u5668array\u5e76\u65e0\u6b64\u9650\u5236\uff0c\u53ea\u4e0d\u8fc7\u8981\u6c42\u521d\u59cb\u503c\u7684\u7c7b\u578b\u548c\u5bb9\u5668\u5927\u5c0f\u8981\u76f8\u540c, \u56e0\u4e3a\u4e0e\u5185\u7f6e\u6570\u7ec4\u4e00\u6837\uff0carray\u7684\u5927\u5c0f\u4e5f\u662f\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u5b9a\u4e49\u4e00\u4e2aarray\u65f6\uff0c\u9664\u4e86\u6307\u5b9a\u5143\u7d20\u7c7b\u578b\uff0c\u8fd8\u8981\u6307\u5b9a\u5bb9\u5668\u5927\u5c0f\u3002 vector \u2003vector\u4e0e\u6570\u7ec4\u7c7b\u4f3c\uff0c\u62e5\u6709\u4e00\u6bb5\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5e76\u4e14\u8d77\u59cb\u5730\u5740\u4e0d\u53d8\u3002\u4fbf\u4e8e\u968f\u673a\u8bbf\u95ee\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1)\uff0c\u4f46\u56e0\u4e3a\u5185\u5b58\u7a7a\u95f4\u662f\u8fde\u7eed\u7684\uff0c\u6240\u4ee5\u5728\u8fdb\u5165\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9020\u6210\u5185\u5b58\u5757\u7684\u62f7\u8d1d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n)\u3002\u6b64\u5916\uff0c\u5f53\u6570\u7ec4\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\uff0c\u4f1a\u91c7\u53d6\u6269\u5bb9\uff0c\u901a\u8fc7\u91cd\u65b0\u7533\u8bf7\u4e00\u5757\u66f4\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u8fdb\u884c\u5185\u5b58\u62f7\u8d1d\u3002 \u2003 \u521d\u59cb\u5316 : // 1. \u9ed8\u8ba4\u521d\u59cb\u5316 vector<int> list1; // 2. \u4e24\u79cd\u65b9\u5f0f\u7b49\u4ef7 \uff0clist2 \u521d\u59cb\u5316\u4e3a list \u7684\u62f7\u8d1d vector<int> list2(list); vector<int> list2 = list; // 3. list \u521d\u59cb\u5316\u4e3a\u5217\u8868\u4e2d\u5143\u7d20\u7684\u62f7\u8d1d\uff0c\u5217\u8868\u4e2d\u5143\u7d20\u5fc5\u987b\u4e0e list \u7684\u5143\u7d20\u7c7b\u578b\u76f8\u5bb9 vector<int> list3 = {1,2,3.0,4,5,6,7}; or vector<int> list3 {1,2,3.0,4,5,6,7}; // 4. \u521d\u59cb\u5316\u4e3a\u4e24\u4e2a\u8fed\u4ee3\u5668\u6307\u5b9a\u8303\u56f4\u4e2d\u5143\u7d20\u7684\u62f7\u8d1d\uff0c\u8303\u56f4\u4e2d\u7684\u5143\u7d20\u7c7b\u578b\u5fc5\u987b\u4e0e list3 \u7684\u5143\u7d20\u7c7b\u578b\u76f8\u5bb9\u3002 vector<int> list5(list.begin() + 2, list.end() - 1); // 5. \u9ed8\u8ba4\u503c\u521d\u59cb\u5316\uff0clist \u4e2d\u5c06\u5305\u542b7\u4e2a\u5143\u7d20\uff0c\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u7f3a\u7701\u7684\u503c\u521d\u59cb\u5316 vector<int> ilist5(7); // 6. \u6307\u5b9a\u503c\u521d\u59cb\u5316\uff0cilist5\u88ab\u521d\u59cb\u5316\u4e3a\u5305\u542b7\u4e2a\u503c\u4e3a3\u7684int vector<int> ilist6(7, 3); \u2003 list \u2003list\u5e95\u5c42\u662f\u7531\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\u7684\uff0c\u56e0\u6b64\u5185\u5b58\u7a7a\u95f4\u4e0d\u662f\u8fde\u7eed\u7684\u3002\u6839\u636e\u94fe\u8868\u7684\u5b9e\u73b0\u539f\u7406\uff0cList\u67e5\u8be2\u6548\u7387\u8f83\u4f4e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n)\uff0c\u4f46\u63d2\u5165\u548c\u5220\u9664\u6548\u7387\u8f83\u9ad8\u3002\u53ea\u9700\u8981\u5728\u63d2\u5165\u7684\u5730\u65b9\u66f4\u6539\u6307\u9488\u7684\u6307\u5411\u5373\u53ef\uff0c\u4e0d\u7528\u79fb\u52a8\u6570\u636e\u3002 \u5173\u8054\u5bb9\u5668 \u6309\u5173\u952e\u5b57\u6765\u4fdd\u5b58\u548c\u8bbf\u95ee\u7684\uff0c\u652f\u6301\u9ad8\u6548\u7684\u5173\u952e\u5b57\u67e5\u627e\u548c\u8bbf\u95ee\u3002 \u2003map\u7684\u4e0b\u6807\u64cd\u4f5c: \u5bf9\u4e00\u4e2amap\u4f7f\u7528\u4e0b\u6807\u51c6\u64cd\u4f5c\uff0c\u82e5\u4f7f\u7528\u4e00\u4e2a\u4e0d\u5728\u5bb9\u5668\u4e2d\u7684\u5173\u952e\u5b57\u4f5c\u4e3a\u4e0b\u6807\uff0c\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u5177\u6709\u6b64\u5173\u952e\u5b57\u7684\u5143\u7d20\u5230map\u4e2d\uff0c\u5e76\u8fdb\u884c\u503c\u521d\u59cb\u5316; \u82e5\u4f7f\u7528m.at[k], \u82e5k\u4e0d\u5728map\u4e2d\uff0c \u5219\u4f1a\u629b\u51faout_of_range\u5f02\u5e38\u3002 \u2003\u6709\u5e8f\u5bb9\u5668\uff1a\u4f7f\u7528\u6bd4\u8f83\u51fd\u6570\u6765\u6bd4\u8f83\u5173\u952e\u5b57\uff0c\u4ece\u800c\u5c06\u5143\u7d20\u6309\u987a\u5e8f\u5b58\u50a8\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6bd4\u8f83\u64cd\u4f5c\u662f\u91c7\u7528\u5173\u952e\u5b57\u7c7b\u578b\u7684<\u8fd0\u7b97\u7b26; \u2003\u65e0\u5e8f\u5bb9\u5668\uff1a\u4f7f\u7528\u5173\u952e\u5b57\u7c7b\u578b\u7684==\u8fd0\u7b97\u7b26\u548c\u4e00\u4e2ahash \u7c7b\u578b\u7684\u5bf9\u8c61\u6765\u7ec4\u7ec7\u5bf9\u8c61\uff0c\u56e0\u6b64\u4e0d\u80fd\u76f4\u63a5\u5b9a\u4e49\u5173\u952e\u5b57\u7c7b\u578b\u4e3a\u81ea\u5b9a\u4e49\u7c7b\u7c7b\u578b\u7684\u65e0\u5e8f\u5bb9\u5668\uff0c\u56e0\u4e3a\u7f3a\u5c11hash\u6a21\u677f\uff0c\u6ca1\u6709\u91cd\u8f7d\u201c==\u201d\u8fd0\u7b97\u7b26\uff0c\u6216\u8005\u7f3a\u5c11\u53ef\u4ee5\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u7b49\u7684\u51fd\u6570\u3002 \u4ee5unordered_multiset\u4e3a\u4f8b\uff1a using SD_multiset = unordered_multiset \u5176\u4e2dhasher\u51fd\u6570\u8ba1\u7b97hash\u503c\uff1beqOp\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u7b49\u3002","title":"container"},{"location":"c_base/container/#about-container","text":"","title":"About Container"},{"location":"c_base/container/#_1","text":"\u987a\u5e8f\u5bb9\u5668\u7684\u5143\u7d20\u6392\u5217\u548c\u5143\u7d20\u503c\u5927\u5c0f\u65e0\u5173\uff0c\u800c\u662f\u7531\u5143\u7d20\u6dfb\u52a0\u5230\u5bb9\u5668\u4e2d\u7684\u6b21\u5e8f\u51b3\u5b9a\u7684\u3002 \uff08vector, list, deque, forward_list, array\uff09 \u2003\u521d\u59cb\u5316\uff1a\u5f53\u5c06\u4e00\u4e2a\u5bb9\u5668\u521d\u59cb\u5316\u4e3a\u53e6\u4e00\u4e2a\u5bb9\u5668\u7684\u62f7\u8d1d\u65f6\uff0c\u4e24\u4e2a\u5bb9\u5668\u7684\u5bb9\u5668\u7c7b\u578b\u548c\u5143\u7d20\u7c7b\u578b\u90fd\u5fc5\u987b\u76f8\u540c\uff1b\u82e5\u4f20\u9012\u8fed\u4ee3\u5668\u53c2\u6570\u6765\u62f7\u8d1d\u4e00\u4e2a\u8303\u56f4\u65f6\uff0c\u5219\u4e0d\u8981\u6c42\u5bb9\u5668\u7c7b\u578b\u548c\u5143\u7d20\u7c7b\u578b\u76f8\u540c\uff0c\u53ea\u8981\u80fd\u5c06\u62f7\u8d1d\u7684\u5143\u7d20\u8f6c\u6362\u4e3a\u8981\u521d\u59cb\u5316\u7684\u5bb9\u5668\u7684\u5143\u7d20\u7c7b\u578b\u5373\u53ef\u3002 \u2003emplace: \u8c03\u7528\u4e00\u4e2aemplace/emplace_back/emplace_front\u6210\u5458\u51fd\u6570\u65f6\uff0c\u662f\u5c06\u53c2\u6570\u4f20\u9012\u7ed9\u5143\u7d20\u7c7b\u578b\u7684\u6784\u9020\u51fd\u6570\uff0cemplace\u6210\u5458\u4f7f\u7528\u8fd9\u4e9b\u53c2\u6570\u5728\u5bb9\u5668\u7ba1\u7406\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\u76f4\u63a5\u6784\u9020\u5143\u7d20\u3002 \u2003\u6539\u53d8\u5bb9\u5668\u5927\u5c0f\uff1a\uff08\u4e0d\u9002\u7528\u4e8earray\uff09 resize:\u589e\u5927\u6216\u51cf\u5c0f\u5bb9\u5668\uff0c\u65b0\u52a0\u7684\u5143\u7d20\u4f1a\u81ea\u52a8\u8fdb\u884c\u503c\u521d\u59cb\u5316/\u591a\u4f59\u7684\u5143\u7d20\u4f1a\u88ab\u5220\u9664\u3002 reserve: \u6539\u53d8\u5bb9\u5668\u7684\u5bb9\u91cf\u5927\u5c0f\uff0c\u5e76\u4e14\u53ea\u6709\u5f53\u6240\u9700\u5185\u5b58\u7a7a\u95f4\u5927\u5c0f\u5927\u4e8e\u5f53\u524d\u5bb9\u91cf\u65f6\uff0c\u624d\u4f1a\u6539\u53d8\u5bb9\u5668\u7684\u5bb9\u91cf,\u82e5\u5c0f\u4e8e\uff0c\u5e76\u4e0d\u4f1a\u9000\u56de\u5185\u5b58\u7a7a\u95f4\u3002resize\u540c\u7406\uff0c\u53ea\u80fd\u6539\u53d8\u5bb9\u5668\u5185\u5143\u7d20\u4e2a\u6570\uff0c\u4e0d\u6539\u53d8\u5bb9\u5668\u9884\u7559\u7684\u5185\u5b58\u7a7a\u95f4\u3002 \u2003\u5bb9\u5668\u64cd\u4f5c\u53ef\u80fd\u4f7f\u8fed\u4ee3\u5668\u5931\u6548","title":"\u987a\u5e8f\u5bb9\u5668"},{"location":"c_base/container/#array","text":"\u867d\u7136\u4e0d\u80fd\u5bf9\u5185\u7f6e\u6570\u7ec4\u7c7b\u578b\u8fdb\u884c\u62f7\u8d1d\u6216\u8005\u5bf9\u8c61\u8d4b\u503c\u64cd\u4f5c\uff0c\u4f46\u5bb9\u5668array\u5e76\u65e0\u6b64\u9650\u5236\uff0c\u53ea\u4e0d\u8fc7\u8981\u6c42\u521d\u59cb\u503c\u7684\u7c7b\u578b\u548c\u5bb9\u5668\u5927\u5c0f\u8981\u76f8\u540c, \u56e0\u4e3a\u4e0e\u5185\u7f6e\u6570\u7ec4\u4e00\u6837\uff0carray\u7684\u5927\u5c0f\u4e5f\u662f\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u5b9a\u4e49\u4e00\u4e2aarray\u65f6\uff0c\u9664\u4e86\u6307\u5b9a\u5143\u7d20\u7c7b\u578b\uff0c\u8fd8\u8981\u6307\u5b9a\u5bb9\u5668\u5927\u5c0f\u3002","title":"array"},{"location":"c_base/container/#vector","text":"vector\u4e0e\u6570\u7ec4\u7c7b\u4f3c\uff0c\u62e5\u6709\u4e00\u6bb5\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5e76\u4e14\u8d77\u59cb\u5730\u5740\u4e0d\u53d8\u3002\u4fbf\u4e8e\u968f\u673a\u8bbf\u95ee\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1)\uff0c\u4f46\u56e0\u4e3a\u5185\u5b58\u7a7a\u95f4\u662f\u8fde\u7eed\u7684\uff0c\u6240\u4ee5\u5728\u8fdb\u5165\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9020\u6210\u5185\u5b58\u5757\u7684\u62f7\u8d1d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n)\u3002\u6b64\u5916\uff0c\u5f53\u6570\u7ec4\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\uff0c\u4f1a\u91c7\u53d6\u6269\u5bb9\uff0c\u901a\u8fc7\u91cd\u65b0\u7533\u8bf7\u4e00\u5757\u66f4\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u8fdb\u884c\u5185\u5b58\u62f7\u8d1d\u3002 \u2003 \u521d\u59cb\u5316 : // 1. \u9ed8\u8ba4\u521d\u59cb\u5316 vector<int> list1; // 2. \u4e24\u79cd\u65b9\u5f0f\u7b49\u4ef7 \uff0clist2 \u521d\u59cb\u5316\u4e3a list \u7684\u62f7\u8d1d vector<int> list2(list); vector<int> list2 = list; // 3. list \u521d\u59cb\u5316\u4e3a\u5217\u8868\u4e2d\u5143\u7d20\u7684\u62f7\u8d1d\uff0c\u5217\u8868\u4e2d\u5143\u7d20\u5fc5\u987b\u4e0e list \u7684\u5143\u7d20\u7c7b\u578b\u76f8\u5bb9 vector<int> list3 = {1,2,3.0,4,5,6,7}; or vector<int> list3 {1,2,3.0,4,5,6,7}; // 4. \u521d\u59cb\u5316\u4e3a\u4e24\u4e2a\u8fed\u4ee3\u5668\u6307\u5b9a\u8303\u56f4\u4e2d\u5143\u7d20\u7684\u62f7\u8d1d\uff0c\u8303\u56f4\u4e2d\u7684\u5143\u7d20\u7c7b\u578b\u5fc5\u987b\u4e0e list3 \u7684\u5143\u7d20\u7c7b\u578b\u76f8\u5bb9\u3002 vector<int> list5(list.begin() + 2, list.end() - 1); // 5. \u9ed8\u8ba4\u503c\u521d\u59cb\u5316\uff0clist \u4e2d\u5c06\u5305\u542b7\u4e2a\u5143\u7d20\uff0c\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u7f3a\u7701\u7684\u503c\u521d\u59cb\u5316 vector<int> ilist5(7); // 6. \u6307\u5b9a\u503c\u521d\u59cb\u5316\uff0cilist5\u88ab\u521d\u59cb\u5316\u4e3a\u5305\u542b7\u4e2a\u503c\u4e3a3\u7684int vector<int> ilist6(7, 3);","title":"vector"},{"location":"c_base/container/#list","text":"list\u5e95\u5c42\u662f\u7531\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\u7684\uff0c\u56e0\u6b64\u5185\u5b58\u7a7a\u95f4\u4e0d\u662f\u8fde\u7eed\u7684\u3002\u6839\u636e\u94fe\u8868\u7684\u5b9e\u73b0\u539f\u7406\uff0cList\u67e5\u8be2\u6548\u7387\u8f83\u4f4e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n)\uff0c\u4f46\u63d2\u5165\u548c\u5220\u9664\u6548\u7387\u8f83\u9ad8\u3002\u53ea\u9700\u8981\u5728\u63d2\u5165\u7684\u5730\u65b9\u66f4\u6539\u6307\u9488\u7684\u6307\u5411\u5373\u53ef\uff0c\u4e0d\u7528\u79fb\u52a8\u6570\u636e\u3002","title":"list"},{"location":"c_base/container/#_2","text":"\u6309\u5173\u952e\u5b57\u6765\u4fdd\u5b58\u548c\u8bbf\u95ee\u7684\uff0c\u652f\u6301\u9ad8\u6548\u7684\u5173\u952e\u5b57\u67e5\u627e\u548c\u8bbf\u95ee\u3002 \u2003map\u7684\u4e0b\u6807\u64cd\u4f5c: \u5bf9\u4e00\u4e2amap\u4f7f\u7528\u4e0b\u6807\u51c6\u64cd\u4f5c\uff0c\u82e5\u4f7f\u7528\u4e00\u4e2a\u4e0d\u5728\u5bb9\u5668\u4e2d\u7684\u5173\u952e\u5b57\u4f5c\u4e3a\u4e0b\u6807\uff0c\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u5177\u6709\u6b64\u5173\u952e\u5b57\u7684\u5143\u7d20\u5230map\u4e2d\uff0c\u5e76\u8fdb\u884c\u503c\u521d\u59cb\u5316; \u82e5\u4f7f\u7528m.at[k], \u82e5k\u4e0d\u5728map\u4e2d\uff0c \u5219\u4f1a\u629b\u51faout_of_range\u5f02\u5e38\u3002 \u2003\u6709\u5e8f\u5bb9\u5668\uff1a\u4f7f\u7528\u6bd4\u8f83\u51fd\u6570\u6765\u6bd4\u8f83\u5173\u952e\u5b57\uff0c\u4ece\u800c\u5c06\u5143\u7d20\u6309\u987a\u5e8f\u5b58\u50a8\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6bd4\u8f83\u64cd\u4f5c\u662f\u91c7\u7528\u5173\u952e\u5b57\u7c7b\u578b\u7684<\u8fd0\u7b97\u7b26; \u2003\u65e0\u5e8f\u5bb9\u5668\uff1a\u4f7f\u7528\u5173\u952e\u5b57\u7c7b\u578b\u7684==\u8fd0\u7b97\u7b26\u548c\u4e00\u4e2ahash \u7c7b\u578b\u7684\u5bf9\u8c61\u6765\u7ec4\u7ec7\u5bf9\u8c61\uff0c\u56e0\u6b64\u4e0d\u80fd\u76f4\u63a5\u5b9a\u4e49\u5173\u952e\u5b57\u7c7b\u578b\u4e3a\u81ea\u5b9a\u4e49\u7c7b\u7c7b\u578b\u7684\u65e0\u5e8f\u5bb9\u5668\uff0c\u56e0\u4e3a\u7f3a\u5c11hash\u6a21\u677f\uff0c\u6ca1\u6709\u91cd\u8f7d\u201c==\u201d\u8fd0\u7b97\u7b26\uff0c\u6216\u8005\u7f3a\u5c11\u53ef\u4ee5\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u7b49\u7684\u51fd\u6570\u3002 \u4ee5unordered_multiset\u4e3a\u4f8b\uff1a using SD_multiset = unordered_multiset \u5176\u4e2dhasher\u51fd\u6570\u8ba1\u7b97hash\u503c\uff1beqOp\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u7b49\u3002","title":"\u5173\u8054\u5bb9\u5668"},{"location":"c_base/exception/","text":"About Exception \u5f02\u5e38\u5bf9\u8c61 \u7f16\u8bd1\u5668\u4f7f\u7528\u5f02\u5e38\u629b\u51fa\u8868\u8fbe\u5f0f\u6765\u5bf9\u5f02\u5e38\u5bf9\u8c61\u8fdb\u884c\u62f7\u8d1d\u521d\u59cb\u5316\u3002 \u5f53\u6211\u4eec\u629b\u51fa\u4e00\u6761\u8868\u8fbe\u5f0f\u65f6\uff0c\u8be5\u8868\u8fbe\u5f0f\u7684\u9759\u6001\u7f16\u8bd1\u65f6\u7c7b\u578b\u51b3\u5b9a\u4e86\u5f02\u5e38\u5bf9\u8c61\u7684\u7c7b\u578b\u3002\u56e0\u6b64\u5982\u679c\u4e00\u6761Throw\u8868\u8fbe\u5f0f\u89e3\u5f15\u7528\u4e00\u4e2a\u57fa\u7c7b\u6307\u9488\uff0c\u800c\u8be5\u6307\u9488\u5b9e\u9645\u6307\u5411\u7684\u662f\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff0c\u5219\u629b\u51fa\u7684\u5bf9\u8c61\u88ab\u5207\u6389\u4e00\u90e8\u5206\uff0c\u53ea\u6709\u57fa\u7c7b\u90e8\u5206\u88ab\u629b\u51fa\u3002 \u91cd\u65b0\u629b\u51fa\uff1athrow; \u7a7a\u7684throw\u8bed\u53e5\u53ea\u80fd\u51fa\u73b0\u5728catch\u8bed\u53e5\u6216catch\u8bed\u53e5\u76f4\u63a5\u6216\u95f4\u63a5\u8c03\u7528\u7684\u51fd\u6570\u4e4b\u5185\u3002\u5982\u679c\u5728\u5904\u7406\u4ee3\u7801\u4e4b\u5916\u7684\u533a\u57df\u9047\u5230\u4e86\u7a7athrow\u8bed\u53e5\uff0c\u7f16\u8bd1\u5668\u5c06\u8c03\u7528terminate\u3002 \u4e00\u4e2a\u91cd\u65b0\u629b\u51fa\u8bed\u53e5\u5e76\u4e0d\u6307\u5b9a\u65b0\u7684\u8868\u8fbe\u5f0f\uff0c\u800c\u662f\u5c06\u5f53\u524d\u7684\u5f02\u5e38\u5bf9\u8c61\u6cbf\u7740\u8c03\u7528\u94fe\u5411\u4e0a\u4f20\u9012\u3002 \u6355\u83b7\u6240\u6709\u5f02\u5e38\uff1acatch(...)\uff0c \u53ef\u4ee5\u4e0e\u4efb\u610f\u7c7b\u578b\u7684\u5f02\u5e38\u5339\u914d\u3002 noexcept\u8bf4\u660e\u7b26 \u2003\u6307\u660e\u51fd\u6570\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u7d27\u8ddf\u51fd\u6570\u5f62\u53c2\u5217\u8868\u4e4b\u540e\uff0cconst\u53ca\u5f15\u7528\u9650\u5b9a\u7b26\u4e4b\u540e\uff0cfinal\\override\u6216\u865a\u51fd\u6570\u7684=0\u4e4b\u524d\u3002 \u82e5\u5b9e\u9645\u4e2d\u4ecd\u7136\u53d1\u751f\u4e86\u5f02\u5e38\uff0c\u5219\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u8c03\u7528terminate\u3002 \u5176\u901a\u5e38\u4e0enoexcept\u8fd0\u7b97\u7b26\u6df7\u5408\u4f7f\u7528\uff0c\u540e\u8005\u8fd4\u56de\u503c\u662f\u4e00\u4e2abool\u7c7b\u578b\u7684\u53f3\u503c\u5e38\u91cf\u8868\u8fbe\u5f0f\u3002 void foo() noexcept; // \u7b49\u4ef7\u4e8e void foo() noexcept(true); void swap(Type& x, Type& y) noexcept(noexcept(x.swap())){ x.swap(y); }","title":"exception"},{"location":"c_base/exception/#about-exception","text":"","title":"About Exception"},{"location":"c_base/exception/#_1","text":"\u7f16\u8bd1\u5668\u4f7f\u7528\u5f02\u5e38\u629b\u51fa\u8868\u8fbe\u5f0f\u6765\u5bf9\u5f02\u5e38\u5bf9\u8c61\u8fdb\u884c\u62f7\u8d1d\u521d\u59cb\u5316\u3002 \u5f53\u6211\u4eec\u629b\u51fa\u4e00\u6761\u8868\u8fbe\u5f0f\u65f6\uff0c\u8be5\u8868\u8fbe\u5f0f\u7684\u9759\u6001\u7f16\u8bd1\u65f6\u7c7b\u578b\u51b3\u5b9a\u4e86\u5f02\u5e38\u5bf9\u8c61\u7684\u7c7b\u578b\u3002\u56e0\u6b64\u5982\u679c\u4e00\u6761Throw\u8868\u8fbe\u5f0f\u89e3\u5f15\u7528\u4e00\u4e2a\u57fa\u7c7b\u6307\u9488\uff0c\u800c\u8be5\u6307\u9488\u5b9e\u9645\u6307\u5411\u7684\u662f\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff0c\u5219\u629b\u51fa\u7684\u5bf9\u8c61\u88ab\u5207\u6389\u4e00\u90e8\u5206\uff0c\u53ea\u6709\u57fa\u7c7b\u90e8\u5206\u88ab\u629b\u51fa\u3002 \u91cd\u65b0\u629b\u51fa\uff1athrow; \u7a7a\u7684throw\u8bed\u53e5\u53ea\u80fd\u51fa\u73b0\u5728catch\u8bed\u53e5\u6216catch\u8bed\u53e5\u76f4\u63a5\u6216\u95f4\u63a5\u8c03\u7528\u7684\u51fd\u6570\u4e4b\u5185\u3002\u5982\u679c\u5728\u5904\u7406\u4ee3\u7801\u4e4b\u5916\u7684\u533a\u57df\u9047\u5230\u4e86\u7a7athrow\u8bed\u53e5\uff0c\u7f16\u8bd1\u5668\u5c06\u8c03\u7528terminate\u3002 \u4e00\u4e2a\u91cd\u65b0\u629b\u51fa\u8bed\u53e5\u5e76\u4e0d\u6307\u5b9a\u65b0\u7684\u8868\u8fbe\u5f0f\uff0c\u800c\u662f\u5c06\u5f53\u524d\u7684\u5f02\u5e38\u5bf9\u8c61\u6cbf\u7740\u8c03\u7528\u94fe\u5411\u4e0a\u4f20\u9012\u3002 \u6355\u83b7\u6240\u6709\u5f02\u5e38\uff1acatch(...)\uff0c \u53ef\u4ee5\u4e0e\u4efb\u610f\u7c7b\u578b\u7684\u5f02\u5e38\u5339\u914d\u3002","title":"\u5f02\u5e38\u5bf9\u8c61"},{"location":"c_base/exception/#noexcept","text":"\u6307\u660e\u51fd\u6570\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u7d27\u8ddf\u51fd\u6570\u5f62\u53c2\u5217\u8868\u4e4b\u540e\uff0cconst\u53ca\u5f15\u7528\u9650\u5b9a\u7b26\u4e4b\u540e\uff0cfinal\\override\u6216\u865a\u51fd\u6570\u7684=0\u4e4b\u524d\u3002 \u82e5\u5b9e\u9645\u4e2d\u4ecd\u7136\u53d1\u751f\u4e86\u5f02\u5e38\uff0c\u5219\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u8c03\u7528terminate\u3002 \u5176\u901a\u5e38\u4e0enoexcept\u8fd0\u7b97\u7b26\u6df7\u5408\u4f7f\u7528\uff0c\u540e\u8005\u8fd4\u56de\u503c\u662f\u4e00\u4e2abool\u7c7b\u578b\u7684\u53f3\u503c\u5e38\u91cf\u8868\u8fbe\u5f0f\u3002 void foo() noexcept; // \u7b49\u4ef7\u4e8e void foo() noexcept(true); void swap(Type& x, Type& y) noexcept(noexcept(x.swap())){ x.swap(y); }","title":"noexcept\u8bf4\u660e\u7b26"},{"location":"c_base/friend_template/","text":"About friend and template friend \u2003\u5728\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u628a\u4e00\u4e9b\u51fd\u6570\uff08\u5305\u62ec\u5168\u5c40\u51fd\u6570\u548c\u5176\u4ed6\u7c7b\u7684\u6210\u5458\u51fd\u6570\uff09\u58f0\u660e\u4e3a\u201c\u53cb\u5143\u201d\uff0c\u8fd9\u6837\u90a3\u4e9b\u51fd\u6570\u5c31\u6210\u4e3a\u8be5\u7c7b\u7684\u53cb\u5143\u51fd\u6570\uff0c\u5728\u53cb\u5143\u51fd\u6570\u5185\u90e8\u5c31\u53ef\u4ee5\u8bbf\u95ee\u8be5\u7c7b\u5bf9\u8c61\u7684\u79c1\u6709\u6210\u5458\u4e86\u3002 \u5c06\u5168\u5c40\u51fd\u6570\u58f0\u660e\u4e3a\u53cb\u5143\u7684\u5199\u6cd5\u5982\u4e0b\uff1a friend \u8fd4\u56de\u503c\u7c7b\u578b \u51fd\u6570\u540d(\u53c2\u6570\u8868); \u5c06\u5176\u4ed6\u7c7b\u7684\u6210\u5458\u51fd\u6570\u58f0\u660e\u4e3a\u53cb\u5143\u7684\u5199\u6cd5\u5982\u4e0b\uff1a friend \u8fd4\u56de\u503c\u7c7b\u578b \u5176\u4ed6\u7c7b\u7684\u7c7b\u540d::\u6210\u5458\u51fd\u6570\u540d(\u53c2\u6570\u8868); \u4f46\u662f\uff0c\u4e0d\u80fd\u628a\u5176\u4ed6\u7c7b\u7684\u79c1\u6709\u6210\u5458\u51fd\u6570\u58f0\u660e\u4e3a\u53cb\u5143. \u2003\u53cb\u5143\u7684\u58f0\u660e\uff1a\u53ea\u80fd\u51fa\u73b0\u5728\u7c7b\u5b9a\u4e49\u7684\u5185\u90e8\uff0c\u5728\u7c7b\u5185\u51fa\u73b0\u7684\u4f4d\u7f6e\u4e0d\u9650\uff1b\u53cb\u5143\u4e0d\u662f\u7c7b\u7684\u6210\u5458\uff0c\u4e5f\u4e0d\u53d7\u5b83\u6240\u5728\u533a\u57df\u8bbf\u95ee\u63a7\u5236\u7ea7\u522b\u7684\u7ea6\u675f\uff1b\u53cb\u5143\u7684\u58f0\u660e\u4ec5\u4ec5\u6307\u5b9a\u4e86\u8bbf\u95ee\u7684\u6743\u9650\uff0c\u800c\u975e\u4e00\u4e2a\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u51fd\u6570\u58f0\u660e\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u7c7b\u7684\u7528\u6237\u80fd\u8c03\u7528\u67d0\u4e2a\u53cb\u5143\u51fd\u6570\uff0c\u5fc5\u987b\u5728\u53cb\u5143\u58f0\u660e\u4e4b\u5916\u518d\u4e13\u95e8\u5bf9\u51fd\u6570\u8fdb\u884c\u4e00\u6b21\u58f0\u660e\u3002 \u2003\u4e00\u4e2a\u7c7b A \u53ef\u4ee5\u5c06\u53e6\u4e00\u4e2a\u7c7b B \u58f0\u660e\u4e3a\u81ea\u5df1\u7684\u53cb\u5143\uff0c\u7c7b B \u7684\u6240\u6709\u6210\u5458\u51fd\u6570\u5c31\u90fd\u53ef\u4ee5\u8bbf\u95ee\u7c7b A \u5bf9\u8c61\u7684\u79c1\u6709\u6210\u5458\u3002\u5728\u7c7b\u5b9a\u4e49\u4e2d\u58f0\u660e\u53cb\u5143\u7c7b\u7684\u5199\u6cd5\u5982\u4e0b\uff1a friend class \u7c7b\u540d; template \u7c7b\u6a21\u677f\uff1a\u4e00\u4e2a\u7c7b\u6a21\u677f(\u7c7b\u751f\u6210\u7c7b)\u5141\u8bb8\u7528\u6237\u4e3a\u7c7b\u5b9a\u4e49\u4e2a\u4e00\u79cd\u6a21\u5f0f\uff0c\u4f7f\u5f97\u7c7b\u4e2d\u7684\u67d0\u4e9b\u6570\u636e\u6210\u5458\u3001\u9ed8\u8ba4\u6210\u5458\u51fd\u6570\u7684\u53c2\u6570\uff0c\u67d0\u4e9b\u6210\u5458\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u80fd\u591f\u53d6\u4efb\u610f\u7c7b\u578b(\u5305\u62ec\u7cfb\u7edf\u9884\u5b9a\u4e49\u7684\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u7684)\u3002\u5982\u679c\u4e00\u4e2a\u7c7b\u4e2d\u7684\u6570\u636e\u6210\u5458\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u80fd\u786e\u5b9a\uff0c\u6216\u8005\u662f\u67d0\u4e2a\u6210\u5458\u51fd\u6570\u7684\u53c2\u6570\u6216\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u4e0d\u80fd\u786e\u5b9a\uff0c\u5c31\u5fc5\u987b\u5c06\u6b64\u7c7b\u58f0\u660e\u4e3a\u6a21\u677f\uff0c\u5b83\u7684\u5b58\u5728\u4e0d\u662f\u4ee3\u8868\u4e00\u4e2a\u5177\u4f53\u7684\u3001\u5b9e\u9645\u7684\u7c7b\uff0c\u800c\u662f\u4ee3\u8868\u4e00\u7c7b\u7c7b\u3002 \u901a\u8fc7 typename \u6216 class \u5173\u952e\u5b57\u5c06T\u89c6\u4e3a\u4e00\u79cd\u672a\u77e5\u7c7b\u578b \u7c7b\u6a21\u677f\u7684\u58f0\u660e\u548c\u5b9e\u73b0\u8981\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u5426\u5219\uff0c\u4f1a\u51fa\u73b0\u8fde\u63a5\u9519\u8bef\u3002 C++ - \u7c7b\u6a21\u677f(class template)\u53cb\u5143(friend) \u7684 \u5168\u90e8\u516d\u79cd\u5f62\u5f0f \u53ca\u4ee3\u7801 #include <iostream> #include <string> template <typename T> class Pal; //\u6a21\u677f\u7c7b\u7684\u524d\u7f6e\u58f0\u660e class C { friend class Pal<C>; //\"\u4ee5\u7c7bC\u5b9e\u4f8b\u5316\"\u7684Pal\u7c7b, \u4e3aC\u7684\u53cb\u5143 template <typename T> friend class Pal2; //Pal2\u7c7b\u7684\u6240\u6709\u5b9e\u4f8b\u5316, \u90fd\u4e3aC\u7684\u53cb\u5143 private: void print() { std::cout << \"class C\" << std::endl; } }; template <typename T> class C2 { friend class Pal<T>; //\"\u4e0eC2\u7c7b\u76f8\u540c\u5b9e\u4f8b\u5316\"\u7684Pal\u7c7b, \u4e3aC2\u7684\u53cb\u5143 //Pal2\u7c7b\u7684\u6240\u6709\u5b9e\u4f8b\u5316, \u90fd\u4e3aC2\u7684\u53cb\u5143, \u6ce8\u610f\u6a21\u677f\u53c2\u6570(X)\u4e0d\u80fd\u76f8\u540c template <typename X> friend class Pal2; friend class Pal3; //\u666e\u901a\u53cb\u5143 friend T; //C++11 \u6a21\u677f\u7c7b\u578b\u53c2\u6570\u53cb\u5143 private: void print() { std::cout << \"class C2\" << std::endl; } }; template <typename T> class Pal { C myC; C2<T> myC2; //\u5fc5\u987b\u4e3aT //C2<double> myC2; //\u5b9e\u4f8b\u5316\u4e0d\u540c, \u65e0\u6cd5\u4f7f\u7528 public: void printC() { std::cout << \"this is class Pal : \"; myC.print(); } void printC2() { std::cout << \"this is class Pal : \"; myC2.print(); } }; template <typename T> class Pal2 { C myC; C2<double> myC2; public: void printC() { std::cout << \"this is class Pal2 : \"; myC.print(); } void printC2() { std::cout << \"this is class Pal2 : \"; myC2.print(); } }; class Pal3 { C2<double> myC2; public: void printC2() { std::cout << \"this is class Pal3 : \"; myC2.print(); } }; class Pal4 { C2<Pal4> myC2; //\u6ce8\u610fPal4\u662fC2\u7c7b\u7684\u6a21\u677f\u53c2\u6570 public: void printC2() { std::cout << \"this is class Pal4 : \"; myC2.print(); } }; int main (void) { Pal<C> pc; //Pal\u7c7b\u5fc5\u987b\u5b9e\u4f8b\u5316\u4e3aC pc.printC(); //\u53ef\u4ee5\u4f7f\u7528 //Pal<int> pci; //pci.print(); //\u62a5\u9519, \u8bbf\u95ee\u4e86\u79c1\u6709\u6210\u5458 Pal2<int> pi2; //Pal2\u7c7b\u53ef\u4ee5\u968f\u610f\u5b9e\u4f8b\u5316 pi2.printC(); Pal<int> pi; //\u6709\u76f8\u540c\u7684\u793a\u4f8b\u5316, \u5728\u7c7b\u58f0\u660eC2<T> pi.printC2(); pi2.printC2(); //\u6ce8\u610f, Pal2\u7c7b\u88ab\u5b9e\u4f8b\u5316\u4e3a<int>, \u5185\u90e8C2\u7c7b\u88ab\u5b9e\u4f8b\u5316\u4e3a<double>; Pal3 p3; p3.printC2(); Pal4 p4; p4.printC2(); return 0; } typename \u58f0\u660e\u4e00\u4e2a\u7c7b\u578b \u2003\u9ed8\u8ba4\u60c5\u51b5\uff0cC++\u8bed\u8a00\u5047\u5b9a\u901a\u8fc7\u4f5c\u7528\u57df\u8fd0\u7b97\u7b26\u8bbf\u95ee\u7684\u540d\u5b57\u4e0d\u662f\u7c7b\u578b\uff0c\u800c\u662fstatic\u6210\u5458\uff0c\u5982T::m\uff1b\u4f8b\u5982\u5728\u7c7b\u6a21\u677f\u4e2d\u5982\u679c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7ed3\u6784\u4f53\u6a21\u677f\uff0c\u4e14\u5b58\u5728\u8fd4\u56de\u7c7b\u578b\u4e3a\u8be5\u7ed3\u6784\u4f53\u6307\u9488\u7684\u6210\u5458\u51fd\u6570\uff0c\u5219\u5728\u7c7b\u5916\u5b9e\u73b0\u8be5\u6210\u5458\u51fd\u6570\u5b9a\u4e49\u65f6\uff0c\u9700\u8981\u6309\u7167\u4ee5\u4e0b\u683c\u5f0f\uff1a template<typename T> class A{ private: struct s{ T val; } s* fun(s*); } template<typename T> typename A<T>::s* A<T>::fun(s*){} \u2003\u2003\u6a21\u677f\u4e2d\u4f9d\u8d56\u4e8e\u6a21\u677f\u53c2\u6570\u7684\u540d\u79f0\u5c5e\u4e8edependent name,\u800c\u5176\u5d4c\u5957\u5728\u4e00\u4e2a\u7c7b\u91cc\u9762\u65f6\uff0c\u79f0\u4e3anested dependent name, \u4e0a\u8ff0\u7684A ::s\u5373\u5c5e\u4e8enested dependent name, \u5728\u58f0\u660e\u65f6\u9700\u8981\u7528typename\u58f0\u660e\uff1b \u5f53\u6a21\u677f\u53c2\u6570T\u5df2\u77e5\u65f6\uff0c\u5219\u65e0\u9700typename. // \u6a21\u677f\u7279\u5316 template<> A<double>::s* A<double>::fcn(){..} A<int>::s s1; \u2003\u2003\u5728\u6d3e\u751f\u7c7b\u7684\u57fa\u7c7b\u5217\u8868\u4ee5\u53ca\u6784\u9020\u51fd\u6570\u7684\u57fa\u7c7b\u521d\u59cb\u5316\u5217\u8868\u4e2d\uff0c\u5219\u4e0d\u5141\u8bb8typename template<typename T> class Derived: public Base<T>{ Derived(T t): Base<T>(t){..} } \u5728\u5b9e\u4f8b\u5316\u7c7b\u6a21\u677f\u65f6\uff0c\u7a7a<>\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u6a21\u677f\u5b9e\u53c2 template <class T=int> class Numbers{...}; Numbers<> a; \u63a7\u5236\u5b9e\u4f8b\u5316\uff1a\u7531\u4e8e\u5f53\u6a21\u677f\u88ab\u4f7f\u7528\u65f6\u624d\u4f1a\u8fdb\u884c\u5b9e\u4f8b\u5316\uff0c\u56e0\u6b64\u76f8\u540c\u7684\u5b9e\u4f8b\u53ef\u80fd\u51fa\u73b0\u5728\u591a\u4e2a\u5bf9\u8c61\u6587\u4ef6\u4e2d\uff0c\u5f53\u591a\u4e2a\u72ec\u7acb\u7f16\u8bd1\u7684\u6e90\u6587\u4ef6\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u6a21\u677f\uff0c\u5e76\u63d0\u4f9b\u4e86\u76f8\u540c\u7684\u6a21\u677f\u53c2\u6570\u65f6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5c31\u4f1a\u6709\u8be5\u6a21\u677f\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u9020\u6210\u4e25\u91cd\u7684\u989d\u5916\u5f00\u9500\u3002 \u4f7f\u7528\u663e\u793a\u5b9e\u4f8b\u5316\u6765\u907f\u514d\u4e0a\u8ff0\u5f00\u9500\uff1a extern template declaration; //\u5b9e\u4f8b\u5316\u58f0\u660e template declaration; //\u5b9e\u4f8b\u5316\u5b9a\u4e49 \u2003\u2003declaration\u662f\u4e00\u4e2a\u7c7b\u6216\u51fd\u6570\u58f0\u660e\uff0c\u5176\u4e2d\u6240\u6709\u6a21\u677f\u53c2\u6570\u5df2\u88ab\u66ff\u6362\u4e3a\u6a21\u677f\u5b9e\u53c2\u3002 \u5f53\u7f16\u8bd1\u5668\u9047\u5230extern\u6a21\u677f\u58f0\u660e\u65f6\uff0c\u5b83\u4e0d\u4f1a\u5728\u672c\u6587\u4ef6\u4e2d\u751f\u6210\u5b9e\u4f8b\u5316\u4ee3\u7801\u3002\u5c06\u4e00\u4e2a\u5b9e\u4f8b\u5316\u58f0\u660e\u4e3aextern\u5c31\u8868\u793a\u627f\u8bfa\u5728\u7a0b\u5e8f\u5176\u4ed6\u4f4d\u7f6e\u6709\u8be5\u5b9e\u4f8b\u5316\u7684\u4e00\u4e2a\u975eextern\u58f0\u660e\uff08\u5b9a\u4e49\uff09\u3002 \u5728\u4e00\u4e2a\u7c7b\u6a21\u677f\u7684\u5b9e\u4f8b\u5316\u5b9a\u4e49\u4e2d\uff0c\u6240\u7528\u7c7b\u578b\u5fc5\u987b\u80fd\u7528\u4e8e\u6a21\u677f\u7684\u6240\u6709\u6210\u5458\u51fd\u6570\uff0c\u56e0\u6b64\u7f16\u8bd1\u5668\u4f1a\u5b9e\u4f8b\u5316\u8be5\u7c7b\u7684\u6240\u6709\u6210\u5458\u3002 \u800c\u5728\u5904\u7406\u7c7b\u6a21\u677f\u7684\u666e\u901a\u5b9e\u4f8b\u5316\u65f6\uff0c\u5176\u6210\u5458\u53ea\u6709\u5728\u4f7f\u7528\u65f6\u624d\u88ab\u5b9e\u4f8b\u5316\u3002 \u2003\u5c06\u5b9e\u53c2\u4f20\u9012\u7ed9\u5e26\u6a21\u677f\u7c7b\u578b\u7684\u51fd\u6570\u5b9e\u53c2\u65f6\uff0c\u5f62\u53c2\u548c\u5b9e\u53c2\u4e2d\u7684\u9876\u5c42const\u4f1a\u88ab\u5ffd\u7565\uff1b\u80fd\u591f\u81ea\u52a8\u5e94\u7528\u7684\u7c7b\u578b\u8f6c\u6362\u53ea\u6709const\u8f6c\u6362\uff08\u53ef\u4ee5\u5c06\u4e00\u4e2a\u975econst\u5bf9\u8c61\u7684\u5f15\u7528\u6216\u6307\u9488\u4f20\u9012\u7ed9\u4e00\u4e2aconst\u7684\u5f15\u7528\u6216\u6307\u9488\u5f62\u53c2\uff09\uff0c\u4ee5\u53ca\u6570\u7ec4\u6216\u51fd\u6570\u5230\u6307\u9488\u7684\u8f6c\u6362\uff08\u8981\u6c42\u51fd\u6570\u5f62\u53c2\u4e0d\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u5426\u5219\u6570\u7ec4\u4e0d\u4f1a\u8f6c\u6362\u4e3a\u6307\u9488\uff09\u3002 \u2003\u82e5\u6a21\u677f\u7c7b\u578b\u53c2\u6570\u7528\u4f5c\u591a\u4e2a\u51fd\u6570\u5f62\u53c2\u7684\u7c7b\u578b\uff0c\u7531\u4e8e\u53ea\u5141\u8bb8\u6709\u9650\u7684\u7c7b\u578b\u8f6c\u6362\uff0c\u5219\u4f20\u9012\u7ed9\u8fd9\u4e9b\u5f62\u53c2\u7684\u5b9e\u53c2\u5fc5\u987b\u5177\u6709\u76f8\u540c\u7684\u7c7b\u578b\uff0c\u82e5\u63a8\u65ad\u51fa\u7684\u7c7b\u578b\u4e0d\u5339\u914d\uff0c\u5219\u8c03\u7528\u9519\u8bef\u3002\u5bf9\u4e8e\u51fd\u6570\u6a21\u677f\u4e2d\u7684\u666e\u901a\u7c7b\u578b\u5b9a\u4e49\u7684\u53c2\u6570\uff0c\u5176\u53ef\u4ee5\u6b63\u5e38\u8f6c\u6362\u4e3a\u5bf9\u5e94\u5f62\u53c2\u7684\u7c7b\u578b\u3002 \u6a21\u677f\u7279\u4f8b\u5316 \u2003\u4e00\u4e2a\u7279\u4f8b\u5316\u6a21\u677f\u5c31\u662f\u6a21\u677f\u7684\u4e00\u4e2a\u72ec\u7acb\u7684\u5b9a\u4e49\u6216\u8005\u5b9e\u4f8b\uff0c\u5728\u5176\u4e2d\u4e00\u4e2a\u6216\u591a\u4e2a\u6a21\u677f\u53c2\u6570\u88ab\u6307\u5b9a\u4e3a\u7279\u5b9a\u7684\u7c7b\u578b\u3002 \u51fd\u6570\u6a21\u677f\u7279\u4f8b\u5316\u672c\u8d28\u662f\u4e00\u4e2a\u7279\u4f8b\uff0c\u800c\u975e\u51fd\u6570\u540d\u7684\u4e00\u4e2a\u91cd\u8f7d\u7248\u672c\u3002 \u2003\u6a21\u677f\u7279\u4f8b\u5316\u53c8\u5206\u4e3a\u5168\u7279\u5316\u548c\u504f\u7279\u5316(\u4f8b\u5982\u90e8\u5206\u53c2\u6570\u7279\u5316\uff0c\u6216\u8005\u53c2\u6570\u8303\u56f4\u4e0a\u8fdb\u884c\u7279\u5316, < T*>) \u2003\u5bf9\u4e8e\u4e00\u4e9b\u5b9a\u4e49\u5728std namespace\u4e2d\u7684class template \u548c function template\uff0cC++\u5141\u8bb8\u6211\u4eec\u540c\u6837\u5728std namespace\u4e2d\uff0c\u5bf9\u4e24\u8005\u8fdb\u884c\u5168\u7279\u5316\uff0c\u4f46\u53ea\u5141\u8bb8\u5bf9\u524d\u8005\u8fdb\u884c\u504f\u7279\u5316\uff1b\u53ef\u4ee5\u5728name space\u4e2d\u63d0\u4f9bfuntion template\u7684\u91cd\u8f7d\u7248\u672c\uff0c\u4e0d\u8fc7\u6700\u597d\u5728\u81ea\u5b9a\u4e49namespace\u65f6\u4e2d\u5b9e\u73b0 funtion template\u7684\u504f\u7279\u5316\u7248\u672c \u6807\u51c6\u5e93\u6a21\u677ffunction \u2003 function f(obj) or function f=obj; //f\u4e2d\u5b58\u50a8\u4e86\u51fd\u6570\u7c7b\u578b\u4e3aT\u7684\u53ef\u8c03\u7528\u5bf9\u8c61obj\u7684\u526f\u672c\u3002 obj\u53ef\u4ee5\u662f\u51fd\u6570\u6307\u9488\u3001\u51fd\u6570\u5bf9\u8c61\u7c7b\u7684\u5bf9\u8c61\u3001lambda. \u56e0\u6b64\u5bf9\u4e8e\u4e0d\u662f\u53ef\u8c03\u7528\u5bf9\u8c61\u7684\u6210\u5458\u51fd\u6570\u6307\u9488,\u53ef\u4ee5\u901a\u8fc7function\u751f\u6210\u4e00\u4e2a\u6210\u5458\u51fd\u6570\u7684\u53ef\u8c03\u7528\u5bf9\u8c61\u3002 function<bool (const string&)> fcn = &string::empty; auto fcn = mem_fn(&string::empty); // mem_fn\u53ef\u4ee5\u6839\u636e\u6210\u5458\u6307\u9488\u7684\u7c7b\u578b\u63a8\u65ad\u53ef\u8c03\u7528\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u65e0\u987b\u7528\u6237\u663e\u5f0f\u6307\u5b9a\u3002 Alias Template template <typename T> using Vec = std::vector<T, MyAlloc<t>>; Vec<int> coll; //\u7b49\u4ef7\u4e8e std::vector<int, Myalloc<int>> coll; // \u8fd9\u91cc\u65e0\u6cd5\u91c7\u7528macro\u6216\u8005typedef,\u524d\u8005\u53ea\u662f\u7b80\u5355\u7684\u66ff\u6362\uff1b\u540e\u8005\u4e0d\u80fd\u63a5\u53d7\u53c2\u6570 \u2003 \u601d\u8003:\u5728\u6a21\u677f\u63a5\u53d7\u4e00\u4e2atemplate\u53c2\u6570Container\u65f6\uff0c\u5f53Container\u672c\u8eab\u53c8\u662f\u4e00\u4e2aclass template,\u5982\u4f55\u53d6\u51fa\u5176template\u53c2\u6570\uff0c\u4f8b\u5982\u63a5\u53d7vector , \u53d6\u51fa\u5176\u5143\u7d20\u7c7b\u578b\u3002 // function template+iterator+traits template<typename Container> void test(Contrainer c){ typedef typename iterator_traits<typename Container::iterator>::value_type Valtype; ... } // template template parameter + alias template template<typename T, template<class> class Container> class X{ private: Container<T> c; }; template<typename T> using Vec=vector<T, allocator<T>> //\u4e0d\u80fd\u518dfunction body\u4e2d\u58f0\u660e X<string, Vec> x1; variadic template \u2003\u63a5\u53d7\u53ef\u53d8\u6570\u76ee\u53c2\u6570\u7684\u6a21\u677f\u51fd\u6570\u6216\u6a21\u677f\u7c7b\uff0c\u53ef\u53d8\u6570\u76ee\u7684\u53c2\u6570\u88ab\u79f0\u4e3a\u53c2\u6570\u5305\u3002 \u6a21\u677f\u53c2\u6570\u5305: class...\u6216typename...\u6307\u51fa\u63a5\u4e0b\u6765\u7684\u53c2\u6570\u8868\u793a\u96f6\u4e2a\u6216\u591a\u4e2a\u7c7b\u578b\u7684\u5217\u8868\uff1b \u51fd\u6570\u53c2\u6570\u5305: \u4e00\u4e2a\u7c7b\u578b\u540d\u540e\u9762\u8ddf\u4e00\u4e2a\u7701\u7565\u53f7\u8868\u793a\u96f6\u4e2a\u6216\u591a\u4e2a\u7ed9\u5b9a\u7c7b\u578b\u7684\u975e\u7c7b\u578b\u53c2\u6570\u7684\u5217\u8868\u3002 sizeof...(): \u8fd0\u7b97\u7b26\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u53c2\u6570\u5305\u4e2d\u5143\u7d20\u6570\u76ee\u3002 // example 1 void printX(){} // to end the recursion, the non-template overload of printX is provided. template<typename T, typename... Types> void printX(const T& first, const Types&... args){ cout << first<<endl>; printX(args...); } // template <typename... Types> void printX(const Types&... args){} \u53ef\u4ee5\u548c\u4e0a\u9762\u5e76\u5b58\uff0c\u4f46\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u8c03\u7528\uff0c\u56e0\u4e3a\u4e0a\u9762\u7684\u5c5e\u4e8e\u7279\u5316\u7248\u672c // example 2 //\u4f8b2\u4e2d\u7684Head::type\u4e0d\u80fd\u88ab\u7f16\u8bd1\u901a\u8fc7\uff0c \u5e94\u4fee\u6539\u4e3a\u4e0b\u9762 // example 3","title":"friend_template"},{"location":"c_base/friend_template/#about-friend-and-template","text":"","title":"About friend and template"},{"location":"c_base/friend_template/#friend","text":"\u5728\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u628a\u4e00\u4e9b\u51fd\u6570\uff08\u5305\u62ec\u5168\u5c40\u51fd\u6570\u548c\u5176\u4ed6\u7c7b\u7684\u6210\u5458\u51fd\u6570\uff09\u58f0\u660e\u4e3a\u201c\u53cb\u5143\u201d\uff0c\u8fd9\u6837\u90a3\u4e9b\u51fd\u6570\u5c31\u6210\u4e3a\u8be5\u7c7b\u7684\u53cb\u5143\u51fd\u6570\uff0c\u5728\u53cb\u5143\u51fd\u6570\u5185\u90e8\u5c31\u53ef\u4ee5\u8bbf\u95ee\u8be5\u7c7b\u5bf9\u8c61\u7684\u79c1\u6709\u6210\u5458\u4e86\u3002 \u5c06\u5168\u5c40\u51fd\u6570\u58f0\u660e\u4e3a\u53cb\u5143\u7684\u5199\u6cd5\u5982\u4e0b\uff1a friend \u8fd4\u56de\u503c\u7c7b\u578b \u51fd\u6570\u540d(\u53c2\u6570\u8868); \u5c06\u5176\u4ed6\u7c7b\u7684\u6210\u5458\u51fd\u6570\u58f0\u660e\u4e3a\u53cb\u5143\u7684\u5199\u6cd5\u5982\u4e0b\uff1a friend \u8fd4\u56de\u503c\u7c7b\u578b \u5176\u4ed6\u7c7b\u7684\u7c7b\u540d::\u6210\u5458\u51fd\u6570\u540d(\u53c2\u6570\u8868); \u4f46\u662f\uff0c\u4e0d\u80fd\u628a\u5176\u4ed6\u7c7b\u7684\u79c1\u6709\u6210\u5458\u51fd\u6570\u58f0\u660e\u4e3a\u53cb\u5143. \u2003\u53cb\u5143\u7684\u58f0\u660e\uff1a\u53ea\u80fd\u51fa\u73b0\u5728\u7c7b\u5b9a\u4e49\u7684\u5185\u90e8\uff0c\u5728\u7c7b\u5185\u51fa\u73b0\u7684\u4f4d\u7f6e\u4e0d\u9650\uff1b\u53cb\u5143\u4e0d\u662f\u7c7b\u7684\u6210\u5458\uff0c\u4e5f\u4e0d\u53d7\u5b83\u6240\u5728\u533a\u57df\u8bbf\u95ee\u63a7\u5236\u7ea7\u522b\u7684\u7ea6\u675f\uff1b\u53cb\u5143\u7684\u58f0\u660e\u4ec5\u4ec5\u6307\u5b9a\u4e86\u8bbf\u95ee\u7684\u6743\u9650\uff0c\u800c\u975e\u4e00\u4e2a\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u51fd\u6570\u58f0\u660e\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u7c7b\u7684\u7528\u6237\u80fd\u8c03\u7528\u67d0\u4e2a\u53cb\u5143\u51fd\u6570\uff0c\u5fc5\u987b\u5728\u53cb\u5143\u58f0\u660e\u4e4b\u5916\u518d\u4e13\u95e8\u5bf9\u51fd\u6570\u8fdb\u884c\u4e00\u6b21\u58f0\u660e\u3002 \u2003\u4e00\u4e2a\u7c7b A \u53ef\u4ee5\u5c06\u53e6\u4e00\u4e2a\u7c7b B \u58f0\u660e\u4e3a\u81ea\u5df1\u7684\u53cb\u5143\uff0c\u7c7b B \u7684\u6240\u6709\u6210\u5458\u51fd\u6570\u5c31\u90fd\u53ef\u4ee5\u8bbf\u95ee\u7c7b A \u5bf9\u8c61\u7684\u79c1\u6709\u6210\u5458\u3002\u5728\u7c7b\u5b9a\u4e49\u4e2d\u58f0\u660e\u53cb\u5143\u7c7b\u7684\u5199\u6cd5\u5982\u4e0b\uff1a friend class \u7c7b\u540d;","title":"friend"},{"location":"c_base/friend_template/#template","text":"\u7c7b\u6a21\u677f\uff1a\u4e00\u4e2a\u7c7b\u6a21\u677f(\u7c7b\u751f\u6210\u7c7b)\u5141\u8bb8\u7528\u6237\u4e3a\u7c7b\u5b9a\u4e49\u4e2a\u4e00\u79cd\u6a21\u5f0f\uff0c\u4f7f\u5f97\u7c7b\u4e2d\u7684\u67d0\u4e9b\u6570\u636e\u6210\u5458\u3001\u9ed8\u8ba4\u6210\u5458\u51fd\u6570\u7684\u53c2\u6570\uff0c\u67d0\u4e9b\u6210\u5458\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u80fd\u591f\u53d6\u4efb\u610f\u7c7b\u578b(\u5305\u62ec\u7cfb\u7edf\u9884\u5b9a\u4e49\u7684\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u7684)\u3002\u5982\u679c\u4e00\u4e2a\u7c7b\u4e2d\u7684\u6570\u636e\u6210\u5458\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u80fd\u786e\u5b9a\uff0c\u6216\u8005\u662f\u67d0\u4e2a\u6210\u5458\u51fd\u6570\u7684\u53c2\u6570\u6216\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u4e0d\u80fd\u786e\u5b9a\uff0c\u5c31\u5fc5\u987b\u5c06\u6b64\u7c7b\u58f0\u660e\u4e3a\u6a21\u677f\uff0c\u5b83\u7684\u5b58\u5728\u4e0d\u662f\u4ee3\u8868\u4e00\u4e2a\u5177\u4f53\u7684\u3001\u5b9e\u9645\u7684\u7c7b\uff0c\u800c\u662f\u4ee3\u8868\u4e00\u7c7b\u7c7b\u3002 \u901a\u8fc7 typename \u6216 class \u5173\u952e\u5b57\u5c06T\u89c6\u4e3a\u4e00\u79cd\u672a\u77e5\u7c7b\u578b \u7c7b\u6a21\u677f\u7684\u58f0\u660e\u548c\u5b9e\u73b0\u8981\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u5426\u5219\uff0c\u4f1a\u51fa\u73b0\u8fde\u63a5\u9519\u8bef\u3002 C++ - \u7c7b\u6a21\u677f(class template)\u53cb\u5143(friend) \u7684 \u5168\u90e8\u516d\u79cd\u5f62\u5f0f \u53ca\u4ee3\u7801 #include <iostream> #include <string> template <typename T> class Pal; //\u6a21\u677f\u7c7b\u7684\u524d\u7f6e\u58f0\u660e class C { friend class Pal<C>; //\"\u4ee5\u7c7bC\u5b9e\u4f8b\u5316\"\u7684Pal\u7c7b, \u4e3aC\u7684\u53cb\u5143 template <typename T> friend class Pal2; //Pal2\u7c7b\u7684\u6240\u6709\u5b9e\u4f8b\u5316, \u90fd\u4e3aC\u7684\u53cb\u5143 private: void print() { std::cout << \"class C\" << std::endl; } }; template <typename T> class C2 { friend class Pal<T>; //\"\u4e0eC2\u7c7b\u76f8\u540c\u5b9e\u4f8b\u5316\"\u7684Pal\u7c7b, \u4e3aC2\u7684\u53cb\u5143 //Pal2\u7c7b\u7684\u6240\u6709\u5b9e\u4f8b\u5316, \u90fd\u4e3aC2\u7684\u53cb\u5143, \u6ce8\u610f\u6a21\u677f\u53c2\u6570(X)\u4e0d\u80fd\u76f8\u540c template <typename X> friend class Pal2; friend class Pal3; //\u666e\u901a\u53cb\u5143 friend T; //C++11 \u6a21\u677f\u7c7b\u578b\u53c2\u6570\u53cb\u5143 private: void print() { std::cout << \"class C2\" << std::endl; } }; template <typename T> class Pal { C myC; C2<T> myC2; //\u5fc5\u987b\u4e3aT //C2<double> myC2; //\u5b9e\u4f8b\u5316\u4e0d\u540c, \u65e0\u6cd5\u4f7f\u7528 public: void printC() { std::cout << \"this is class Pal : \"; myC.print(); } void printC2() { std::cout << \"this is class Pal : \"; myC2.print(); } }; template <typename T> class Pal2 { C myC; C2<double> myC2; public: void printC() { std::cout << \"this is class Pal2 : \"; myC.print(); } void printC2() { std::cout << \"this is class Pal2 : \"; myC2.print(); } }; class Pal3 { C2<double> myC2; public: void printC2() { std::cout << \"this is class Pal3 : \"; myC2.print(); } }; class Pal4 { C2<Pal4> myC2; //\u6ce8\u610fPal4\u662fC2\u7c7b\u7684\u6a21\u677f\u53c2\u6570 public: void printC2() { std::cout << \"this is class Pal4 : \"; myC2.print(); } }; int main (void) { Pal<C> pc; //Pal\u7c7b\u5fc5\u987b\u5b9e\u4f8b\u5316\u4e3aC pc.printC(); //\u53ef\u4ee5\u4f7f\u7528 //Pal<int> pci; //pci.print(); //\u62a5\u9519, \u8bbf\u95ee\u4e86\u79c1\u6709\u6210\u5458 Pal2<int> pi2; //Pal2\u7c7b\u53ef\u4ee5\u968f\u610f\u5b9e\u4f8b\u5316 pi2.printC(); Pal<int> pi; //\u6709\u76f8\u540c\u7684\u793a\u4f8b\u5316, \u5728\u7c7b\u58f0\u660eC2<T> pi.printC2(); pi2.printC2(); //\u6ce8\u610f, Pal2\u7c7b\u88ab\u5b9e\u4f8b\u5316\u4e3a<int>, \u5185\u90e8C2\u7c7b\u88ab\u5b9e\u4f8b\u5316\u4e3a<double>; Pal3 p3; p3.printC2(); Pal4 p4; p4.printC2(); return 0; } typename \u58f0\u660e\u4e00\u4e2a\u7c7b\u578b \u2003\u9ed8\u8ba4\u60c5\u51b5\uff0cC++\u8bed\u8a00\u5047\u5b9a\u901a\u8fc7\u4f5c\u7528\u57df\u8fd0\u7b97\u7b26\u8bbf\u95ee\u7684\u540d\u5b57\u4e0d\u662f\u7c7b\u578b\uff0c\u800c\u662fstatic\u6210\u5458\uff0c\u5982T::m\uff1b\u4f8b\u5982\u5728\u7c7b\u6a21\u677f\u4e2d\u5982\u679c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7ed3\u6784\u4f53\u6a21\u677f\uff0c\u4e14\u5b58\u5728\u8fd4\u56de\u7c7b\u578b\u4e3a\u8be5\u7ed3\u6784\u4f53\u6307\u9488\u7684\u6210\u5458\u51fd\u6570\uff0c\u5219\u5728\u7c7b\u5916\u5b9e\u73b0\u8be5\u6210\u5458\u51fd\u6570\u5b9a\u4e49\u65f6\uff0c\u9700\u8981\u6309\u7167\u4ee5\u4e0b\u683c\u5f0f\uff1a template<typename T> class A{ private: struct s{ T val; } s* fun(s*); } template<typename T> typename A<T>::s* A<T>::fun(s*){} \u2003\u2003\u6a21\u677f\u4e2d\u4f9d\u8d56\u4e8e\u6a21\u677f\u53c2\u6570\u7684\u540d\u79f0\u5c5e\u4e8edependent name,\u800c\u5176\u5d4c\u5957\u5728\u4e00\u4e2a\u7c7b\u91cc\u9762\u65f6\uff0c\u79f0\u4e3anested dependent name, \u4e0a\u8ff0\u7684A ::s\u5373\u5c5e\u4e8enested dependent name, \u5728\u58f0\u660e\u65f6\u9700\u8981\u7528typename\u58f0\u660e\uff1b \u5f53\u6a21\u677f\u53c2\u6570T\u5df2\u77e5\u65f6\uff0c\u5219\u65e0\u9700typename. // \u6a21\u677f\u7279\u5316 template<> A<double>::s* A<double>::fcn(){..} A<int>::s s1; \u2003\u2003\u5728\u6d3e\u751f\u7c7b\u7684\u57fa\u7c7b\u5217\u8868\u4ee5\u53ca\u6784\u9020\u51fd\u6570\u7684\u57fa\u7c7b\u521d\u59cb\u5316\u5217\u8868\u4e2d\uff0c\u5219\u4e0d\u5141\u8bb8typename template<typename T> class Derived: public Base<T>{ Derived(T t): Base<T>(t){..} } \u5728\u5b9e\u4f8b\u5316\u7c7b\u6a21\u677f\u65f6\uff0c\u7a7a<>\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u6a21\u677f\u5b9e\u53c2 template <class T=int> class Numbers{...}; Numbers<> a; \u63a7\u5236\u5b9e\u4f8b\u5316\uff1a\u7531\u4e8e\u5f53\u6a21\u677f\u88ab\u4f7f\u7528\u65f6\u624d\u4f1a\u8fdb\u884c\u5b9e\u4f8b\u5316\uff0c\u56e0\u6b64\u76f8\u540c\u7684\u5b9e\u4f8b\u53ef\u80fd\u51fa\u73b0\u5728\u591a\u4e2a\u5bf9\u8c61\u6587\u4ef6\u4e2d\uff0c\u5f53\u591a\u4e2a\u72ec\u7acb\u7f16\u8bd1\u7684\u6e90\u6587\u4ef6\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u6a21\u677f\uff0c\u5e76\u63d0\u4f9b\u4e86\u76f8\u540c\u7684\u6a21\u677f\u53c2\u6570\u65f6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5c31\u4f1a\u6709\u8be5\u6a21\u677f\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u9020\u6210\u4e25\u91cd\u7684\u989d\u5916\u5f00\u9500\u3002 \u4f7f\u7528\u663e\u793a\u5b9e\u4f8b\u5316\u6765\u907f\u514d\u4e0a\u8ff0\u5f00\u9500\uff1a extern template declaration; //\u5b9e\u4f8b\u5316\u58f0\u660e template declaration; //\u5b9e\u4f8b\u5316\u5b9a\u4e49 \u2003\u2003declaration\u662f\u4e00\u4e2a\u7c7b\u6216\u51fd\u6570\u58f0\u660e\uff0c\u5176\u4e2d\u6240\u6709\u6a21\u677f\u53c2\u6570\u5df2\u88ab\u66ff\u6362\u4e3a\u6a21\u677f\u5b9e\u53c2\u3002 \u5f53\u7f16\u8bd1\u5668\u9047\u5230extern\u6a21\u677f\u58f0\u660e\u65f6\uff0c\u5b83\u4e0d\u4f1a\u5728\u672c\u6587\u4ef6\u4e2d\u751f\u6210\u5b9e\u4f8b\u5316\u4ee3\u7801\u3002\u5c06\u4e00\u4e2a\u5b9e\u4f8b\u5316\u58f0\u660e\u4e3aextern\u5c31\u8868\u793a\u627f\u8bfa\u5728\u7a0b\u5e8f\u5176\u4ed6\u4f4d\u7f6e\u6709\u8be5\u5b9e\u4f8b\u5316\u7684\u4e00\u4e2a\u975eextern\u58f0\u660e\uff08\u5b9a\u4e49\uff09\u3002 \u5728\u4e00\u4e2a\u7c7b\u6a21\u677f\u7684\u5b9e\u4f8b\u5316\u5b9a\u4e49\u4e2d\uff0c\u6240\u7528\u7c7b\u578b\u5fc5\u987b\u80fd\u7528\u4e8e\u6a21\u677f\u7684\u6240\u6709\u6210\u5458\u51fd\u6570\uff0c\u56e0\u6b64\u7f16\u8bd1\u5668\u4f1a\u5b9e\u4f8b\u5316\u8be5\u7c7b\u7684\u6240\u6709\u6210\u5458\u3002 \u800c\u5728\u5904\u7406\u7c7b\u6a21\u677f\u7684\u666e\u901a\u5b9e\u4f8b\u5316\u65f6\uff0c\u5176\u6210\u5458\u53ea\u6709\u5728\u4f7f\u7528\u65f6\u624d\u88ab\u5b9e\u4f8b\u5316\u3002 \u2003\u5c06\u5b9e\u53c2\u4f20\u9012\u7ed9\u5e26\u6a21\u677f\u7c7b\u578b\u7684\u51fd\u6570\u5b9e\u53c2\u65f6\uff0c\u5f62\u53c2\u548c\u5b9e\u53c2\u4e2d\u7684\u9876\u5c42const\u4f1a\u88ab\u5ffd\u7565\uff1b\u80fd\u591f\u81ea\u52a8\u5e94\u7528\u7684\u7c7b\u578b\u8f6c\u6362\u53ea\u6709const\u8f6c\u6362\uff08\u53ef\u4ee5\u5c06\u4e00\u4e2a\u975econst\u5bf9\u8c61\u7684\u5f15\u7528\u6216\u6307\u9488\u4f20\u9012\u7ed9\u4e00\u4e2aconst\u7684\u5f15\u7528\u6216\u6307\u9488\u5f62\u53c2\uff09\uff0c\u4ee5\u53ca\u6570\u7ec4\u6216\u51fd\u6570\u5230\u6307\u9488\u7684\u8f6c\u6362\uff08\u8981\u6c42\u51fd\u6570\u5f62\u53c2\u4e0d\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u5426\u5219\u6570\u7ec4\u4e0d\u4f1a\u8f6c\u6362\u4e3a\u6307\u9488\uff09\u3002 \u2003\u82e5\u6a21\u677f\u7c7b\u578b\u53c2\u6570\u7528\u4f5c\u591a\u4e2a\u51fd\u6570\u5f62\u53c2\u7684\u7c7b\u578b\uff0c\u7531\u4e8e\u53ea\u5141\u8bb8\u6709\u9650\u7684\u7c7b\u578b\u8f6c\u6362\uff0c\u5219\u4f20\u9012\u7ed9\u8fd9\u4e9b\u5f62\u53c2\u7684\u5b9e\u53c2\u5fc5\u987b\u5177\u6709\u76f8\u540c\u7684\u7c7b\u578b\uff0c\u82e5\u63a8\u65ad\u51fa\u7684\u7c7b\u578b\u4e0d\u5339\u914d\uff0c\u5219\u8c03\u7528\u9519\u8bef\u3002\u5bf9\u4e8e\u51fd\u6570\u6a21\u677f\u4e2d\u7684\u666e\u901a\u7c7b\u578b\u5b9a\u4e49\u7684\u53c2\u6570\uff0c\u5176\u53ef\u4ee5\u6b63\u5e38\u8f6c\u6362\u4e3a\u5bf9\u5e94\u5f62\u53c2\u7684\u7c7b\u578b\u3002 \u6a21\u677f\u7279\u4f8b\u5316 \u2003\u4e00\u4e2a\u7279\u4f8b\u5316\u6a21\u677f\u5c31\u662f\u6a21\u677f\u7684\u4e00\u4e2a\u72ec\u7acb\u7684\u5b9a\u4e49\u6216\u8005\u5b9e\u4f8b\uff0c\u5728\u5176\u4e2d\u4e00\u4e2a\u6216\u591a\u4e2a\u6a21\u677f\u53c2\u6570\u88ab\u6307\u5b9a\u4e3a\u7279\u5b9a\u7684\u7c7b\u578b\u3002 \u51fd\u6570\u6a21\u677f\u7279\u4f8b\u5316\u672c\u8d28\u662f\u4e00\u4e2a\u7279\u4f8b\uff0c\u800c\u975e\u51fd\u6570\u540d\u7684\u4e00\u4e2a\u91cd\u8f7d\u7248\u672c\u3002 \u2003\u6a21\u677f\u7279\u4f8b\u5316\u53c8\u5206\u4e3a\u5168\u7279\u5316\u548c\u504f\u7279\u5316(\u4f8b\u5982\u90e8\u5206\u53c2\u6570\u7279\u5316\uff0c\u6216\u8005\u53c2\u6570\u8303\u56f4\u4e0a\u8fdb\u884c\u7279\u5316, < T*>) \u2003\u5bf9\u4e8e\u4e00\u4e9b\u5b9a\u4e49\u5728std namespace\u4e2d\u7684class template \u548c function template\uff0cC++\u5141\u8bb8\u6211\u4eec\u540c\u6837\u5728std namespace\u4e2d\uff0c\u5bf9\u4e24\u8005\u8fdb\u884c\u5168\u7279\u5316\uff0c\u4f46\u53ea\u5141\u8bb8\u5bf9\u524d\u8005\u8fdb\u884c\u504f\u7279\u5316\uff1b\u53ef\u4ee5\u5728name space\u4e2d\u63d0\u4f9bfuntion template\u7684\u91cd\u8f7d\u7248\u672c\uff0c\u4e0d\u8fc7\u6700\u597d\u5728\u81ea\u5b9a\u4e49namespace\u65f6\u4e2d\u5b9e\u73b0 funtion template\u7684\u504f\u7279\u5316\u7248\u672c \u6807\u51c6\u5e93\u6a21\u677ffunction \u2003 function f(obj) or function f=obj; //f\u4e2d\u5b58\u50a8\u4e86\u51fd\u6570\u7c7b\u578b\u4e3aT\u7684\u53ef\u8c03\u7528\u5bf9\u8c61obj\u7684\u526f\u672c\u3002 obj\u53ef\u4ee5\u662f\u51fd\u6570\u6307\u9488\u3001\u51fd\u6570\u5bf9\u8c61\u7c7b\u7684\u5bf9\u8c61\u3001lambda. \u56e0\u6b64\u5bf9\u4e8e\u4e0d\u662f\u53ef\u8c03\u7528\u5bf9\u8c61\u7684\u6210\u5458\u51fd\u6570\u6307\u9488,\u53ef\u4ee5\u901a\u8fc7function\u751f\u6210\u4e00\u4e2a\u6210\u5458\u51fd\u6570\u7684\u53ef\u8c03\u7528\u5bf9\u8c61\u3002 function<bool (const string&)> fcn = &string::empty; auto fcn = mem_fn(&string::empty); // mem_fn\u53ef\u4ee5\u6839\u636e\u6210\u5458\u6307\u9488\u7684\u7c7b\u578b\u63a8\u65ad\u53ef\u8c03\u7528\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u65e0\u987b\u7528\u6237\u663e\u5f0f\u6307\u5b9a\u3002","title":"template"},{"location":"c_base/friend_template/#alias-template","text":"template <typename T> using Vec = std::vector<T, MyAlloc<t>>; Vec<int> coll; //\u7b49\u4ef7\u4e8e std::vector<int, Myalloc<int>> coll; // \u8fd9\u91cc\u65e0\u6cd5\u91c7\u7528macro\u6216\u8005typedef,\u524d\u8005\u53ea\u662f\u7b80\u5355\u7684\u66ff\u6362\uff1b\u540e\u8005\u4e0d\u80fd\u63a5\u53d7\u53c2\u6570 \u2003 \u601d\u8003:\u5728\u6a21\u677f\u63a5\u53d7\u4e00\u4e2atemplate\u53c2\u6570Container\u65f6\uff0c\u5f53Container\u672c\u8eab\u53c8\u662f\u4e00\u4e2aclass template,\u5982\u4f55\u53d6\u51fa\u5176template\u53c2\u6570\uff0c\u4f8b\u5982\u63a5\u53d7vector , \u53d6\u51fa\u5176\u5143\u7d20\u7c7b\u578b\u3002 // function template+iterator+traits template<typename Container> void test(Contrainer c){ typedef typename iterator_traits<typename Container::iterator>::value_type Valtype; ... } // template template parameter + alias template template<typename T, template<class> class Container> class X{ private: Container<T> c; }; template<typename T> using Vec=vector<T, allocator<T>> //\u4e0d\u80fd\u518dfunction body\u4e2d\u58f0\u660e X<string, Vec> x1;","title":"Alias Template"},{"location":"c_base/friend_template/#variadic-template","text":"\u63a5\u53d7\u53ef\u53d8\u6570\u76ee\u53c2\u6570\u7684\u6a21\u677f\u51fd\u6570\u6216\u6a21\u677f\u7c7b\uff0c\u53ef\u53d8\u6570\u76ee\u7684\u53c2\u6570\u88ab\u79f0\u4e3a\u53c2\u6570\u5305\u3002 \u6a21\u677f\u53c2\u6570\u5305: class...\u6216typename...\u6307\u51fa\u63a5\u4e0b\u6765\u7684\u53c2\u6570\u8868\u793a\u96f6\u4e2a\u6216\u591a\u4e2a\u7c7b\u578b\u7684\u5217\u8868\uff1b \u51fd\u6570\u53c2\u6570\u5305: \u4e00\u4e2a\u7c7b\u578b\u540d\u540e\u9762\u8ddf\u4e00\u4e2a\u7701\u7565\u53f7\u8868\u793a\u96f6\u4e2a\u6216\u591a\u4e2a\u7ed9\u5b9a\u7c7b\u578b\u7684\u975e\u7c7b\u578b\u53c2\u6570\u7684\u5217\u8868\u3002 sizeof...(): \u8fd0\u7b97\u7b26\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u5e38\u91cf\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u53c2\u6570\u5305\u4e2d\u5143\u7d20\u6570\u76ee\u3002 // example 1 void printX(){} // to end the recursion, the non-template overload of printX is provided. template<typename T, typename... Types> void printX(const T& first, const Types&... args){ cout << first<<endl>; printX(args...); } // template <typename... Types> void printX(const Types&... args){} \u53ef\u4ee5\u548c\u4e0a\u9762\u5e76\u5b58\uff0c\u4f46\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u8c03\u7528\uff0c\u56e0\u4e3a\u4e0a\u9762\u7684\u5c5e\u4e8e\u7279\u5316\u7248\u672c // example 2 //\u4f8b2\u4e2d\u7684Head::type\u4e0d\u80fd\u88ab\u7f16\u8bd1\u901a\u8fc7\uff0c \u5e94\u4fee\u6539\u4e3a\u4e0b\u9762 // example 3","title":"variadic template"},{"location":"c_base/function/","text":"About Function \u51fd\u6570\u6307\u9488 type (*p)(param_list); //p\u6307\u5411\u4e00\u4e2a\u5305\u542bparam_list\u5f62\u53c2\u3001\u8fd4\u56de\u503c\u7c7b\u578btype\u7684\u51fd\u6570\uff1b p = fun_name; //\u51fd\u6570\u540d\u53ef\u4ee5\u81ea\u52a8\u8f6c\u6362\u6210\u6307\u9488 p= &fun_name; //\u4e5f\u53ef\u4ee5\u901a\u8fc7&\u83b7\u53d6 // p(..) \u4e0e (*P)(..)\u662f\u7b49\u6548\u7684\uff0c\u5373\u65e0\u9700\u89e3\u5f15\u7528\u51fd\u6570\u6307\u9488\u5373\u53ef\u8c03\u7528\u8be5\u51fd\u6570\uff1b // another test // \u4e0a\u9762\u7684p\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5176\u7c7b\u578b\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488 typedef type(*T)(param_list //\u8fd9\u91cc\u662f\u4e3a\u51fd\u6570\u6307\u9488\u7c7b\u578b\u91cd\u65b0\u5b9a\u4e49\u4e86\u201cT\u201d\u7c7b\u578b\u540d T t1; t1(...); \u2003\u51fd\u6570\u6307\u9488\u5f62\u53c2\uff1a\u4e0d\u80fd\u5b9a\u4e49\u51fd\u6570\u7c7b\u578b\u7684\u5f62\u53c2\uff0c\u4f46\u662f\u5f62\u53c2\u53ef\u4ee5\u662f\u6307\u5411\u51fd\u6570\u7c7b\u578b\u7684\u6307\u9488\u3002 void foo(type fun(param_list)); or void foo(type(*p)(param_list)); \u91cd\u8f7d(overload) \u2003\u51fd\u6570\u91cd\u8f7d: \u51fd\u6570\u540d\u79f0\u76f8\u540c\uff0c\u4f46\u51fd\u6570\u7b7e\u540d\u4e0d\u540c\uff0c\u51fd\u6570\u7b7e\u540d\u5305\u62ec\u53c2\u6570\u5217\u8868\u3001const\uff08const member fucntion\uff09. const\u5f62\u53c2\uff1a\u4e00\u4e2a\u62e5\u6709\u9876\u5c42const\u7684\u5f62\u53c2\u65e0\u6cd5\u548c\u53e6\u4e00\u4e2a\u6ca1\u6709\u9876\u5c42const\u7684\u5f62\u53c2\u533a\u5206\u5f00\u6765\uff1b \u5982\u679c\u5f62\u53c2\u662f\u67d0\u79cd\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff0c\u5219\u901a\u8fc7\u533a\u5206\u5176\u6307\u5411\u7684\u662f\u5e38\u91cf\u5bf9\u8c61\u8fd8\u662f\u975e\u5e38\u91cf\u5bf9\u8c61\u53ef\u4ee5\u5b9e\u73b0\u51fd\u6570\u91cd\u8f7d\uff0c\u6b64\u65f6\u7684const\u662f\u5e95\u5c42\u7684 \u3002 \u6210\u5458\u51fd\u6570 \u91cd\u8f7d\u7684\u7279\u5f81: \uff081\uff09\u76f8\u540c\u7684\u8303\u56f4\uff08\u5728\u540c\u4e00\u4e2a\u7c7b\u4e2d; \uff082\uff09\u51fd\u6570\u540d\u5b57\u76f8\u540c; \uff083\uff09\u53c2\u6570\u4e0d\u540c; \uff084\uff09virtual \u5173\u952e\u5b57\u53ef\u6709\u53ef\u65e0, \u5176\u5e76\u975e\u51fd\u6570\u7b7e\u540d\u7684\u4e00\u90e8\u5206\u3002 \u8986\u76d6(override) \u2003\u6307\u6d3e\u751f\u7c7b\u51fd\u6570\u8986\u76d6\u57fa\u7c7b\u51fd\u6570\uff0c\u7279\u5f81\u662f\uff1a \uff081\uff09\u4e0d\u540c\u7684\u8303\u56f4(\u5206\u522b\u4f4d\u4e8e\u6d3e\u751f\u7c7b\u4e0e\u57fa\u7c7b); \uff082\uff09\u51fd\u6570\u540d\u5b57\u76f8\u540c; \uff083\uff09\u51fd\u6570\u7b7e\u540d\u76f8\u540c; \uff084\uff09\u57fa\u7c7b\u51fd\u6570\u5fc5\u987b\u6709virtual \u5173\u952e\u5b57; \u9690\u85cf \u6d3e\u751f\u7c7b\u7684\u51fd\u6570\u5c4f\u853d\u4e86\u4e0e\u5176\u540c\u540d\u7684\u57fa\u7c7b\u51fd\u6570\uff0c\u89c4\u5219\u5982\u4e0b\uff1a \u2003\uff081\uff09\u5982\u679c\u6d3e\u751f\u7c7b\u7684\u51fd\u6570\u4e0e\u57fa\u7c7b\u7684\u51fd\u6570\u540c\u540d\uff0c\u4f46\u662f\u53c2\u6570\u4e0d\u540c\u3002\u6b64\u65f6\uff0c\u4e0d\u8bba\u6709\u65e0virtual\u5173\u952e\u5b57\uff0c\u57fa\u7c7b\u7684\u51fd\u6570\u5c06\u88ab\u9690\u85cf\uff08\u6ce8\u610f\u522b\u4e0e\u91cd\u8f7d\u6df7\u6dc6\uff09\u3002 \u2003\uff082\uff09\u5982\u679c\u6d3e\u751f\u7c7b\u7684\u51fd\u6570\u4e0e\u57fa\u7c7b\u7684\u51fd\u6570\u540c\u540d\uff0c\u5e76\u4e14\u53c2\u6570\u4e5f\u76f8\u540c\uff0c\u4f46\u662f\u57fa\u7c7b\u51fd\u6570\u6ca1\u6709virtual \u5173\u952e\u5b57\u3002\u6b64\u65f6\uff0c\u57fa\u7c7b\u7684\u51fd\u6570\u88ab\u9690\u85cf\uff08\u6ce8\u610f\u522b\u4e0e\u8986\u76d6\u6df7\u6dc6\uff09 \u6b64\u65f6\u6b32\u8c03\u7528\u7236\u7c7b\u4e2d\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u5217\u5f62\u5f0f: Derived.Base::fcn(); \u51fd\u6570\u53c2\u6570 \u5f53\u4e00\u4e2a\u51fd\u6570\u53c2\u6570\u662f \u6a21\u677f\u7c7b\u578b\u53c2\u6570 \u7684\u4e00\u4e2a\u666e\u901a\u5de6\u503c\u5f15\u7528\uff0c\u5219\u53ea\u80fd\u4f20\u9012\u4e00\u4e2a\u5de6\u503c\u5b9e\u53c2\uff1b\u800c\u51fd\u6570\u53c2\u6570\u662f\u53f3\u503c\u5f15\u7528\u65f6\uff0c\u5219\u53ef\u4ee5\u4f20\u9012\u4efb\u610f\u5b9e\u53c2\uff1b \u5176\u4e2d\u82e5\u5c06\u4e00\u4e2a\u5de6\u503c\u4f20\u9012\u7ed9\u8fd9\u6837\u7684\u53c2\u6570\uff0c\u5219\u63a8\u65ad\u51fa\u7684\u6a21\u677f\u53c2\u6570\u5b9e\u53c2\u7c7b\u578b\u662f\u4e00\u4e2a\u5de6\u503c\u5f15\u7528\uff08\u6839\u636e\u5f15\u7528\u6298\u53e0\u89c4\u5219\u5f97\u5230\uff09\uff0e \u5bf9\u4e8e\u975e\u51fd\u6570\u6a21\u677f\uff0c\u53f3\u503c\u7c7b\u578b\u53c2\u6570\u53ea\u80fd\u63a5\u53d7\u4e00\u4e2a\u53f3\u503c\u3002 \u5982\u679c\u4e00\u4e2a\u51fd\u6570\u53c2\u6570\u662f\u6307\u5411\u6a21\u677f\u7c7b\u578b\u53c2\u6570\u7684\u53f3\u503c\u5f15\u7528\uff0c\u5b83\u5bf9\u5e94\u7684\u5b9e\u53c2\u7684const\u5c5e\u6027\u548c\u5de6\u503c/\u53f3\u503c\u5c5e\u6027\u5c06\u5f97\u5230\u4fdd\u6301\u3002 \u5f53\u7528\u4e8e\u4e00\u4e2a\u6307\u5411\u6a21\u677f\u53c2\u6570\u7c7b\u578b\u7684\u53f3\u503c\u5f15\u7528\u51fd\u6570\u53c2\u6570\u65f6\uff0cstd::forward \u4f1a\u4fdd\u6301\u5b9e\u53c2\u7c7b\u578b\u7684\u6240\u6709\u7ec6\u8282\u3002 \u5f53\u6709\u591a\u4e2a\u91cd\u8f7d\u6a21\u677f\u5bf9\u4e00\u4e2a\u8c03\u7528\u63d0\u4f9b\u540c\u6837\u597d\u7684\u5339\u914d\u65f6\uff0c\u5e94\u9009\u62e9\u6700\u7279\u4f8b\u5316\u7684\u7248\u672c\u3002 \u5bf9\u4e8e\u4e00\u4e2a\u8c03\u7528\uff0c\u5982\u679c\u4e00\u4e2a\u975e\u51fd\u6570\u6a21\u677f\u4e0e\u4e00\u4e2a\u51fd\u6570\u6a21\u677f\u63d0\u4f9b\u540c\u6837\u7684\u597d\u7684\u5339\u914d\uff0c\u5219\u9009\u62e9\u975e\u6a21\u677f\u7248\u672c\u3002\u3000 \u5982\u679c\u51fd\u6570\u53c2\u6570\u7c7b\u578b\u662f\u6307\u9488\uff0c\u8bb0\u4f4f\u5728\u51fd\u6570\u4f53\u5185\u4fee\u6539\u6307\u9488\u6307\u5411\u7684\u5bf9\u8c61\u662f\u53ef\u4ee5\u540c\u6b65\u7684\uff0c\u800c\u4fee\u6539\u6307\u9488\u672c\u8eab\u4e0d\u4f1a\u540c\u6b65(\u56e0\u4e3a\u4fee\u6539\u7684\u662f\u539f\u6307\u9488\u7684\u62f7\u8d1d)\uff1b\u4f20\u5165\u6307\u9488\u7684\u5f15\u7528\uff0c\u5219\u53ef\u4ee5\u540c\u65f6\u540c\u6b65\u4fee\u6539\u6307\u9488\u672c\u8eab\u548c\u6307\u9488\u6240\u6307\u5411\u5bf9\u8c61 \u3002 \u51fd\u6570\u5b9e\u53c2\u67e5\u627e\u89c4\u5219\uff1a 1>\u7531\u5185\u5411\u5916\uff1b 2>\u5f53\u7ed9\u51fd\u6570\u4f20\u9012\u4e00\u4e2a\u7c7b\u7c7b\u578b\u7684\u5bf9\u8c61\u65f6\uff0c\u9664\u4e86\u5728\u5e38\u89c4\u7684\u4f5c\u7528\u57df\u67e5\u627e\u5916\uff0c\u8fd8\u4f1a\u67e5\u627e\u5b9e\u53c2\u7c7b\u4ee5\u53ca\u5b9e\u53c2\u7c7b\u57fa\u7c7b\u6240\u5c5e\u7684\u547d\u540d\u7a7a\u95f4\u3002 \u5728\u8fd9\u4e9b\u547d\u540d\u7a7a\u95f4\u4e2d\u6240\u6709\u4e0e\u88ab\u8c03\u7528\u51fd\u6570\u540c\u540d\u7684\u51fd\u6570\u90fd\u5c06\u88ab\u6dfb\u52a0\u5230\u5019\u9009\u96c6\u4e2d\uff0c\u5373\u4f7f\u67d0\u4e9b\u51fd\u6570\u5728\u8c03\u7528\u65f6\u4e0d\u53ef\u89c1\uff1b \u8fd9\u4e00\u89c4\u5219\u5bf9\u4e8e\u4f20\u9012\u7c7b\u7684\u5f15\u7528\u6216\u6307\u9488\u7684\u8c03\u7528\u540c\u6837\u6709\u6548\uff1b 3>\u5f53\u7c7b\u58f0\u660e\u4e00\u4e2a\u53cb\u5143\u65f6\uff0c\u8be5\u53cb\u5143\u58f0\u660e\u5e76\u6ca1\u6709\u4f7f\u5f97\u53cb\u5143\u672c\u8eab\u53ef\u89c1\uff0c\u4f46\u53ef\u4ee5\u8ba4\u4e3a\u5176\u662f\u6700\u8fd1\u7684\u5916\u5c42\u547d\u540d\u7a7a\u95f4\u7684\u6210\u5458\u3002 \u51fd\u6570\u53ef\u53d8\u6570\u91cf\u53c2\u6570 \u82e5\u6240\u6709\u7684\u5b9e\u53c2\u7c7b\u578b\u76f8\u540c\uff0c\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u540d\u4e3ainitializer_list\u7684\u6807\u51c6\u5e93\u7c7b\u578b\uff08\u5b9a\u4e49\u5728\u540c\u540d\u5934\u6587\u4ef6\u4e2d\uff09\u3002initializer_list\u5bf9\u8c61\u4e2d\u7684\u5143\u7d20\u7528\u4e8e\u662f\u5e38\u91cf\u503c\uff0c\u65e0\u6cd5\u4fee\u6539\u3002 eg: void print(initializer_list<string> list){...}; print({\u201cerror\u201d, \u201cxx\u201d}); //\u5e8f\u5217\u5fc5\u987b\u653e\u5728{}\u4e2d \u9488\u5bf9\u7c7b\u578b\u4e0d\u540c\u7684\u5b9e\u53c2\uff0c\u4f7f\u7528\u53ef\u53d8\u53c2\u6570\u6a21\u677f \u7701\u7565\u7b26\u5f62\u53c2\uff0c\u5176\u53ea\u80fd\u51fa\u73b0\u5728\u5f62\u53c2\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5f62\u5f0f\u5982\u4e0b\uff1a void foo(param_list, ...); void foo(...); \u2003\u2003\u5176\u5e94\u8be5\u4ec5\u4ec5\u7528\u4e8eC\u548cC++\u90fd\u901a\u7528\u7684\u7c7b\u578b\u3002 \u51fd\u6570\u8fd4\u56de\u7c7b\u578b \u2003 return-by-value , \u5982\u679c\u8fd4\u56de\u7684\u662f\u4e00\u4e2a \u975e\u4e34\u65f6\u53d8\u91cf\u7684\u5de6\u503c \uff0c\u8fd4\u56de\u65f6\u4f1a\u53d1\u751f\u62f7\u8d1d\uff1b\u5982\u679c\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u4e34\u65f6\u53d8\u91cf\u6216\u8005\u5c31\u662f\u4e00\u4e2a\u4e34\u65f6\u7684\u53f3\u503c\uff0c\u5219\u4f1a\u8f6c\u5316\u4e3a\u79fb\u52a8\u6765\u8282\u7701\u62f7\u8d1d\u5f00\u9500\u3002 \u7528const\u4fee\u9970return-by-value\u4e00\u822c\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u8fd4\u56de\u7684\u672c\u8eab\u5c31\u662f\u503c\u7684\u62f7\u8d1d\u3002\u4e0d\u8fc7\u5728\u91cd\u8f7d\u8fd0\u7b97\u7b26\u65f6\uff0c\u5982\u679c\u53c2\u6570\u662f\u81ea\u5b9a\u4e49\u7c7b\u578b\uff0c\u4f7f\u7528const T\u4f5c\u4e3a\u8fd4\u56de\u503c\u7c7b\u578b\uff0c\u53ef\u4ee5\u907f\u514d\u5982\u201cif(t1*t2=t3)\u201d\u613f\u610f\u662f\u5224\u65ad\u76f8\u7b49\uff0c\u5374\u53d8\u6210\u4e86\u5411\u4e00\u4e2a\u53f3\u503c\u8d4b\u503c\uff0creturn-by-const-value\u53ef\u4ee5\u68c0\u6d4b\u51fa\u8fd9\u79cd\u9519\u8bef\u3002\u5904\u4e8e\u6b64\u79cd\u8003\u8651 return-by-const-value \u4e5f\u662f\u5341\u5206\u5e38\u89c1\u7684\uff0c\u4e0d\u4f1a\u5e26\u6765\u989d\u5916\u7684\u56f0\u6270\uff0c \u8fd8\u53ef\u4ee5\u907f\u514d\u524d\u8ff0\u95ee\u9898\u3002 \u2003 return-by-const-reference , \u5982\u679c\u4ee5\u4e00\u4e2a\u666e\u901a\u53d8\u91cf\u6765\u63a5\u53d7\u8fd4\u56de\u503c\uff0c\u5219\u4f9d\u65e7\u4f1a\u53d1\u751f\u62f7\u8d1d\uff0c\u800c\u4ee5\u5e38\u91cf\u5f15\u7528\u6765\u63a5\u53d7\uff0c\u5219\u4e0d\u4f1a\u53d1\u9001\u62f7\u8d1d\u8f6c\u6362\uff0c\u6b64\u65f6\u4e5f\u4e0d\u80fd\u5bf9\u8fd4\u56de\u503c\u8fdb\u884c\u4fee\u6539(\u591a\u89c1\u7684\u662fconst-reference\u4f20\u53c2\uff0c\u800c\u975e\u8fd4\u56de)\u3002\u6b64\u5916\u4ee5non-const \u5f15\u7528\u7c7b\u578b\u6765\u63a5\u53d7\u8fd4\u56de\u503c\u662f\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\u7684\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u63a5\u53d7\u8005\u53ef\u80fd\u4f1a\u6539\u53d8\u5bf9\u8c61\u3002 \u2003 return-by-reference , \u591a\u89c1\u4e8e\u8c03\u7528\u8005\u9700\u8981\u5bf9\u8fd4\u56de\u5bf9\u8c61\u7684\u5185\u90e8\u6570\u636e\u8fdb\u884c\u4fee\u6539\uff0c\u6216\u8005\u8fd4\u56de\u7c7b\u578b\u4e0d\u80fd\u88ab\u62f7\u8d1d(\u4f8b\u5982IO\u6d41)\u3002","title":"function"},{"location":"c_base/function/#about-function","text":"","title":"About Function"},{"location":"c_base/function/#_1","text":"type (*p)(param_list); //p\u6307\u5411\u4e00\u4e2a\u5305\u542bparam_list\u5f62\u53c2\u3001\u8fd4\u56de\u503c\u7c7b\u578btype\u7684\u51fd\u6570\uff1b p = fun_name; //\u51fd\u6570\u540d\u53ef\u4ee5\u81ea\u52a8\u8f6c\u6362\u6210\u6307\u9488 p= &fun_name; //\u4e5f\u53ef\u4ee5\u901a\u8fc7&\u83b7\u53d6 // p(..) \u4e0e (*P)(..)\u662f\u7b49\u6548\u7684\uff0c\u5373\u65e0\u9700\u89e3\u5f15\u7528\u51fd\u6570\u6307\u9488\u5373\u53ef\u8c03\u7528\u8be5\u51fd\u6570\uff1b // another test // \u4e0a\u9762\u7684p\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5176\u7c7b\u578b\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488 typedef type(*T)(param_list //\u8fd9\u91cc\u662f\u4e3a\u51fd\u6570\u6307\u9488\u7c7b\u578b\u91cd\u65b0\u5b9a\u4e49\u4e86\u201cT\u201d\u7c7b\u578b\u540d T t1; t1(...); \u2003\u51fd\u6570\u6307\u9488\u5f62\u53c2\uff1a\u4e0d\u80fd\u5b9a\u4e49\u51fd\u6570\u7c7b\u578b\u7684\u5f62\u53c2\uff0c\u4f46\u662f\u5f62\u53c2\u53ef\u4ee5\u662f\u6307\u5411\u51fd\u6570\u7c7b\u578b\u7684\u6307\u9488\u3002 void foo(type fun(param_list)); or void foo(type(*p)(param_list));","title":"\u51fd\u6570\u6307\u9488"},{"location":"c_base/function/#overload","text":"\u51fd\u6570\u91cd\u8f7d: \u51fd\u6570\u540d\u79f0\u76f8\u540c\uff0c\u4f46\u51fd\u6570\u7b7e\u540d\u4e0d\u540c\uff0c\u51fd\u6570\u7b7e\u540d\u5305\u62ec\u53c2\u6570\u5217\u8868\u3001const\uff08const member fucntion\uff09. const\u5f62\u53c2\uff1a\u4e00\u4e2a\u62e5\u6709\u9876\u5c42const\u7684\u5f62\u53c2\u65e0\u6cd5\u548c\u53e6\u4e00\u4e2a\u6ca1\u6709\u9876\u5c42const\u7684\u5f62\u53c2\u533a\u5206\u5f00\u6765\uff1b \u5982\u679c\u5f62\u53c2\u662f\u67d0\u79cd\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff0c\u5219\u901a\u8fc7\u533a\u5206\u5176\u6307\u5411\u7684\u662f\u5e38\u91cf\u5bf9\u8c61\u8fd8\u662f\u975e\u5e38\u91cf\u5bf9\u8c61\u53ef\u4ee5\u5b9e\u73b0\u51fd\u6570\u91cd\u8f7d\uff0c\u6b64\u65f6\u7684const\u662f\u5e95\u5c42\u7684 \u3002 \u6210\u5458\u51fd\u6570 \u91cd\u8f7d\u7684\u7279\u5f81: \uff081\uff09\u76f8\u540c\u7684\u8303\u56f4\uff08\u5728\u540c\u4e00\u4e2a\u7c7b\u4e2d; \uff082\uff09\u51fd\u6570\u540d\u5b57\u76f8\u540c; \uff083\uff09\u53c2\u6570\u4e0d\u540c; \uff084\uff09virtual \u5173\u952e\u5b57\u53ef\u6709\u53ef\u65e0, \u5176\u5e76\u975e\u51fd\u6570\u7b7e\u540d\u7684\u4e00\u90e8\u5206\u3002","title":"\u91cd\u8f7d(overload)"},{"location":"c_base/function/#override","text":"\u6307\u6d3e\u751f\u7c7b\u51fd\u6570\u8986\u76d6\u57fa\u7c7b\u51fd\u6570\uff0c\u7279\u5f81\u662f\uff1a \uff081\uff09\u4e0d\u540c\u7684\u8303\u56f4(\u5206\u522b\u4f4d\u4e8e\u6d3e\u751f\u7c7b\u4e0e\u57fa\u7c7b); \uff082\uff09\u51fd\u6570\u540d\u5b57\u76f8\u540c; \uff083\uff09\u51fd\u6570\u7b7e\u540d\u76f8\u540c; \uff084\uff09\u57fa\u7c7b\u51fd\u6570\u5fc5\u987b\u6709virtual \u5173\u952e\u5b57;","title":"\u8986\u76d6(override)"},{"location":"c_base/function/#_2","text":"\u6d3e\u751f\u7c7b\u7684\u51fd\u6570\u5c4f\u853d\u4e86\u4e0e\u5176\u540c\u540d\u7684\u57fa\u7c7b\u51fd\u6570\uff0c\u89c4\u5219\u5982\u4e0b\uff1a \u2003\uff081\uff09\u5982\u679c\u6d3e\u751f\u7c7b\u7684\u51fd\u6570\u4e0e\u57fa\u7c7b\u7684\u51fd\u6570\u540c\u540d\uff0c\u4f46\u662f\u53c2\u6570\u4e0d\u540c\u3002\u6b64\u65f6\uff0c\u4e0d\u8bba\u6709\u65e0virtual\u5173\u952e\u5b57\uff0c\u57fa\u7c7b\u7684\u51fd\u6570\u5c06\u88ab\u9690\u85cf\uff08\u6ce8\u610f\u522b\u4e0e\u91cd\u8f7d\u6df7\u6dc6\uff09\u3002 \u2003\uff082\uff09\u5982\u679c\u6d3e\u751f\u7c7b\u7684\u51fd\u6570\u4e0e\u57fa\u7c7b\u7684\u51fd\u6570\u540c\u540d\uff0c\u5e76\u4e14\u53c2\u6570\u4e5f\u76f8\u540c\uff0c\u4f46\u662f\u57fa\u7c7b\u51fd\u6570\u6ca1\u6709virtual \u5173\u952e\u5b57\u3002\u6b64\u65f6\uff0c\u57fa\u7c7b\u7684\u51fd\u6570\u88ab\u9690\u85cf\uff08\u6ce8\u610f\u522b\u4e0e\u8986\u76d6\u6df7\u6dc6\uff09 \u6b64\u65f6\u6b32\u8c03\u7528\u7236\u7c7b\u4e2d\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u5217\u5f62\u5f0f: Derived.Base::fcn();","title":"\u9690\u85cf"},{"location":"c_base/function/#_3","text":"\u5f53\u4e00\u4e2a\u51fd\u6570\u53c2\u6570\u662f \u6a21\u677f\u7c7b\u578b\u53c2\u6570 \u7684\u4e00\u4e2a\u666e\u901a\u5de6\u503c\u5f15\u7528\uff0c\u5219\u53ea\u80fd\u4f20\u9012\u4e00\u4e2a\u5de6\u503c\u5b9e\u53c2\uff1b\u800c\u51fd\u6570\u53c2\u6570\u662f\u53f3\u503c\u5f15\u7528\u65f6\uff0c\u5219\u53ef\u4ee5\u4f20\u9012\u4efb\u610f\u5b9e\u53c2\uff1b \u5176\u4e2d\u82e5\u5c06\u4e00\u4e2a\u5de6\u503c\u4f20\u9012\u7ed9\u8fd9\u6837\u7684\u53c2\u6570\uff0c\u5219\u63a8\u65ad\u51fa\u7684\u6a21\u677f\u53c2\u6570\u5b9e\u53c2\u7c7b\u578b\u662f\u4e00\u4e2a\u5de6\u503c\u5f15\u7528\uff08\u6839\u636e\u5f15\u7528\u6298\u53e0\u89c4\u5219\u5f97\u5230\uff09\uff0e \u5bf9\u4e8e\u975e\u51fd\u6570\u6a21\u677f\uff0c\u53f3\u503c\u7c7b\u578b\u53c2\u6570\u53ea\u80fd\u63a5\u53d7\u4e00\u4e2a\u53f3\u503c\u3002 \u5982\u679c\u4e00\u4e2a\u51fd\u6570\u53c2\u6570\u662f\u6307\u5411\u6a21\u677f\u7c7b\u578b\u53c2\u6570\u7684\u53f3\u503c\u5f15\u7528\uff0c\u5b83\u5bf9\u5e94\u7684\u5b9e\u53c2\u7684const\u5c5e\u6027\u548c\u5de6\u503c/\u53f3\u503c\u5c5e\u6027\u5c06\u5f97\u5230\u4fdd\u6301\u3002 \u5f53\u7528\u4e8e\u4e00\u4e2a\u6307\u5411\u6a21\u677f\u53c2\u6570\u7c7b\u578b\u7684\u53f3\u503c\u5f15\u7528\u51fd\u6570\u53c2\u6570\u65f6\uff0cstd::forward \u4f1a\u4fdd\u6301\u5b9e\u53c2\u7c7b\u578b\u7684\u6240\u6709\u7ec6\u8282\u3002 \u5f53\u6709\u591a\u4e2a\u91cd\u8f7d\u6a21\u677f\u5bf9\u4e00\u4e2a\u8c03\u7528\u63d0\u4f9b\u540c\u6837\u597d\u7684\u5339\u914d\u65f6\uff0c\u5e94\u9009\u62e9\u6700\u7279\u4f8b\u5316\u7684\u7248\u672c\u3002 \u5bf9\u4e8e\u4e00\u4e2a\u8c03\u7528\uff0c\u5982\u679c\u4e00\u4e2a\u975e\u51fd\u6570\u6a21\u677f\u4e0e\u4e00\u4e2a\u51fd\u6570\u6a21\u677f\u63d0\u4f9b\u540c\u6837\u7684\u597d\u7684\u5339\u914d\uff0c\u5219\u9009\u62e9\u975e\u6a21\u677f\u7248\u672c\u3002\u3000 \u5982\u679c\u51fd\u6570\u53c2\u6570\u7c7b\u578b\u662f\u6307\u9488\uff0c\u8bb0\u4f4f\u5728\u51fd\u6570\u4f53\u5185\u4fee\u6539\u6307\u9488\u6307\u5411\u7684\u5bf9\u8c61\u662f\u53ef\u4ee5\u540c\u6b65\u7684\uff0c\u800c\u4fee\u6539\u6307\u9488\u672c\u8eab\u4e0d\u4f1a\u540c\u6b65(\u56e0\u4e3a\u4fee\u6539\u7684\u662f\u539f\u6307\u9488\u7684\u62f7\u8d1d)\uff1b\u4f20\u5165\u6307\u9488\u7684\u5f15\u7528\uff0c\u5219\u53ef\u4ee5\u540c\u65f6\u540c\u6b65\u4fee\u6539\u6307\u9488\u672c\u8eab\u548c\u6307\u9488\u6240\u6307\u5411\u5bf9\u8c61 \u3002 \u51fd\u6570\u5b9e\u53c2\u67e5\u627e\u89c4\u5219\uff1a 1>\u7531\u5185\u5411\u5916\uff1b 2>\u5f53\u7ed9\u51fd\u6570\u4f20\u9012\u4e00\u4e2a\u7c7b\u7c7b\u578b\u7684\u5bf9\u8c61\u65f6\uff0c\u9664\u4e86\u5728\u5e38\u89c4\u7684\u4f5c\u7528\u57df\u67e5\u627e\u5916\uff0c\u8fd8\u4f1a\u67e5\u627e\u5b9e\u53c2\u7c7b\u4ee5\u53ca\u5b9e\u53c2\u7c7b\u57fa\u7c7b\u6240\u5c5e\u7684\u547d\u540d\u7a7a\u95f4\u3002 \u5728\u8fd9\u4e9b\u547d\u540d\u7a7a\u95f4\u4e2d\u6240\u6709\u4e0e\u88ab\u8c03\u7528\u51fd\u6570\u540c\u540d\u7684\u51fd\u6570\u90fd\u5c06\u88ab\u6dfb\u52a0\u5230\u5019\u9009\u96c6\u4e2d\uff0c\u5373\u4f7f\u67d0\u4e9b\u51fd\u6570\u5728\u8c03\u7528\u65f6\u4e0d\u53ef\u89c1\uff1b \u8fd9\u4e00\u89c4\u5219\u5bf9\u4e8e\u4f20\u9012\u7c7b\u7684\u5f15\u7528\u6216\u6307\u9488\u7684\u8c03\u7528\u540c\u6837\u6709\u6548\uff1b 3>\u5f53\u7c7b\u58f0\u660e\u4e00\u4e2a\u53cb\u5143\u65f6\uff0c\u8be5\u53cb\u5143\u58f0\u660e\u5e76\u6ca1\u6709\u4f7f\u5f97\u53cb\u5143\u672c\u8eab\u53ef\u89c1\uff0c\u4f46\u53ef\u4ee5\u8ba4\u4e3a\u5176\u662f\u6700\u8fd1\u7684\u5916\u5c42\u547d\u540d\u7a7a\u95f4\u7684\u6210\u5458\u3002","title":"\u51fd\u6570\u53c2\u6570"},{"location":"c_base/function/#_4","text":"\u82e5\u6240\u6709\u7684\u5b9e\u53c2\u7c7b\u578b\u76f8\u540c\uff0c\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u540d\u4e3ainitializer_list\u7684\u6807\u51c6\u5e93\u7c7b\u578b\uff08\u5b9a\u4e49\u5728\u540c\u540d\u5934\u6587\u4ef6\u4e2d\uff09\u3002initializer_list\u5bf9\u8c61\u4e2d\u7684\u5143\u7d20\u7528\u4e8e\u662f\u5e38\u91cf\u503c\uff0c\u65e0\u6cd5\u4fee\u6539\u3002 eg: void print(initializer_list<string> list){...}; print({\u201cerror\u201d, \u201cxx\u201d}); //\u5e8f\u5217\u5fc5\u987b\u653e\u5728{}\u4e2d \u9488\u5bf9\u7c7b\u578b\u4e0d\u540c\u7684\u5b9e\u53c2\uff0c\u4f7f\u7528\u53ef\u53d8\u53c2\u6570\u6a21\u677f \u7701\u7565\u7b26\u5f62\u53c2\uff0c\u5176\u53ea\u80fd\u51fa\u73b0\u5728\u5f62\u53c2\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5f62\u5f0f\u5982\u4e0b\uff1a void foo(param_list, ...); void foo(...); \u2003\u2003\u5176\u5e94\u8be5\u4ec5\u4ec5\u7528\u4e8eC\u548cC++\u90fd\u901a\u7528\u7684\u7c7b\u578b\u3002","title":"\u51fd\u6570\u53ef\u53d8\u6570\u91cf\u53c2\u6570"},{"location":"c_base/function/#_5","text":"return-by-value , \u5982\u679c\u8fd4\u56de\u7684\u662f\u4e00\u4e2a \u975e\u4e34\u65f6\u53d8\u91cf\u7684\u5de6\u503c \uff0c\u8fd4\u56de\u65f6\u4f1a\u53d1\u751f\u62f7\u8d1d\uff1b\u5982\u679c\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u4e34\u65f6\u53d8\u91cf\u6216\u8005\u5c31\u662f\u4e00\u4e2a\u4e34\u65f6\u7684\u53f3\u503c\uff0c\u5219\u4f1a\u8f6c\u5316\u4e3a\u79fb\u52a8\u6765\u8282\u7701\u62f7\u8d1d\u5f00\u9500\u3002 \u7528const\u4fee\u9970return-by-value\u4e00\u822c\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u8fd4\u56de\u7684\u672c\u8eab\u5c31\u662f\u503c\u7684\u62f7\u8d1d\u3002\u4e0d\u8fc7\u5728\u91cd\u8f7d\u8fd0\u7b97\u7b26\u65f6\uff0c\u5982\u679c\u53c2\u6570\u662f\u81ea\u5b9a\u4e49\u7c7b\u578b\uff0c\u4f7f\u7528const T\u4f5c\u4e3a\u8fd4\u56de\u503c\u7c7b\u578b\uff0c\u53ef\u4ee5\u907f\u514d\u5982\u201cif(t1*t2=t3)\u201d\u613f\u610f\u662f\u5224\u65ad\u76f8\u7b49\uff0c\u5374\u53d8\u6210\u4e86\u5411\u4e00\u4e2a\u53f3\u503c\u8d4b\u503c\uff0creturn-by-const-value\u53ef\u4ee5\u68c0\u6d4b\u51fa\u8fd9\u79cd\u9519\u8bef\u3002\u5904\u4e8e\u6b64\u79cd\u8003\u8651 return-by-const-value \u4e5f\u662f\u5341\u5206\u5e38\u89c1\u7684\uff0c\u4e0d\u4f1a\u5e26\u6765\u989d\u5916\u7684\u56f0\u6270\uff0c \u8fd8\u53ef\u4ee5\u907f\u514d\u524d\u8ff0\u95ee\u9898\u3002 \u2003 return-by-const-reference , \u5982\u679c\u4ee5\u4e00\u4e2a\u666e\u901a\u53d8\u91cf\u6765\u63a5\u53d7\u8fd4\u56de\u503c\uff0c\u5219\u4f9d\u65e7\u4f1a\u53d1\u751f\u62f7\u8d1d\uff0c\u800c\u4ee5\u5e38\u91cf\u5f15\u7528\u6765\u63a5\u53d7\uff0c\u5219\u4e0d\u4f1a\u53d1\u9001\u62f7\u8d1d\u8f6c\u6362\uff0c\u6b64\u65f6\u4e5f\u4e0d\u80fd\u5bf9\u8fd4\u56de\u503c\u8fdb\u884c\u4fee\u6539(\u591a\u89c1\u7684\u662fconst-reference\u4f20\u53c2\uff0c\u800c\u975e\u8fd4\u56de)\u3002\u6b64\u5916\u4ee5non-const \u5f15\u7528\u7c7b\u578b\u6765\u63a5\u53d7\u8fd4\u56de\u503c\u662f\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\u7684\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u63a5\u53d7\u8005\u53ef\u80fd\u4f1a\u6539\u53d8\u5bf9\u8c61\u3002 \u2003 return-by-reference , \u591a\u89c1\u4e8e\u8c03\u7528\u8005\u9700\u8981\u5bf9\u8fd4\u56de\u5bf9\u8c61\u7684\u5185\u90e8\u6570\u636e\u8fdb\u884c\u4fee\u6539\uff0c\u6216\u8005\u8fd4\u56de\u7c7b\u578b\u4e0d\u80fd\u88ab\u62f7\u8d1d(\u4f8b\u5982IO\u6d41)\u3002","title":"\u51fd\u6570\u8fd4\u56de\u7c7b\u578b"},{"location":"c_base/inherit/","text":"\u5173\u4e8e\u7ee7\u627f 1. protected \u2003 \u57fa\u7c7b\u4e2d\u88ab\u58f0\u660e\u4e3aprotected\u7684\u6210\u5458\uff0c\u5bf9\u4e8e\u7c7b\u7684\u7528\u6237\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684 \uff1b\u4f46\u5bf9\u4e8e\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u548c\u53cb\u5143\u662f\u53ef\u8bbf\u95ee\u7684; \u9700\u6ce8\u610f\u7684\u662f\uff0c\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u51fd\u6570\u53ea\u80fd\u8bbf\u95ee\u6240\u4f5c\u7528\u7684\u90a3\u4e2a\u5bf9\u8c61\uff08\u5373this\u6307\u9488\u6307\u5411\u7684\u5bf9\u8c61\uff09\u7684\u57fa\u7c7b\u4fdd\u62a4\u6210\u5458\uff0c\u4e0d\u80fd\u8bbf\u95ee\u5176\u4ed6\u57fa\u7c7b\u5bf9\u8c61\u7684\u57fa\u7c7b\u4fdd\u62a4\u6210\u5458\u3002\u5728\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u51fd\u6570\u5916\u90e8\uff0c\u4e0d\u80fd\u8bbf\u95ee\u57fa\u7c7b\u7684\u79c1\u6709\u6210\u5458\u548c\u4fdd\u62a4\u6210\u5458\u3002 #include<iostream> using namespace std; class A{ public: int a; A(){ a1 = 1;a2 = 2;a3 = 3;a = 4; } public: int a1; protected: int a2; private: int a3; }; class B : protected A{ public: int a; B(int i){ A(); a = i; } void fun(){ cout << a << endl; //\u6b63\u786e\uff0cpublic\u6210\u5458\uff0c\u8f93\u51fai\u3002 cout << a1 << endl; //\u6b63\u786e\uff0c\u57fa\u7c7b\u7684public\u6210\u5458\uff0c\u5728\u6d3e\u751f\u7c7b\u4e2d\u53d8\u6210\u4e86protected\uff0c\u53ef\u4ee5\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 cout << a2 << endl; //\u6b63\u786e\uff0c\u57fa\u7c7b\u7684protected\u6210\u5458\uff0c\u5728\u6d3e\u751f\u7c7b\u4e2d\u8fd8\u662fprotected\uff0c\u53ef\u4ee5\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 cout << a3 << endl; //\u9519\u8bef\uff0c\u57fa\u7c7b\u7684private\u6210\u5458\u4e0d\u80fd\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 } }; int main(){ B b(10); cout << b.a << endl; //\u6b63\u786e\u3002public\u6210\u5458 cout << b.a1 << endl; //\u9519\u8bef\uff0cprotected\u6210\u5458\u4e0d\u80fd\u5728\u7c7b\u5916\u8bbf\u95ee\u3002 cout << b.a2 << endl; //\u9519\u8bef\uff0cprotected\u6210\u5458\u4e0d\u80fd\u5728\u7c7b\u5916\u8bbf\u95ee\u3002 cout << b.a3 << endl; //\u9519\u8bef\uff0cprivate\u6210\u5458\u4e0d\u80fd\u5728\u7c7b\u5916\u8bbf\u95ee\u3002 return 0; } 2. \u7ee7\u627f\u5173\u7cfb \u2003\u6d3e\u751f\u7c7b\u5728\u7ee7\u627f\u57fa\u7c7b\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9apublic\u3001protected\u3001private\u4e09\u79cd\u7ee7\u627f\u65b9\u5f0f\uff1a public\u7ee7\u627f\uff1a\u57fa\u7c7bpublic\u6210\u5458\uff0cprotected\u6210\u5458\uff0cprivate\u6210\u5458\u7684\u8bbf\u95ee\u5c5e\u6027\u5728\u6d3e\u751f\u7c7b\u4e2d\u5206\u522b\u53d8\u6210\uff1apublic, protected, private protected\u7ee7\u627f\uff1a\u57fa\u7c7bpublic\u6210\u5458\uff0cprotected\u6210\u5458\uff0cprivate\u6210\u5458\u7684\u8bbf\u95ee\u5c5e\u6027\u5728\u6d3e\u751f\u7c7b\u4e2d\u5206\u522b\u53d8\u6210\uff1aprotected, protected, private private\u7ee7\u627f\uff1a\u57fa\u7c7bpublic\u6210\u5458\uff0cprotected\u6210\u5458\uff0cprivate\u6210\u5458\u7684\u8bbf\u95ee\u5c5e\u6027\u5728\u6d3e\u751f\u7c7b\u4e2d\u5206\u522b\u53d8\u6210\uff1aprivate, private, private \u2003\u4f46\u65e0\u8bba\u54ea\u79cd\u7ee7\u627f\u65b9\u5f0f\uff0c\u57fa\u7c7b\u4e2d\u7684private\u6210\u5458\u53ea\u80fd\u88ab\u672c\u7c7b\u6210\u5458\uff08\u7c7b\u5185\uff09\u548c\u53cb\u5143\u8bbf\u95ee\uff0c\u4e0d\u80fd\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\uff1b\u4ee5\u53caprotected\u6210\u5458\u53ef\u4ee5\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 \u2003\u7ee7\u627f\u5173\u7cfb\u6539\u53d8\u7684\u662f\u6d3e\u751f\u7c7b\u7684\u6d3e\u751f\u7c7b\u5bf9\u4e8e\u57fa\u7c7b\u6210\u5458\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u4ee5private\u7ee7\u627f\u4e3a\u4f8b\uff0c\u57fa\u7c7b\u7684public\u6210\u5458\u5bf9\u4e8e\u6d3e\u751f\u7c7b\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e5f\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684\u3002 \u91cd\u70b9\u8bf4\u660e \u2003\u4ee5public \u5f62\u5f0f\u7ee7\u627f\uff0c\u7f16\u8bd1\u5668\u4f1a\u5728\u5fc5\u8981\u65f6\u523b\uff0c\u5c06\u6d3e\u751f\u7c7b\u5bf9\u8c61\u8f6c\u6362\u6210\u57fa\u7c7b\u5bf9\u8c61\uff1b\u800c\u4ee5private\u5f62\u5f0f\u7ee7\u627f\uff0c\u5219\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u884c\u4e3a\u3002 \u2003 private \u7ee7\u627f\u610f\u5473\u7740implemented-in-terms-of(\u6839\u636e\u67d0\u7269\u5b9e\u73b0\u51fa)\uff0c\u5373\u6d3e\u751f\u7c7b\u4e0e\u57fa\u7c7b\u5e76\u4e0d\u5b58\u5728is-a\u7684\u5173\u7cfb\u3002 \u2003\u5f53\u4f60\u9762\u5bf9\u5e76\u4e0d\u5b58\u5728is-a\u5173\u7cfb\u7684\u4e24\u4e2aclasses\uff0c\u5176\u4e2d\u4e00\u4e2a\u7c7b\u9700\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2a\u7c7bprotected\u6210\u5458\uff0c\u6216\u8005\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\u5176\u4e00\u6216\u591a\u4e2avirtual\u51fd\u6570\uff0c\u53ef\u4ee5\u8003\u8651private\u7ee7\u627f\u3002 3.\u591a\u91cd\u7ee7\u627f \u2003\u5141\u8bb8\u6d3e\u751f\u7c7b\u4ece\u5b83\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u57fa\u7c7b\u4e2d\u7ee7\u627f\u6784\u9020\u51fd\u6570\uff0c\u6b64\u5916\u5982\u679c\u4ece\u591a\u4e2a\u57fa\u7c7b\u4e2d\u7ee7\u627f\u4e86\u76f8\u540c\u7684\u6784\u9020\u51fd\u6570\uff08\u5373\u5f62\u53c2\u5217\u8868\u76f8\u540c\uff09\uff0c\u5219\u6d3e\u751f\u7c7b\u5fc5\u987b\u5b9a\u4e49\u4e13\u5c5e\u7248\u672c\u7684\u6784\u9020\u51fd\u6570\uff0c\u4e0e\u57fa\u7c7b\u7684\u5f62\u53c2\u5217\u8868\u4e0d\u540c\u3002 \u2003\u57fa\u7c7b\u6216\u6d3e\u751f\u7c7b\u7684\u5408\u6210\u62f7\u8d1d\u63a7\u5236\u6210\u8bed\u3001\u5408\u6210\u6784\u9020\u51fd\u6570\u3001\u8d4b\u503c\u8fd0\u7b97\u7b26\u6216\u6790\u6784\u51fd\u6570\uff0c\u5b83\u4eec\u5bf9\u672c\u8eab\u7684\u6210\u5458\u4f9d\u6b21\u8fdb\u884c\u521d\u59cb\u5316\u3001\u8d4b\u503c\u6216\u9500\u6bc1\u64cd\u4f5c\uff0c\u6b64\u5916\u8fd8\u8d1f\u8d23\u4f7f\u7528\u76f4\u63a5\u57fa\u7c7b\u4e2d\u5bf9\u5e94\u7684\u64cd\u4f5c\u5bf9\u4e00\u4e2a\u5bf9\u8c61\u7684\u76f4\u63a5\u57fa\u7c7b\u90e8\u5206\u8fdb\u884c\u521d\u59cb\u5316\u3001\u8d4b\u503c\u6216\u9500\u6bc1\u76f4\u81f3\u7ee7\u627f\u94fe\u9876\u7aef\u3002 \u2003\u5c3d\u7ba1\u5728\u6d3e\u751f\u5217\u8868\u4e2d\u540c\u4e00\u4e2a\u57fa\u7c7b\u53ea\u80fd\u51fa\u73b0\u5728\u4e00\u6b21\uff0c\u4f46\u6d3e\u751f\u7c7b\u53ef\u4ee5\u591a\u6b21\u7ee7\u627f\u540c\u4e00\u4e2a\u7c7b\u3002\u6d3e\u751f\u7c7b\u53ef\u4ee5\u901a\u8fc7\u5176\u591a\u4e2a\u57fa\u7c7b\u5206\u522b\u7ee7\u627f\u540c\u4e00\u4e2a\u95f4\u63a5\u57fa\u7c7b\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7ee7\u627f\u67d0\u4e2a\u57fa\u7c7b\uff0c\u7136\u540e\u901a\u8fc7\u53e6\u4e00\u4e2a\u57fa\u7c7b\u518d\u4e00\u6b21\u95f4\u63a5\u7ee7\u627f\u8be5\u7c7b\u3002 \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6d3e\u751f\u7c7b\u4e2d\u542b\u6709\u7ee7\u627f\u94fe\u4e0a\u6bcf\u4e2a\u7c7b\u5bf9\u5e94\u7684\u5b50\u90e8\u5206\uff0c \u5982\u679c\u67d0\u4e2a\u7c7b\u5728\u6d3e\u751f\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u591a\u6b21\uff0c\u5219\u6d3e\u751f\u7c7b\u4e2d\u5c06\u5305\u542b\u8be5\u7c7b\u7684\u591a\u4e2a\u5b50\u5bf9\u8c61\u3002 \u2003 \u865a\u7ee7\u627f \uff1a\u4ee4\u67d0\u4e2a\u7c7b\u505a\u51fa\u58f0\u660e\uff0c\u627f\u8bfa\u613f\u610f\u5171\u4eab\u5b83\u7684\u57fa\u7c7b\u3002\u5176\u4e2d\u5171\u4eab\u7684\u57fa\u7c7b\u5b50\u5bf9\u8c61\u79f0\u4e3a\u865a\u57fa\u7c7b\u3002\u5728\u8fd9\u79cd\u673a\u5236\u4e0b\uff0c\u4e0d\u8bba\u865a\u57fa\u7c7b\u5728\u7ee7\u627f\u4f53\u7cfb\u4e2d\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff0c\u5728\u6d3e\u751f\u7c7b\u4e2d\u90fd\u53ea\u5305\u542b\u552f\u4e00\u4e00\u4e2a\u5171\u4eab\u7684\u865a\u57fa\u7c7b\u5b50\u5bf9\u8c61\u3002 class Bear: virtual public ZooAnimal{} //virtual\u548cpublic\u987a\u5e8f\u968f\u610f\uff0c virtual\u8bf4\u660e\u4e86\u4e00\u79cd\u610f\u613f\uff0c\u5373\u5728\u540e\u7eed\u7684\u6d3e\u751f\u7c7b\u5f53\u4e2d\u5171\u4eab\u865a\u57fa\u7c7b\u7684\u540c\u4e00\u4efd\u5b9e\u4f8b \u865a\u6d3e\u751f\u53ea\u5f71\u54cd\u4ece\u6307\u5b9a\u4e86\u865a\u57fa\u7c7b\u7684\u6d3e\u751f\u8fdb\u4e00\u6b65\u6d3e\u751f\u51fa\u7684\u7c7b\uff0c\u4e0d\u4f1a\u5f71\u54cd\u6d3e\u751f\u7c7b\u672c\u8eab\u3002\uff08eg.\u5373\u5f71\u54cd\u7684\u662fBear\u7684\u6d3e\u751f\u7c7b\uff09 \u5f71\u54cd\u5305\u62ec: \u865a\u57fa\u7c7b\u662f\u7531\u6700\u5e95\u5c42\u7684\u6d3e\u751f\u7c7b\u521d\u59cb\u5316\u7684\uff1b \u865a\u57fa\u7c7b\u6210\u5458\u7684\u53ef\u89c1\u6027 : \u5047\u5b9aB\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3ax\u7684\u6210\u5458\uff0cD1\u548cD2\u90fd\u662f\u4eceB\u865a\u7ee7\u627f\u5f97\u5230\u7684\uff0cD\u7ee7\u627f\u4e86D1\u548cD2\uff0c\u5219\u5728D\u7684\u4f5c\u7528\u57df\u4e2d\uff0cx\u901a\u8fc7D\u7684\u4fe9\u4e2a\u57fa\u7c7b\u90fd\u662f\u53ef\u89c1\u7684\uff0c\u5982\u679c\u6211\u4eec\u901a\u8fc7D\u7684\u5bf9\u8c61\u4f7f\u7528x\uff0c\u6709\u4e09\u79cd\u53ef\u80fd\u6027\uff1a \u20031.\u5982\u679c\u5728D1\u548cD2\u4e2d\u90fd\u6ca1\u6709x\u7684\u5b9a\u4e49\uff0c\u5219x\u5c06\u88ab\u89e3\u6790\u4e3aB\u7684\u6210\u5458\uff0c\u6b64\u65f6\u4e0d\u5b58\u5728\u4e8c\u4e49\u6027\uff0c\u4e00\u4e2aD\u7684\u5bf9\u8c61\u53ea\u542b\u6709x\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff1b \u20032.\u5982\u679cx\u662fB\u7684\u6210\u5458\uff0c\u540c\u65f6\u662fD1\u548cD2\u4e2d\u67d0\u4e00\u4e2a\u7684\u6210\u5458\uff0c\u5219\u540c\u6837\u6ca1\u6709\u4e8c\u4e49\u6027\uff0c\u6d3e\u751f\u7c7b\u7684x\u6bd4\u5171\u4eab\u865a\u57fa\u7c7bB\u7684x\u4f18\u5148\u7ea7\u66f4\u9ad8\uff1b \u20033.\u5982\u679c\u5728D1\u548cD2\u4e2d\u90fd\u6709x\u7684\u5b9a\u4e49\uff0c\u5219\u76f4\u63a5\u8bbf\u95eex\u5c06\u4ea7\u751f\u4e8c\u4e49\u6027\u95ee\u9898\uff1b\u4e0e\u975e\u865a\u7684\u591a\u91cd\u7ee7\u627f\u4f53\u7cfb\u4e00\u6837\uff0c\u89e3\u51b3\u8fd9\u79cd\u4e8c\u4e49\u6027\u95ee\u9898\u6700\u597d\u7684\u65b9\u6cd5\u662f\u5728\u6d3e\u751f\u7c7b\u4e2d\u4e3a\u6210\u5458\u81ea\u5b9a\u4e49\u65b0\u7684\u5b9e\u4f8b\u3002 \u542b\u6709\u865a\u57fa\u7c7b\u7684\u5bf9\u8c61\u7684\u6784\u9020\u987a\u5e8f\u4e0e\u4e00\u822c\u7684\u987a\u5e8f\u533a\u522b\uff1a\u9996\u5148\u4f7f\u7528\u63d0\u4f9b\u7ed9\u6700\u5e95\u5c42\u6d3e\u751f\u7c7b\u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u503c\u521d\u59cb\u5316\u8be5\u5bf9\u8c61\u7684\u865a\u57fa\u7c7b\u90e8\u5206\uff0c\u63a5\u4e0b\u6765\u6309\u7167\u76f4\u63a5\u57fa\u7c7b\u5728\u6d3e\u751f\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u4f9d\u6b21\u8fdb\u884c\u521d\u59cb\u5316\uff1b \u6790\u6784\u51fd\u6570\u987a\u5e8f\u4e0e\u6b64\u76f8\u53cd\u3002","title":"inherit"},{"location":"c_base/inherit/#_1","text":"","title":"\u5173\u4e8e\u7ee7\u627f"},{"location":"c_base/inherit/#1-protected","text":"\u57fa\u7c7b\u4e2d\u88ab\u58f0\u660e\u4e3aprotected\u7684\u6210\u5458\uff0c\u5bf9\u4e8e\u7c7b\u7684\u7528\u6237\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684 \uff1b\u4f46\u5bf9\u4e8e\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u548c\u53cb\u5143\u662f\u53ef\u8bbf\u95ee\u7684; \u9700\u6ce8\u610f\u7684\u662f\uff0c\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u51fd\u6570\u53ea\u80fd\u8bbf\u95ee\u6240\u4f5c\u7528\u7684\u90a3\u4e2a\u5bf9\u8c61\uff08\u5373this\u6307\u9488\u6307\u5411\u7684\u5bf9\u8c61\uff09\u7684\u57fa\u7c7b\u4fdd\u62a4\u6210\u5458\uff0c\u4e0d\u80fd\u8bbf\u95ee\u5176\u4ed6\u57fa\u7c7b\u5bf9\u8c61\u7684\u57fa\u7c7b\u4fdd\u62a4\u6210\u5458\u3002\u5728\u6d3e\u751f\u7c7b\u7684\u6210\u5458\u51fd\u6570\u5916\u90e8\uff0c\u4e0d\u80fd\u8bbf\u95ee\u57fa\u7c7b\u7684\u79c1\u6709\u6210\u5458\u548c\u4fdd\u62a4\u6210\u5458\u3002 #include<iostream> using namespace std; class A{ public: int a; A(){ a1 = 1;a2 = 2;a3 = 3;a = 4; } public: int a1; protected: int a2; private: int a3; }; class B : protected A{ public: int a; B(int i){ A(); a = i; } void fun(){ cout << a << endl; //\u6b63\u786e\uff0cpublic\u6210\u5458\uff0c\u8f93\u51fai\u3002 cout << a1 << endl; //\u6b63\u786e\uff0c\u57fa\u7c7b\u7684public\u6210\u5458\uff0c\u5728\u6d3e\u751f\u7c7b\u4e2d\u53d8\u6210\u4e86protected\uff0c\u53ef\u4ee5\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 cout << a2 << endl; //\u6b63\u786e\uff0c\u57fa\u7c7b\u7684protected\u6210\u5458\uff0c\u5728\u6d3e\u751f\u7c7b\u4e2d\u8fd8\u662fprotected\uff0c\u53ef\u4ee5\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 cout << a3 << endl; //\u9519\u8bef\uff0c\u57fa\u7c7b\u7684private\u6210\u5458\u4e0d\u80fd\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 } }; int main(){ B b(10); cout << b.a << endl; //\u6b63\u786e\u3002public\u6210\u5458 cout << b.a1 << endl; //\u9519\u8bef\uff0cprotected\u6210\u5458\u4e0d\u80fd\u5728\u7c7b\u5916\u8bbf\u95ee\u3002 cout << b.a2 << endl; //\u9519\u8bef\uff0cprotected\u6210\u5458\u4e0d\u80fd\u5728\u7c7b\u5916\u8bbf\u95ee\u3002 cout << b.a3 << endl; //\u9519\u8bef\uff0cprivate\u6210\u5458\u4e0d\u80fd\u5728\u7c7b\u5916\u8bbf\u95ee\u3002 return 0; }","title":"1. protected"},{"location":"c_base/inherit/#2","text":"\u6d3e\u751f\u7c7b\u5728\u7ee7\u627f\u57fa\u7c7b\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9apublic\u3001protected\u3001private\u4e09\u79cd\u7ee7\u627f\u65b9\u5f0f\uff1a public\u7ee7\u627f\uff1a\u57fa\u7c7bpublic\u6210\u5458\uff0cprotected\u6210\u5458\uff0cprivate\u6210\u5458\u7684\u8bbf\u95ee\u5c5e\u6027\u5728\u6d3e\u751f\u7c7b\u4e2d\u5206\u522b\u53d8\u6210\uff1apublic, protected, private protected\u7ee7\u627f\uff1a\u57fa\u7c7bpublic\u6210\u5458\uff0cprotected\u6210\u5458\uff0cprivate\u6210\u5458\u7684\u8bbf\u95ee\u5c5e\u6027\u5728\u6d3e\u751f\u7c7b\u4e2d\u5206\u522b\u53d8\u6210\uff1aprotected, protected, private private\u7ee7\u627f\uff1a\u57fa\u7c7bpublic\u6210\u5458\uff0cprotected\u6210\u5458\uff0cprivate\u6210\u5458\u7684\u8bbf\u95ee\u5c5e\u6027\u5728\u6d3e\u751f\u7c7b\u4e2d\u5206\u522b\u53d8\u6210\uff1aprivate, private, private \u2003\u4f46\u65e0\u8bba\u54ea\u79cd\u7ee7\u627f\u65b9\u5f0f\uff0c\u57fa\u7c7b\u4e2d\u7684private\u6210\u5458\u53ea\u80fd\u88ab\u672c\u7c7b\u6210\u5458\uff08\u7c7b\u5185\uff09\u548c\u53cb\u5143\u8bbf\u95ee\uff0c\u4e0d\u80fd\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\uff1b\u4ee5\u53caprotected\u6210\u5458\u53ef\u4ee5\u88ab\u6d3e\u751f\u7c7b\u8bbf\u95ee\u3002 \u2003\u7ee7\u627f\u5173\u7cfb\u6539\u53d8\u7684\u662f\u6d3e\u751f\u7c7b\u7684\u6d3e\u751f\u7c7b\u5bf9\u4e8e\u57fa\u7c7b\u6210\u5458\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u4ee5private\u7ee7\u627f\u4e3a\u4f8b\uff0c\u57fa\u7c7b\u7684public\u6210\u5458\u5bf9\u4e8e\u6d3e\u751f\u7c7b\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e5f\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684\u3002 \u91cd\u70b9\u8bf4\u660e \u2003\u4ee5public \u5f62\u5f0f\u7ee7\u627f\uff0c\u7f16\u8bd1\u5668\u4f1a\u5728\u5fc5\u8981\u65f6\u523b\uff0c\u5c06\u6d3e\u751f\u7c7b\u5bf9\u8c61\u8f6c\u6362\u6210\u57fa\u7c7b\u5bf9\u8c61\uff1b\u800c\u4ee5private\u5f62\u5f0f\u7ee7\u627f\uff0c\u5219\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u884c\u4e3a\u3002 \u2003 private \u7ee7\u627f\u610f\u5473\u7740implemented-in-terms-of(\u6839\u636e\u67d0\u7269\u5b9e\u73b0\u51fa)\uff0c\u5373\u6d3e\u751f\u7c7b\u4e0e\u57fa\u7c7b\u5e76\u4e0d\u5b58\u5728is-a\u7684\u5173\u7cfb\u3002 \u2003\u5f53\u4f60\u9762\u5bf9\u5e76\u4e0d\u5b58\u5728is-a\u5173\u7cfb\u7684\u4e24\u4e2aclasses\uff0c\u5176\u4e2d\u4e00\u4e2a\u7c7b\u9700\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2a\u7c7bprotected\u6210\u5458\uff0c\u6216\u8005\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\u5176\u4e00\u6216\u591a\u4e2avirtual\u51fd\u6570\uff0c\u53ef\u4ee5\u8003\u8651private\u7ee7\u627f\u3002","title":"2. \u7ee7\u627f\u5173\u7cfb"},{"location":"c_base/inherit/#3","text":"\u5141\u8bb8\u6d3e\u751f\u7c7b\u4ece\u5b83\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u57fa\u7c7b\u4e2d\u7ee7\u627f\u6784\u9020\u51fd\u6570\uff0c\u6b64\u5916\u5982\u679c\u4ece\u591a\u4e2a\u57fa\u7c7b\u4e2d\u7ee7\u627f\u4e86\u76f8\u540c\u7684\u6784\u9020\u51fd\u6570\uff08\u5373\u5f62\u53c2\u5217\u8868\u76f8\u540c\uff09\uff0c\u5219\u6d3e\u751f\u7c7b\u5fc5\u987b\u5b9a\u4e49\u4e13\u5c5e\u7248\u672c\u7684\u6784\u9020\u51fd\u6570\uff0c\u4e0e\u57fa\u7c7b\u7684\u5f62\u53c2\u5217\u8868\u4e0d\u540c\u3002 \u2003\u57fa\u7c7b\u6216\u6d3e\u751f\u7c7b\u7684\u5408\u6210\u62f7\u8d1d\u63a7\u5236\u6210\u8bed\u3001\u5408\u6210\u6784\u9020\u51fd\u6570\u3001\u8d4b\u503c\u8fd0\u7b97\u7b26\u6216\u6790\u6784\u51fd\u6570\uff0c\u5b83\u4eec\u5bf9\u672c\u8eab\u7684\u6210\u5458\u4f9d\u6b21\u8fdb\u884c\u521d\u59cb\u5316\u3001\u8d4b\u503c\u6216\u9500\u6bc1\u64cd\u4f5c\uff0c\u6b64\u5916\u8fd8\u8d1f\u8d23\u4f7f\u7528\u76f4\u63a5\u57fa\u7c7b\u4e2d\u5bf9\u5e94\u7684\u64cd\u4f5c\u5bf9\u4e00\u4e2a\u5bf9\u8c61\u7684\u76f4\u63a5\u57fa\u7c7b\u90e8\u5206\u8fdb\u884c\u521d\u59cb\u5316\u3001\u8d4b\u503c\u6216\u9500\u6bc1\u76f4\u81f3\u7ee7\u627f\u94fe\u9876\u7aef\u3002 \u2003\u5c3d\u7ba1\u5728\u6d3e\u751f\u5217\u8868\u4e2d\u540c\u4e00\u4e2a\u57fa\u7c7b\u53ea\u80fd\u51fa\u73b0\u5728\u4e00\u6b21\uff0c\u4f46\u6d3e\u751f\u7c7b\u53ef\u4ee5\u591a\u6b21\u7ee7\u627f\u540c\u4e00\u4e2a\u7c7b\u3002\u6d3e\u751f\u7c7b\u53ef\u4ee5\u901a\u8fc7\u5176\u591a\u4e2a\u57fa\u7c7b\u5206\u522b\u7ee7\u627f\u540c\u4e00\u4e2a\u95f4\u63a5\u57fa\u7c7b\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7ee7\u627f\u67d0\u4e2a\u57fa\u7c7b\uff0c\u7136\u540e\u901a\u8fc7\u53e6\u4e00\u4e2a\u57fa\u7c7b\u518d\u4e00\u6b21\u95f4\u63a5\u7ee7\u627f\u8be5\u7c7b\u3002 \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6d3e\u751f\u7c7b\u4e2d\u542b\u6709\u7ee7\u627f\u94fe\u4e0a\u6bcf\u4e2a\u7c7b\u5bf9\u5e94\u7684\u5b50\u90e8\u5206\uff0c \u5982\u679c\u67d0\u4e2a\u7c7b\u5728\u6d3e\u751f\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u591a\u6b21\uff0c\u5219\u6d3e\u751f\u7c7b\u4e2d\u5c06\u5305\u542b\u8be5\u7c7b\u7684\u591a\u4e2a\u5b50\u5bf9\u8c61\u3002 \u2003 \u865a\u7ee7\u627f \uff1a\u4ee4\u67d0\u4e2a\u7c7b\u505a\u51fa\u58f0\u660e\uff0c\u627f\u8bfa\u613f\u610f\u5171\u4eab\u5b83\u7684\u57fa\u7c7b\u3002\u5176\u4e2d\u5171\u4eab\u7684\u57fa\u7c7b\u5b50\u5bf9\u8c61\u79f0\u4e3a\u865a\u57fa\u7c7b\u3002\u5728\u8fd9\u79cd\u673a\u5236\u4e0b\uff0c\u4e0d\u8bba\u865a\u57fa\u7c7b\u5728\u7ee7\u627f\u4f53\u7cfb\u4e2d\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff0c\u5728\u6d3e\u751f\u7c7b\u4e2d\u90fd\u53ea\u5305\u542b\u552f\u4e00\u4e00\u4e2a\u5171\u4eab\u7684\u865a\u57fa\u7c7b\u5b50\u5bf9\u8c61\u3002 class Bear: virtual public ZooAnimal{} //virtual\u548cpublic\u987a\u5e8f\u968f\u610f\uff0c virtual\u8bf4\u660e\u4e86\u4e00\u79cd\u610f\u613f\uff0c\u5373\u5728\u540e\u7eed\u7684\u6d3e\u751f\u7c7b\u5f53\u4e2d\u5171\u4eab\u865a\u57fa\u7c7b\u7684\u540c\u4e00\u4efd\u5b9e\u4f8b \u865a\u6d3e\u751f\u53ea\u5f71\u54cd\u4ece\u6307\u5b9a\u4e86\u865a\u57fa\u7c7b\u7684\u6d3e\u751f\u8fdb\u4e00\u6b65\u6d3e\u751f\u51fa\u7684\u7c7b\uff0c\u4e0d\u4f1a\u5f71\u54cd\u6d3e\u751f\u7c7b\u672c\u8eab\u3002\uff08eg.\u5373\u5f71\u54cd\u7684\u662fBear\u7684\u6d3e\u751f\u7c7b\uff09 \u5f71\u54cd\u5305\u62ec: \u865a\u57fa\u7c7b\u662f\u7531\u6700\u5e95\u5c42\u7684\u6d3e\u751f\u7c7b\u521d\u59cb\u5316\u7684\uff1b \u865a\u57fa\u7c7b\u6210\u5458\u7684\u53ef\u89c1\u6027 : \u5047\u5b9aB\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3ax\u7684\u6210\u5458\uff0cD1\u548cD2\u90fd\u662f\u4eceB\u865a\u7ee7\u627f\u5f97\u5230\u7684\uff0cD\u7ee7\u627f\u4e86D1\u548cD2\uff0c\u5219\u5728D\u7684\u4f5c\u7528\u57df\u4e2d\uff0cx\u901a\u8fc7D\u7684\u4fe9\u4e2a\u57fa\u7c7b\u90fd\u662f\u53ef\u89c1\u7684\uff0c\u5982\u679c\u6211\u4eec\u901a\u8fc7D\u7684\u5bf9\u8c61\u4f7f\u7528x\uff0c\u6709\u4e09\u79cd\u53ef\u80fd\u6027\uff1a \u20031.\u5982\u679c\u5728D1\u548cD2\u4e2d\u90fd\u6ca1\u6709x\u7684\u5b9a\u4e49\uff0c\u5219x\u5c06\u88ab\u89e3\u6790\u4e3aB\u7684\u6210\u5458\uff0c\u6b64\u65f6\u4e0d\u5b58\u5728\u4e8c\u4e49\u6027\uff0c\u4e00\u4e2aD\u7684\u5bf9\u8c61\u53ea\u542b\u6709x\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff1b \u20032.\u5982\u679cx\u662fB\u7684\u6210\u5458\uff0c\u540c\u65f6\u662fD1\u548cD2\u4e2d\u67d0\u4e00\u4e2a\u7684\u6210\u5458\uff0c\u5219\u540c\u6837\u6ca1\u6709\u4e8c\u4e49\u6027\uff0c\u6d3e\u751f\u7c7b\u7684x\u6bd4\u5171\u4eab\u865a\u57fa\u7c7bB\u7684x\u4f18\u5148\u7ea7\u66f4\u9ad8\uff1b \u20033.\u5982\u679c\u5728D1\u548cD2\u4e2d\u90fd\u6709x\u7684\u5b9a\u4e49\uff0c\u5219\u76f4\u63a5\u8bbf\u95eex\u5c06\u4ea7\u751f\u4e8c\u4e49\u6027\u95ee\u9898\uff1b\u4e0e\u975e\u865a\u7684\u591a\u91cd\u7ee7\u627f\u4f53\u7cfb\u4e00\u6837\uff0c\u89e3\u51b3\u8fd9\u79cd\u4e8c\u4e49\u6027\u95ee\u9898\u6700\u597d\u7684\u65b9\u6cd5\u662f\u5728\u6d3e\u751f\u7c7b\u4e2d\u4e3a\u6210\u5458\u81ea\u5b9a\u4e49\u65b0\u7684\u5b9e\u4f8b\u3002 \u542b\u6709\u865a\u57fa\u7c7b\u7684\u5bf9\u8c61\u7684\u6784\u9020\u987a\u5e8f\u4e0e\u4e00\u822c\u7684\u987a\u5e8f\u533a\u522b\uff1a\u9996\u5148\u4f7f\u7528\u63d0\u4f9b\u7ed9\u6700\u5e95\u5c42\u6d3e\u751f\u7c7b\u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u503c\u521d\u59cb\u5316\u8be5\u5bf9\u8c61\u7684\u865a\u57fa\u7c7b\u90e8\u5206\uff0c\u63a5\u4e0b\u6765\u6309\u7167\u76f4\u63a5\u57fa\u7c7b\u5728\u6d3e\u751f\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u4f9d\u6b21\u8fdb\u884c\u521d\u59cb\u5316\uff1b \u6790\u6784\u51fd\u6570\u987a\u5e8f\u4e0e\u6b64\u76f8\u53cd\u3002","title":"3.\u591a\u91cd\u7ee7\u627f"},{"location":"c_base/initialization/","text":"About Initialization \u58f0\u660e \u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\u53ea\u662f\u5c06\u53d8\u91cf\u540d\u6807\u8bc6\u7b26\u7684\u6709\u5173\u4fe1\u606f\u544a\u8bc9\u7f16\u8bd1\u5668\uff0c\u4f7f\u7f16\u8bd1\u5668\u201c\u8ba4\u8bc6\u201d\u8be5\u6807\u8bc6\u7b26\uff0c\u4f46\u58f0\u660e\u4e0d\u4e00\u5b9a\u5f15\u8d77\u5185\u5b58\u7684\u5206\u914d\u3002 \u5b9a\u4e49 \u5b9a\u4e49\u53d8\u91cf\u610f\u5473\u7740\u7ed9\u53d8\u91cf\u5206\u914d\u5185\u5b58\u7a7a\u95f4\uff0c\u7528\u4e8e\u5b58\u653e\u5bf9\u5e94\u7c7b\u578b\u7684\u6570\u636e\uff0c\u53d8\u91cf\u540d\u5c31\u662f\u5bf9\u76f8\u5e94\u7684\u5185\u5b58\u5355\u5143\u7684\u547d\u540d\u3002\u800c\u5728C++\u7a0b\u5e8f\u4e2d\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u53d8\u91cf\u58f0\u660e\u4e5f\u5c31\u662f\u53d8\u91cf\u5b9a\u4e49\uff0c\u58f0\u660e\u53d8\u91cf\u7684\u540c\u65f6\u4e5f\u5c31\u5b8c\u6210\u4e86\u53d8\u91cf\u7684\u5b9a\u4e49\uff0c\u4e0d\u8fc7\u4e5f\u6709\u4f8b\u5916\u3002\u5982\u679c\u60f3\u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\u800c\u975e\u5b9a\u4e49\u5b83\uff0c\u5219\u53ef\u52a0\u4e0aextern\u5173\u952e\u5b57\uff0c\u800c\u4e14\u4e0d\u7528\u663e\u793a\u521d\u59cb\u5316\u53d8\u91cf\u3002 \u4efb\u4f55\u5305\u542b\u4e86\u663e\u793a\u521d\u59cb\u5316\u7684\u58f0\u660e\u5373\u6210\u4e3a\u5b9a\u4e49, \u5373extern\u8bed\u53e5\u5982\u679c\u5305\u542b\u521d\u59cb\u503c\u5c31\u4e0d\u518d\u662f\u58f0\u660e\uff0c\u800c\u53d8\u6210\u5b9a\u4e49\u4e86\u3002 extern int a; //\u4ec5\u4ec5\u58f0\u660e\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf \uff0c\u6ca1\u6709\u5b9a\u4e49\uff0c int a; //\u58f0\u660e\u5e76\u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf extern int a = 0;//\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\u5e76\u521d\u59cb\u5316\u521d\u503c int a = 0; //\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\u5e76\u521d\u59cb\u5316\u521d\u503c \u53d8\u91cf\u7684\u5b9a\u4e49\u5fc5\u987b\u51fa\u73b0\u4e14\u53ea\u80fd\u51fa\u73b0\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u800c\u5176\u4ed6\u7528\u5230\u8be5\u53d8\u91cf\u7684\u6587\u4ef6\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u8bf4\u660e\uff0c\u4f46\u7edd\u4e0d\u80fd\u91cd\u590d\u5b9a\u4e49\u3002\u5f53\u4f60\u8981\u5f15\u7528\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u65f6\uff0c\u4f60\u5c31\u8981\u58f0\u660eextern int a;\u8fd9\u4e2a\u65f6\u5019extern\u4e0d\u80fd\u7701\uff0c\u5426\u5219\u5c31\u6210\u5b9a\u4e49\u4e86\u3002\u4f8b\u5982\u5982\u679c\u60f3\u8981\u5728\u591a\u4e2a\u6587\u4ef6\u4e4b\u95f4\u5171\u4eabconst\u5bf9\u8c61\u65f6\uff0c\u5fc5\u987b\u5728\u53d8\u91cf\u7684\u5b9a\u4e49\u4e4b\u524d\u6dfb\u52a0extern\u3002 header.h extern const int a =1; main.cpp main(){ extern const int a; cout << a; //\u8f93\u51fa1 } \u4e0d\u80fd\u5728\u4efb\u4f55\u51fd\u6570\u4f53\u5185\u90e8(\u5305\u62ecmain\u51fd\u6570)\u521d\u59cb\u5316\u4e00\u4e2a\u7531extern\u5173\u952e\u5b57\u6807\u8bb0\u7684\u53d8\u91cf\u3002 \u521d\u59cb\u5316 \u521d\u59cb\u5316\u4e0d\u662f\u8d4b\u503c\uff0c\u5176\u542b\u4e49\u662f\u521b\u5efa\u4e00\u4e2a\u53d8\u91cf\u65f6\u8d4b\u4e88\u5176\u4e00\u4e2a\u521d\u59cb\u503c\uff0c\u800c\u8d4b\u503c\u7684\u542b\u4e49\u662f\u628a\u5bf9\u8c61\u5f53\u524d\u503c\u64e6\u9664\uff0c\u800c\u4ee5\u4e00\u4e2a\u65b0\u503c\u6765\u66ff\u4ee3\u3002 int a=1; //\u521d\u59cb\u5316 a=2; //\u8d4b\u503c \u5217\u8868\u521d\u59cb\u5316\uff0c \u8981\u6c42\u63d0\u4f9b\u7684\u521d\u59cb\u503c\u4e0e\u8981\u521d\u59cb\u5316\u7684\u53d8\u91cf\u7c7b\u578b\u4e25\u683c\u7edf\u4e00\uff0c\u5728 \u4f7f\u7528\u5217\u8868\u521d\u59cb\u5316\u65f6\uff0c\u82e5\u521d\u59cb\u503c\u5b58\u5728\u4e22\u5931\u4fe1\u606f\u7684\u98ce\u9669(\u5982\u7528long\u3001double\u7684\u503c\u53bb\u521d\u59cb\u5316int\u53d8\u91cf\uff0c\u6709\u53ef\u80fd\u4e22\u5931\u6570\u636e\u6216\u8005\u6ea2\u51fa)\uff0c\u5219\u7f16\u8bd1\u5668\u5c06\u62a5\u9519\u3002 int a ={0}; int b{0}; \u521d\u59cb\u5316\u4e0e\u5b9a\u4e49\uff0c\u5b9a\u4e49\u53d1\u751f\u65f6\u4e0d\u4e00\u5b9a\u4f1a\u8fdb\u884c\u521d\u59cb\u5316\uff1a \u5f53\u53d8\u91cf\u4e3a\u81ea\u5b9a\u4e49\u7c7b\u7c7b\u578b: \u2003\u8c03\u7528\u81ea\u8eab\u7684\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u8fdb\u884c\u521d\u59cb\u5316\u3002 \u5f53\u53d8\u91cf\u4e3a\u5185\u7f6e\u7c7b\u578b\u65f6: \u2003\u8be5\u53d8\u91cf\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u5916\u65f6\uff0c\u5c06\u88ab\u521d\u59cb\u5316\u4e3a0\u3002 \u2003\u8be5\u53d8\u91cf\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u5185\u65f6\uff0c\u5c06\u4e0d\u4f1a\u8fdb\u884c\u521d\u59cb\u5316, \u4e00\u4e2a\u672a\u88ab\u521d\u59cb\u5316\u7684\u5185\u7f6e\u7c7b\u578b\u53d8\u91cf\u7684\u503c\u662f\u672a\u5b9a\u4e49\u7684\u3002 \u7c7b\u6210\u5458\u53d8\u91cf\u521d\u59cb\u5316\uff1a\u521d\u59cb\u5316\u5217\u8868\u548c\u8d4b\u503c\u521d\u59cb\u5316 \u521d\u59cb\u5316\u5217\u8868: \u683c\u5f0f: Base(int a1, int a2, A a): data1(a1), data2(a2), data3(a); \u2003\u5fc5\u987b\u7528\u521d\u59cb\u5316\u5217\u8868\u7684\u60c5\u51b5\uff1a \u20031\uff09\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a\u7c7b\u6210\u5458\uff0c\u5b83\u672c\u8eab\u662f\u4e00\u4e2a\u7c7b\u6216\u8005\u662f\u4e00\u4e2a\u7ed3\u6784\uff0c\u800c\u4e14\u8fd9\u4e2a\u6210\u5458\u5b83\u53ea\u6709\u4e00\u4e2a\u5e26\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\uff0c\u6ca1\u6709\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u3002\u8fd9\u65f6\u8981\u5bf9\u8fd9\u4e2a\u7c7b\u6210\u5458\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u5c31\u5fc5\u987b\u8c03\u7528\u8fd9\u4e2a\u7c7b\u6210\u5458\u7684\u5e26\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\u3002 \u20032\uff09\u5f53\u7c7b\u6210\u5458\u4e2d\u542b\u6709\u4e00\u4e2aconst\u5bf9\u8c61\u65f6\uff0c\u6216\u8005\u662f\u4e00\u4e2a\u5f15\u7528\u65f6\uff0c\u4ed6\u4eec\u4e5f\u5fc5\u987b\u8981\u901a\u8fc7\u6210\u5458\u521d\u59cb\u5316\u5217\u8868\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u56e0\u4e3a\u8fd9\u4e24\u79cd\u5bf9\u8c61\u8981\u5728\u58f0\u660e\u540e\u9a6c\u4e0a\u521d\u59cb\u5316\uff0c\u800c\u5728\u6784\u9020\u51fd\u6570\u4e2d\uff0c\u505a\u7684\u662f\u5bf9\u4ed6\u4eec\u7684\u8d4b\u503c\uff0c\u8fd9\u6837\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\u3002 \u20033\uff09 \u5b50\u7c7b\u521d\u59cb\u5316\u7236\u7c7b\u7684\u79c1\u6709\u6210\u5458\uff0c\u9700\u8981\u5728(\u5e76\u4e14\u4e5f\u53ea\u80fd\u5728)\u53c2\u6570\u521d\u59cb\u5316\u5217\u8868\u4e2d\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570 \u3002 \u20034)\u6210\u5458\u53d8\u91cf\u7684\u521d\u59cb\u5316\u987a\u5e8f\u4e0e\u58f0\u660e\u7684\u987a\u5e8f\u76f8\u5173\uff0c\u4e0e\u5728\u521d\u59cb\u5316\u5217\u8868\u4e2d\u7684\u987a\u5e8f\u65e0\u5173\uff1b\u521d\u59cb\u5316\u5217\u8868\u5148\u4e8e\u6784\u9020\u51fd\u6570\u7684\u51fd\u6570\u4f53\u6267\u884c\u3002 \u7c7b\u5185\u521d\u59cb\u503c\uff1a\u63d0\u4f9b\u4e00\u4e2a \u7c7b\u5185\u521d\u59cb\u503c \u65f6\uff0c\u5fc5\u987b\u4ee5\u7b26\u5408=\u6216\u8005\u82b1\u62ec\u53f7\u8868\u793a\uff0c\u4e0d\u80fd\u7528()\u62ec\u53f7\uff1b eg: vector f{type_item}; //\u6b63\u786e vector f(n, type_item); //\u610f\u56fe\u521d\u59cb\u5316\u5305\u542bn\u4e2atype_item\u7684vector\uff0c\u9519\u8bef\u539f\u56e0\u662f\u5bb9\u6613\u548c\u51fd\u6570\u58f0\u660e\u51b2\u7a81\uff1b\u8be5\u53e5\u5728\u7c7b\u5916\u4f7f\u7528\u65f6\u662f\u53ef\u4ee5\u7684\u3002 static member data initialization \u2003\u9759\u6001\u6210\u5458\u53d8\u91cf\u4e0d\u5c5e\u4e8e\u7c7b\u7684\u4efb\u4f55\u4e00\u4e2a\u5bf9\u8c61\uff0c\u6240\u4ee5\u5b83\u4eec\u5e76\u4e0d\u662f\u5728\u521b\u5efa\u7c7b\u7684\u5bf9\u8c61\u65f6\u88ab\u5b9a\u4e49\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u4e0d\u662f\u7531\u7c7b\u7684\u6784\u9020\u51fd\u6570\u521d\u59cb\u5316\u7684\u3002\u5373\u5728\u7c7b\u5185\u7684\u9759\u6001\u6210\u5458\u53d8\u91cf\u58f0\u660e\u5e76\u975e\u5b9a\u4e49\uff0c \u53ea\u6709\u5728\u7c7b\u5916\u5b9a\u4e49\u6216\u8005\u521d\u59cb\u5316\u540e\uff0c\u624d\u80fd\u8bbf\u95ee\u8be5\u9759\u6001\u6210\u5458\u53d8\u91cf\u3002 \u6240\u4ee5static \u6210\u5458\u53d8\u91cf\u4e0d\u968f\u5bf9\u8c61\u7684\u521b\u5efa\u800c\u5206\u914d\u5185\u5b58\uff0c\u4e5f\u4e0d\u968f\u5bf9\u8c61\u7684\u9500\u6bc1\u800c\u91ca\u653e\u5185\u5b58\u3002\u800c\u666e\u901a\u6210\u5458\u53d8\u91cf\u5728\u5bf9\u8c61\u521b\u5efa\u65f6\u5206\u914d\u5185\u5b58\uff0c\u5728\u5bf9\u8c61\u9500\u6bc1\u65f6\u91ca\u653e\u5185\u5b58\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5728\u7c7b\u5185\u521d\u59cb\u5316\u9759\u6001\u6210\u5458\uff0c\u800c\u662f\u5728\u7c7b\u5916\u5bf9\u5176\u521d\u59cb\u5316\uff0c eg: \u7c7b\u5185\u58f0\u660e\u4e3a static vector< int > elems; \u7c7b\u5916\u521d\u59cb\u5316\u4e3a vector< int > class_name::elems; \u8fd9\u91cc\u53ef\u4ee5\u8d4b\u521d\u503c\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u8d4b\u3002 \u4e0d\u8fc7\u4e5f\u53ef\u4ee5\u4e3a\u9759\u6001\u6210\u5458\u53d8\u91cf\u63d0\u4f9b\u7c7b\u5185const\u521d\u59cb\u503c\uff0c\u4f46\u8981\u6c42\u9759\u6001\u6210\u5458\u5fc5\u987b\u662f\u5b57\u9762\u503c\u5e38\u91cf\u7c7b\u578b\u7684constexpr\uff0c\u521d\u59cb\u503c\u4e5f\u5fc5\u987b\u662f\u5e38\u91cf\u8868\u8fbe\u5f0f\u3002 eg. static contestexpr int period = 20; static const int _buf_size =1024; \u5373\u4f7f\u4e00\u4e2astatic member data\u5728\u7c7b\u5185\u88ab\u521d\u59cb\u5316\u540e\uff0c\u4e5f\u5e94\u5728\u7c7b\u7684\u5916\u90e8\u5b9a\u4e49\u4e00\u4e0b\u8be5\u6210\u5458\u3002 \u503c\u521d\u59cb\u5316\u4e0e\u9ed8\u8ba4\u521d\u59cb\u5316 \u2003\u503c\u521d\u59cb\u5316\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u7528\u6570\u503c\u521d\u59cb\u5316\u53d8\u91cf\u3002 \u2003\u9ed8\u8ba4\u521d\u59cb\u5316\uff1a\u5982\u679c\u5b9a\u4e49\u53d8\u91cf\u65f6\u6ca1\u6709\u6307\u5b9a\u521d\u503c\uff0c\u5219\u53d8\u91cf\u88ab\u9ed8\u8ba4\u521d\u59cb\u5316\u3002\u5176\u521d\u59cb\u503c\u548c\u53d8\u91cf\u7684\u7c7b\u578b\u4ee5\u53ca\u53d8\u91cf\u5b9a\u4e49\u7684\u4f4d\u7f6e\u76f8\u5173\u3002 \u9ed8\u8ba4\u521d\u59cb\u5316\u7c7b\u5bf9\u8c61\u548c\u9ed8\u8ba4\u521d\u59cb\u5316\u5185\u7f6e\u7c7b\u578b\u53d8\u91cf\u6709\u6240\u4e0d\u540c \u3002 \u2003\u5bf9\u4e8e\u9ed8\u8ba4\u521d\u59cb\u5316\u5185\u7f6e\u7c7b\u578b\u53d8\u91cf\u6765\u8bf4\uff1a\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u4e4b\u5916\u7684\u53d8\u91cf\u662f\u5168\u5c40\u53d8\u91cf\uff0c\u4e00\u822c\u5b58\u50a8\u5728\u5168\u5c40\u533a\uff0c\u5b58\u50a8\u5728\u5168\u5c40\u533a\u7684\u53d8\u91cf\u4e00\u822c\u4f1a\u6267\u884c\u503c\u521d\u59cb\u5316\u3002\u6b64\u65f6\uff0c\u5176\u521d\u59cb\u503c\u548c\u53d8\u91cf\u7684\u7c7b\u578b\u6709\u5173\u3002\u5bf9\u4e8eint\u7c7b\u578b\u5176\u521d\u59cb\u503c\u4e3a0\uff0c\u5bf9\u4e8echar\u7c7b\u578b\u5176\u9ed8\u8ba4\u521d\u59cb\u503c\u4e3a''\u3002 \u2003\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u5185\u90e8\u7684\u662f\u5c40\u90e8\u53d8\u91cf\uff0c\u5176\u5b58\u50a8\u5728\u6808\u533a\u4e2d\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u521d\u503c\uff0c\u90a3\u4e48\u8be5\u5c40\u90e8\u53d8\u91cf\u5c06\u4e0d\u4f1a\u88ab\u521d\u59cb\u5316\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u5c40\u90e8\u53d8\u91cf\u7684\u503c\u662f\u672a\u5b9a\u4e49\u7684\uff0c\u662f\u4e2a\u968f\u673a\u503c\u3002\u6b64\u65f6\uff0c\u5982\u679c\u4e0d\u7ed9\u8fd9\u4e2a\u5c40\u90e8\u53d8\u91cf\u8d4b\u503c\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4f7f\u7528\u8be5\u5c40\u90e8\u53d8\u91cf\uff0c\u5426\u5219\u5c31\u4f1a\u51fa\u9519\uff0c\u6ce8\u610f\u8fd9\u79cd\u60c5\u51b5\u662f\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u65e2\u6ca1\u6709\u4f7f\u7528\u9ed8\u8ba4\u521d\u59cb\u5316\u4e5f\u6ca1\u6709\u4f7f\u7528\u503c\u521d\u59cb\u5316\uff0c\u6ca1\u6709\u521d\u59cb\u5316\u7684\u503c\u662f\u4e0d\u80fd\u4f7f\u7528\u7684. Uniform Initialization \u2003Since C++ 11, for any initialization, you can use one common syntax, that is brace, \"{}\". int va[] {1, 2, 3}; vector<int> vec {1, 2, 3}; complex<double> c{4.0, 2.0}; \u2003 \u7f16\u8bd1\u5668\u770b\u5230\"{}\"\u4f1a\u5c06\u5176\u89c6\u4e3ainitializer_list , \u5176\u53c8\u5173\u8054\u4e00\u4e2aarray (intializer_list\u5185\u90e8\u6709\u4e00\u4e2a\u6307\u5411array\u7684\u6307\u9488\uff0c\u62f7\u8d1d\u4e00\u4e2ainitializer_list\u5c5e\u4e8e\u6d45\u62f7\u8d1d\uff0c\u9020\u6210\u4e24\u4e2a\u5bf9\u8c61\u4e2d\u7684\u6307\u9488\u6307\u5411\u540c\u4e00\u4e2aarray)\u3002\u8c03\u7528\u6784\u9020\u51fd\u6570\u65f6: \u82e5\u5b58\u5728\u4e00\u4e2a\u7248\u672c\u6709\u591a\u4e2a\u53c2\u6570\uff0c\u901a\u8fc7{}\u521d\u59cb\u5316\u65f6\uff0c\u5173\u8054\u7684array\u5185\u7684\u5143\u7d20\u53ef\u88ab\u7f16\u8bd1\u5668\u5206\u89e3\u9010\u4e00\u4f20\u9012\u7ed9\u51fd\u6570\uff1b \u901a\u8fc7()\u521d\u59cb\u5316\u65f6\uff0c\u63d0\u4f9b\u548c\u6784\u9020\u51fd\u6570\u76f8\u540c\u6570\u91cf\u3001\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u4e5f\u53ef\u8fdb\u884c\u521d\u59cb\u5316\u3002 \u82e5\u5b58\u5728\u4e00\u4e2a\u7248\u672c\u63a5\u53d7initializaer_list \u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5219\u901a\u8fc7{}\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u4f18\u5148\u4f7f\u7528\u8be5\u7248\u672c\u3002 class P{ public: P(int a, b){cout<<\"P(int,int), a=\"<<a<<\" , b=\"<<b;} P(initializer_list<int> initlist){ cout <<\"P{initializer_list<int>}, vlaues=\"; for(auto& v: initlist){ cout<<v<<\" \"; } } } //\u6d4b\u8bd5 P p(1, 2); // \u8f93\u51faP(int, int), a=1, b=2 P p2{1, 2}; // \u8f93\u51faP{initializer_list<int>}, values=1, 2 P p3{1, 2, 3}; // \u8f93\u51faP{initializer_list<int>}, values=1, 2, 3 P p4={1, 2, 2}; // \u8f93\u51faP{initializer_list<int>}, values=1, 2, 2","title":"initialization"},{"location":"c_base/initialization/#about-initialization","text":"","title":"About Initialization"},{"location":"c_base/initialization/#_1","text":"\u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\u53ea\u662f\u5c06\u53d8\u91cf\u540d\u6807\u8bc6\u7b26\u7684\u6709\u5173\u4fe1\u606f\u544a\u8bc9\u7f16\u8bd1\u5668\uff0c\u4f7f\u7f16\u8bd1\u5668\u201c\u8ba4\u8bc6\u201d\u8be5\u6807\u8bc6\u7b26\uff0c\u4f46\u58f0\u660e\u4e0d\u4e00\u5b9a\u5f15\u8d77\u5185\u5b58\u7684\u5206\u914d\u3002","title":"\u58f0\u660e"},{"location":"c_base/initialization/#_2","text":"\u5b9a\u4e49\u53d8\u91cf\u610f\u5473\u7740\u7ed9\u53d8\u91cf\u5206\u914d\u5185\u5b58\u7a7a\u95f4\uff0c\u7528\u4e8e\u5b58\u653e\u5bf9\u5e94\u7c7b\u578b\u7684\u6570\u636e\uff0c\u53d8\u91cf\u540d\u5c31\u662f\u5bf9\u76f8\u5e94\u7684\u5185\u5b58\u5355\u5143\u7684\u547d\u540d\u3002\u800c\u5728C++\u7a0b\u5e8f\u4e2d\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u53d8\u91cf\u58f0\u660e\u4e5f\u5c31\u662f\u53d8\u91cf\u5b9a\u4e49\uff0c\u58f0\u660e\u53d8\u91cf\u7684\u540c\u65f6\u4e5f\u5c31\u5b8c\u6210\u4e86\u53d8\u91cf\u7684\u5b9a\u4e49\uff0c\u4e0d\u8fc7\u4e5f\u6709\u4f8b\u5916\u3002\u5982\u679c\u60f3\u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\u800c\u975e\u5b9a\u4e49\u5b83\uff0c\u5219\u53ef\u52a0\u4e0aextern\u5173\u952e\u5b57\uff0c\u800c\u4e14\u4e0d\u7528\u663e\u793a\u521d\u59cb\u5316\u53d8\u91cf\u3002 \u4efb\u4f55\u5305\u542b\u4e86\u663e\u793a\u521d\u59cb\u5316\u7684\u58f0\u660e\u5373\u6210\u4e3a\u5b9a\u4e49, \u5373extern\u8bed\u53e5\u5982\u679c\u5305\u542b\u521d\u59cb\u503c\u5c31\u4e0d\u518d\u662f\u58f0\u660e\uff0c\u800c\u53d8\u6210\u5b9a\u4e49\u4e86\u3002 extern int a; //\u4ec5\u4ec5\u58f0\u660e\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf \uff0c\u6ca1\u6709\u5b9a\u4e49\uff0c int a; //\u58f0\u660e\u5e76\u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf extern int a = 0;//\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\u5e76\u521d\u59cb\u5316\u521d\u503c int a = 0; //\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\u5e76\u521d\u59cb\u5316\u521d\u503c \u53d8\u91cf\u7684\u5b9a\u4e49\u5fc5\u987b\u51fa\u73b0\u4e14\u53ea\u80fd\u51fa\u73b0\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u800c\u5176\u4ed6\u7528\u5230\u8be5\u53d8\u91cf\u7684\u6587\u4ef6\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u8bf4\u660e\uff0c\u4f46\u7edd\u4e0d\u80fd\u91cd\u590d\u5b9a\u4e49\u3002\u5f53\u4f60\u8981\u5f15\u7528\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u65f6\uff0c\u4f60\u5c31\u8981\u58f0\u660eextern int a;\u8fd9\u4e2a\u65f6\u5019extern\u4e0d\u80fd\u7701\uff0c\u5426\u5219\u5c31\u6210\u5b9a\u4e49\u4e86\u3002\u4f8b\u5982\u5982\u679c\u60f3\u8981\u5728\u591a\u4e2a\u6587\u4ef6\u4e4b\u95f4\u5171\u4eabconst\u5bf9\u8c61\u65f6\uff0c\u5fc5\u987b\u5728\u53d8\u91cf\u7684\u5b9a\u4e49\u4e4b\u524d\u6dfb\u52a0extern\u3002 header.h extern const int a =1; main.cpp main(){ extern const int a; cout << a; //\u8f93\u51fa1 } \u4e0d\u80fd\u5728\u4efb\u4f55\u51fd\u6570\u4f53\u5185\u90e8(\u5305\u62ecmain\u51fd\u6570)\u521d\u59cb\u5316\u4e00\u4e2a\u7531extern\u5173\u952e\u5b57\u6807\u8bb0\u7684\u53d8\u91cf\u3002","title":"\u5b9a\u4e49"},{"location":"c_base/initialization/#_3","text":"\u521d\u59cb\u5316\u4e0d\u662f\u8d4b\u503c\uff0c\u5176\u542b\u4e49\u662f\u521b\u5efa\u4e00\u4e2a\u53d8\u91cf\u65f6\u8d4b\u4e88\u5176\u4e00\u4e2a\u521d\u59cb\u503c\uff0c\u800c\u8d4b\u503c\u7684\u542b\u4e49\u662f\u628a\u5bf9\u8c61\u5f53\u524d\u503c\u64e6\u9664\uff0c\u800c\u4ee5\u4e00\u4e2a\u65b0\u503c\u6765\u66ff\u4ee3\u3002 int a=1; //\u521d\u59cb\u5316 a=2; //\u8d4b\u503c \u5217\u8868\u521d\u59cb\u5316\uff0c \u8981\u6c42\u63d0\u4f9b\u7684\u521d\u59cb\u503c\u4e0e\u8981\u521d\u59cb\u5316\u7684\u53d8\u91cf\u7c7b\u578b\u4e25\u683c\u7edf\u4e00\uff0c\u5728 \u4f7f\u7528\u5217\u8868\u521d\u59cb\u5316\u65f6\uff0c\u82e5\u521d\u59cb\u503c\u5b58\u5728\u4e22\u5931\u4fe1\u606f\u7684\u98ce\u9669(\u5982\u7528long\u3001double\u7684\u503c\u53bb\u521d\u59cb\u5316int\u53d8\u91cf\uff0c\u6709\u53ef\u80fd\u4e22\u5931\u6570\u636e\u6216\u8005\u6ea2\u51fa)\uff0c\u5219\u7f16\u8bd1\u5668\u5c06\u62a5\u9519\u3002 int a ={0}; int b{0}; \u521d\u59cb\u5316\u4e0e\u5b9a\u4e49\uff0c\u5b9a\u4e49\u53d1\u751f\u65f6\u4e0d\u4e00\u5b9a\u4f1a\u8fdb\u884c\u521d\u59cb\u5316\uff1a \u5f53\u53d8\u91cf\u4e3a\u81ea\u5b9a\u4e49\u7c7b\u7c7b\u578b: \u2003\u8c03\u7528\u81ea\u8eab\u7684\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u8fdb\u884c\u521d\u59cb\u5316\u3002 \u5f53\u53d8\u91cf\u4e3a\u5185\u7f6e\u7c7b\u578b\u65f6: \u2003\u8be5\u53d8\u91cf\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u5916\u65f6\uff0c\u5c06\u88ab\u521d\u59cb\u5316\u4e3a0\u3002 \u2003\u8be5\u53d8\u91cf\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u5185\u65f6\uff0c\u5c06\u4e0d\u4f1a\u8fdb\u884c\u521d\u59cb\u5316, \u4e00\u4e2a\u672a\u88ab\u521d\u59cb\u5316\u7684\u5185\u7f6e\u7c7b\u578b\u53d8\u91cf\u7684\u503c\u662f\u672a\u5b9a\u4e49\u7684\u3002 \u7c7b\u6210\u5458\u53d8\u91cf\u521d\u59cb\u5316\uff1a\u521d\u59cb\u5316\u5217\u8868\u548c\u8d4b\u503c\u521d\u59cb\u5316 \u521d\u59cb\u5316\u5217\u8868: \u683c\u5f0f: Base(int a1, int a2, A a): data1(a1), data2(a2), data3(a); \u2003\u5fc5\u987b\u7528\u521d\u59cb\u5316\u5217\u8868\u7684\u60c5\u51b5\uff1a \u20031\uff09\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a\u7c7b\u6210\u5458\uff0c\u5b83\u672c\u8eab\u662f\u4e00\u4e2a\u7c7b\u6216\u8005\u662f\u4e00\u4e2a\u7ed3\u6784\uff0c\u800c\u4e14\u8fd9\u4e2a\u6210\u5458\u5b83\u53ea\u6709\u4e00\u4e2a\u5e26\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\uff0c\u6ca1\u6709\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u3002\u8fd9\u65f6\u8981\u5bf9\u8fd9\u4e2a\u7c7b\u6210\u5458\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u5c31\u5fc5\u987b\u8c03\u7528\u8fd9\u4e2a\u7c7b\u6210\u5458\u7684\u5e26\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\u3002 \u20032\uff09\u5f53\u7c7b\u6210\u5458\u4e2d\u542b\u6709\u4e00\u4e2aconst\u5bf9\u8c61\u65f6\uff0c\u6216\u8005\u662f\u4e00\u4e2a\u5f15\u7528\u65f6\uff0c\u4ed6\u4eec\u4e5f\u5fc5\u987b\u8981\u901a\u8fc7\u6210\u5458\u521d\u59cb\u5316\u5217\u8868\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u56e0\u4e3a\u8fd9\u4e24\u79cd\u5bf9\u8c61\u8981\u5728\u58f0\u660e\u540e\u9a6c\u4e0a\u521d\u59cb\u5316\uff0c\u800c\u5728\u6784\u9020\u51fd\u6570\u4e2d\uff0c\u505a\u7684\u662f\u5bf9\u4ed6\u4eec\u7684\u8d4b\u503c\uff0c\u8fd9\u6837\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\u3002 \u20033\uff09 \u5b50\u7c7b\u521d\u59cb\u5316\u7236\u7c7b\u7684\u79c1\u6709\u6210\u5458\uff0c\u9700\u8981\u5728(\u5e76\u4e14\u4e5f\u53ea\u80fd\u5728)\u53c2\u6570\u521d\u59cb\u5316\u5217\u8868\u4e2d\u663e\u793a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570 \u3002 \u20034)\u6210\u5458\u53d8\u91cf\u7684\u521d\u59cb\u5316\u987a\u5e8f\u4e0e\u58f0\u660e\u7684\u987a\u5e8f\u76f8\u5173\uff0c\u4e0e\u5728\u521d\u59cb\u5316\u5217\u8868\u4e2d\u7684\u987a\u5e8f\u65e0\u5173\uff1b\u521d\u59cb\u5316\u5217\u8868\u5148\u4e8e\u6784\u9020\u51fd\u6570\u7684\u51fd\u6570\u4f53\u6267\u884c\u3002 \u7c7b\u5185\u521d\u59cb\u503c\uff1a\u63d0\u4f9b\u4e00\u4e2a \u7c7b\u5185\u521d\u59cb\u503c \u65f6\uff0c\u5fc5\u987b\u4ee5\u7b26\u5408=\u6216\u8005\u82b1\u62ec\u53f7\u8868\u793a\uff0c\u4e0d\u80fd\u7528()\u62ec\u53f7\uff1b eg: vector f{type_item}; //\u6b63\u786e vector f(n, type_item); //\u610f\u56fe\u521d\u59cb\u5316\u5305\u542bn\u4e2atype_item\u7684vector\uff0c\u9519\u8bef\u539f\u56e0\u662f\u5bb9\u6613\u548c\u51fd\u6570\u58f0\u660e\u51b2\u7a81\uff1b\u8be5\u53e5\u5728\u7c7b\u5916\u4f7f\u7528\u65f6\u662f\u53ef\u4ee5\u7684\u3002 static member data initialization \u2003\u9759\u6001\u6210\u5458\u53d8\u91cf\u4e0d\u5c5e\u4e8e\u7c7b\u7684\u4efb\u4f55\u4e00\u4e2a\u5bf9\u8c61\uff0c\u6240\u4ee5\u5b83\u4eec\u5e76\u4e0d\u662f\u5728\u521b\u5efa\u7c7b\u7684\u5bf9\u8c61\u65f6\u88ab\u5b9a\u4e49\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u4e0d\u662f\u7531\u7c7b\u7684\u6784\u9020\u51fd\u6570\u521d\u59cb\u5316\u7684\u3002\u5373\u5728\u7c7b\u5185\u7684\u9759\u6001\u6210\u5458\u53d8\u91cf\u58f0\u660e\u5e76\u975e\u5b9a\u4e49\uff0c \u53ea\u6709\u5728\u7c7b\u5916\u5b9a\u4e49\u6216\u8005\u521d\u59cb\u5316\u540e\uff0c\u624d\u80fd\u8bbf\u95ee\u8be5\u9759\u6001\u6210\u5458\u53d8\u91cf\u3002 \u6240\u4ee5static \u6210\u5458\u53d8\u91cf\u4e0d\u968f\u5bf9\u8c61\u7684\u521b\u5efa\u800c\u5206\u914d\u5185\u5b58\uff0c\u4e5f\u4e0d\u968f\u5bf9\u8c61\u7684\u9500\u6bc1\u800c\u91ca\u653e\u5185\u5b58\u3002\u800c\u666e\u901a\u6210\u5458\u53d8\u91cf\u5728\u5bf9\u8c61\u521b\u5efa\u65f6\u5206\u914d\u5185\u5b58\uff0c\u5728\u5bf9\u8c61\u9500\u6bc1\u65f6\u91ca\u653e\u5185\u5b58\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5728\u7c7b\u5185\u521d\u59cb\u5316\u9759\u6001\u6210\u5458\uff0c\u800c\u662f\u5728\u7c7b\u5916\u5bf9\u5176\u521d\u59cb\u5316\uff0c eg: \u7c7b\u5185\u58f0\u660e\u4e3a static vector< int > elems; \u7c7b\u5916\u521d\u59cb\u5316\u4e3a vector< int > class_name::elems; \u8fd9\u91cc\u53ef\u4ee5\u8d4b\u521d\u503c\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u8d4b\u3002 \u4e0d\u8fc7\u4e5f\u53ef\u4ee5\u4e3a\u9759\u6001\u6210\u5458\u53d8\u91cf\u63d0\u4f9b\u7c7b\u5185const\u521d\u59cb\u503c\uff0c\u4f46\u8981\u6c42\u9759\u6001\u6210\u5458\u5fc5\u987b\u662f\u5b57\u9762\u503c\u5e38\u91cf\u7c7b\u578b\u7684constexpr\uff0c\u521d\u59cb\u503c\u4e5f\u5fc5\u987b\u662f\u5e38\u91cf\u8868\u8fbe\u5f0f\u3002 eg. static contestexpr int period = 20; static const int _buf_size =1024; \u5373\u4f7f\u4e00\u4e2astatic member data\u5728\u7c7b\u5185\u88ab\u521d\u59cb\u5316\u540e\uff0c\u4e5f\u5e94\u5728\u7c7b\u7684\u5916\u90e8\u5b9a\u4e49\u4e00\u4e0b\u8be5\u6210\u5458\u3002 \u503c\u521d\u59cb\u5316\u4e0e\u9ed8\u8ba4\u521d\u59cb\u5316 \u2003\u503c\u521d\u59cb\u5316\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u7528\u6570\u503c\u521d\u59cb\u5316\u53d8\u91cf\u3002 \u2003\u9ed8\u8ba4\u521d\u59cb\u5316\uff1a\u5982\u679c\u5b9a\u4e49\u53d8\u91cf\u65f6\u6ca1\u6709\u6307\u5b9a\u521d\u503c\uff0c\u5219\u53d8\u91cf\u88ab\u9ed8\u8ba4\u521d\u59cb\u5316\u3002\u5176\u521d\u59cb\u503c\u548c\u53d8\u91cf\u7684\u7c7b\u578b\u4ee5\u53ca\u53d8\u91cf\u5b9a\u4e49\u7684\u4f4d\u7f6e\u76f8\u5173\u3002 \u9ed8\u8ba4\u521d\u59cb\u5316\u7c7b\u5bf9\u8c61\u548c\u9ed8\u8ba4\u521d\u59cb\u5316\u5185\u7f6e\u7c7b\u578b\u53d8\u91cf\u6709\u6240\u4e0d\u540c \u3002 \u2003\u5bf9\u4e8e\u9ed8\u8ba4\u521d\u59cb\u5316\u5185\u7f6e\u7c7b\u578b\u53d8\u91cf\u6765\u8bf4\uff1a\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u4e4b\u5916\u7684\u53d8\u91cf\u662f\u5168\u5c40\u53d8\u91cf\uff0c\u4e00\u822c\u5b58\u50a8\u5728\u5168\u5c40\u533a\uff0c\u5b58\u50a8\u5728\u5168\u5c40\u533a\u7684\u53d8\u91cf\u4e00\u822c\u4f1a\u6267\u884c\u503c\u521d\u59cb\u5316\u3002\u6b64\u65f6\uff0c\u5176\u521d\u59cb\u503c\u548c\u53d8\u91cf\u7684\u7c7b\u578b\u6709\u5173\u3002\u5bf9\u4e8eint\u7c7b\u578b\u5176\u521d\u59cb\u503c\u4e3a0\uff0c\u5bf9\u4e8echar\u7c7b\u578b\u5176\u9ed8\u8ba4\u521d\u59cb\u503c\u4e3a''\u3002 \u2003\u5b9a\u4e49\u5728\u51fd\u6570\u4f53\u5185\u90e8\u7684\u662f\u5c40\u90e8\u53d8\u91cf\uff0c\u5176\u5b58\u50a8\u5728\u6808\u533a\u4e2d\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u521d\u503c\uff0c\u90a3\u4e48\u8be5\u5c40\u90e8\u53d8\u91cf\u5c06\u4e0d\u4f1a\u88ab\u521d\u59cb\u5316\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u5c40\u90e8\u53d8\u91cf\u7684\u503c\u662f\u672a\u5b9a\u4e49\u7684\uff0c\u662f\u4e2a\u968f\u673a\u503c\u3002\u6b64\u65f6\uff0c\u5982\u679c\u4e0d\u7ed9\u8fd9\u4e2a\u5c40\u90e8\u53d8\u91cf\u8d4b\u503c\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4f7f\u7528\u8be5\u5c40\u90e8\u53d8\u91cf\uff0c\u5426\u5219\u5c31\u4f1a\u51fa\u9519\uff0c\u6ce8\u610f\u8fd9\u79cd\u60c5\u51b5\u662f\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u65e2\u6ca1\u6709\u4f7f\u7528\u9ed8\u8ba4\u521d\u59cb\u5316\u4e5f\u6ca1\u6709\u4f7f\u7528\u503c\u521d\u59cb\u5316\uff0c\u6ca1\u6709\u521d\u59cb\u5316\u7684\u503c\u662f\u4e0d\u80fd\u4f7f\u7528\u7684.","title":"\u521d\u59cb\u5316"},{"location":"c_base/initialization/#uniform-initialization","text":"Since C++ 11, for any initialization, you can use one common syntax, that is brace, \"{}\". int va[] {1, 2, 3}; vector<int> vec {1, 2, 3}; complex<double> c{4.0, 2.0}; \u2003 \u7f16\u8bd1\u5668\u770b\u5230\"{}\"\u4f1a\u5c06\u5176\u89c6\u4e3ainitializer_list , \u5176\u53c8\u5173\u8054\u4e00\u4e2aarray (intializer_list\u5185\u90e8\u6709\u4e00\u4e2a\u6307\u5411array\u7684\u6307\u9488\uff0c\u62f7\u8d1d\u4e00\u4e2ainitializer_list\u5c5e\u4e8e\u6d45\u62f7\u8d1d\uff0c\u9020\u6210\u4e24\u4e2a\u5bf9\u8c61\u4e2d\u7684\u6307\u9488\u6307\u5411\u540c\u4e00\u4e2aarray)\u3002\u8c03\u7528\u6784\u9020\u51fd\u6570\u65f6: \u82e5\u5b58\u5728\u4e00\u4e2a\u7248\u672c\u6709\u591a\u4e2a\u53c2\u6570\uff0c\u901a\u8fc7{}\u521d\u59cb\u5316\u65f6\uff0c\u5173\u8054\u7684array\u5185\u7684\u5143\u7d20\u53ef\u88ab\u7f16\u8bd1\u5668\u5206\u89e3\u9010\u4e00\u4f20\u9012\u7ed9\u51fd\u6570\uff1b \u901a\u8fc7()\u521d\u59cb\u5316\u65f6\uff0c\u63d0\u4f9b\u548c\u6784\u9020\u51fd\u6570\u76f8\u540c\u6570\u91cf\u3001\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u4e5f\u53ef\u8fdb\u884c\u521d\u59cb\u5316\u3002 \u82e5\u5b58\u5728\u4e00\u4e2a\u7248\u672c\u63a5\u53d7initializaer_list \u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5219\u901a\u8fc7{}\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u4f18\u5148\u4f7f\u7528\u8be5\u7248\u672c\u3002 class P{ public: P(int a, b){cout<<\"P(int,int), a=\"<<a<<\" , b=\"<<b;} P(initializer_list<int> initlist){ cout <<\"P{initializer_list<int>}, vlaues=\"; for(auto& v: initlist){ cout<<v<<\" \"; } } } //\u6d4b\u8bd5 P p(1, 2); // \u8f93\u51faP(int, int), a=1, b=2 P p2{1, 2}; // \u8f93\u51faP{initializer_list<int>}, values=1, 2 P p3{1, 2, 3}; // \u8f93\u51faP{initializer_list<int>}, values=1, 2, 3 P p4={1, 2, 2}; // \u8f93\u51faP{initializer_list<int>}, values=1, 2, 2","title":"Uniform Initialization"},{"location":"c_base/inline/","text":"About Inline inline : \u53ea\u6709\u4e0e\u51fd\u6570\u7684\u5b9a\u4e49\u5728\u4e00\u8d77\u624d\u8d77\u4f5c\u7528\u3002 \u5b9a\u4e49\u5728class\u4e2d\u7684\u6210\u5458\u51fd\u6570\u81ea\u52a8\u89c6\u4e3ainline\u51fd\u6570 inline\u51fd\u6570\u4ec5\u4ec5\u662f\u4e00\u4e2a\u5bf9\u7f16\u8bd1\u5668\u7684\u5efa\u8bae\uff0c\u6240\u4ee5\u6700\u540e\u80fd\u5426\u771f\u6b63\u5185\u8054\uff0c\u53d6\u51b3\u4e8e\u7f16\u8bd1\u5668\uff1a\u5b83\u5982\u679c\u8ba4\u4e3a\u51fd\u6570\u4e0d\u590d\u6742\uff0c\u80fd\u5728\u8c03\u7528\u70b9\u5c55\u5f00\uff0c\u5c31\u4f1a\u771f\u6b63\u5185\u8054\uff0c\u5e76\u4e0d\u662f\u8bf4\u58f0\u660e\u4e86\u5185\u8054\u5c31\u4f1a\u5185\u8054\uff0c\u58f0\u660e\u5185\u8054\u53ea\u662f\u4e00\u4e2a\u5efa\u8bae\u800c\u5df2\u3002 \u5185\u8054\u662f\u4ee5\u4ee3\u7801\u81a8\u80c0(\u590d\u5236)\u4e3a\u4ee3\u4ef7\uff0c\u4ec5\u4ec5\u7701\u53bb\u4e86\u51fd\u6570\u8c03\u7528\u7684\u5f00\u9500\uff0c\u4ece\u800c\u63d0\u9ad8\u51fd\u6570\u7684\u6267\u884c\u6548\u7387\u3002\u5982\u679c\u6267\u884c\u51fd\u6570\u4f53\u5185\u4ee3\u7801\u7684\u65f6\u95f4\u76f8\u6bd4\u4e8e\u51fd\u6570\u8c03\u7528\u7684\u5f00\u9500\u8f83\u5927\uff0c\u90a3\u4e48\u6548\u7387\u7684\u6536\u83b7\u4f1a\u66f4\u5c11\uff01\u53e6\u4e00\u65b9\u9762\uff0c\u6bcf\u4e00\u5904\u5185\u8054\u51fd\u6570\u7684\u8c03\u7528\u90fd\u8981\u590d\u5236\u4ee3\u7801\uff0c\u5c06\u4f7f\u7a0b\u5e8f\u7684\u603b\u4ee3\u7801\u91cf\u589e\u5927\uff0c\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58\u7a7a\u95f4\u3002 \u4ee5\u4e0b\u60c5\u51b5\u4e0d\u5b9c\u4f7f\u7528\u5185\u8054\uff1a \u5982\u679c\u51fd\u6570\u4f53\u5185\u7684\u4ee3\u7801\u6bd4\u8f83\u957f\uff0c\u4f7f\u7528\u5185\u8054\u5c06\u5bfc\u81f4\u5185\u5b58\u6d88\u8017\u4ee3\u4ef7\u8f83\u9ad8\u3002 \u5982\u679c\u51fd\u6570\u4f53\u5185\u51fa\u73b0\u5faa\u73af\uff0c\u90a3\u4e48\u6267\u884c\u51fd\u6570\u4f53\u5185\u4ee3\u7801\u7684\u65f6\u95f4\u8981\u6bd4\u51fd\u6570\u8c03\u7528\u7684\u5f00\u9500\u5927\u3002 with virtual function \u865a\u51fd\u6570\u53ef\u4ee5\u662f\u5185\u8054\u51fd\u6570\uff0c\u5185\u8054\u662f\u53ef\u4ee5\u4fee\u9970\u865a\u51fd\u6570\u7684\uff0c\u4f46\u662f\u5f53\u865a\u51fd\u6570\u8868\u73b0\u591a\u6001\u6027\u7684\u65f6\u5019\u4e0d\u80fd\u5185\u8054\u3002\u5185\u8054\u662f\u5728\u7f16\u8bd1\u671f\u5efa\u8bae\u7f16\u8bd1\u5668\u5185\u8054\uff0c\u800c\u865a\u51fd\u6570\u7684\u591a\u6001\u6027\u5728\u8fd0\u884c\u671f\uff0c\u7f16\u8bd1\u5668\u65e0\u6cd5\u77e5\u9053\u8fd0\u884c\u671f\u8c03\u7528\u54ea\u4e2a\u4ee3\u7801\uff0c\u56e0\u6b64\u865a\u51fd\u6570\u8868\u73b0\u4e3a\u591a\u6001\u6027\u65f6\uff08\u8fd0\u884c\u671f\uff09\u4e0d\u53ef\u4ee5\u5185\u8054\u3002 inline virtual \u552f\u4e00\u53ef\u4ee5\u5185\u8054\u7684\u65f6\u5019\u662f\uff1a\u7f16\u8bd1\u5668\u77e5\u9053\u6240\u8c03\u7528\u7684\u5bf9\u8c61\u662f\u54ea\u4e2a\u7c7b\u3002","title":"inline"},{"location":"c_base/inline/#about-inline","text":"","title":"About Inline"},{"location":"c_base/inline/#inline","text":"\u53ea\u6709\u4e0e\u51fd\u6570\u7684\u5b9a\u4e49\u5728\u4e00\u8d77\u624d\u8d77\u4f5c\u7528\u3002 \u5b9a\u4e49\u5728class\u4e2d\u7684\u6210\u5458\u51fd\u6570\u81ea\u52a8\u89c6\u4e3ainline\u51fd\u6570 inline\u51fd\u6570\u4ec5\u4ec5\u662f\u4e00\u4e2a\u5bf9\u7f16\u8bd1\u5668\u7684\u5efa\u8bae\uff0c\u6240\u4ee5\u6700\u540e\u80fd\u5426\u771f\u6b63\u5185\u8054\uff0c\u53d6\u51b3\u4e8e\u7f16\u8bd1\u5668\uff1a\u5b83\u5982\u679c\u8ba4\u4e3a\u51fd\u6570\u4e0d\u590d\u6742\uff0c\u80fd\u5728\u8c03\u7528\u70b9\u5c55\u5f00\uff0c\u5c31\u4f1a\u771f\u6b63\u5185\u8054\uff0c\u5e76\u4e0d\u662f\u8bf4\u58f0\u660e\u4e86\u5185\u8054\u5c31\u4f1a\u5185\u8054\uff0c\u58f0\u660e\u5185\u8054\u53ea\u662f\u4e00\u4e2a\u5efa\u8bae\u800c\u5df2\u3002 \u5185\u8054\u662f\u4ee5\u4ee3\u7801\u81a8\u80c0(\u590d\u5236)\u4e3a\u4ee3\u4ef7\uff0c\u4ec5\u4ec5\u7701\u53bb\u4e86\u51fd\u6570\u8c03\u7528\u7684\u5f00\u9500\uff0c\u4ece\u800c\u63d0\u9ad8\u51fd\u6570\u7684\u6267\u884c\u6548\u7387\u3002\u5982\u679c\u6267\u884c\u51fd\u6570\u4f53\u5185\u4ee3\u7801\u7684\u65f6\u95f4\u76f8\u6bd4\u4e8e\u51fd\u6570\u8c03\u7528\u7684\u5f00\u9500\u8f83\u5927\uff0c\u90a3\u4e48\u6548\u7387\u7684\u6536\u83b7\u4f1a\u66f4\u5c11\uff01\u53e6\u4e00\u65b9\u9762\uff0c\u6bcf\u4e00\u5904\u5185\u8054\u51fd\u6570\u7684\u8c03\u7528\u90fd\u8981\u590d\u5236\u4ee3\u7801\uff0c\u5c06\u4f7f\u7a0b\u5e8f\u7684\u603b\u4ee3\u7801\u91cf\u589e\u5927\uff0c\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58\u7a7a\u95f4\u3002","title":"inline:"},{"location":"c_base/inline/#_1","text":"\u5982\u679c\u51fd\u6570\u4f53\u5185\u7684\u4ee3\u7801\u6bd4\u8f83\u957f\uff0c\u4f7f\u7528\u5185\u8054\u5c06\u5bfc\u81f4\u5185\u5b58\u6d88\u8017\u4ee3\u4ef7\u8f83\u9ad8\u3002 \u5982\u679c\u51fd\u6570\u4f53\u5185\u51fa\u73b0\u5faa\u73af\uff0c\u90a3\u4e48\u6267\u884c\u51fd\u6570\u4f53\u5185\u4ee3\u7801\u7684\u65f6\u95f4\u8981\u6bd4\u51fd\u6570\u8c03\u7528\u7684\u5f00\u9500\u5927\u3002","title":"\u4ee5\u4e0b\u60c5\u51b5\u4e0d\u5b9c\u4f7f\u7528\u5185\u8054\uff1a"},{"location":"c_base/inline/#with-virtual-function","text":"\u865a\u51fd\u6570\u53ef\u4ee5\u662f\u5185\u8054\u51fd\u6570\uff0c\u5185\u8054\u662f\u53ef\u4ee5\u4fee\u9970\u865a\u51fd\u6570\u7684\uff0c\u4f46\u662f\u5f53\u865a\u51fd\u6570\u8868\u73b0\u591a\u6001\u6027\u7684\u65f6\u5019\u4e0d\u80fd\u5185\u8054\u3002\u5185\u8054\u662f\u5728\u7f16\u8bd1\u671f\u5efa\u8bae\u7f16\u8bd1\u5668\u5185\u8054\uff0c\u800c\u865a\u51fd\u6570\u7684\u591a\u6001\u6027\u5728\u8fd0\u884c\u671f\uff0c\u7f16\u8bd1\u5668\u65e0\u6cd5\u77e5\u9053\u8fd0\u884c\u671f\u8c03\u7528\u54ea\u4e2a\u4ee3\u7801\uff0c\u56e0\u6b64\u865a\u51fd\u6570\u8868\u73b0\u4e3a\u591a\u6001\u6027\u65f6\uff08\u8fd0\u884c\u671f\uff09\u4e0d\u53ef\u4ee5\u5185\u8054\u3002 inline virtual \u552f\u4e00\u53ef\u4ee5\u5185\u8054\u7684\u65f6\u5019\u662f\uff1a\u7f16\u8bd1\u5668\u77e5\u9053\u6240\u8c03\u7528\u7684\u5bf9\u8c61\u662f\u54ea\u4e2a\u7c7b\u3002","title":"with virtual function"},{"location":"c_base/iterator/","text":"About iterator \u8fed\u4ee3\u5668\u7c7b\u578b struct input_iterator_tag{}; \u53ea\u80fd\u5411\u524d\u79fb\u52a8\uff0c\u5982istream_iterator, \u652f\u6301++iter\u6216iter++, \u5bf9\u4e8e\u6240\u6307\u5bf9\u8c61\u53ea\u8bfb; struct output_iterator_tag{}; \u53ea\u80fd\u5411\u524d\u79fb\u52a8\uff0c\u5982ostream_iterator, \u652f\u6301++iter\u6216iter++, \u5bf9\u4e8e\u6240\u6307\u5bf9\u8c61\u53ea\u5199; struct forward_iterator_tag:: public input_iterator_tag{}; \u53ea\u80fd\u5411\u524d\u79fb\u52a8\uff0c\u4f46\u5bf9\u4e8e\u6240\u6307\u5bf9\u8c61\u540c\u65f6\u53ef\u8bfb\u53ef\u5199 struct bidirectional_iterator_tag:: public forward_iterator{}; \u53ef\u524d\u540e\u79fb\u52a8\uff0c \u5982map\u3001set\u3001multimap\u3001multiset\u7684\u8fed\u4ee3\u5668\u3002 struct random_access_iterator_tag:: public bidirectional_iterator_tag{}; \u968f\u673a\u8bbf\u95ee\u8fed\u4ee3\u5668\uff0c\u53ef\u8fdb\u884c\u8fed\u4ee3\u5668\u7b97\u672f\u8fd0\u7b97, \u5bb9\u5668\u5143\u7d20\u5b58\u50a8\u5728\u8fde\u7eed\u5185\u5b58\u7a7a\u95f4\u5185, \u5982vector\u3001string\u3001deque\u3002 //\u8fed\u4ee3\u5668\u6307\u793a\u7684\u65b0\u4f4d\u7f6e\u4e0e\u539f\u6765\u76f8\u6bd4\u5411\u524d\uff08\u5411\u540e\uff09\u79fb\u52a8n\u4e2a\u5143\u7d20\uff0c\u7ed3\u679c\u8fed\u4ee3\u5668\u6216\u6307\u793a\u5bb9\u5668\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\u6216\u4e3a\u5c3e\u540e\u8fed\u4ee3\u5668\u3002 iter+n or iter-n iter+=n \u6216\u8005 iter-=n; //\u4e24\u4e2a\u8fed\u4ee3\u5668\u76f8\u51cf\u662f\u5b83\u4eec\u4e4b\u95f4\u7684\u8ddd\u79bb\u3002\u53c2\u4e0e\u8fd0\u7b97\u7684\u4e24\u4e2a\u8fed\u4ee3\u5668\u5fc5\u987b\u6307\u5411\u540c\u4e00\u4e2a\u5bb9\u5668\u4e2d\u7684\u5143\u7d20\u6216\u4e3a\u5c3e\u540e\u8fed\u4ee3\u5668\uff0c //\u5176\u7c7b\u578b\u4e3adifference_type\u7684\u5e26\u7b26\u53f7\u6574\u578b\u6570\u3002 iter1-iter2 iter:\u89e3\u5f15\u7528\u8fed\u4ee3\u5668\uff0c\u8fd4\u56de\u5176\u6240\u6307\u5143\u7d20\u7684\u5f15\u7528\u3002 iter++: iter\u5411\u540e\u79fb\u52a8\u4e00\u4f4d\uff0c\u8fd4\u56de\u4e00\u4e2aiter\u79fb\u52a8\u524d\u7684\u4e34\u65f6\u5bf9\u8c61\uff0c\u4e00\u4e2a\u53f3\u503c ++iter: \u8fd4\u56de iter\u79fb\u52a8\u540e\u7684\u5f15\u7528, \u4e00\u4e2a\u5de6\u503c\uff0c++iter=&variable;//\u6b63\u786e\uff0c\u4f46\u5176\u4fee\u6539\u7684\u662fiter\u6307\u9488\u503c\uff0c\u800c\u975e\u5176\u6307\u5411\u7684\u5bf9\u8c61\uff0c\u5bb9\u5668\u5185\u5143\u7d20\u6ca1\u6709\u6539\u53d8\u3002 iter++: \u7b49\u4ef7\u4e8e (iter++), \u662f\u4e00\u4e2a\u5de6\u503c ++iter: \u7b49\u4ef7\u4e8e *(++iter) iterator\uff1a\u4f46\u51e1\u4f7f\u7528\u4e86\u8fed\u4ee3\u5668\u7684\u5faa\u73af\u4f53\uff0c\u90fd\u4e0d\u8981\u5411\u8fed\u4ee3\u5668\u6240\u5c5e\u7684\u5bb9\u5668\u6dfb\u52a0\u6216\u8005\u51cf\u5c11\u5143\u7d20\uff0c\u5373\u4e0d\u8981\u6539\u53d8\u5176\u5bf9\u8c61\u5bb9\u91cf\u5927\u5c0f\u3002 /* \u5b9e\u8d28\u662f\u4e00\u4e2a int* const\u6307\u9488\uff0c\u8868\u793aiter\u4e0d\u80fd\u6307\u5411\u5176\u4ed6\u5bf9\u8c61\uff0c++iter\u4f1a\u62a5\u9519\uff0c\u4f46\u4f9d\u65e7\u6240\u6307\u5411\u5bf9\u8c61\u5185\u5bb9\u4f9d\u65e7\u53ef\u88ab\u4fee\u6539 */ const vector<int>::iterator iter=vec.begin(); /* \u5b9e\u8d28\u662f\u4e00\u4e2aconst int*\u6307\u9488 */ vector<int>::const_iterator citer = vec.cbegin()","title":"iterator"},{"location":"c_base/iterator/#about-iterator","text":"","title":"About iterator"},{"location":"c_base/iterator/#_1","text":"struct input_iterator_tag{}; \u53ea\u80fd\u5411\u524d\u79fb\u52a8\uff0c\u5982istream_iterator, \u652f\u6301++iter\u6216iter++, \u5bf9\u4e8e\u6240\u6307\u5bf9\u8c61\u53ea\u8bfb; struct output_iterator_tag{}; \u53ea\u80fd\u5411\u524d\u79fb\u52a8\uff0c\u5982ostream_iterator, \u652f\u6301++iter\u6216iter++, \u5bf9\u4e8e\u6240\u6307\u5bf9\u8c61\u53ea\u5199; struct forward_iterator_tag:: public input_iterator_tag{}; \u53ea\u80fd\u5411\u524d\u79fb\u52a8\uff0c\u4f46\u5bf9\u4e8e\u6240\u6307\u5bf9\u8c61\u540c\u65f6\u53ef\u8bfb\u53ef\u5199 struct bidirectional_iterator_tag:: public forward_iterator{}; \u53ef\u524d\u540e\u79fb\u52a8\uff0c \u5982map\u3001set\u3001multimap\u3001multiset\u7684\u8fed\u4ee3\u5668\u3002 struct random_access_iterator_tag:: public bidirectional_iterator_tag{}; \u968f\u673a\u8bbf\u95ee\u8fed\u4ee3\u5668\uff0c\u53ef\u8fdb\u884c\u8fed\u4ee3\u5668\u7b97\u672f\u8fd0\u7b97, \u5bb9\u5668\u5143\u7d20\u5b58\u50a8\u5728\u8fde\u7eed\u5185\u5b58\u7a7a\u95f4\u5185, \u5982vector\u3001string\u3001deque\u3002 //\u8fed\u4ee3\u5668\u6307\u793a\u7684\u65b0\u4f4d\u7f6e\u4e0e\u539f\u6765\u76f8\u6bd4\u5411\u524d\uff08\u5411\u540e\uff09\u79fb\u52a8n\u4e2a\u5143\u7d20\uff0c\u7ed3\u679c\u8fed\u4ee3\u5668\u6216\u6307\u793a\u5bb9\u5668\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\u6216\u4e3a\u5c3e\u540e\u8fed\u4ee3\u5668\u3002 iter+n or iter-n iter+=n \u6216\u8005 iter-=n; //\u4e24\u4e2a\u8fed\u4ee3\u5668\u76f8\u51cf\u662f\u5b83\u4eec\u4e4b\u95f4\u7684\u8ddd\u79bb\u3002\u53c2\u4e0e\u8fd0\u7b97\u7684\u4e24\u4e2a\u8fed\u4ee3\u5668\u5fc5\u987b\u6307\u5411\u540c\u4e00\u4e2a\u5bb9\u5668\u4e2d\u7684\u5143\u7d20\u6216\u4e3a\u5c3e\u540e\u8fed\u4ee3\u5668\uff0c //\u5176\u7c7b\u578b\u4e3adifference_type\u7684\u5e26\u7b26\u53f7\u6574\u578b\u6570\u3002 iter1-iter2 iter:\u89e3\u5f15\u7528\u8fed\u4ee3\u5668\uff0c\u8fd4\u56de\u5176\u6240\u6307\u5143\u7d20\u7684\u5f15\u7528\u3002 iter++: iter\u5411\u540e\u79fb\u52a8\u4e00\u4f4d\uff0c\u8fd4\u56de\u4e00\u4e2aiter\u79fb\u52a8\u524d\u7684\u4e34\u65f6\u5bf9\u8c61\uff0c\u4e00\u4e2a\u53f3\u503c ++iter: \u8fd4\u56de iter\u79fb\u52a8\u540e\u7684\u5f15\u7528, \u4e00\u4e2a\u5de6\u503c\uff0c++iter=&variable;//\u6b63\u786e\uff0c\u4f46\u5176\u4fee\u6539\u7684\u662fiter\u6307\u9488\u503c\uff0c\u800c\u975e\u5176\u6307\u5411\u7684\u5bf9\u8c61\uff0c\u5bb9\u5668\u5185\u5143\u7d20\u6ca1\u6709\u6539\u53d8\u3002 iter++: \u7b49\u4ef7\u4e8e (iter++), \u662f\u4e00\u4e2a\u5de6\u503c ++iter: \u7b49\u4ef7\u4e8e *(++iter) iterator\uff1a\u4f46\u51e1\u4f7f\u7528\u4e86\u8fed\u4ee3\u5668\u7684\u5faa\u73af\u4f53\uff0c\u90fd\u4e0d\u8981\u5411\u8fed\u4ee3\u5668\u6240\u5c5e\u7684\u5bb9\u5668\u6dfb\u52a0\u6216\u8005\u51cf\u5c11\u5143\u7d20\uff0c\u5373\u4e0d\u8981\u6539\u53d8\u5176\u5bf9\u8c61\u5bb9\u91cf\u5927\u5c0f\u3002 /* \u5b9e\u8d28\u662f\u4e00\u4e2a int* const\u6307\u9488\uff0c\u8868\u793aiter\u4e0d\u80fd\u6307\u5411\u5176\u4ed6\u5bf9\u8c61\uff0c++iter\u4f1a\u62a5\u9519\uff0c\u4f46\u4f9d\u65e7\u6240\u6307\u5411\u5bf9\u8c61\u5185\u5bb9\u4f9d\u65e7\u53ef\u88ab\u4fee\u6539 */ const vector<int>::iterator iter=vec.begin(); /* \u5b9e\u8d28\u662f\u4e00\u4e2aconst int*\u6307\u9488 */ vector<int>::const_iterator citer = vec.cbegin()","title":"\u8fed\u4ee3\u5668\u7c7b\u578b"},{"location":"c_base/memory/","text":"C++ \u5185\u5b58\u7ba1\u7406 \u5185\u5b58\u5206\u533a \u2003\u5173\u4e8enew\u548cmalloc\u5206\u914d\u7684\u5185\u5b58\uff0c\u6216\u8c13\uff0cnew\u5206\u914d\u7684\u5185\u5b58\u5728\u5806\u533a\uff0cmalloc\u5206\u914d\u7684\u5185\u5b58\u5728\u81ea\u7531\u5b58\u50a8\u533a\uff1b\u4f46\u5927\u591a\u6570\u7f16\u8bd1\u5668\u5b9e\u73b0new\u90fd\u662f\u901a\u8fc7malloc\uff0c\u4e24\u8005\u5206\u914d\u7684\u5185\u5b58\u5e76\u65e0\u533a\u522b\uff1b\u8fd9\u4e00\u53eb\u6cd5\u53ea\u662f\u7528\u6765\u533a\u522bC++\u548cC\u5206\u914d\u7684\u5185\u5b58\uff0c\u540e\u8005\u53ea\u80fd\u901a\u8fc7malloc\u5206\u914d\u5185\u5b58\u3002 \u2003\u5728C\u8bed\u8a00\u4e2d\uff0c\u5168\u5c40\u533a\u53c8\u5206\u4e3a\u521d\u59cb\u5316\u7684\u548c\u672a\u521d\u59cb\u5316\u7684\uff0c\u5728C++\u91cc\u9762\u6ca1\u6709\u8fd9\u4e2a\u533a\u5206\u4e86\uff0c\u4ed6\u4eec\u5171\u540c\u5360\u7528\u540c\u4e00\u5757\u5185\u5b58\u533a\u3002","title":"memory"},{"location":"c_base/memory/#c","text":"","title":"C++ \u5185\u5b58\u7ba1\u7406"},{"location":"c_base/memory/#_1","text":"\u5173\u4e8enew\u548cmalloc\u5206\u914d\u7684\u5185\u5b58\uff0c\u6216\u8c13\uff0cnew\u5206\u914d\u7684\u5185\u5b58\u5728\u5806\u533a\uff0cmalloc\u5206\u914d\u7684\u5185\u5b58\u5728\u81ea\u7531\u5b58\u50a8\u533a\uff1b\u4f46\u5927\u591a\u6570\u7f16\u8bd1\u5668\u5b9e\u73b0new\u90fd\u662f\u901a\u8fc7malloc\uff0c\u4e24\u8005\u5206\u914d\u7684\u5185\u5b58\u5e76\u65e0\u533a\u522b\uff1b\u8fd9\u4e00\u53eb\u6cd5\u53ea\u662f\u7528\u6765\u533a\u522bC++\u548cC\u5206\u914d\u7684\u5185\u5b58\uff0c\u540e\u8005\u53ea\u80fd\u901a\u8fc7malloc\u5206\u914d\u5185\u5b58\u3002 \u2003\u5728C\u8bed\u8a00\u4e2d\uff0c\u5168\u5c40\u533a\u53c8\u5206\u4e3a\u521d\u59cb\u5316\u7684\u548c\u672a\u521d\u59cb\u5316\u7684\uff0c\u5728C++\u91cc\u9762\u6ca1\u6709\u8fd9\u4e2a\u533a\u5206\u4e86\uff0c\u4ed6\u4eec\u5171\u540c\u5360\u7528\u540c\u4e00\u5757\u5185\u5b58\u533a\u3002","title":"\u5185\u5b58\u5206\u533a"},{"location":"c_base/new_delete/","text":"About new and delete new \u2003 \u5148\u5206\u914d\u5185\u5b58\uff0c\u518d\u8c03\u7528\u6784\u9020\u51fd\u6570 string* ps = new string(\"hello\"); // \u7f16\u8bd1\u5668\u4f1a\u8f6c\u5316\u4e3a\u4ee5\u4e0b\u5f62\u5f0f void* mem = operator new(sizeof(string)); // \u5206\u914d\u5185\u5b58 ps = static_cast<string*>(mem); //\u8f6c\u578b ps->string::string(\"hello\"); //\u8c03\u7528\u6784\u9020\u51fd\u6570 delete \u2003 \u5148\u8c03\u7528\u6790\u6784\u51fd\u6570\uff0c\u518d\u91ca\u653e\u5185\u5b58 delete ps; // \u7f16\u8bd1\u5668\u4f1a\u8f6c\u5316\u4e3a\u4ee5\u4e0b\u5f62\u5f0f string::~string(ps); // \u6790\u6784\u51fd\u6570 operator delete(ps); // \u91ca\u653e\u5185\u5b58 \u2003 array new \u5fc5\u987b\u8981\u642d\u914darray delete(\u5373delete []); \u5bf9\u4e8e\u5185\u7f6e\u7c7b\u578b\uff0c\u5982int\u3001double, \u91c7\u7528delete\u4e5f\u53ef\uff0c\u56e0\u4e3aint\u3001double\u7c7b\u578b\u6ca1\u6709\u6790\u6784\u51fd\u6570\uff0c\u5185\u5b58\u4f1a\u88ab\u6b63\u5e38\u91ca\u653e\uff1b\u5bf9\u4e8e\u7c7b\u7c7b\u578b\uff0c\u5982\u679c\u8be5\u7c7b\u6ca1\u6709\u63d0\u4f9b\u6790\u6784\u51fd\u6570\uff0c\u4e14\u8be5\u7c7b\u7684\u6210\u5458\u4e2d\u4e0d\u5305\u542b\u7c7b\u7c7b\u578b\uff0c\u53ea\u6709\u5185\u7f6e\u7c7b\u578b\uff0c\u91c7\u7528delte\u4e5f\u4e0d\u4f1a\u6709\u5185\u5b58\u6cc4\u6f0f\uff1b\u4f46\u5982\u679c\u5176\u4e2d\u5305\u542b\u7c7b\u7c7b\u578b\u6210\u5458\u6216\u6307\u9488\u6210\u5458\uff0c\u5219delete\u53ea\u4f1a\u91ca\u653e\u6570\u7ec4\u4e2d\u7b2c\u4e00\u4e2a\u5143\u7d20\u5360\u7528\u7684\u5185\u5b58\uff0c\u5176\u4f59\u5143\u7d20\u5185\u5b58\u5c06\u4f1a\u6cc4\u6f0f\uff0c\u6b64\u65f6\u7a0b\u5e8f\u4e0d\u4f1a\u62a5\u9519\uff1b \u2003\u6216\u82e5\u5982\u4e0b\u9762\u60c5\u51b5\uff0cDemo\u4e2d\u63d0\u4f9b\u4e86\u6790\u6784\u51fd\u6570(\u5373\u4f7f\u51fd\u6570\u4f53\u4e3a\u7a7a)\uff0c\u65e0\u8bba\u7c7b\u6210\u5458\u7c7b\u578b\u662f\u5185\u7f6e\u7c7b\u578b\uff0c\u8fd8\u662f\u7c7b\u7c7b\u578b\u3001\u6307\u9488\u7c7b\u578b\uff0c\u7531\u4e8e\u5185\u5b58\u5e03\u5c40\u4e2d\u5305\u542b\u4e86\u6570\u7ec4\u957f\u5ea6\uff0c\u91c7\u7528delete\u6765\u8bd5\u56fe\u91ca\u653e\u5185\u5b58\u90fd\u4f1a\u62a5\u9519\u3002 \u91cd\u590ddelete \u2003delete\u4e00\u6b21\u7684\u6307\u9488\u5e76\u975eNULL\uff0c\u800c\u662f\u6210\u4e86\u7a7a\u60ac\u6307\u9488(dangling pointer)\uff0c\u867d\u7136\u6307\u9488\u5df2\u7ecf\u65e0\u6548\uff0c\u4f46\u5728\u5f88\u591a\u673a\u5668\u4e0a\u6307\u9488\u4ecd\u7136\u4fdd\u5b58\u7740(\u5df2\u7ecf\u91ca\u653e\u4e86\u7684)\u52a8\u6001\u5185\u5b58\u7684\u5730\u5740\u3002 \u2003 \u91cd\u590ddelete\u4f1a\u9020\u6210\u4e0d\u53ef\u77e5\u7684\u9519\u8bef\uff0c\u867d\u7136\u7f16\u8bd1\u5668\u53ef\u80fd\u4f1a\u68c0\u6d4b\u51fa\u91cd\u590ddelete\u7684\u53d1\u751f\uff0c\u4f46\u4e0d\u8981\u4f9d\u8d56\u7f16\u8bd1\u5668\u81ea\u8eab\u7684\u9009\u62e9\u3002 \u2003 \u5bf9\u4e8edelete\u4e00\u6b21\u7684\u6307\u9488\uff0c\u53ef\u4ee5\u663e\u793a\u4ee4\u5176\u4e3aNULL\uff0c\u6e05\u695a\u6307\u51fa\u8be5\u6307\u9488\u4e0d\u6307\u5411\u4efb\u4f55\u5bf9\u8c61\uff0cdelete\u4e00\u4e2a\u7a7a\u6307\u9488\u4e0d\u4f1a\u6709\u4efb\u4f55\u95ee\u9898 int\\* p = new int(1); delete p; p=NULL; delete p; //\u5220\u9664\u4e00\u4e2a\u7a7a\u6307\u9488\uff0c\u4e0d\u4f1a\u62a5\u9519 \u5173\u4e8e\u91cd\u8f7d class FF { public: FF() :_id(0) { std::cout << \"default ctor.this=\" << this << \" id=\" << _id << std::endl; } FF(int i) :_id(i) { std::cout << \"ctor.this=\" << this << \" id=\" << _id << std::endl; } ~FF() { std::cout << \"dtor.this=\" << this << \" id=\" << _id << std::endl; } static void* operator new(size_t size); static void operator delete(void* pdead, size_t size); static void* operator new[](size_t size); static void operator delete[](void* pdead, size_t size); private: int _id; }; void* FF::operator new(size_t size) { FF* p = (FF*)malloc(size); std::cout << \"\u8c03\u7528\u4e86Foo::operator new\" << std::endl; return p; } void FF::operator delete(void* pdead, size_t size) { std::cout << \"\u8c03\u7528\u4e86Foo::operator delete\" << std::endl; free(pdead); } void* FF::operator new[](size_t size) { FF* p = (FF*)malloc(size); std::cout << \"\u8c03\u7528\u4e86Foo::operator new[]\" << std::endl; return p; } void FF::operator delete[](void* pdead, size_t size) { std::cout << \"\u8c03\u7528\u4e86Foo::operator delete[]\" << std::endl; free(pdead); } // main FF* pf = new FF(7); FF* pf1 = new FF[3]; delete pf; delete[] pf1; // \u8f93\u51fa // \u8c03\u7528\u4e86Foo::operator new // ctor.this=011D62B8 id=7 // \u8c03\u7528\u4e86Foo::operator new[] // default ctor.this=011E0DCC id // default ctor.this=011E0DD0 id // default ctor.this=011E0DD4 id // dtor.this=011D62B8 id=7 // \u8c03\u7528\u4e86Foo::operator delete // dtor.this=011E0DD4 id=0 // dtor.this=011E0DD0 id=0 // dtor.this=011E0DCC id=0 // \u8c03\u7528\u4e86Foo::operator delete[] \u2003\u901a\u8fc7::new\u548c::delete\u53ef\u4ee5\u5f3a\u5236\u4f7f\u7528\u5168\u5c40\u7684operator new\u548coperator delete\uff0c\u800c\u975e\u91cd\u8f7d\u7248\u672c\u3002 \u2003\u7c7b\u4e2d\u7684operator new\u548coperatir delete\u7684\u91cd\u8f7d\u51fd\u6570\u5fc5\u987b\u662fstatic\uff0c\u56e0\u4e3aoperator new\u5c31\u662f\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\u88ab\u8c03\u7528\uff0c\u6b64\u65f6\u5c1a\u672a\u6709\u5bf9\u8c61\u5b58\u5728\uff0c\u5982\u679c\u51fd\u6570\u662f\u975e\u9759\u6001\u7684\uff0c\u81ea\u7136\u662f\u4e0d\u80fd\u88ab\u8c03\u7528\u7684\u3002 \u603b\u7ed3 new/delete and operator new/delete and placement new new/delete\u5c5e\u4e8e\u64cd\u4f5c\u7b26\uff0c\u800coperator new/operator delete\u662f\u51fd\u6570. new: \u8c03\u7528operator new\u5206\u914d\u8db3\u591f\u7684\u7a7a\u95f4\uff0c\u5e76\u8c03\u7528\u76f8\u5173\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570; \u4e0d\u53ef\u4ee5\u88ab\u91cd\u8f7d operator new \uff081\uff09\u53ea\u5206\u914d\u6240\u8981\u6c42\u7684\u7a7a\u95f4\uff0c\u4e0d\u8c03\u7528\u76f8\u5173\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570\u3002\u5f53\u65e0\u6cd5\u6ee1\u8db3\u6240\u8981\u6c42\u5206\u914d\u7684\u7a7a\u95f4\u65f6\uff0c\u5219 ->\u5982\u679c\u6709new_handler\uff0c\u5219\u8c03\u7528new_handler\uff0c\u5426\u5219 ->\u5982\u679c\u6ca1\u8981\u6c42\u4e0d\u629b\u51fa\u5f02\u5e38\uff08\u4ee5nothrow\u53c2\u6570\u8868\u8fbe\uff09\uff0c\u5219\u6267\u884cbad_alloc\u5f02\u5e38\uff0c\u5426\u5219 ->\u8fd4\u56de0 \uff082\uff09\u53ef\u4ee5\u88ab\u91cd\u8f7d \uff083\uff09\u91cd\u8f7d\u65f6\uff0c\u8fd4\u56de\u7c7b\u578b\u5fc5\u987b\u58f0\u660e\u4e3avoid* \uff084\uff09\u91cd\u8f7d\u65f6\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u7c7b\u578b\u5fc5\u987b\u4e3a\u8868\u8fbe\u8981\u6c42\u5206\u914d\u7a7a\u95f4\u7684\u5927\u5c0f\uff08\u5b57\u8282\uff09\uff0c\u7c7b\u578b\u4e3asize_t \uff085\uff09\u91cd\u8f7d\u65f6\uff0c\u53ef\u4ee5\u5e26\u5176\u5b83\u53c2\u6570\uff0c\u5373\u6240\u8c13\u7684placement new\uff0c \u5f62\u5982operator new(size_t, string)\u3001operator new(size_t, void*)\u5f62\u5f0f; (6)placement new\u5bf9\u5e94\u5f62\u5f0f\u7684\u91cd\u8f7doperator delete\u4e5f\u53ef\u53eb\u505a placement delete , \u4f46\u5176\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u88ab\u8c03\u7528\uff0c \u53ea\u6709\u5f53\u76f8\u5e94\u7248\u672c\u7684placement new\u8c03\u7528\u6784\u9020\u51fd\u6570\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u624d\u4f1a\u88ab\u8c03\u7528(\u4e8b\u5b9e\u4e0a\u4e0d\u540c\u7f16\u8bd1\u5668\u5bf9\u6b64\u6709\u4e0d\u540c\u8868\u73b0)\uff0c \u7528\u6765\u5f52\u8fd8\u672a\u5b8c\u5168\u521b\u5efa\u6210\u529f\u7684object\u6240\u5360\u7528\u7684memory\uff1b \u82e5\u7f3a\u5c11\u5bf9\u5e94\u7248\u672c\u7684placement delete,\u5e76\u4e0d\u4f1a\u62a5\u9519\uff0c\u610f\u5473\u7740\u653e\u5f03\u6784\u9020\u51fd\u6570\u629b\u51fa\u7684\u5f02\u5e38\u3002 \u5982\u679cplacement new\u6784\u9020\u6210\u529f\u540e, \u8c03\u7528delete\u91ca\u653e\u5185\u5b58, \u6240\u8c03\u7528\u7684\u662f\u6b63\u5e38\u5f62\u5f0f\u7684operator delete(\u53ef\u80fd\u662f\u5168\u5c40\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u81ea\u5b9a\u4e49\u7684)\u3002 \u63a5\u53d7\u7b2c\u4e8c\u4e2a\u6307\u9488\u53c2\u6570\u7684placement new, \u6267\u884c\u65f6\u5ffd\u7565size_t\u53c2\u6570\uff0c\u53ea\u8fd4\u8fd8\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a \u6307\u5411\u5df2\u7ecf\u5206\u914d\u597d\u7684\u67d0\u6bb5\u5185\u5b58\u7684\u4e00\u4e2a\u6307\u9488 \uff0c\u8fd9\u6bb5\u5185\u5b58\u53ef\u80fd\u5728\u6808\u4e2d\u6216\u8005\u9759\u6001\u5168\u5c40\u533a\uff0c\u800cdelete\u53ea\u80fd\u91ca\u653e\u5206\u914d\u5728\u5806\u4e2d\u7684\u5185\u5b58\uff0c\u56e0\u6b64\u901a\u8fc7\u6b64\u79cdplacement new\u5f97\u5230\u7684\u6307\u9488\u4e0d\u80fd\u8c03\u7528delete\uff0c\u53ea\u9700\u8c03\u7528\u6307\u5411\u5bf9\u8c61\u7684\u6790\u6784\u51fd\u6570\u3002 new (place_address) type new (place_address) type (initializers) new (place_address) type [size] new (place_address) type [size] { brace initializer list} \u2003\u5176\u4e2dplace_address\u662f\u4e00\u4e2a\u6307\u9488\uff0c \u540c\u65f6\u5728initializers\u63d0\u4f9b\u7684\u4e00\u4e2a(\u53ef\u4e3a\u7a7a)\u4ee5\u9017\u53f7\u5206\u9694\u7684\u521d\u59cb\u503c\u5217\u8868\uff0c\u8be5\u521d\u59cb\u503c\u5217\u8868\u5c06\u7528\u4e8e\u6784\u9020\u65b0\u5206\u914d\u7684\u5bf9\u8c61\u3002 \u5f53\u53ea\u4f20\u5165\u4e00\u4e2a\u6307\u9488\u7c7b\u578b\u7684\u5b9e\u53c2\u65f6\uff0c\u5b9a\u4f4dnew\u8868\u8fbe\u5f0f\u6784\u9020\u5bf9\u8c61\u4f46\u662f\u4e0d\u5206\u914d\u5185\u5b58\u3002\u8fd9\u79cd\u91cd\u8f7d\u5f62\u5f0f\u7684operator new\u5e38\u88ab\u7ffb\u8bd1\u4e3a\u5b9a\u4f4dnew\uff0cC++\u5e93\u4e2d\u5df2\u7ecf\u63d0\u4f9b\u4e86\u8be5\u7248\u672c\u3002 \u4f18\u70b9: 1.\u7528placement new \u89e3\u51b3buffer\u7684\u95ee\u9898 \u95ee\u9898\u63cf\u8ff0:\u7528new\u5206\u914d\u7684\u6570\u7ec4\u7f13\u51b2\u65f6,\u7531\u4e8e\u8c03\u7528\u4e86\u9ed8\u8ba4\u6784\u9020\u51fd\u6570,\u56e0\u6b64\u6267\u884c\u6548\u7387\u4e0a\u4e0d\u4f73\u3002\u82e5\u6ca1\u6709\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u5219\u4f1a\u53d1\u751f\u7f16\u8bd1\u65f6\u9519\u8bef\u3002 \u5982\u679c\u4f60\u60f3\u5728\u9884\u5206\u914d\u7684\u5185\u5b58\u4e0a\u521b\u5efa\u5bf9\u8c61\uff0c\u7528\u7f3a\u7701\u7684new\u64cd\u4f5c\u7b26\u662f\u884c\u4e0d\u901a\u7684\u3002\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c \u4f60\u53ef\u4ee5\u7528placement new\u6784\u9020\u3002\u5b83\u5141\u8bb8\u4f60\u6784\u9020\u4e00\u4e2a\u65b0\u5bf9\u8c61\u5230\u9884\u5206\u914d\u7684\u5185\u5b58\u4e0a\u3002 2.\u589e\u5927\u65f6\u7a7a\u6548\u7387\u7684\u95ee\u9898 \u4f7f\u7528new\u64cd\u4f5c\u7b26\u5206\u914d\u5185\u5b58\u9700\u8981\u5728\u5806\u4e2d\u67e5\u627e\u8db3\u591f\u5927\u7684\u5269\u4f59\u7a7a\u95f4\uff0c\u663e\u7136\u8fd9\u4e2a\u64cd\u4f5c\u901f\u5ea6\u662f\u5f88\u6162\u7684\uff0c \u800c\u4e14\u6709\u53ef\u80fd\u51fa\u73b0\u65e0\u6cd5\u5206\u914d\u5185\u5b58\u7684\u5f02\u5e38\uff08\u7a7a\u95f4\u4e0d\u591f\uff09\u3002 placement new\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6211\u4eec\u6784\u9020\u5bf9\u8c61\u90fd\u662f\u5728\u4e00\u4e2a\u9884\u5148\u51c6\u5907\u597d\u4e86\u7684\u5185\u5b58\u7f13\u51b2\u533a\u4e2d\u8fdb\u884c\uff0c\u4e0d\u9700\u8981\u67e5\u627e\u5185\u5b58\uff0c \u5185\u5b58\u5206\u914d\u7684\u65f6\u95f4\u662f\u5e38\u6570\uff1b\u800c\u4e14\u4e0d\u4f1a\u51fa\u73b0\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u9014\u51fa\u73b0\u5185\u5b58\u4e0d\u8db3\u7684\u5f02\u5e38\u3002 \u6240\u4ee5\uff0cplacement new\u975e\u5e38\u9002\u5408\u90a3\u4e9b\u5bf9\u65f6\u95f4\u8981\u6c42\u6bd4\u8f83\u9ad8\uff0c\u957f\u65f6\u95f4\u8fd0\u884c\u4e0d\u5e0c\u671b\u88ab\u6253\u65ad\u7684\u5e94\u7528\u7a0b\u5e8f\u3002","title":"new_delete"},{"location":"c_base/new_delete/#about-new-and-delete","text":"","title":"About new and delete"},{"location":"c_base/new_delete/#new","text":"\u5148\u5206\u914d\u5185\u5b58\uff0c\u518d\u8c03\u7528\u6784\u9020\u51fd\u6570 string* ps = new string(\"hello\"); // \u7f16\u8bd1\u5668\u4f1a\u8f6c\u5316\u4e3a\u4ee5\u4e0b\u5f62\u5f0f void* mem = operator new(sizeof(string)); // \u5206\u914d\u5185\u5b58 ps = static_cast<string*>(mem); //\u8f6c\u578b ps->string::string(\"hello\"); //\u8c03\u7528\u6784\u9020\u51fd\u6570","title":"new"},{"location":"c_base/new_delete/#delete","text":"\u5148\u8c03\u7528\u6790\u6784\u51fd\u6570\uff0c\u518d\u91ca\u653e\u5185\u5b58 delete ps; // \u7f16\u8bd1\u5668\u4f1a\u8f6c\u5316\u4e3a\u4ee5\u4e0b\u5f62\u5f0f string::~string(ps); // \u6790\u6784\u51fd\u6570 operator delete(ps); // \u91ca\u653e\u5185\u5b58 \u2003 array new \u5fc5\u987b\u8981\u642d\u914darray delete(\u5373delete []); \u5bf9\u4e8e\u5185\u7f6e\u7c7b\u578b\uff0c\u5982int\u3001double, \u91c7\u7528delete\u4e5f\u53ef\uff0c\u56e0\u4e3aint\u3001double\u7c7b\u578b\u6ca1\u6709\u6790\u6784\u51fd\u6570\uff0c\u5185\u5b58\u4f1a\u88ab\u6b63\u5e38\u91ca\u653e\uff1b\u5bf9\u4e8e\u7c7b\u7c7b\u578b\uff0c\u5982\u679c\u8be5\u7c7b\u6ca1\u6709\u63d0\u4f9b\u6790\u6784\u51fd\u6570\uff0c\u4e14\u8be5\u7c7b\u7684\u6210\u5458\u4e2d\u4e0d\u5305\u542b\u7c7b\u7c7b\u578b\uff0c\u53ea\u6709\u5185\u7f6e\u7c7b\u578b\uff0c\u91c7\u7528delte\u4e5f\u4e0d\u4f1a\u6709\u5185\u5b58\u6cc4\u6f0f\uff1b\u4f46\u5982\u679c\u5176\u4e2d\u5305\u542b\u7c7b\u7c7b\u578b\u6210\u5458\u6216\u6307\u9488\u6210\u5458\uff0c\u5219delete\u53ea\u4f1a\u91ca\u653e\u6570\u7ec4\u4e2d\u7b2c\u4e00\u4e2a\u5143\u7d20\u5360\u7528\u7684\u5185\u5b58\uff0c\u5176\u4f59\u5143\u7d20\u5185\u5b58\u5c06\u4f1a\u6cc4\u6f0f\uff0c\u6b64\u65f6\u7a0b\u5e8f\u4e0d\u4f1a\u62a5\u9519\uff1b \u2003\u6216\u82e5\u5982\u4e0b\u9762\u60c5\u51b5\uff0cDemo\u4e2d\u63d0\u4f9b\u4e86\u6790\u6784\u51fd\u6570(\u5373\u4f7f\u51fd\u6570\u4f53\u4e3a\u7a7a)\uff0c\u65e0\u8bba\u7c7b\u6210\u5458\u7c7b\u578b\u662f\u5185\u7f6e\u7c7b\u578b\uff0c\u8fd8\u662f\u7c7b\u7c7b\u578b\u3001\u6307\u9488\u7c7b\u578b\uff0c\u7531\u4e8e\u5185\u5b58\u5e03\u5c40\u4e2d\u5305\u542b\u4e86\u6570\u7ec4\u957f\u5ea6\uff0c\u91c7\u7528delete\u6765\u8bd5\u56fe\u91ca\u653e\u5185\u5b58\u90fd\u4f1a\u62a5\u9519\u3002 \u91cd\u590ddelete \u2003delete\u4e00\u6b21\u7684\u6307\u9488\u5e76\u975eNULL\uff0c\u800c\u662f\u6210\u4e86\u7a7a\u60ac\u6307\u9488(dangling pointer)\uff0c\u867d\u7136\u6307\u9488\u5df2\u7ecf\u65e0\u6548\uff0c\u4f46\u5728\u5f88\u591a\u673a\u5668\u4e0a\u6307\u9488\u4ecd\u7136\u4fdd\u5b58\u7740(\u5df2\u7ecf\u91ca\u653e\u4e86\u7684)\u52a8\u6001\u5185\u5b58\u7684\u5730\u5740\u3002 \u2003 \u91cd\u590ddelete\u4f1a\u9020\u6210\u4e0d\u53ef\u77e5\u7684\u9519\u8bef\uff0c\u867d\u7136\u7f16\u8bd1\u5668\u53ef\u80fd\u4f1a\u68c0\u6d4b\u51fa\u91cd\u590ddelete\u7684\u53d1\u751f\uff0c\u4f46\u4e0d\u8981\u4f9d\u8d56\u7f16\u8bd1\u5668\u81ea\u8eab\u7684\u9009\u62e9\u3002 \u2003 \u5bf9\u4e8edelete\u4e00\u6b21\u7684\u6307\u9488\uff0c\u53ef\u4ee5\u663e\u793a\u4ee4\u5176\u4e3aNULL\uff0c\u6e05\u695a\u6307\u51fa\u8be5\u6307\u9488\u4e0d\u6307\u5411\u4efb\u4f55\u5bf9\u8c61\uff0cdelete\u4e00\u4e2a\u7a7a\u6307\u9488\u4e0d\u4f1a\u6709\u4efb\u4f55\u95ee\u9898 int\\* p = new int(1); delete p; p=NULL; delete p; //\u5220\u9664\u4e00\u4e2a\u7a7a\u6307\u9488\uff0c\u4e0d\u4f1a\u62a5\u9519","title":"delete"},{"location":"c_base/new_delete/#_1","text":"class FF { public: FF() :_id(0) { std::cout << \"default ctor.this=\" << this << \" id=\" << _id << std::endl; } FF(int i) :_id(i) { std::cout << \"ctor.this=\" << this << \" id=\" << _id << std::endl; } ~FF() { std::cout << \"dtor.this=\" << this << \" id=\" << _id << std::endl; } static void* operator new(size_t size); static void operator delete(void* pdead, size_t size); static void* operator new[](size_t size); static void operator delete[](void* pdead, size_t size); private: int _id; }; void* FF::operator new(size_t size) { FF* p = (FF*)malloc(size); std::cout << \"\u8c03\u7528\u4e86Foo::operator new\" << std::endl; return p; } void FF::operator delete(void* pdead, size_t size) { std::cout << \"\u8c03\u7528\u4e86Foo::operator delete\" << std::endl; free(pdead); } void* FF::operator new[](size_t size) { FF* p = (FF*)malloc(size); std::cout << \"\u8c03\u7528\u4e86Foo::operator new[]\" << std::endl; return p; } void FF::operator delete[](void* pdead, size_t size) { std::cout << \"\u8c03\u7528\u4e86Foo::operator delete[]\" << std::endl; free(pdead); } // main FF* pf = new FF(7); FF* pf1 = new FF[3]; delete pf; delete[] pf1; // \u8f93\u51fa // \u8c03\u7528\u4e86Foo::operator new // ctor.this=011D62B8 id=7 // \u8c03\u7528\u4e86Foo::operator new[] // default ctor.this=011E0DCC id // default ctor.this=011E0DD0 id // default ctor.this=011E0DD4 id // dtor.this=011D62B8 id=7 // \u8c03\u7528\u4e86Foo::operator delete // dtor.this=011E0DD4 id=0 // dtor.this=011E0DD0 id=0 // dtor.this=011E0DCC id=0 // \u8c03\u7528\u4e86Foo::operator delete[] \u2003\u901a\u8fc7::new\u548c::delete\u53ef\u4ee5\u5f3a\u5236\u4f7f\u7528\u5168\u5c40\u7684operator new\u548coperator delete\uff0c\u800c\u975e\u91cd\u8f7d\u7248\u672c\u3002 \u2003\u7c7b\u4e2d\u7684operator new\u548coperatir delete\u7684\u91cd\u8f7d\u51fd\u6570\u5fc5\u987b\u662fstatic\uff0c\u56e0\u4e3aoperator new\u5c31\u662f\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\u88ab\u8c03\u7528\uff0c\u6b64\u65f6\u5c1a\u672a\u6709\u5bf9\u8c61\u5b58\u5728\uff0c\u5982\u679c\u51fd\u6570\u662f\u975e\u9759\u6001\u7684\uff0c\u81ea\u7136\u662f\u4e0d\u80fd\u88ab\u8c03\u7528\u7684\u3002","title":"\u5173\u4e8e\u91cd\u8f7d"},{"location":"c_base/new_delete/#_2","text":"new/delete and operator new/delete and placement new new/delete\u5c5e\u4e8e\u64cd\u4f5c\u7b26\uff0c\u800coperator new/operator delete\u662f\u51fd\u6570. new: \u8c03\u7528operator new\u5206\u914d\u8db3\u591f\u7684\u7a7a\u95f4\uff0c\u5e76\u8c03\u7528\u76f8\u5173\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570; \u4e0d\u53ef\u4ee5\u88ab\u91cd\u8f7d operator new \uff081\uff09\u53ea\u5206\u914d\u6240\u8981\u6c42\u7684\u7a7a\u95f4\uff0c\u4e0d\u8c03\u7528\u76f8\u5173\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570\u3002\u5f53\u65e0\u6cd5\u6ee1\u8db3\u6240\u8981\u6c42\u5206\u914d\u7684\u7a7a\u95f4\u65f6\uff0c\u5219 ->\u5982\u679c\u6709new_handler\uff0c\u5219\u8c03\u7528new_handler\uff0c\u5426\u5219 ->\u5982\u679c\u6ca1\u8981\u6c42\u4e0d\u629b\u51fa\u5f02\u5e38\uff08\u4ee5nothrow\u53c2\u6570\u8868\u8fbe\uff09\uff0c\u5219\u6267\u884cbad_alloc\u5f02\u5e38\uff0c\u5426\u5219 ->\u8fd4\u56de0 \uff082\uff09\u53ef\u4ee5\u88ab\u91cd\u8f7d \uff083\uff09\u91cd\u8f7d\u65f6\uff0c\u8fd4\u56de\u7c7b\u578b\u5fc5\u987b\u58f0\u660e\u4e3avoid* \uff084\uff09\u91cd\u8f7d\u65f6\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u7c7b\u578b\u5fc5\u987b\u4e3a\u8868\u8fbe\u8981\u6c42\u5206\u914d\u7a7a\u95f4\u7684\u5927\u5c0f\uff08\u5b57\u8282\uff09\uff0c\u7c7b\u578b\u4e3asize_t \uff085\uff09\u91cd\u8f7d\u65f6\uff0c\u53ef\u4ee5\u5e26\u5176\u5b83\u53c2\u6570\uff0c\u5373\u6240\u8c13\u7684placement new\uff0c \u5f62\u5982operator new(size_t, string)\u3001operator new(size_t, void*)\u5f62\u5f0f; (6)placement new\u5bf9\u5e94\u5f62\u5f0f\u7684\u91cd\u8f7doperator delete\u4e5f\u53ef\u53eb\u505a placement delete , \u4f46\u5176\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u88ab\u8c03\u7528\uff0c \u53ea\u6709\u5f53\u76f8\u5e94\u7248\u672c\u7684placement new\u8c03\u7528\u6784\u9020\u51fd\u6570\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u624d\u4f1a\u88ab\u8c03\u7528(\u4e8b\u5b9e\u4e0a\u4e0d\u540c\u7f16\u8bd1\u5668\u5bf9\u6b64\u6709\u4e0d\u540c\u8868\u73b0)\uff0c \u7528\u6765\u5f52\u8fd8\u672a\u5b8c\u5168\u521b\u5efa\u6210\u529f\u7684object\u6240\u5360\u7528\u7684memory\uff1b \u82e5\u7f3a\u5c11\u5bf9\u5e94\u7248\u672c\u7684placement delete,\u5e76\u4e0d\u4f1a\u62a5\u9519\uff0c\u610f\u5473\u7740\u653e\u5f03\u6784\u9020\u51fd\u6570\u629b\u51fa\u7684\u5f02\u5e38\u3002 \u5982\u679cplacement new\u6784\u9020\u6210\u529f\u540e, \u8c03\u7528delete\u91ca\u653e\u5185\u5b58, \u6240\u8c03\u7528\u7684\u662f\u6b63\u5e38\u5f62\u5f0f\u7684operator delete(\u53ef\u80fd\u662f\u5168\u5c40\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u81ea\u5b9a\u4e49\u7684)\u3002 \u63a5\u53d7\u7b2c\u4e8c\u4e2a\u6307\u9488\u53c2\u6570\u7684placement new, \u6267\u884c\u65f6\u5ffd\u7565size_t\u53c2\u6570\uff0c\u53ea\u8fd4\u8fd8\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a \u6307\u5411\u5df2\u7ecf\u5206\u914d\u597d\u7684\u67d0\u6bb5\u5185\u5b58\u7684\u4e00\u4e2a\u6307\u9488 \uff0c\u8fd9\u6bb5\u5185\u5b58\u53ef\u80fd\u5728\u6808\u4e2d\u6216\u8005\u9759\u6001\u5168\u5c40\u533a\uff0c\u800cdelete\u53ea\u80fd\u91ca\u653e\u5206\u914d\u5728\u5806\u4e2d\u7684\u5185\u5b58\uff0c\u56e0\u6b64\u901a\u8fc7\u6b64\u79cdplacement new\u5f97\u5230\u7684\u6307\u9488\u4e0d\u80fd\u8c03\u7528delete\uff0c\u53ea\u9700\u8c03\u7528\u6307\u5411\u5bf9\u8c61\u7684\u6790\u6784\u51fd\u6570\u3002 new (place_address) type new (place_address) type (initializers) new (place_address) type [size] new (place_address) type [size] { brace initializer list} \u2003\u5176\u4e2dplace_address\u662f\u4e00\u4e2a\u6307\u9488\uff0c \u540c\u65f6\u5728initializers\u63d0\u4f9b\u7684\u4e00\u4e2a(\u53ef\u4e3a\u7a7a)\u4ee5\u9017\u53f7\u5206\u9694\u7684\u521d\u59cb\u503c\u5217\u8868\uff0c\u8be5\u521d\u59cb\u503c\u5217\u8868\u5c06\u7528\u4e8e\u6784\u9020\u65b0\u5206\u914d\u7684\u5bf9\u8c61\u3002 \u5f53\u53ea\u4f20\u5165\u4e00\u4e2a\u6307\u9488\u7c7b\u578b\u7684\u5b9e\u53c2\u65f6\uff0c\u5b9a\u4f4dnew\u8868\u8fbe\u5f0f\u6784\u9020\u5bf9\u8c61\u4f46\u662f\u4e0d\u5206\u914d\u5185\u5b58\u3002\u8fd9\u79cd\u91cd\u8f7d\u5f62\u5f0f\u7684operator new\u5e38\u88ab\u7ffb\u8bd1\u4e3a\u5b9a\u4f4dnew\uff0cC++\u5e93\u4e2d\u5df2\u7ecf\u63d0\u4f9b\u4e86\u8be5\u7248\u672c\u3002 \u4f18\u70b9: 1.\u7528placement new \u89e3\u51b3buffer\u7684\u95ee\u9898 \u95ee\u9898\u63cf\u8ff0:\u7528new\u5206\u914d\u7684\u6570\u7ec4\u7f13\u51b2\u65f6,\u7531\u4e8e\u8c03\u7528\u4e86\u9ed8\u8ba4\u6784\u9020\u51fd\u6570,\u56e0\u6b64\u6267\u884c\u6548\u7387\u4e0a\u4e0d\u4f73\u3002\u82e5\u6ca1\u6709\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u5219\u4f1a\u53d1\u751f\u7f16\u8bd1\u65f6\u9519\u8bef\u3002 \u5982\u679c\u4f60\u60f3\u5728\u9884\u5206\u914d\u7684\u5185\u5b58\u4e0a\u521b\u5efa\u5bf9\u8c61\uff0c\u7528\u7f3a\u7701\u7684new\u64cd\u4f5c\u7b26\u662f\u884c\u4e0d\u901a\u7684\u3002\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c \u4f60\u53ef\u4ee5\u7528placement new\u6784\u9020\u3002\u5b83\u5141\u8bb8\u4f60\u6784\u9020\u4e00\u4e2a\u65b0\u5bf9\u8c61\u5230\u9884\u5206\u914d\u7684\u5185\u5b58\u4e0a\u3002 2.\u589e\u5927\u65f6\u7a7a\u6548\u7387\u7684\u95ee\u9898 \u4f7f\u7528new\u64cd\u4f5c\u7b26\u5206\u914d\u5185\u5b58\u9700\u8981\u5728\u5806\u4e2d\u67e5\u627e\u8db3\u591f\u5927\u7684\u5269\u4f59\u7a7a\u95f4\uff0c\u663e\u7136\u8fd9\u4e2a\u64cd\u4f5c\u901f\u5ea6\u662f\u5f88\u6162\u7684\uff0c \u800c\u4e14\u6709\u53ef\u80fd\u51fa\u73b0\u65e0\u6cd5\u5206\u914d\u5185\u5b58\u7684\u5f02\u5e38\uff08\u7a7a\u95f4\u4e0d\u591f\uff09\u3002 placement new\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6211\u4eec\u6784\u9020\u5bf9\u8c61\u90fd\u662f\u5728\u4e00\u4e2a\u9884\u5148\u51c6\u5907\u597d\u4e86\u7684\u5185\u5b58\u7f13\u51b2\u533a\u4e2d\u8fdb\u884c\uff0c\u4e0d\u9700\u8981\u67e5\u627e\u5185\u5b58\uff0c \u5185\u5b58\u5206\u914d\u7684\u65f6\u95f4\u662f\u5e38\u6570\uff1b\u800c\u4e14\u4e0d\u4f1a\u51fa\u73b0\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u9014\u51fa\u73b0\u5185\u5b58\u4e0d\u8db3\u7684\u5f02\u5e38\u3002 \u6240\u4ee5\uff0cplacement new\u975e\u5e38\u9002\u5408\u90a3\u4e9b\u5bf9\u65f6\u95f4\u8981\u6c42\u6bd4\u8f83\u9ad8\uff0c\u957f\u65f6\u95f4\u8fd0\u884c\u4e0d\u5e0c\u671b\u88ab\u6253\u65ad\u7684\u5e94\u7528\u7a0b\u5e8f\u3002","title":"\u603b\u7ed3"},{"location":"c_base/pointer_reference/","text":"\u6307\u9488 and \u5f15\u7528 \u6307\u9488 \u7c7b\u578b: \u5185\u7f6e\u6307\u9488\uff1a\u7531new\u64cd\u4f5c\u8fd4\u56de\u7684\u6307\u9488\uff0c\u7ed1\u5b9a\u7684\u662f\u52a8\u6001\u5206\u914d\u5bf9\u8c61\uff1b\u666e\u901a\u6307\u9488\uff1a\u7c7b\u4f3c int *p =1; \u667a\u80fd\u6307\u9488; \u9690\u5f0f\u9500\u6bc1\u4e00\u4e2a\u5185\u7f6e\u6307\u9488\u7c7b\u578b\u7684\u6210\u5458\u4e0d\u4f1adelete\u5b83\u6240\u6307\u5411\u7684\u5bf9\u8c61\uff1b\u5f53\u6307\u5411\u4e00\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u6216\u8005\u6307\u9488\u79bb\u5f00\u4f5c\u7528\u57df\u65f6\uff0c\u6790\u6784\u51fd\u6570\u4e0d\u4f1a\u6267\u884c\u3002\uff08\u662f\u4e3a\u4e86\u907f\u514d\u5b58\u5728\u591a\u4e2a\u6307\u9488\u6307\u5411\u540c\u4e00\u5757\u5185\u5b58\u65f6\uff0c\u8bef\u56de\u6536\uff09\u4f46\u662f\u6307\u9488\u53d8\u91cf\u672c\u8eab\u6240\u5360\u7684\u5185\u5b58\u4f1a\u88ab\u56de\u6536\u3002 \u6307\u9488\u672c\u8eab\u5c5e\u4e8e\u5bf9\u8c61\uff0c\u5176\u5141\u8bb8\u5bf9\u6307\u9488\u8d4b\u503c\u548c\u62f7\u8d1d\uff0c\u5728\u5b9a\u4e49\u65f6\u65e0\u987b\u8d4b\u521d\u503c\uff1b\u800c\u5728\u5757\u4f5c\u7528\u57df\u5185\u5b9a\u4e49\u7684\u6307\u9488\u5982\u679c\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u5c06\u662f\u4e00\u4e2a\u4e0d\u786e\u5b9a\u7684\u503c\u3002 \u7a7a\u6307\u9488\uff1aint *p = nullptr; int *p =0; int *p =NULL; \u4e0d\u5141\u8bb8\u5c06int\u53d8\u91cf\u8d4b\u503c\u7ed9\u6307\u9488\uff0c\u5373\u4f7f\u5176\u503c\u662f0\uff0c\u5373 int a =0; int * p = a; //\u9519\u8bef \u7a7a\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u662f\u7279\u6b8a\u7684\uff0c\u8be5\u5730\u5740\u4e0d\u5141\u8bb8\u5b58\u653e\u6570\u636e\u548c\u4e0d\u5141\u8bb8\u7a0b\u5e8f\u8bbf\u95ee\uff0c\u6240\u4ee5\u7a7a\u6307\u9488\u4e0d\u80fd\u64cd\u4f5c\u8be5\u5730\u5740\u91cc\u7684\u4e1c\u897f\uff0c \u53ef\u4ee5\u7406\u89e3\u4e3a\u201c\u6307\u9488\u6307\u5411\u4e86\u7a7a\uff0c\u65e0\u6cd5\u64cd\u4f5c\u4e86\u201d \u6307\u9488\u6709\u4e24\u4e2a\u5c5e\u6027:\u6307\u5411\u53d8\u91cf/\u5bf9\u8c61\u7684\u5730\u5740\u548c\u957f\u5ea6\uff0c\u4f46\u662f\u6307\u9488\u53ea\u5b58\u50a8\u5730\u5740,\u957f\u5ea6\u5219\u53d6\u51b3\u4e8e\u6307\u9488\u7684\u7c7b\u578b\uff1b \u7f16\u8bd1\u5668\u6839\u636e\u6307\u9488\u7684\u7c7b\u578b\u4ece\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u5411\u540e\u5bfb\u5740\uff0c\u6307\u9488\u7c7b\u578b\u4e0d\u540c\u5219\u5bfb\u5740\u8303\u56f4\u4e5f\u4e0d\u540c, \u6bd4\u5982:int*\u4ece\u6307\u5b9a\u5730\u5740\u5411\u540e\u5bfb\u627e4\u5b57\u8282\u4f5c\u4e3a\u53d8\u91cf\u7684\u5b58\u50a8\u5355\u5143; double*\u4ece\u6307\u5b9a\u5730\u5740\u5411\u540e\u5bfb\u627e8\u5b57\u8282\u4f5c\u4e3a\u53d8\u91cf\u7684\u5b58\u50a8\u5355\u5143\u3002 \u800cvoid* \u6307\u9488\u5219\u6ca1\u6709\u7c7b\u578b\uff0c\u5176\u53ef\u4ee5\u5b58\u653e\u4efb\u610f\u7c7b\u578b\u5bf9\u8c61\u7684\u5730\u5740\uff0c\u4f46\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u64cd\u4f5cvoid* \u6307\u9488\u6240\u6307\u5411\u7684\u5bf9\u8c61\u3002 void\u6307\u9488\u4e0d\u80fd\u53c2\u4e0e\u6307\u9488\u8fd0\u7b97,\u9664\u975e\u8fdb\u884c\u8f6c\u6362\uff0c(type*) vp++; const\u6307\u9488\uff1a int * const a; \u8bb0\u4f4f*\u653e\u5728const\u4e4b\u524d\u7528\u4ee5\u8bf4\u660e\u6307\u9488\u662f\u4e00\u4e2a\u5e38\u91cf\uff0c\u4e0d\u53d8\u7684\u662f\u6307\u9488\u672c\u8eab\u800c\u975e\u6307\u5411\u7684\u5bf9\u8c61\u7684\u503c constexpr\u6307\u9488\uff1a constexpr int * p = nullptr; p\u662f\u4e00\u4e2a\u6307\u5411\u6574\u6570\u7684\u5e38\u91cf\u6307\u9488\uff0c\u56e0\u4e3aconstexpr\u628a\u5b83\u6240\u5b9a\u4e49\u7684\u5bf9\u8c61\u7f6e\u4e3a\u4e86\u9876\u5c42const\u3002 \u89e3\u5f15\u7528\uff1a\u5bf9\u6307\u9488\u89e3\u5f15\u7528\u4f1a\u5f97\u5230\u6240\u6307\u7684\u5bf9\u8c61\uff0c\u662f\u4e00\u4e2a\u5de6\u503c\uff1b\u800c\u8fed\u4ee3\u5668\u7684\u89e3\u5f15\u7528\u662f\u91cd\u8f7d\u4e86*\u8fd0\u7b97\u7b26\uff0c\u5176\u8fd4\u56de\u6240\u6307\u5143\u7d20\u7684\u5f15\u7528\u3002 \u6307\u9488\u7684\u7c7b\u578b\u5fc5\u987b\u548c\u5176\u6240\u6307\u5411\u5bf9\u8c61\u7684\u7c7b\u578b\u4e00\u81f4\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\u4f8b\u5916: \u2003\u7b2c\u4e00\u79cd\uff0c\u6307\u5411\u5e38\u91cf\u7684\u6307\u9488\u6ca1\u6709\u89c4\u5b9a\u5176\u6240\u6307\u5411\u7684\u5bf9\u8c61\u5fc5\u987b\u662f\u4e00\u4e2a\u5e38\u91cf\uff0c\u4ec5\u4ec5\u8981\u6c42\u4e0d\u80fd\u901a\u8fc7\u8be5\u6307\u9488\u6539\u53d8\u5bf9\u8c61\u7684\u503c\u3002 \u2003\u7b2c\u4e8c\u79cd\uff0c\u6307\u9488\u7c7b\u578b\u6307\u5411\u57fa\u7c7b\uff0c\u4f46\u5176\u6240\u6307\u5411\u5b9e\u9645\u5bf9\u8c61\u662f\u6d3e\u751f\u7c7b\u7c7b\u578b\u3002 int *p: p\u662f\u6307\u5411int\u578b\u53d8\u91cf\u7684\u6307\u9488\u53d8\u91cf int* *p\uff1a p\u662f\u6307\u5411int*\u578b\u53d8\u91cf\u7684\u6307\u9488\u53d8\u91cf\uff0c\u5373\u6307\u5411\u6307\u9488\u7684\u6307\u9488\u3002 T *p; // p+1 \u5b9e\u9645\u4e3ap+sizeof(T)*1; \u667a\u80fd\u6307\u9488 \uff1a\u81ea\u52a8\u91ca\u653e\u6240\u6307\u5411\u7684\u5bf9\u8c61\uff0c\u5176\u662f\u4e00\u79cd\u6a21\u677f\uff0c\u5728\u521b\u5efa\u667a\u80fd\u6307\u9488\u65f6\uff0c\u9700\u8981\u63d0\u4f9b\u6307\u9488\u53ef\u4ee5\u6307\u5411\u7684\u7c7b\u578b\uff0c\u6709\u4e09\u79cd\u7c7b\u578b\uff0c\u90fd\u5b9a\u4e49\u5728memory\u5934\u6587\u4ef6\u4e2d\u3002 shared_ptr \u2003\u5141\u8bb8\u591a\u4e2a\u6307\u9488\u6307\u5411\u540c\u4e00\u4e2a\u5bf9\u8c61; \u2003\u5f53\u7528\u4e00\u4e2ashared_ptr\u521d\u59cb\u5316\u53e6\u4e00\u4e2ashared_ptr\u6216\u8005\u5c06\u5b83\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u4e00\u4e2a\u51fd\u6570\u4ee5\u53ca\u4f5c\u4e3a\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5b83\u6240\u5173\u8054\u7684\u8ba1\u6570\u5668\uff08\u5f15\u7528\u8ba1\u6570\uff09\u5c31\u4f1a\u9012\u589e\uff1b\u82e5\u662f\u7ed9\u5176\u8d4b\u4e88\u65b0\u503c\uff0c\u6216\u662fshared_ptr\u88ab\u9500\u6bc1\uff0c \u5b83\u5c31\u4f1a\u81ea\u52a8\u91ca\u653e\u81ea\u5df1\u6240\u7ba1\u7406\u7684\u5bf9\u8c61\u3002 \u2003 \u7528\u6765\u521d\u59cb\u5316\u667a\u80fd\u6307\u9488\u7684\u666e\u901a\u6307\u9488\u5fc5\u987b\u6307\u5411\u52a8\u6001\u5185\u5b58(\u901a\u8fc7new\u5206\u914d\u7684\u5185\u5b58)\uff0c\u56e0\u4e3a\u667a\u80fd\u6307\u9488\u9ed8\u8ba4\u4f7f\u7528delete \u6765\u91ca\u653e\u6240\u5173\u8054\u7684\u5bf9\u8c61\u3002\u5982\u679c\u5c06\u667a\u80fd\u6307\u9488\u7ed1\u5b9a\u5230\u4e00\u4e2a\u6307\u5411\u5176\u4ed6\u7c7b\u578b\u7684\u8d44\u6e90\u7684\u6307\u9488\u4e0a\uff0c\u5fc5\u987b\u63d0\u4f9b\u81ea\u5df1\u7684\u64cd\u4f5c\u6765\u66ff\u4ee3delete. \u2003 \u63a5\u53d7\u6307\u9488\u53c2\u6570\u7684\u667a\u80fd\u6307\u9488\u6784\u9020\u51fd\u6570\u662fexplicit, \u610f\u5473\u7740\u5fc5\u987b\u7528\u76f4\u63a5\u521d\u59cb\u5316\u5f62\u5f0f\u6765\u521d\u59cb\u5316\u4e00\u4e2a\u667a\u80fd\u6307\u9488\uff1a shared_ptr < int > p1(new int(1)); shared_ptr < int > p2 = new int(1); //\u9519\u8bef unique_ptr \u2003\u72ec\u5360\u6240\u6307\u5411\u7684\u5bf9\u8c61, \u67d0\u4e00\u65f6\u523b\u53ea\u80fd\u6709\u4e00\u4e2aunique_ptr\u6307\u5411\u4e00\u4e2a\u7ed9\u5b9a\u7684\u5bf9\u8c61\uff0c\u6545\u5176\u4e0d\u652f\u6301\u62f7\u8d1d\u548c\u8d4b\u503c\u64cd\u4f5c; \u2003\u901a\u8fc7\u8c03\u7528release\u6216\u8005reset\u53ef\u4ee5\u5c06\u6307\u9488\u7684\u6240\u6709\u6743\u4ece\u4e00\u4e2a\u975econst unique_ptr\u4f20\u7ed9\u53e6\u4e00\u4e2aunique_ptr: \u2003 unique_ptr p(p1.release()); p2.reset(p3.release()); \u2003\u4e0d\u80fd\u62f7\u8d1dunique_ptr\u7684\u89c4\u5219\u6709\u4e00\u4e2a\u4f8b\u5916\uff1a\u5373\u53ef\u4ee5\u62f7\u8d1d\u548c\u8d4b\u503c\u4e00\u4e2a\u5c06\u8981\u88ab\u9500\u6bc1\u7684unique_ptr, \u4f8b\u5982\u4ece\u51fd\u6570\u8fd4\u56de\u4e00\u4e2aunique_ptr\u3002 weak_ptr \u2003\u5c5e\u4e8e\u4e00\u79cd\u5f31\u5f15\u7528\uff0c\u6307\u5411shared_ptr\u6240\u7ba1\u7406\u7684\u5bf9\u8c61\u3002 \u2003weak_ptr\u4e3b\u8981\u7528\u6765\u89e3\u51b3\u5faa\u73af\u5f15\u7528\u7684\u95ee\u9898\u3002 \u667a\u80fd\u6307\u9488\u4f7f\u7528\u89c4\u8303\uff1a \u2003\u4e0d\u4f7f\u7528\u76f8\u540c\u7684\u5185\u7f6e\u6307\u9488\u503c\u521d\u59cb\u5316\u6216reset\u591a\u4e2a\u667a\u80fd\u6307\u9488\uff1b \u2003\u4e0ddelete get()\u8fd4\u56de\u7684\u6307\u9488\uff1b \u2003\u4e0d\u4f7f\u7528get()\u521d\u59cb\u5316\u6216reset\u53e6\u4e00\u4e2a\u667a\u80fd\u6307\u9488\uff1b \u2003\u5982\u679c\u4f7f\u7528get()\u8fd4\u56de\u7684\u6307\u9488\uff0c\u8bb0\u4f4f\u5f53\u6700\u540e\u4e00\u4e2a\u5bf9\u5e94\u7684\u667a\u80fd\u6307\u9488\u9500\u6bc1\u540e\uff0c\u6307\u9488\u5c31\u53d8\u4e3a\u65e0\u6548\u4e86\uff1b \u2003\u5f53\u4f7f\u7528\u667a\u80fd\u6307\u9488\u7ba1\u7406\u7684\u8d44\u6e90\u4e0d\u662fnew\u5206\u914d\u7684\u5185\u5b58\uff0c\u8bb0\u4f4f\u4f20\u9012\u7ed9\u5b83\u4e00\u4e2a\u5220\u9664\u5668\u3002 \u2003\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u667a\u80fd\u6307\u9488\u7684\u9ed8\u8ba4\u5220\u9664\u5668\u5373\u53ef\u91ca\u653e\u4fdd\u5b58\u7684\u6307\u9488\uff0c\u4f46\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5982\uff1a\u8d44\u6e90\u4e0d\u662f new \u51fa\u6765\u7684(\u4e00\u822c\u4e5f\u610f\u5473\u7740\u4e0d\u80fd delete), \u53ef\u80fd\u662f malloc \u51fa\u6765\u7684\u6216\u8005\u8d44\u6e90\u662f\u88ab\u7b2c\u4e09\u65b9\u5e93\u7ba1\u7406\u7684 (\u7b2c\u4e09\u65b9\u63d0\u4f9b\u8d44\u6e90\u83b7\u53d6\u548c\u8d44\u6e90\u91ca\u653e\u63a5\u53e3)\uff1b\u8d44\u6e90\u4e0d\u662f RAII \u7684, \u610f\u5473\u7740\u6790\u6784\u51fd\u6570\u4e0d\u4f1a\u628a\u8d44\u6e90\u5b8c\u5168\u91ca\u653e\u6389.\uff0c\u5373\u5355\u7eaf delete \u8fd8\u4e0d\u591f\uff1b \u2003 \u5982\u679cptr\u4e0d\u662f\u6307\u5411\u4e2aobject\uff0c\u800c\u662f\u4e00\u4e2aobject\u7684\u6570\u7ec4\u3002\u90a3\u4e48\u6784\u9020shared_ptr\u65f6\u5019\u5c31\u5f97\u81ea\u5df1\u4f20\u5165\u5220\u9664\u5668 , \u4f8b\u5982\u8fd9\u91cc\u4f20\u5165\u4e00\u4e2alambda\u7c7b\u578b\u7684deletor, shared_ptr(ptr, [](void*){delete [] ptr}) \u667a\u80fd\u6307\u9488\u4e0e\u52a8\u6001\u6570\u7ec4 \u2003\u53ef\u4ee5\u4f7f\u7528unique_ptr\u6765\u7ba1\u7406new\u5206\u914d\u7684\u6570\u7ec4\uff1a unique_ptr< T [] > up(new T [10]); auto p = up.release(); //up\u653e\u5f03\u6307\u9488\u7684\u63a7\u5236\u6743\uff0c\u5e76\u8fd4\u56de\u6307\u9488\uff0c\u7136\u540e\u5c06up\u7f6e\u4e3a\u7a7a delete p; or up.reset(); // \u91ca\u653eup\u6307\u5411\u7684\u5bf9\u8c61\uff0c up.reset(q); up\u91ca\u653e\u539f\u5148\u5360\u6709\u5185\u5b58\uff0c\u6539\u4e3a\u6307\u5411q\u6240\u6307\u5411\u7684\u5185\u5b58 /*\u6b64\u65f6\u4e0d\u80fd\u4f7f\u7528\u70b9\u548c\u7bad\u5934\u6210\u5458\u8fd0\u7b97\u7b26\uff0c\u56e0\u4e3aup\u4e0d\u662f\u6307\u5411\u5355\u4e2a\u5bf9\u8c61;\u4f46\u53ef\u4ee5\u4f7f\u7528\u4e0b\u6807\u8fd0\u7b97\u7b26\u8bbf\u95ee\u6570\u7ec4\u4e2d\u7684\u5143\u7d20 \uff08\u52a8\u6001\u6570\u7ec4\u672c\u8eab\u5e76\u975e\u6570\u7ec4\u7c7b\u578b\uff0c\u662f\u4e0d\u652f\u6301\u4e0b\u6807\u8fd0\u7b97\u7684\uff09\u3002*/ \u2003shared_ptr\u4e0d\u76f4\u63a5\u652f\u6301\u7ba1\u7406\u52a8\u6001\u6570\u7ec4\uff0c\u5fc5\u987b\u63d0\u4f9b\u81ea\u5df1\u5b9a\u4e49\u7684\u5220\u9664\u5668 shared_ptr< int > sp(new int[10], \\[](int\\* p){delete \\[] p;}); sp.reset(); /* \u4e0d\u8fc7shared_ptr\u6ca1\u6709\u5b9a\u4e49\u4e0b\u6807\u8fd0\u7b97\u7b26\uff0c\u4e14\u6240\u6709\u667a\u80fd\u6307\u9488\u7c7b\u578b\u90fd\u4e0d\u652f\u6301\u6307\u9488\u7b97\u672f\u8fd0\u7b97\uff0c \u56e0\u6b64\u53ea\u80fd\u901a\u8fc7get()\u83b7\u53d6\u5185\u7f6e\u6307\u9488\uff0c\u7528\u6765\u8bbf\u95ee\u6570\u7ec4\u5143\u7d20\u3002*/ \u4ec0\u4e48\u65f6\u5019\u4f7f\u7528\u52a8\u6001\u5185\u5b58\uff1f \u2003\u7a0b\u5e8f\u4e0d\u77e5\u9053\u81ea\u5df1\u9700\u8981\u4f7f\u7528\u591a\u5c11\u5bf9\u8c61, \u5982\u5bb9\u5668; \u7a0b\u5e8f\u4e0d\u77e5\u9053\u6240\u9700\u5bf9\u8c61\u7684\u51c6\u786e\u7c7b\u578b\uff1b\u7a0b\u5e8f\u9700\u8981\u5728\u591a\u4e2a\u5bf9\u8c61\u95f4\u5171\u4eab\u6570\u636e\u3002 shared_ptr\u4e0eunique_ptr\u7684\u53e6\u4e00\u4e2a\u5dee\u5f02\uff1a\u5141\u8bb8\u7528\u6237\u91cd\u8f7d\u9ed8\u8ba4\u5220\u9664\u5668\u7684\u65b9\u5f0f \u524d\u8005\u53ea\u8981\u5728\u521b\u5efa\u6216reset\u6307\u9488\u65f6\u4f20\u9012\u4e00\u4e2a\u53ef\u8c03\u7528\u5bf9\u8c61\u5373\u53ef\uff0c\u540e\u8005\u53ea\u80fd\u5728\u5b9a\u4e49\u65f6\u4ee5\u663e\u5f0f\u6a21\u677f\u5b9e\u53c2\u7684\u5f62\u5f0f\u63d0\u4f9b\u5220\u9664\u5668\u7684\u7c7b\u578b\u3002 \u901a\u8fc7\u5728\u7f16\u8bd1\u65f6\u7ed1\u5b9a\u5220\u9664\u5668\uff0cunique_ptr\u907f\u514d\u4e86\u95f4\u63a5\u8c03\u7528\u5220\u9664\u5668\u7684\u8fd0\u884c\u65f6\u5f00\u9500\uff1b\u800c\u5728\u8fd0\u884c\u65f6\u7ed1\u5b9a\u5220\u9664\u5668\uff0cshared_ptr\u4f7f\u5f97\u7528\u6237\u91cd\u8f7d\u5220\u9664\u5668\u66f4\u4e3a\u65b9\u4fbf\u3002 shared_ptr p(q, d); p.reset(q, d); //\u65e0\u9700\u5728\u5b9a\u4e49\u65f6\u6307\u660e ................................................................................. unique_ptr(connection, decltype(end_connection)*) p(&c, end_connection); //end_connection \u4e0eend_connection_2\u4e24\u8005\u8fd4\u56de\u7c7b\u578b\u76f8\u540c\uff0c\u5373\u8981\u6c42\u5fc5\u987b\u5728\u5b9a\u4e49\u65f6\u63d0\u4f9b\u5220\u9664\u5668\u7684\u7c7b\u578b\u3002 p.reset(&c, end_connection_2) About this pointer \u2003 this\u6307\u9488\uff0c\u5728 C++ \u4e2d\uff0c\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u90fd\u80fd\u901a\u8fc7 this \u6307\u9488\u6765\u8bbf\u95ee\u81ea\u5df1\u7684\u5730\u5740\u3002 this \u6307\u9488\u662f\u6240\u6709\u6210\u5458\u51fd\u6570\u7684\u9690\u542b\u53c2\u6570\u3002 \u56e0\u6b64\uff0c\u5728\u6210\u5458\u51fd\u6570\u5185\u90e8\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u6307\u5411\u8c03\u7528\u5bf9\u8c61\u3002\u5f53\u6211\u4eec\u8c03\u7528\u6210\u5458\u51fd\u6570\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u66ff\u67d0\u4e2a\u5bf9\u8c61\u8c03\u7528\u5b83\u3002 \u2003\u6210\u5458\u51fd\u6570\u901a\u8fc7\u4e00\u4e2a\u540d\u4e3a this \u7684\u989d\u5916\u9690\u5f0f\u53c2\u6570\u6765\u8bbf\u95ee\u8c03\u7528\u5b83\u7684\u90a3\u4e2a\u5bf9\u8c61\uff0c\u5f53\u6211\u4eec\u8c03\u7528\u4e00\u4e2a\u6210\u5458\u51fd\u6570\u65f6\uff0c\u7528\u8bf7\u6c42\u8be5\u51fd\u6570\u7684\u5bf9\u8c61\u5730\u5740\u521d\u59cb\u5316 this\uff1b\u5bf9\u4e8e\u6211\u4eec\u6765\u8bf4\uff0cthis \u5f62\u53c2\u662f\u9690\u5f0f\u5b9a\u4e49\u7684\u3002\u5b9e\u9645\u4e0a\uff0c\u4efb\u4f55\u81ea\u5b9a\u4e49\u540d\u4e3a this \u7684\u53c2\u6570\u6216\u53d8\u91cf\u7684\u884c\u4e3a\u90fd\u662f\u975e\u6cd5\u7684\u3002 \u2003\u4e00\u822c\u6765\u8bf4\uff0cthis\u7c7b\u578b\u662f\u4e00\u4e2a\u6307\u5411 \u975e\u5e38\u91cf\u7c7b \u7c7b\u578b\u7684const\u6307\u9488\uff08eg. class_name* const this\uff09\uff0c\u56e0\u6b64\u4e0d\u80fd\u5c06this\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5e38\u91cf\u5bf9\u8c61\u4e0a\uff1b\u6240\u4ee5\u6211\u4eec\u4e0d\u80fd\u8c03\u7528\u5e38\u91cf\u5bf9\u8c61\u7684\u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570\uff0c\u56e0\u4e3a\u8fd9\u4f1a\u7528\u8be5\u5e38\u91cf\u5bf9\u8c61\u7684\u5730\u5740\u521d\u59cb\u5316this\uff0c\u4f46this\u6307\u5411\u7684\u662f\u975e\u5e38\u91cf\u7c7b\u7c7b\u578b\uff0c\u5c06\u5f15\u53d1\u7f16\u8bd1\u5668\u62a5\u9519\u3002 \u2003c++\u5141\u8bb8\u7684\u505a\u6cd5\u662f\u628aconst\u5173\u952e\u5b57\u653e\u5728\u6210\u5458\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u4e4b\u540e\uff0c\u4ee5\u6b64\u6765\u6539\u53d8this\u6307\u9488\u7684\u7c7b\u578b\u3002\u56e0\u6b64\u5728\u5e38\u91cf\u5bf9\u8c61\u8c03\u7528\u5e38\u91cf\u6210\u5458\u51fd\u6570\u65f6\uff0cthis\u6307\u9488\u7c7b\u578b\u4e3a\u6307\u5411 const \u5bf9\u8c61\u7684 const \u6307\u9488\u3002 \u5f15\u7528 \u2003\u5f15\u7528\u5e76\u975e\u5bf9\u8c61\uff0c\u800c\u662f\u4e3a\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5bf9\u8c61\u6240\u8d77\u7684\u53e6\u5916\u4e00\u4e2a\u540d\u5b57\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728\u5f15\u7528\u7684\u5f15\u7528\u3002\u5b9a\u4e49\u5f15\u7528\u65f6\uff0c\u7a0b\u5e8f\u628a\u5f15\u7528\u548c\u5b83\u7684\u521d\u59cb\u503c\u5bf9\u8c61\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u800c\u4e0d\u662f\u628a\u521d\u59cb\u503c\u62f7\u8d1d\u7ed9\u5f15\u7528\u3002 \u2003\u5f15\u7528\u7684\u7c7b\u578b\u5fc5\u987b\u4e0e\u5176\u6240\u5f15\u7528\u5bf9\u8c61\u7684\u7c7b\u578b\u4e00\u81f4\uff0c\u4f46\u662f\u6709\u4e24\u79cd\u4f8b\u5916\uff1a \u7b2c\u4e00\u79cd\uff1a\u5728\u521d\u59cb\u5316\u5e38\u91cf\u5f15\u7528\u65f6\u5141\u8bb8\u7528\u4efb\u610f\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u521d\u59cb\u503c\uff0c\u53ea\u8981\u8be5\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u80fd\u8f6c\u6362\u6210\u5f15\u7528\u7684\u7c7b\u578b\u5373\u53ef\uff0c\u5c24\u5176\uff0c\u5141\u8bb8\u4e3a\u4e00\u4e2a\u5e38\u91cf\u5f15\u7528\u7ed1\u5b9a\u975e\u5e38\u91cf\u7684\u5bf9\u8c61\u3001\u5b57\u9762\u503c\u3001\u751a\u81f3\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002\u6b64\u65f6\uff0c\u901a\u8fc7\u8be5\u5e38\u91cf\u5f15\u7528\u4e0d\u80fd\u4fee\u6539\u5668\u7ed1\u5b9a\u7684\u5bf9\u8c61\u7684\u503c\uff0c\u4f46\u82e5\u8be5\u7ed1\u5b9a\u7684\u5bf9\u8c61\u672c\u8eab\u662f\u975e\u5e38\u91cf\uff0c\u53ef\u4ee5\u81ea\u6211\u4fee\u6539\u3002 \u7b2c\u4e8c\u79cd\u60c5\u51b5\u662f\u6d3e\u751f\u7c7b\u5f15\u7528\u5411\u57fa\u7c7b\u5f15\u7528\u7684\u81ea\u52a8\u7c7b\u578b\u8f6c\u6362\u3002 \u2003 return by reference: \u4f20\u9012\u8005\u65e0\u9700\u77e5\u9053\u63a5\u6536\u8005\u662f\u5426\u662f\u4ee5reference\u5f62\u5f0f\u63a5\u6536\uff1b\u800creturen by pointer\u8981\u6c42\u63a5\u6536\u8005\u5fc5\u987b\u662f\u4ee5pointer\u5f62\u5f0f\u3002 C++ 11 \u5f15\u7528 \u5de6\u503c\u5f15\u7528 and \u53f3\u503c\u5f15\u7528 \u2003\u5de6\u503c\u5f15\u7528\u201c&\u201d\u548c\u53f3\u503c\u5f15\u7528\u201c&&\u201d\uff1aC++\u4e2d\u6240\u6709\u7684\u503c\u90fd\u5fc5\u7136\u5c5e\u4e8e\u5de6\u503c\u3001\u53f3\u503c\u4e8c\u8005\u4e4b\u4e00\u3002\u5de6\u503c\u662f\u6307\u8868\u8fbe\u5f0f\u7ed3\u675f\u540e\u4f9d\u7136\u5b58\u5728\u7684\u6301\u4e45\u5316\u5bf9\u8c61\uff0c \u53f3\u503c\u662f\u6307\u8868\u8fbe\u5f0f\u7ed3\u675f\u65f6\u5c31\u4e0d\u518d\u5b58\u5728\u7684\u4e34\u65f6\u5bf9\u8c61 \u3002\u6240\u6709\u7684\u5177\u540d\u53d8\u91cf\u6216\u8005\u5bf9\u8c61\u90fd\u662f\u5de6\u503c\uff0c\u800c\u53f3\u503c\u4e0d\u5177\u540d\u3002\u533a\u5206\u5de6\u503c\u548c\u53f3\u503c\u7684\u4fbf\u6377\u65b9\u6cd5\uff1a\u770b\u80fd\u4e0d\u80fd\u5bf9\u8868\u8fbe\u5f0f\u53d6\u5730\u5740\uff0c\u5982\u679c\u80fd\uff0c\u5219\u4e3a\u5de6\u503c\uff0c\u5426\u5219\u4e3a\u53f3\u503c\u3002 \u2003 \u867d\u7136\u5de6\u503c\u5f15\u7528\u4e0d\u53ef\u4ee5\u7ed1\u5b9a\u53f3\u503c\uff0c\u4f46\u5e38\u91cf\u5de6\u503c\u5f15\u7528\u5374\u53ef\u4ee5\u7ed1\u5b9aconst\u53f3\u503c \u2003 const int &a = 1; //a\u5e76\u4e0d\u80fd\u88ab\u4fee\u6539 \u89c4\u52191. \u5f15\u7528\u6298\u53e0 \u5982\u679c\u95f4\u63a5\u7684\u521b\u5efa\u4e00\u4e2a\u5f15\u7528\u7684\u5f15\u7528\uff0c\u5219\u8fd9\u4e9b\u5f15\u7528\u5c31\u4f1a\u201c\u6298\u53e0\u201d\u3002\u5728\u6240\u6709\u60c5\u51b5\u4e0b\uff08\u9664\u4e86\u4e00\u4e2a\u4f8b\u5916\uff09\uff0c\u5f15\u7528\u6298\u53e0\u6210\u4e00\u4e2a\u666e\u901a\u7684\u5de6\u503c\u5f15\u7528\u7c7b\u578b\u3002\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5f15\u7528\u4f1a\u6298\u53e0\u6210\u53f3\u503c\u5f15\u7528\uff0c\u5373\u53f3\u503c\u5f15\u7528\u7684\u53f3\u503c\u5f15\u7528\uff0c T&& &&\u3002\u5373 X& &\u3001X& &&\u3001X&& &\u90fd\u6298\u53e0\u6210X& X&& &&\u6298\u53e0\u4e3aX&& \u89c4\u52192. \u53f3\u503c\u5f15\u7528\u7279\u6b8a\u7c7b\u578b\u63a8\u65ad\u89c4\u5219 \u2003\u5f53\u5c06\u4e00\u4e2a\u5de6\u503c\u4f20\u9012\u7ed9\u4e00\u4e2a\u53c2\u6570\u662f\u53f3\u503c\u5f15\u7528\u7684\u51fd\u6570\uff0c\u4e14\u6b64\u53f3\u503c\u5f15\u7528\u6307\u5411\u6a21\u677f\u7c7b\u578b\u53c2\u6570(T&&)\u65f6\uff0c\u7f16\u8bd1\u5668\u63a8\u65ad\u6a21\u677f\u53c2\u6570\u7c7b\u578b\u4e3a\u5b9e\u53c2\u7684\u5de6\u503c\u5f15\u7528\uff0c\u5982 template<typename T> void f(T&&); int i = 42; f(i) // \u6a21\u677f\u53c2\u6570\u7c7b\u578bT\u5c06\u63a8\u65ad\u4e3aint&\u7c7b\u578b\uff0c\u800c\u975eint\u3002 \u2003\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u5f62\u53c2\u662f\u4e00\u4e2a\u6307\u5411 \u6a21\u677f\u7c7b\u578b \u7684\u53f3\u503c\u5f15\u7528\uff0c\u5219\u8be5\u53c2\u6570\u53ef\u4ee5\u88ab\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5de6\u503c\u4e0a\u3002 \u89c4\u52193 \u2003\u867d\u7136\u4e0d\u80fd\u9690\u5f0f\u7684\u5c06\u4e00\u4e2a\u5de6\u503c\u8f6c\u6362\u4e3a\u53f3\u503c\u5f15\u7528\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7static_cast\u663e\u793a\u5730\u5c06\u4e00\u4e2a\u5de6\u503c\u8f6c\u6362\u4e3a\u4e00\u4e2a\u53f3\u503c\u3002 std::move \u2003\u5728C++11\u4e2d\uff0c\u6807\u51c6\u5e93\u5728 \u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6709\u7528\u7684\u51fd\u6570std::move\uff0cstd::move\u5e76\u4e0d\u80fd\u79fb\u52a8\u4efb\u4f55\u4e1c\u897f\uff0c\u5b83\u552f\u4e00\u7684\u529f\u80fd\u662f\u5c06\u4e00\u4e2a\u5de6\u503c\u5f3a\u5236\u8f6c\u5316\u4e3a\u53f3\u503c\u5f15\u7528\uff0c\u7ee7\u800c\u53ef\u4ee5\u901a\u8fc7\u53f3\u503c\u5f15\u7528\u4f7f\u7528\u8be5\u503c\uff0c\u4ee5\u7528\u4e8e\u79fb\u52a8\u8bed\u4e49\u3002\u4ece\u5b9e\u73b0\u4e0a\u8bb2\uff0cstd::move\u81ea\u8eab\u9664\u4e86\u505a\u4e00\u4e9b\u53c2\u6570\u7684\u63a8\u65ad\u4e4b\u5916\uff0c\u8fd4\u56de\u53f3\u503c\u5f15\u7528\u672c\u8d28\u4e0a\u8fd8\u662f\u9760static_cast \u5b8c\u6210\u7684\u3002 template<typename T> typename remove_reference<T>::type && move(T&& t) { return static_cast<typename remove_reference<T>::type &&>(t); } \u2003\u2003\u6839\u636e\u89c4\u52191\uff0c2\u53ef\u77e5\uff0cmove\u65e2\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u5de6\u503c\uff0c\u4e5f\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u53f3\u503c\u3002 \u2003\u2003 std::move\u662f\u5c06\u5bf9\u8c61\u7684\u72b6\u6001\u6216\u8005\u6240\u6709\u6743\u4ece\u4e00\u4e2a\u5bf9\u8c61\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff0c\u53ea\u662f\u8f6c\u79fb \uff0c\u6ca1\u6709\u5185\u5b58\u7684\u642c\u8fc1\u6216\u8005\u5185\u5b58\u62f7\u8d1d\u6240\u4ee5\u53ef\u4ee5\u63d0\u9ad8\u5229\u7528\u6548\u7387,\u6539\u5584\u6027\u80fd\u3002 \u2003\u2003 eg: int && rr1 = std::move(rr); //\u8c03\u7528move\u610f\u5473\u7740\u9664\u5bf9rr\u8d4b\u503c\u6216\u9500\u6bc1\u5b83\u65f6\uff0c\u6211\u4eec\u5c06\u4e0d\u518d\u4f7f\u7528\u5b83\u3002 std::forward \u2003\u5b8c\u7f8e\u8f6c\u53d1: \u5b8c\u7f8e\u8f6c\u53d1\u5b9e\u73b0\u4e86\u53c2\u6570\u5728\u4f20\u9012\u8fc7\u7a0b\u4e2d\u4fdd\u6301\u5176\u503c\u5c5e\u6027\u7684\u529f\u80fd\uff0c\u5373\u82e5\u662f\u5de6\u503c\uff0c\u5219\u4f20\u9012\u4e4b\u540e\u4ecd\u7136\u662f\u5de6\u503c\uff0c\u82e5\u662f\u53f3\u503c\uff0c\u5219\u4f20\u9012\u4e4b\u540e\u4ecd\u7136\u662f\u53f3\u503c\u3002 \u2003std::forward\u53ea\u6709\u5728\u5b83\u7684\u53c2\u6570\u7ed1\u5b9a\u5230\u4e00\u4e2a\u53f3\u503c\u4e0a\u7684\u65f6\u5019\uff0c\u5b83\u624d\u8f6c\u6362\u5b83\u7684\u53c2\u6570\u5230\u4e00\u4e2a\u53f3\u503c\u3002 class Foo { public: std::string member; template<typename T> Foo(T&& member): member{std::forward<T>(member)} {} }; /* \u4f20\u9012\u4e00\u4e2alvalue\u6216\u8005\u4f20\u9012\u4e00\u4e2aconst lvaue: \u4f20\u9012\u4e00\u4e2alvalue\uff0c\u6a21\u677f\u63a8\u5bfc\u4e4b\u540e T = std::string& \u4f20\u9012\u4e00\u4e2aconst lvaue, \u6a21\u677f\u63a8\u5bfc\u4e4b\u540eT = const std::string& T& &&\u5c06\u6298\u53e0\u4e3aT&\uff0c\u5373std::string& && \u6298\u53e0\u4e3a std::string& \u6700\u7ec8\u51fd\u6570\u4e3a: Foo(string& member): member{std::forward<string&>(member)} {} std::forward<string&>(member)\u5c06\u8fd4\u56de\u4e00\u4e2a\u5de6\u503c\uff0c\u6700\u7ec8\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570, \u4f20\u9012\u4e00\u4e2arvalue \u4f20\u9012\u4e00\u4e2arvalue: \u6a21\u677f\u63a8\u5bfc\u4e4b\u540e T = std::string \u6700\u7ec8\u51fd\u6570\u4e3a: Foo(string&& member): member{std::forward<string>(member)} {} std::forward<string>(member) \u5c06\u8fd4\u56de\u4e00\u4e2a\u53f3\u503c\uff0c\u6700\u7ec8\u8c03\u7528\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1b */ \u5f15\u7528\u9650\u5b9a\u7b26 \u2003\u5728\u53c2\u6570\u5217\u8868\u540e\u653e\u7f6e& \u6216\u8005&&, \u5206\u522b\u6307\u51fathis\u6307\u9488\u6307\u5411\u4e00\u4e2a\u5de6\u503c\u6216\u53f3\u503c\uff1b\u53ea\u80fd\u4f5c\u7528\u4e8e\u975estatic\u6210\u5458\u51fd\u6570\uff0c\u4e14\u5fc5\u987b\u540c\u65f6\u51fa\u73b0\u5728\u51fd\u6570\u7684\u58f0\u660e\u548c\u5b9a\u4e49\u4e2d\uff1b\u82e5\u540c\u65f6\u91c7\u7528const\u9650\u5b9a\uff0c\u5219\u5f15\u7528\u9650\u5b9a\u7b26\u5fc5\u987b\u653e\u5728const\u540e\u9762\u3002\u4e14\u5982\u679c\u5b9a\u4e49\u4e24\u4e2a\u6216\u4ee5\u4e0a\u5177\u6709\u76f8\u540c\u540d\u5b57\u548c\u53c2\u6570\u5217\u8868\u7684\u6210\u5458\u51fd\u6570\uff0c\u5fc5\u987b\u5168\u90e8\u52a0\u4e0a\u5f15\u7528\u9650\u5b9a\u7b26\uff08\u4e0d\u540c\u4e8econst\u6210\u5458\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u662f\u5426\u52a0const\u6765\u91cd\u8f7d\uff09\u3002 \u6307\u9488\u4e0e\u5f15\u7528\u533a\u522b","title":"pointer_reference"},{"location":"c_base/pointer_reference/#and","text":"","title":"\u6307\u9488 and \u5f15\u7528"},{"location":"c_base/pointer_reference/#_1","text":"\u7c7b\u578b: \u5185\u7f6e\u6307\u9488\uff1a\u7531new\u64cd\u4f5c\u8fd4\u56de\u7684\u6307\u9488\uff0c\u7ed1\u5b9a\u7684\u662f\u52a8\u6001\u5206\u914d\u5bf9\u8c61\uff1b\u666e\u901a\u6307\u9488\uff1a\u7c7b\u4f3c int *p =1; \u667a\u80fd\u6307\u9488; \u9690\u5f0f\u9500\u6bc1\u4e00\u4e2a\u5185\u7f6e\u6307\u9488\u7c7b\u578b\u7684\u6210\u5458\u4e0d\u4f1adelete\u5b83\u6240\u6307\u5411\u7684\u5bf9\u8c61\uff1b\u5f53\u6307\u5411\u4e00\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u6216\u8005\u6307\u9488\u79bb\u5f00\u4f5c\u7528\u57df\u65f6\uff0c\u6790\u6784\u51fd\u6570\u4e0d\u4f1a\u6267\u884c\u3002\uff08\u662f\u4e3a\u4e86\u907f\u514d\u5b58\u5728\u591a\u4e2a\u6307\u9488\u6307\u5411\u540c\u4e00\u5757\u5185\u5b58\u65f6\uff0c\u8bef\u56de\u6536\uff09\u4f46\u662f\u6307\u9488\u53d8\u91cf\u672c\u8eab\u6240\u5360\u7684\u5185\u5b58\u4f1a\u88ab\u56de\u6536\u3002 \u6307\u9488\u672c\u8eab\u5c5e\u4e8e\u5bf9\u8c61\uff0c\u5176\u5141\u8bb8\u5bf9\u6307\u9488\u8d4b\u503c\u548c\u62f7\u8d1d\uff0c\u5728\u5b9a\u4e49\u65f6\u65e0\u987b\u8d4b\u521d\u503c\uff1b\u800c\u5728\u5757\u4f5c\u7528\u57df\u5185\u5b9a\u4e49\u7684\u6307\u9488\u5982\u679c\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u5c06\u662f\u4e00\u4e2a\u4e0d\u786e\u5b9a\u7684\u503c\u3002 \u7a7a\u6307\u9488\uff1aint *p = nullptr; int *p =0; int *p =NULL; \u4e0d\u5141\u8bb8\u5c06int\u53d8\u91cf\u8d4b\u503c\u7ed9\u6307\u9488\uff0c\u5373\u4f7f\u5176\u503c\u662f0\uff0c\u5373 int a =0; int * p = a; //\u9519\u8bef \u7a7a\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u662f\u7279\u6b8a\u7684\uff0c\u8be5\u5730\u5740\u4e0d\u5141\u8bb8\u5b58\u653e\u6570\u636e\u548c\u4e0d\u5141\u8bb8\u7a0b\u5e8f\u8bbf\u95ee\uff0c\u6240\u4ee5\u7a7a\u6307\u9488\u4e0d\u80fd\u64cd\u4f5c\u8be5\u5730\u5740\u91cc\u7684\u4e1c\u897f\uff0c \u53ef\u4ee5\u7406\u89e3\u4e3a\u201c\u6307\u9488\u6307\u5411\u4e86\u7a7a\uff0c\u65e0\u6cd5\u64cd\u4f5c\u4e86\u201d \u6307\u9488\u6709\u4e24\u4e2a\u5c5e\u6027:\u6307\u5411\u53d8\u91cf/\u5bf9\u8c61\u7684\u5730\u5740\u548c\u957f\u5ea6\uff0c\u4f46\u662f\u6307\u9488\u53ea\u5b58\u50a8\u5730\u5740,\u957f\u5ea6\u5219\u53d6\u51b3\u4e8e\u6307\u9488\u7684\u7c7b\u578b\uff1b \u7f16\u8bd1\u5668\u6839\u636e\u6307\u9488\u7684\u7c7b\u578b\u4ece\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u5411\u540e\u5bfb\u5740\uff0c\u6307\u9488\u7c7b\u578b\u4e0d\u540c\u5219\u5bfb\u5740\u8303\u56f4\u4e5f\u4e0d\u540c, \u6bd4\u5982:int*\u4ece\u6307\u5b9a\u5730\u5740\u5411\u540e\u5bfb\u627e4\u5b57\u8282\u4f5c\u4e3a\u53d8\u91cf\u7684\u5b58\u50a8\u5355\u5143; double*\u4ece\u6307\u5b9a\u5730\u5740\u5411\u540e\u5bfb\u627e8\u5b57\u8282\u4f5c\u4e3a\u53d8\u91cf\u7684\u5b58\u50a8\u5355\u5143\u3002 \u800cvoid* \u6307\u9488\u5219\u6ca1\u6709\u7c7b\u578b\uff0c\u5176\u53ef\u4ee5\u5b58\u653e\u4efb\u610f\u7c7b\u578b\u5bf9\u8c61\u7684\u5730\u5740\uff0c\u4f46\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u64cd\u4f5cvoid* \u6307\u9488\u6240\u6307\u5411\u7684\u5bf9\u8c61\u3002 void\u6307\u9488\u4e0d\u80fd\u53c2\u4e0e\u6307\u9488\u8fd0\u7b97,\u9664\u975e\u8fdb\u884c\u8f6c\u6362\uff0c(type*) vp++; const\u6307\u9488\uff1a int * const a; \u8bb0\u4f4f*\u653e\u5728const\u4e4b\u524d\u7528\u4ee5\u8bf4\u660e\u6307\u9488\u662f\u4e00\u4e2a\u5e38\u91cf\uff0c\u4e0d\u53d8\u7684\u662f\u6307\u9488\u672c\u8eab\u800c\u975e\u6307\u5411\u7684\u5bf9\u8c61\u7684\u503c constexpr\u6307\u9488\uff1a constexpr int * p = nullptr; p\u662f\u4e00\u4e2a\u6307\u5411\u6574\u6570\u7684\u5e38\u91cf\u6307\u9488\uff0c\u56e0\u4e3aconstexpr\u628a\u5b83\u6240\u5b9a\u4e49\u7684\u5bf9\u8c61\u7f6e\u4e3a\u4e86\u9876\u5c42const\u3002 \u89e3\u5f15\u7528\uff1a\u5bf9\u6307\u9488\u89e3\u5f15\u7528\u4f1a\u5f97\u5230\u6240\u6307\u7684\u5bf9\u8c61\uff0c\u662f\u4e00\u4e2a\u5de6\u503c\uff1b\u800c\u8fed\u4ee3\u5668\u7684\u89e3\u5f15\u7528\u662f\u91cd\u8f7d\u4e86*\u8fd0\u7b97\u7b26\uff0c\u5176\u8fd4\u56de\u6240\u6307\u5143\u7d20\u7684\u5f15\u7528\u3002 \u6307\u9488\u7684\u7c7b\u578b\u5fc5\u987b\u548c\u5176\u6240\u6307\u5411\u5bf9\u8c61\u7684\u7c7b\u578b\u4e00\u81f4\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\u4f8b\u5916: \u2003\u7b2c\u4e00\u79cd\uff0c\u6307\u5411\u5e38\u91cf\u7684\u6307\u9488\u6ca1\u6709\u89c4\u5b9a\u5176\u6240\u6307\u5411\u7684\u5bf9\u8c61\u5fc5\u987b\u662f\u4e00\u4e2a\u5e38\u91cf\uff0c\u4ec5\u4ec5\u8981\u6c42\u4e0d\u80fd\u901a\u8fc7\u8be5\u6307\u9488\u6539\u53d8\u5bf9\u8c61\u7684\u503c\u3002 \u2003\u7b2c\u4e8c\u79cd\uff0c\u6307\u9488\u7c7b\u578b\u6307\u5411\u57fa\u7c7b\uff0c\u4f46\u5176\u6240\u6307\u5411\u5b9e\u9645\u5bf9\u8c61\u662f\u6d3e\u751f\u7c7b\u7c7b\u578b\u3002 int *p: p\u662f\u6307\u5411int\u578b\u53d8\u91cf\u7684\u6307\u9488\u53d8\u91cf int* *p\uff1a p\u662f\u6307\u5411int*\u578b\u53d8\u91cf\u7684\u6307\u9488\u53d8\u91cf\uff0c\u5373\u6307\u5411\u6307\u9488\u7684\u6307\u9488\u3002 T *p; // p+1 \u5b9e\u9645\u4e3ap+sizeof(T)*1; \u667a\u80fd\u6307\u9488 \uff1a\u81ea\u52a8\u91ca\u653e\u6240\u6307\u5411\u7684\u5bf9\u8c61\uff0c\u5176\u662f\u4e00\u79cd\u6a21\u677f\uff0c\u5728\u521b\u5efa\u667a\u80fd\u6307\u9488\u65f6\uff0c\u9700\u8981\u63d0\u4f9b\u6307\u9488\u53ef\u4ee5\u6307\u5411\u7684\u7c7b\u578b\uff0c\u6709\u4e09\u79cd\u7c7b\u578b\uff0c\u90fd\u5b9a\u4e49\u5728memory\u5934\u6587\u4ef6\u4e2d\u3002 shared_ptr \u2003\u5141\u8bb8\u591a\u4e2a\u6307\u9488\u6307\u5411\u540c\u4e00\u4e2a\u5bf9\u8c61; \u2003\u5f53\u7528\u4e00\u4e2ashared_ptr\u521d\u59cb\u5316\u53e6\u4e00\u4e2ashared_ptr\u6216\u8005\u5c06\u5b83\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u4e00\u4e2a\u51fd\u6570\u4ee5\u53ca\u4f5c\u4e3a\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5b83\u6240\u5173\u8054\u7684\u8ba1\u6570\u5668\uff08\u5f15\u7528\u8ba1\u6570\uff09\u5c31\u4f1a\u9012\u589e\uff1b\u82e5\u662f\u7ed9\u5176\u8d4b\u4e88\u65b0\u503c\uff0c\u6216\u662fshared_ptr\u88ab\u9500\u6bc1\uff0c \u5b83\u5c31\u4f1a\u81ea\u52a8\u91ca\u653e\u81ea\u5df1\u6240\u7ba1\u7406\u7684\u5bf9\u8c61\u3002 \u2003 \u7528\u6765\u521d\u59cb\u5316\u667a\u80fd\u6307\u9488\u7684\u666e\u901a\u6307\u9488\u5fc5\u987b\u6307\u5411\u52a8\u6001\u5185\u5b58(\u901a\u8fc7new\u5206\u914d\u7684\u5185\u5b58)\uff0c\u56e0\u4e3a\u667a\u80fd\u6307\u9488\u9ed8\u8ba4\u4f7f\u7528delete \u6765\u91ca\u653e\u6240\u5173\u8054\u7684\u5bf9\u8c61\u3002\u5982\u679c\u5c06\u667a\u80fd\u6307\u9488\u7ed1\u5b9a\u5230\u4e00\u4e2a\u6307\u5411\u5176\u4ed6\u7c7b\u578b\u7684\u8d44\u6e90\u7684\u6307\u9488\u4e0a\uff0c\u5fc5\u987b\u63d0\u4f9b\u81ea\u5df1\u7684\u64cd\u4f5c\u6765\u66ff\u4ee3delete. \u2003 \u63a5\u53d7\u6307\u9488\u53c2\u6570\u7684\u667a\u80fd\u6307\u9488\u6784\u9020\u51fd\u6570\u662fexplicit, \u610f\u5473\u7740\u5fc5\u987b\u7528\u76f4\u63a5\u521d\u59cb\u5316\u5f62\u5f0f\u6765\u521d\u59cb\u5316\u4e00\u4e2a\u667a\u80fd\u6307\u9488\uff1a shared_ptr < int > p1(new int(1)); shared_ptr < int > p2 = new int(1); //\u9519\u8bef unique_ptr \u2003\u72ec\u5360\u6240\u6307\u5411\u7684\u5bf9\u8c61, \u67d0\u4e00\u65f6\u523b\u53ea\u80fd\u6709\u4e00\u4e2aunique_ptr\u6307\u5411\u4e00\u4e2a\u7ed9\u5b9a\u7684\u5bf9\u8c61\uff0c\u6545\u5176\u4e0d\u652f\u6301\u62f7\u8d1d\u548c\u8d4b\u503c\u64cd\u4f5c; \u2003\u901a\u8fc7\u8c03\u7528release\u6216\u8005reset\u53ef\u4ee5\u5c06\u6307\u9488\u7684\u6240\u6709\u6743\u4ece\u4e00\u4e2a\u975econst unique_ptr\u4f20\u7ed9\u53e6\u4e00\u4e2aunique_ptr: \u2003 unique_ptr p(p1.release()); p2.reset(p3.release()); \u2003\u4e0d\u80fd\u62f7\u8d1dunique_ptr\u7684\u89c4\u5219\u6709\u4e00\u4e2a\u4f8b\u5916\uff1a\u5373\u53ef\u4ee5\u62f7\u8d1d\u548c\u8d4b\u503c\u4e00\u4e2a\u5c06\u8981\u88ab\u9500\u6bc1\u7684unique_ptr, \u4f8b\u5982\u4ece\u51fd\u6570\u8fd4\u56de\u4e00\u4e2aunique_ptr\u3002 weak_ptr \u2003\u5c5e\u4e8e\u4e00\u79cd\u5f31\u5f15\u7528\uff0c\u6307\u5411shared_ptr\u6240\u7ba1\u7406\u7684\u5bf9\u8c61\u3002 \u2003weak_ptr\u4e3b\u8981\u7528\u6765\u89e3\u51b3\u5faa\u73af\u5f15\u7528\u7684\u95ee\u9898\u3002 \u667a\u80fd\u6307\u9488\u4f7f\u7528\u89c4\u8303\uff1a \u2003\u4e0d\u4f7f\u7528\u76f8\u540c\u7684\u5185\u7f6e\u6307\u9488\u503c\u521d\u59cb\u5316\u6216reset\u591a\u4e2a\u667a\u80fd\u6307\u9488\uff1b \u2003\u4e0ddelete get()\u8fd4\u56de\u7684\u6307\u9488\uff1b \u2003\u4e0d\u4f7f\u7528get()\u521d\u59cb\u5316\u6216reset\u53e6\u4e00\u4e2a\u667a\u80fd\u6307\u9488\uff1b \u2003\u5982\u679c\u4f7f\u7528get()\u8fd4\u56de\u7684\u6307\u9488\uff0c\u8bb0\u4f4f\u5f53\u6700\u540e\u4e00\u4e2a\u5bf9\u5e94\u7684\u667a\u80fd\u6307\u9488\u9500\u6bc1\u540e\uff0c\u6307\u9488\u5c31\u53d8\u4e3a\u65e0\u6548\u4e86\uff1b \u2003\u5f53\u4f7f\u7528\u667a\u80fd\u6307\u9488\u7ba1\u7406\u7684\u8d44\u6e90\u4e0d\u662fnew\u5206\u914d\u7684\u5185\u5b58\uff0c\u8bb0\u4f4f\u4f20\u9012\u7ed9\u5b83\u4e00\u4e2a\u5220\u9664\u5668\u3002 \u2003\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u667a\u80fd\u6307\u9488\u7684\u9ed8\u8ba4\u5220\u9664\u5668\u5373\u53ef\u91ca\u653e\u4fdd\u5b58\u7684\u6307\u9488\uff0c\u4f46\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5982\uff1a\u8d44\u6e90\u4e0d\u662f new \u51fa\u6765\u7684(\u4e00\u822c\u4e5f\u610f\u5473\u7740\u4e0d\u80fd delete), \u53ef\u80fd\u662f malloc \u51fa\u6765\u7684\u6216\u8005\u8d44\u6e90\u662f\u88ab\u7b2c\u4e09\u65b9\u5e93\u7ba1\u7406\u7684 (\u7b2c\u4e09\u65b9\u63d0\u4f9b\u8d44\u6e90\u83b7\u53d6\u548c\u8d44\u6e90\u91ca\u653e\u63a5\u53e3)\uff1b\u8d44\u6e90\u4e0d\u662f RAII \u7684, \u610f\u5473\u7740\u6790\u6784\u51fd\u6570\u4e0d\u4f1a\u628a\u8d44\u6e90\u5b8c\u5168\u91ca\u653e\u6389.\uff0c\u5373\u5355\u7eaf delete \u8fd8\u4e0d\u591f\uff1b \u2003 \u5982\u679cptr\u4e0d\u662f\u6307\u5411\u4e2aobject\uff0c\u800c\u662f\u4e00\u4e2aobject\u7684\u6570\u7ec4\u3002\u90a3\u4e48\u6784\u9020shared_ptr\u65f6\u5019\u5c31\u5f97\u81ea\u5df1\u4f20\u5165\u5220\u9664\u5668 , \u4f8b\u5982\u8fd9\u91cc\u4f20\u5165\u4e00\u4e2alambda\u7c7b\u578b\u7684deletor, shared_ptr(ptr, [](void*){delete [] ptr}) \u667a\u80fd\u6307\u9488\u4e0e\u52a8\u6001\u6570\u7ec4 \u2003\u53ef\u4ee5\u4f7f\u7528unique_ptr\u6765\u7ba1\u7406new\u5206\u914d\u7684\u6570\u7ec4\uff1a unique_ptr< T [] > up(new T [10]); auto p = up.release(); //up\u653e\u5f03\u6307\u9488\u7684\u63a7\u5236\u6743\uff0c\u5e76\u8fd4\u56de\u6307\u9488\uff0c\u7136\u540e\u5c06up\u7f6e\u4e3a\u7a7a delete p; or up.reset(); // \u91ca\u653eup\u6307\u5411\u7684\u5bf9\u8c61\uff0c up.reset(q); up\u91ca\u653e\u539f\u5148\u5360\u6709\u5185\u5b58\uff0c\u6539\u4e3a\u6307\u5411q\u6240\u6307\u5411\u7684\u5185\u5b58 /*\u6b64\u65f6\u4e0d\u80fd\u4f7f\u7528\u70b9\u548c\u7bad\u5934\u6210\u5458\u8fd0\u7b97\u7b26\uff0c\u56e0\u4e3aup\u4e0d\u662f\u6307\u5411\u5355\u4e2a\u5bf9\u8c61;\u4f46\u53ef\u4ee5\u4f7f\u7528\u4e0b\u6807\u8fd0\u7b97\u7b26\u8bbf\u95ee\u6570\u7ec4\u4e2d\u7684\u5143\u7d20 \uff08\u52a8\u6001\u6570\u7ec4\u672c\u8eab\u5e76\u975e\u6570\u7ec4\u7c7b\u578b\uff0c\u662f\u4e0d\u652f\u6301\u4e0b\u6807\u8fd0\u7b97\u7684\uff09\u3002*/ \u2003shared_ptr\u4e0d\u76f4\u63a5\u652f\u6301\u7ba1\u7406\u52a8\u6001\u6570\u7ec4\uff0c\u5fc5\u987b\u63d0\u4f9b\u81ea\u5df1\u5b9a\u4e49\u7684\u5220\u9664\u5668 shared_ptr< int > sp(new int[10], \\[](int\\* p){delete \\[] p;}); sp.reset(); /* \u4e0d\u8fc7shared_ptr\u6ca1\u6709\u5b9a\u4e49\u4e0b\u6807\u8fd0\u7b97\u7b26\uff0c\u4e14\u6240\u6709\u667a\u80fd\u6307\u9488\u7c7b\u578b\u90fd\u4e0d\u652f\u6301\u6307\u9488\u7b97\u672f\u8fd0\u7b97\uff0c \u56e0\u6b64\u53ea\u80fd\u901a\u8fc7get()\u83b7\u53d6\u5185\u7f6e\u6307\u9488\uff0c\u7528\u6765\u8bbf\u95ee\u6570\u7ec4\u5143\u7d20\u3002*/ \u4ec0\u4e48\u65f6\u5019\u4f7f\u7528\u52a8\u6001\u5185\u5b58\uff1f \u2003\u7a0b\u5e8f\u4e0d\u77e5\u9053\u81ea\u5df1\u9700\u8981\u4f7f\u7528\u591a\u5c11\u5bf9\u8c61, \u5982\u5bb9\u5668; \u7a0b\u5e8f\u4e0d\u77e5\u9053\u6240\u9700\u5bf9\u8c61\u7684\u51c6\u786e\u7c7b\u578b\uff1b\u7a0b\u5e8f\u9700\u8981\u5728\u591a\u4e2a\u5bf9\u8c61\u95f4\u5171\u4eab\u6570\u636e\u3002 shared_ptr\u4e0eunique_ptr\u7684\u53e6\u4e00\u4e2a\u5dee\u5f02\uff1a\u5141\u8bb8\u7528\u6237\u91cd\u8f7d\u9ed8\u8ba4\u5220\u9664\u5668\u7684\u65b9\u5f0f \u524d\u8005\u53ea\u8981\u5728\u521b\u5efa\u6216reset\u6307\u9488\u65f6\u4f20\u9012\u4e00\u4e2a\u53ef\u8c03\u7528\u5bf9\u8c61\u5373\u53ef\uff0c\u540e\u8005\u53ea\u80fd\u5728\u5b9a\u4e49\u65f6\u4ee5\u663e\u5f0f\u6a21\u677f\u5b9e\u53c2\u7684\u5f62\u5f0f\u63d0\u4f9b\u5220\u9664\u5668\u7684\u7c7b\u578b\u3002 \u901a\u8fc7\u5728\u7f16\u8bd1\u65f6\u7ed1\u5b9a\u5220\u9664\u5668\uff0cunique_ptr\u907f\u514d\u4e86\u95f4\u63a5\u8c03\u7528\u5220\u9664\u5668\u7684\u8fd0\u884c\u65f6\u5f00\u9500\uff1b\u800c\u5728\u8fd0\u884c\u65f6\u7ed1\u5b9a\u5220\u9664\u5668\uff0cshared_ptr\u4f7f\u5f97\u7528\u6237\u91cd\u8f7d\u5220\u9664\u5668\u66f4\u4e3a\u65b9\u4fbf\u3002 shared_ptr p(q, d); p.reset(q, d); //\u65e0\u9700\u5728\u5b9a\u4e49\u65f6\u6307\u660e ................................................................................. unique_ptr(connection, decltype(end_connection)*) p(&c, end_connection); //end_connection \u4e0eend_connection_2\u4e24\u8005\u8fd4\u56de\u7c7b\u578b\u76f8\u540c\uff0c\u5373\u8981\u6c42\u5fc5\u987b\u5728\u5b9a\u4e49\u65f6\u63d0\u4f9b\u5220\u9664\u5668\u7684\u7c7b\u578b\u3002 p.reset(&c, end_connection_2)","title":"\u6307\u9488"},{"location":"c_base/pointer_reference/#about-this-pointer","text":"this\u6307\u9488\uff0c\u5728 C++ \u4e2d\uff0c\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u90fd\u80fd\u901a\u8fc7 this \u6307\u9488\u6765\u8bbf\u95ee\u81ea\u5df1\u7684\u5730\u5740\u3002 this \u6307\u9488\u662f\u6240\u6709\u6210\u5458\u51fd\u6570\u7684\u9690\u542b\u53c2\u6570\u3002 \u56e0\u6b64\uff0c\u5728\u6210\u5458\u51fd\u6570\u5185\u90e8\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u6307\u5411\u8c03\u7528\u5bf9\u8c61\u3002\u5f53\u6211\u4eec\u8c03\u7528\u6210\u5458\u51fd\u6570\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u66ff\u67d0\u4e2a\u5bf9\u8c61\u8c03\u7528\u5b83\u3002 \u2003\u6210\u5458\u51fd\u6570\u901a\u8fc7\u4e00\u4e2a\u540d\u4e3a this \u7684\u989d\u5916\u9690\u5f0f\u53c2\u6570\u6765\u8bbf\u95ee\u8c03\u7528\u5b83\u7684\u90a3\u4e2a\u5bf9\u8c61\uff0c\u5f53\u6211\u4eec\u8c03\u7528\u4e00\u4e2a\u6210\u5458\u51fd\u6570\u65f6\uff0c\u7528\u8bf7\u6c42\u8be5\u51fd\u6570\u7684\u5bf9\u8c61\u5730\u5740\u521d\u59cb\u5316 this\uff1b\u5bf9\u4e8e\u6211\u4eec\u6765\u8bf4\uff0cthis \u5f62\u53c2\u662f\u9690\u5f0f\u5b9a\u4e49\u7684\u3002\u5b9e\u9645\u4e0a\uff0c\u4efb\u4f55\u81ea\u5b9a\u4e49\u540d\u4e3a this \u7684\u53c2\u6570\u6216\u53d8\u91cf\u7684\u884c\u4e3a\u90fd\u662f\u975e\u6cd5\u7684\u3002 \u2003\u4e00\u822c\u6765\u8bf4\uff0cthis\u7c7b\u578b\u662f\u4e00\u4e2a\u6307\u5411 \u975e\u5e38\u91cf\u7c7b \u7c7b\u578b\u7684const\u6307\u9488\uff08eg. class_name* const this\uff09\uff0c\u56e0\u6b64\u4e0d\u80fd\u5c06this\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5e38\u91cf\u5bf9\u8c61\u4e0a\uff1b\u6240\u4ee5\u6211\u4eec\u4e0d\u80fd\u8c03\u7528\u5e38\u91cf\u5bf9\u8c61\u7684\u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570\uff0c\u56e0\u4e3a\u8fd9\u4f1a\u7528\u8be5\u5e38\u91cf\u5bf9\u8c61\u7684\u5730\u5740\u521d\u59cb\u5316this\uff0c\u4f46this\u6307\u5411\u7684\u662f\u975e\u5e38\u91cf\u7c7b\u7c7b\u578b\uff0c\u5c06\u5f15\u53d1\u7f16\u8bd1\u5668\u62a5\u9519\u3002 \u2003c++\u5141\u8bb8\u7684\u505a\u6cd5\u662f\u628aconst\u5173\u952e\u5b57\u653e\u5728\u6210\u5458\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u4e4b\u540e\uff0c\u4ee5\u6b64\u6765\u6539\u53d8this\u6307\u9488\u7684\u7c7b\u578b\u3002\u56e0\u6b64\u5728\u5e38\u91cf\u5bf9\u8c61\u8c03\u7528\u5e38\u91cf\u6210\u5458\u51fd\u6570\u65f6\uff0cthis\u6307\u9488\u7c7b\u578b\u4e3a\u6307\u5411 const \u5bf9\u8c61\u7684 const \u6307\u9488\u3002","title":"About this pointer"},{"location":"c_base/pointer_reference/#_2","text":"\u5f15\u7528\u5e76\u975e\u5bf9\u8c61\uff0c\u800c\u662f\u4e3a\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5bf9\u8c61\u6240\u8d77\u7684\u53e6\u5916\u4e00\u4e2a\u540d\u5b57\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728\u5f15\u7528\u7684\u5f15\u7528\u3002\u5b9a\u4e49\u5f15\u7528\u65f6\uff0c\u7a0b\u5e8f\u628a\u5f15\u7528\u548c\u5b83\u7684\u521d\u59cb\u503c\u5bf9\u8c61\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u800c\u4e0d\u662f\u628a\u521d\u59cb\u503c\u62f7\u8d1d\u7ed9\u5f15\u7528\u3002 \u2003\u5f15\u7528\u7684\u7c7b\u578b\u5fc5\u987b\u4e0e\u5176\u6240\u5f15\u7528\u5bf9\u8c61\u7684\u7c7b\u578b\u4e00\u81f4\uff0c\u4f46\u662f\u6709\u4e24\u79cd\u4f8b\u5916\uff1a \u7b2c\u4e00\u79cd\uff1a\u5728\u521d\u59cb\u5316\u5e38\u91cf\u5f15\u7528\u65f6\u5141\u8bb8\u7528\u4efb\u610f\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u521d\u59cb\u503c\uff0c\u53ea\u8981\u8be5\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u80fd\u8f6c\u6362\u6210\u5f15\u7528\u7684\u7c7b\u578b\u5373\u53ef\uff0c\u5c24\u5176\uff0c\u5141\u8bb8\u4e3a\u4e00\u4e2a\u5e38\u91cf\u5f15\u7528\u7ed1\u5b9a\u975e\u5e38\u91cf\u7684\u5bf9\u8c61\u3001\u5b57\u9762\u503c\u3001\u751a\u81f3\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002\u6b64\u65f6\uff0c\u901a\u8fc7\u8be5\u5e38\u91cf\u5f15\u7528\u4e0d\u80fd\u4fee\u6539\u5668\u7ed1\u5b9a\u7684\u5bf9\u8c61\u7684\u503c\uff0c\u4f46\u82e5\u8be5\u7ed1\u5b9a\u7684\u5bf9\u8c61\u672c\u8eab\u662f\u975e\u5e38\u91cf\uff0c\u53ef\u4ee5\u81ea\u6211\u4fee\u6539\u3002 \u7b2c\u4e8c\u79cd\u60c5\u51b5\u662f\u6d3e\u751f\u7c7b\u5f15\u7528\u5411\u57fa\u7c7b\u5f15\u7528\u7684\u81ea\u52a8\u7c7b\u578b\u8f6c\u6362\u3002 \u2003 return by reference: \u4f20\u9012\u8005\u65e0\u9700\u77e5\u9053\u63a5\u6536\u8005\u662f\u5426\u662f\u4ee5reference\u5f62\u5f0f\u63a5\u6536\uff1b\u800creturen by pointer\u8981\u6c42\u63a5\u6536\u8005\u5fc5\u987b\u662f\u4ee5pointer\u5f62\u5f0f\u3002","title":"\u5f15\u7528"},{"location":"c_base/pointer_reference/#c-11","text":"\u5de6\u503c\u5f15\u7528 and \u53f3\u503c\u5f15\u7528 \u2003\u5de6\u503c\u5f15\u7528\u201c&\u201d\u548c\u53f3\u503c\u5f15\u7528\u201c&&\u201d\uff1aC++\u4e2d\u6240\u6709\u7684\u503c\u90fd\u5fc5\u7136\u5c5e\u4e8e\u5de6\u503c\u3001\u53f3\u503c\u4e8c\u8005\u4e4b\u4e00\u3002\u5de6\u503c\u662f\u6307\u8868\u8fbe\u5f0f\u7ed3\u675f\u540e\u4f9d\u7136\u5b58\u5728\u7684\u6301\u4e45\u5316\u5bf9\u8c61\uff0c \u53f3\u503c\u662f\u6307\u8868\u8fbe\u5f0f\u7ed3\u675f\u65f6\u5c31\u4e0d\u518d\u5b58\u5728\u7684\u4e34\u65f6\u5bf9\u8c61 \u3002\u6240\u6709\u7684\u5177\u540d\u53d8\u91cf\u6216\u8005\u5bf9\u8c61\u90fd\u662f\u5de6\u503c\uff0c\u800c\u53f3\u503c\u4e0d\u5177\u540d\u3002\u533a\u5206\u5de6\u503c\u548c\u53f3\u503c\u7684\u4fbf\u6377\u65b9\u6cd5\uff1a\u770b\u80fd\u4e0d\u80fd\u5bf9\u8868\u8fbe\u5f0f\u53d6\u5730\u5740\uff0c\u5982\u679c\u80fd\uff0c\u5219\u4e3a\u5de6\u503c\uff0c\u5426\u5219\u4e3a\u53f3\u503c\u3002 \u2003 \u867d\u7136\u5de6\u503c\u5f15\u7528\u4e0d\u53ef\u4ee5\u7ed1\u5b9a\u53f3\u503c\uff0c\u4f46\u5e38\u91cf\u5de6\u503c\u5f15\u7528\u5374\u53ef\u4ee5\u7ed1\u5b9aconst\u53f3\u503c \u2003 const int &a = 1; //a\u5e76\u4e0d\u80fd\u88ab\u4fee\u6539 \u89c4\u52191. \u5f15\u7528\u6298\u53e0 \u5982\u679c\u95f4\u63a5\u7684\u521b\u5efa\u4e00\u4e2a\u5f15\u7528\u7684\u5f15\u7528\uff0c\u5219\u8fd9\u4e9b\u5f15\u7528\u5c31\u4f1a\u201c\u6298\u53e0\u201d\u3002\u5728\u6240\u6709\u60c5\u51b5\u4e0b\uff08\u9664\u4e86\u4e00\u4e2a\u4f8b\u5916\uff09\uff0c\u5f15\u7528\u6298\u53e0\u6210\u4e00\u4e2a\u666e\u901a\u7684\u5de6\u503c\u5f15\u7528\u7c7b\u578b\u3002\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5f15\u7528\u4f1a\u6298\u53e0\u6210\u53f3\u503c\u5f15\u7528\uff0c\u5373\u53f3\u503c\u5f15\u7528\u7684\u53f3\u503c\u5f15\u7528\uff0c T&& &&\u3002\u5373 X& &\u3001X& &&\u3001X&& &\u90fd\u6298\u53e0\u6210X& X&& &&\u6298\u53e0\u4e3aX&& \u89c4\u52192. \u53f3\u503c\u5f15\u7528\u7279\u6b8a\u7c7b\u578b\u63a8\u65ad\u89c4\u5219 \u2003\u5f53\u5c06\u4e00\u4e2a\u5de6\u503c\u4f20\u9012\u7ed9\u4e00\u4e2a\u53c2\u6570\u662f\u53f3\u503c\u5f15\u7528\u7684\u51fd\u6570\uff0c\u4e14\u6b64\u53f3\u503c\u5f15\u7528\u6307\u5411\u6a21\u677f\u7c7b\u578b\u53c2\u6570(T&&)\u65f6\uff0c\u7f16\u8bd1\u5668\u63a8\u65ad\u6a21\u677f\u53c2\u6570\u7c7b\u578b\u4e3a\u5b9e\u53c2\u7684\u5de6\u503c\u5f15\u7528\uff0c\u5982 template<typename T> void f(T&&); int i = 42; f(i) // \u6a21\u677f\u53c2\u6570\u7c7b\u578bT\u5c06\u63a8\u65ad\u4e3aint&\u7c7b\u578b\uff0c\u800c\u975eint\u3002 \u2003\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u5f62\u53c2\u662f\u4e00\u4e2a\u6307\u5411 \u6a21\u677f\u7c7b\u578b \u7684\u53f3\u503c\u5f15\u7528\uff0c\u5219\u8be5\u53c2\u6570\u53ef\u4ee5\u88ab\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5de6\u503c\u4e0a\u3002 \u89c4\u52193 \u2003\u867d\u7136\u4e0d\u80fd\u9690\u5f0f\u7684\u5c06\u4e00\u4e2a\u5de6\u503c\u8f6c\u6362\u4e3a\u53f3\u503c\u5f15\u7528\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7static_cast\u663e\u793a\u5730\u5c06\u4e00\u4e2a\u5de6\u503c\u8f6c\u6362\u4e3a\u4e00\u4e2a\u53f3\u503c\u3002 std::move \u2003\u5728C++11\u4e2d\uff0c\u6807\u51c6\u5e93\u5728 \u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6709\u7528\u7684\u51fd\u6570std::move\uff0cstd::move\u5e76\u4e0d\u80fd\u79fb\u52a8\u4efb\u4f55\u4e1c\u897f\uff0c\u5b83\u552f\u4e00\u7684\u529f\u80fd\u662f\u5c06\u4e00\u4e2a\u5de6\u503c\u5f3a\u5236\u8f6c\u5316\u4e3a\u53f3\u503c\u5f15\u7528\uff0c\u7ee7\u800c\u53ef\u4ee5\u901a\u8fc7\u53f3\u503c\u5f15\u7528\u4f7f\u7528\u8be5\u503c\uff0c\u4ee5\u7528\u4e8e\u79fb\u52a8\u8bed\u4e49\u3002\u4ece\u5b9e\u73b0\u4e0a\u8bb2\uff0cstd::move\u81ea\u8eab\u9664\u4e86\u505a\u4e00\u4e9b\u53c2\u6570\u7684\u63a8\u65ad\u4e4b\u5916\uff0c\u8fd4\u56de\u53f3\u503c\u5f15\u7528\u672c\u8d28\u4e0a\u8fd8\u662f\u9760static_cast \u5b8c\u6210\u7684\u3002 template<typename T> typename remove_reference<T>::type && move(T&& t) { return static_cast<typename remove_reference<T>::type &&>(t); } \u2003\u2003\u6839\u636e\u89c4\u52191\uff0c2\u53ef\u77e5\uff0cmove\u65e2\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u5de6\u503c\uff0c\u4e5f\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u53f3\u503c\u3002 \u2003\u2003 std::move\u662f\u5c06\u5bf9\u8c61\u7684\u72b6\u6001\u6216\u8005\u6240\u6709\u6743\u4ece\u4e00\u4e2a\u5bf9\u8c61\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff0c\u53ea\u662f\u8f6c\u79fb \uff0c\u6ca1\u6709\u5185\u5b58\u7684\u642c\u8fc1\u6216\u8005\u5185\u5b58\u62f7\u8d1d\u6240\u4ee5\u53ef\u4ee5\u63d0\u9ad8\u5229\u7528\u6548\u7387,\u6539\u5584\u6027\u80fd\u3002 \u2003\u2003 eg: int && rr1 = std::move(rr); //\u8c03\u7528move\u610f\u5473\u7740\u9664\u5bf9rr\u8d4b\u503c\u6216\u9500\u6bc1\u5b83\u65f6\uff0c\u6211\u4eec\u5c06\u4e0d\u518d\u4f7f\u7528\u5b83\u3002 std::forward \u2003\u5b8c\u7f8e\u8f6c\u53d1: \u5b8c\u7f8e\u8f6c\u53d1\u5b9e\u73b0\u4e86\u53c2\u6570\u5728\u4f20\u9012\u8fc7\u7a0b\u4e2d\u4fdd\u6301\u5176\u503c\u5c5e\u6027\u7684\u529f\u80fd\uff0c\u5373\u82e5\u662f\u5de6\u503c\uff0c\u5219\u4f20\u9012\u4e4b\u540e\u4ecd\u7136\u662f\u5de6\u503c\uff0c\u82e5\u662f\u53f3\u503c\uff0c\u5219\u4f20\u9012\u4e4b\u540e\u4ecd\u7136\u662f\u53f3\u503c\u3002 \u2003std::forward\u53ea\u6709\u5728\u5b83\u7684\u53c2\u6570\u7ed1\u5b9a\u5230\u4e00\u4e2a\u53f3\u503c\u4e0a\u7684\u65f6\u5019\uff0c\u5b83\u624d\u8f6c\u6362\u5b83\u7684\u53c2\u6570\u5230\u4e00\u4e2a\u53f3\u503c\u3002 class Foo { public: std::string member; template<typename T> Foo(T&& member): member{std::forward<T>(member)} {} }; /* \u4f20\u9012\u4e00\u4e2alvalue\u6216\u8005\u4f20\u9012\u4e00\u4e2aconst lvaue: \u4f20\u9012\u4e00\u4e2alvalue\uff0c\u6a21\u677f\u63a8\u5bfc\u4e4b\u540e T = std::string& \u4f20\u9012\u4e00\u4e2aconst lvaue, \u6a21\u677f\u63a8\u5bfc\u4e4b\u540eT = const std::string& T& &&\u5c06\u6298\u53e0\u4e3aT&\uff0c\u5373std::string& && \u6298\u53e0\u4e3a std::string& \u6700\u7ec8\u51fd\u6570\u4e3a: Foo(string& member): member{std::forward<string&>(member)} {} std::forward<string&>(member)\u5c06\u8fd4\u56de\u4e00\u4e2a\u5de6\u503c\uff0c\u6700\u7ec8\u8c03\u7528\u62f7\u8d1d\u6784\u9020\u51fd\u6570, \u4f20\u9012\u4e00\u4e2arvalue \u4f20\u9012\u4e00\u4e2arvalue: \u6a21\u677f\u63a8\u5bfc\u4e4b\u540e T = std::string \u6700\u7ec8\u51fd\u6570\u4e3a: Foo(string&& member): member{std::forward<string>(member)} {} std::forward<string>(member) \u5c06\u8fd4\u56de\u4e00\u4e2a\u53f3\u503c\uff0c\u6700\u7ec8\u8c03\u7528\u79fb\u52a8\u6784\u9020\u51fd\u6570\uff1b */","title":"C++ 11 \u5f15\u7528"},{"location":"c_base/pointer_reference/#_3","text":"\u5728\u53c2\u6570\u5217\u8868\u540e\u653e\u7f6e& \u6216\u8005&&, \u5206\u522b\u6307\u51fathis\u6307\u9488\u6307\u5411\u4e00\u4e2a\u5de6\u503c\u6216\u53f3\u503c\uff1b\u53ea\u80fd\u4f5c\u7528\u4e8e\u975estatic\u6210\u5458\u51fd\u6570\uff0c\u4e14\u5fc5\u987b\u540c\u65f6\u51fa\u73b0\u5728\u51fd\u6570\u7684\u58f0\u660e\u548c\u5b9a\u4e49\u4e2d\uff1b\u82e5\u540c\u65f6\u91c7\u7528const\u9650\u5b9a\uff0c\u5219\u5f15\u7528\u9650\u5b9a\u7b26\u5fc5\u987b\u653e\u5728const\u540e\u9762\u3002\u4e14\u5982\u679c\u5b9a\u4e49\u4e24\u4e2a\u6216\u4ee5\u4e0a\u5177\u6709\u76f8\u540c\u540d\u5b57\u548c\u53c2\u6570\u5217\u8868\u7684\u6210\u5458\u51fd\u6570\uff0c\u5fc5\u987b\u5168\u90e8\u52a0\u4e0a\u5f15\u7528\u9650\u5b9a\u7b26\uff08\u4e0d\u540c\u4e8econst\u6210\u5458\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u662f\u5426\u52a0const\u6765\u91cd\u8f7d\uff09\u3002","title":"\u5f15\u7528\u9650\u5b9a\u7b26"},{"location":"c_base/pointer_reference/#_4","text":"","title":"\u6307\u9488\u4e0e\u5f15\u7528\u533a\u522b"},{"location":"c_base/static/","text":"About Static \u9759\u6001\u4e0e\u52a8\u6001 \u2003\u9759\u6001\u7c7b\u578b: \u5bf9\u8c61\u7684\u9759\u6001\u7c7b\u578b\u6307\u5176\u5728\u7a0b\u5e8f\u4e2d\u88ab\u58f0\u660e\u65f6\u6240\u91c7\u7528\u7684\u7c7b\u578b; \u52a8\u6001\u7c7b\u578b\u5219\u662f\u6307\u201c\u76ee\u524d\u6240\u6307\u5bf9\u8c61\u7c7b\u578b\u201d, \u53ef\u5728\u8fd0\u884c\u671f\u53d1\u751f\u6539\u53d8; \u2003\u8003\u8651\u5e26\u6709\u7f3a\u7701\u53c2\u6570\u7684virtual\u51fd\u6570: virtual\u51fd\u6570\u662f\u52a8\u6001\u7ed1\u5b9a\uff0c\u7f3a\u7701\u53c2\u6570\u662f\u9759\u6001\u7ed1\u5b9a, \u610f\u5473\u7740\u4f60\u53ef\u80fd\u5728\"\u8c03\u7528\u4e00\u4e2a\u5b9a\u4e49\u4e8ederived class \u5185\u7684\u865a\u51fd\u6570\uff0c\u4f46\u4f7f\u7528base class\u63d0\u4f9b\u7684\u7f3a\u7701\u53c2\u6570\u503c\" \u51fd\u6570\u4e2d\u7684\u9759\u6001\u53d8\u91cf \u2003\u5f53\u53d8\u91cf\u58f0\u660e\u4e3astatic\u65f6\uff0c\u7a7a\u95f4\u5c06\u5728\u7a0b\u5e8f\u7684\u751f\u547d\u5468\u671f\u5185\u5206\u914d\u3002\u5373\u4f7f\u591a\u6b21\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u9759\u6001\u53d8\u91cf\u7684\u7a7a\u95f4\u4e5f\u53ea\u5206\u914d\u4e00\u6b21\uff0c\u524d\u4e00\u6b21\u8c03\u7528\u4e2d\u7684\u53d8\u91cf\u503c\u901a\u8fc7\u4e0b\u4e00\u6b21\u51fd\u6570\u8c03\u7528\u4f20\u9012\u3002\u8fd9\u5bf9\u4e8e\u5728C / C ++\u6216\u9700\u8981\u5b58\u50a8\u5148\u524d\u51fd\u6570\u72b6\u6001\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u975e\u5e38\u6709\u7528\u3002 \u9759\u6001\u6210\u5458\u51fd\u6570 \u2003\u5176\u4e0d\u80fd\u8bbf\u95ee\u975e\u9759\u6001\u6210\u5458\u53d8\u91cf\uff0c\u56e0\u4e3a\u9759\u6001\u6210\u5458\u51fd\u6570\u5c5e\u4e8e\u7c7b\uff0c\u901a\u8fc7\u7c7b\u8bbf\u95ee\uff0c\u8c03\u7528\u51fd\u6570\u65f6\u6ca1\u6709\u63d0\u4f9bthis\u6307\u9488, \u6240\u4ee5\u5176\u4e0d\u80fd\u8bbf\u95ee\u975e\u9759\u6001\u6210\u5458\u53d8\u91cf\uff08\u56e0\u4e3a\u5176\u5c5e\u4e8e\u67d0\u4e2a\u5177\u4f53\u7684\u5bf9\u8c61\uff09\u3002","title":"static"},{"location":"c_base/static/#about-static","text":"","title":"About Static"},{"location":"c_base/static/#_1","text":"\u9759\u6001\u7c7b\u578b: \u5bf9\u8c61\u7684\u9759\u6001\u7c7b\u578b\u6307\u5176\u5728\u7a0b\u5e8f\u4e2d\u88ab\u58f0\u660e\u65f6\u6240\u91c7\u7528\u7684\u7c7b\u578b; \u52a8\u6001\u7c7b\u578b\u5219\u662f\u6307\u201c\u76ee\u524d\u6240\u6307\u5bf9\u8c61\u7c7b\u578b\u201d, \u53ef\u5728\u8fd0\u884c\u671f\u53d1\u751f\u6539\u53d8; \u2003\u8003\u8651\u5e26\u6709\u7f3a\u7701\u53c2\u6570\u7684virtual\u51fd\u6570: virtual\u51fd\u6570\u662f\u52a8\u6001\u7ed1\u5b9a\uff0c\u7f3a\u7701\u53c2\u6570\u662f\u9759\u6001\u7ed1\u5b9a, \u610f\u5473\u7740\u4f60\u53ef\u80fd\u5728\"\u8c03\u7528\u4e00\u4e2a\u5b9a\u4e49\u4e8ederived class \u5185\u7684\u865a\u51fd\u6570\uff0c\u4f46\u4f7f\u7528base class\u63d0\u4f9b\u7684\u7f3a\u7701\u53c2\u6570\u503c\"","title":"\u9759\u6001\u4e0e\u52a8\u6001"},{"location":"c_base/static/#_2","text":"\u5f53\u53d8\u91cf\u58f0\u660e\u4e3astatic\u65f6\uff0c\u7a7a\u95f4\u5c06\u5728\u7a0b\u5e8f\u7684\u751f\u547d\u5468\u671f\u5185\u5206\u914d\u3002\u5373\u4f7f\u591a\u6b21\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u9759\u6001\u53d8\u91cf\u7684\u7a7a\u95f4\u4e5f\u53ea\u5206\u914d\u4e00\u6b21\uff0c\u524d\u4e00\u6b21\u8c03\u7528\u4e2d\u7684\u53d8\u91cf\u503c\u901a\u8fc7\u4e0b\u4e00\u6b21\u51fd\u6570\u8c03\u7528\u4f20\u9012\u3002\u8fd9\u5bf9\u4e8e\u5728C / C ++\u6216\u9700\u8981\u5b58\u50a8\u5148\u524d\u51fd\u6570\u72b6\u6001\u7684\u4efb\u4f55\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u975e\u5e38\u6709\u7528\u3002","title":"\u51fd\u6570\u4e2d\u7684\u9759\u6001\u53d8\u91cf"},{"location":"c_base/static/#_3","text":"\u5176\u4e0d\u80fd\u8bbf\u95ee\u975e\u9759\u6001\u6210\u5458\u53d8\u91cf\uff0c\u56e0\u4e3a\u9759\u6001\u6210\u5458\u51fd\u6570\u5c5e\u4e8e\u7c7b\uff0c\u901a\u8fc7\u7c7b\u8bbf\u95ee\uff0c\u8c03\u7528\u51fd\u6570\u65f6\u6ca1\u6709\u63d0\u4f9bthis\u6307\u9488, \u6240\u4ee5\u5176\u4e0d\u80fd\u8bbf\u95ee\u975e\u9759\u6001\u6210\u5458\u53d8\u91cf\uff08\u56e0\u4e3a\u5176\u5c5e\u4e8e\u67d0\u4e2a\u5177\u4f53\u7684\u5bf9\u8c61\uff09\u3002","title":"\u9759\u6001\u6210\u5458\u51fd\u6570"},{"location":"c_base/virtual/","text":"About Virtual Function \u865a\u51fd\u6570\u5b9e\u73b0\u4e86C++\u7684\u591a\u6001 \u2003\u5728c++\u4e2d\uff0c\u4e00\u4e2a\u57fa\u7c7b\u7684\u6307\u9488\u6216\u8005\u5f15\u7528\u53ef\u4ee5\u6307\u5411\u6216\u8005\u5f15\u7528\u6d3e\u751f\u7c7b\u7684\u5bf9\u8c61\u3002\u5bf9\u4e8e\u57fa\u7c7b\u4e2d\u7684\u865a\u51fd\u6570\uff0c\u5176\u542b\u4e49\u662f\uff1a\u5f53\u901a\u8fc7\u57fa\u7c7b\u7684\u6307\u9488\u6216\u8005\u5f15\u7528\u8c03\u7528\u8be5\u6210\u5458\u51fd\u6570\u65f6\uff0c\u82e5\u6d3e\u751f\u7c7b\u8986\u76d6(override)\u4e86\u57fa\u7c7b\u4e2d\u7684\u865a\u6210\u5458\u51fd\u6570\uff0c\u5c06\u6839\u636e\u6307\u9488\u5b9e\u9645\u6307\u5411\u7684\u5bf9\u8c61\u7c7b\u578b\u786e\u5b9a\u8c03\u7528\u7684\u51fd\u6570\uff0c\u800c\u975e\u6307\u9488\u7684\u7c7b\u578b\u3002 \u2003\u4e0a\u8ff0\u884c\u4e3a\u4e5f\u53ef\u4ee5\u79f0\u4e3a\u52a8\u6001\u7ed1\u5b9a\uff08\u8fd0\u884c\u65f6\u7ed1\u5b9a\uff09\uff0c\u5373\u51fd\u6570\u7684\u8fd0\u884c\u7248\u672c\u7531\u5b9e\u53c2\u51b3\u5b9a\uff0c\u5728\u8fd0\u884c\u65f6\u9009\u62e9\u51fd\u6570\u7684\u7248\u672c\u3002 class Base{ public: virtual void test(){ cout << \u201c\u57fa\u7c7b\u65b9\u6cd5\u201d}; virtual ~Base(){}; } class Derived:public Base{ public: void test(){ cout << \u201c\u6d3e\u751f\u7c7b\u65b9\u6cd5\u201d}; } \u53ea\u9700\u5c06\u57fa\u7c7b\u4e2d\u7684\u6210\u5458\u51fd\u6570\u58f0\u660e\u4e3a\u865a\u51fd\u6570\u5373\u53ef\uff0c\u6d3e\u751f\u7c7b\u4e2d\u91cd\u5199\u7684virtual\u51fd\u6570\u81ea\u52a8\u6210\u4e3a\u865a\u51fd\u6570\uff1b \u6d3e\u751f\u7c7b\u82e5\u5b58\u5728\u548c\u7236\u7c7b\u865a\u51fd\u6570\u540c\u540d\u4f46\u53c2\u6570\u7c7b\u578b\u4e0d\u540c\u7684\u51fd\u6570\u65f6\uff0c\u4f1a\u5bfc\u81f4\u7236\u7c7b\u4e2d\u7684\u8fd9\u4e2a\u865a\u51fd\u6570\u5bf9\u4e8e\u5b50\u7c7b\u5bf9\u8c61\u4e0d\u53ef\u89c1\u3002\u6b64\u65f6\u53ef\u901a\u8fc7 Derived.Base::fcn() \u6765\u8c03\u7528\u88ab\u9690\u85cf\u7684\u51fd\u6570 \u57fa\u7c7b\u4e2d\u7684\u6790\u6784\u51fd\u6570\u5fc5\u987b\u4e3a\u865a\u51fd\u6570 \uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u5bf9\u8c61\u91ca\u653e\u9519\u8bef\u3002\u5982\u679c\u57fa\u7c7b\u7684\u6790\u6784\u51fd\u6570\u4e0d\u662f\u865a\u51fd\u6570\uff0c\u5219\u5220\u9664\u4e00\u4e2a\u57fa\u7c7b\u7684\u6307\u9488\u7684\u65f6\u5019\uff0cC++\u4e0d\u7ba1\u8fd9\u4e2a\u6307\u9488\u6307\u5411\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u8fd8\u662f\u4e00\u4e2a\u6d3e\u751f\u7c7b\u7684\u5bf9\u8c61\uff0c\u8c03\u7528\u7684\u90fd\u662f\u57fa\u7c7b\u7684\u6790\u6784\u51fd\u6570\u800c\u4e0d\u662f\u6d3e\u751f\u7c7b\u7684\u3002\u5982\u679c\u5b9e\u9645\u6307\u5411\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4f9d\u8d56\u4e8e\u6d3e\u751f\u7c7b\u7684\u6790\u6784\u51fd\u6570\u7684\u4ee3\u7801\u6765\u91ca\u653e\u8d44\u6e90\uff0c\u8fd9\u6837\u505a\u5c31\u4f1a\u9020\u6210\u8d44\u6e90\u6cc4\u6f0f\u3002\u5982\u679c\u57fa\u7c7b\u7684\u6790\u6784\u51fd\u6570\u662f\u865a\u51fd\u6570\uff0c\u5e76\u4e14\u6d3e\u751f\u7c7b\u63d0\u4f9b\u81ea\u5df1\u7684\u6790\u6784\u51fd\u6570\uff0c\u5219\u5220\u9664\u57fa\u7c7b\u6307\u9488\u65f6\uff0c\u4f1a\u8c03\u7528\u6d3e\u751f\u7c7b\u7684\u6790\u6784\u51fd\u6570\u3002 \u865a\u51fd\u6570\u7684\u4f7f\u7528\u5c06\u5bfc\u81f4\u7c7b\u5bf9\u8c61\u5360\u7528\u66f4\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u3002\u7f16\u8bd1\u5668\u7ed9\u6bcf\u4e00\u4e2a\u5305\u62ec\u865a\u51fd\u6570\u7684\u5bf9\u8c61\u6dfb\u52a0\u4e86\u4e00\u4e2a\u9690\u85cf\u6210\u5458\uff1a\u6307\u5411\u865a\u51fd\u6570\u8868\u7684\u6307\u9488 vptr \u3002 \u2003 \u865a\u51fd\u6570\u8868\u662f\u7f16\u8bd1\u5668\u5728\u7f16\u8bd1\u65f6\u8bbe\u7f6e\u7684\u9759\u6001\u6570\u7ec4\uff0c\u5c5e\u4e8e\u7c7b\u800c\u975e\u67d0\u4e2a\u5177\u4f53\u7684\u5b9e\u4f8b \u3002\u865a\u51fd\u6570\u8868\u5305\u542b\u53ef\u7531\u7c7b\u7684\u5bf9\u8c61\u8c03\u7528\u7684\u6bcf\u4e2a\u865a\u51fd\u6570\u7684\u4e00\u4e2a\u6761\u76ee\u3002\u6b64\u8868\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488\uff0c\u6307\u5411\u8be5\u7c7b\u53ef\u8bbf\u95ee\u7684\u51fd\u6570\u3002 \u2003vptr\u5728\u521b\u5efa\u7c7b\u5b9e\u4f8b\u65f6\u81ea\u52a8\u8bbe\u7f6e\uff0c\u4ee5\u4fbf\u6307\u5411\u8be5\u7c7b\u7684\u865a\u51fd\u6570\u8868(\u4e0ethis\u6307\u9488\u4e0d\u540c\uff0cthis\u6307\u9488\u5b9e\u9645\u4e0a\u662f\u7f16\u8bd1\u5668\u7528\u6765\u89e3\u6790\u81ea\u5f15\u7528\u7684\u51fd\u6570\u53c2\u6570\uff0cvptr\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u6307\u9488)\u3002\u5f53\u6d3e\u751f\u7c7b\u91cd\u65b0\u5b9a\u4e49\u865a\u51fd\u6570\u65f6\uff0c\u5219\u5c06\u8be5\u51fd\u6570\u7684\u5730\u5740\u6dfb\u52a0\u5230\u865a\u51fd\u6570\u8868\u4e2d\u3002\u65e0\u8bba\u4e00\u4e2a\u7c7b\u5bf9\u8c61\u4e2d\u5b9a\u4e49\u4e86\u591a\u5c11\u4e2a\u865a\u51fd\u6570\uff0c\u865a\u51fd\u6570\u6307\u9488\u53ea\u6709\u4e00\u4e2a\u3002\u76f8\u5e94\u5730\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u7684\u5927\u5c0f\u8981\u6bd4\u6ca1\u6709\u865a\u51fd\u6570\u65f6\u59274\u4e2a\u5b57\u8282\uff0832\u4f4d\u4e3b\u673a, 64\u4f4d\u673a\u5668\u5219\u4e3a8\u5b57\u8282)\u3002 \u6784\u9020\u51fd\u6570\u4e0d\u53ef\u4ee5\u58f0\u660e\u4e3a\u865a\u51fd\u6570\uff1a\u5c3d\u7ba1\u865a\u51fd\u6570\u8868vtable\u662f\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u5df2\u7ecf\u5efa\u7acb\u7684\uff0c\u4f46\u6307\u5411\u865a\u51fd\u6570\u8868\u7684\u6307\u9488vptr\u662f\u5728\u8fd0\u884c\u9636\u6bb5\u5b9e\u4f8b\u5316\u5bf9\u8c61\u65f6\u624d\u4ea7\u751f\u7684 \u3002 \u5982\u679c\u6784\u9020\u51fd\u6570\u662f\u865a\u7684\uff0c\u5c31\u9700\u8981\u901a\u8fc7\u865a\u6307\u9488\u6307\u5411\u7684\u865a\u51fd\u6570\u8868\u6765\u8c03\u7528\uff0c\u53ef\u662f\u6b64\u65f6\u5bf9\u8c61\u8fd8\u6ca1\u6709\u5b9e\u4f8b\u5316\uff0c\u5c1a\u672a\u5206\u914d\u5185\u5b58\uff0c\u5c31\u6ca1\u6709\u865a\u6307\u9488\uff0c\u6240\u4ee5\u6784\u9020\u51fd\u6570\u4e0d\u80fd\u662f\u865a\u51fd\u6570\u3002 \u9759\u6001\u51fd\u6570\u4e0d\u53ef\u4ee5\u58f0\u660e\u4e3a\u865a\u51fd\u6570: static\u6210\u5458\u51fd\u6570\u4e0d\u5c5e\u4e8e\u4efb\u4f55\u7c7b\u5bf9\u8c61\u6216\u7c7b\u5b9e\u4f8b\uff0c\u4e14\u865a\u51fd\u6570\u4f9d\u9760vptr\u548cvtable\u6765\u5904\u7406\u3002vptr\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u5728\u7c7b\u7684\u6784\u9020\u51fd\u6570\u4e2d\u521b\u5efa\u751f\u6210\uff0c\u901a\u8fc7this\u6307\u9488\u6765\u8bbf\u95ee\u5b83\uff0c\u9759\u6001\u6210\u5458\u51fd\u6570\u6ca1\u6709this\u6307\u9488\uff0c\u6240\u4ee5\u65e0\u6cd5\u8bbf\u95eevptr\u3002 \u6790\u6784\u51fd\u6570\u53ef\u4ee5\u58f0\u660e\u4e3a\u865a\u51fd\u6570\u3002\u5982\u679c\u6211\u4eec\u9700\u8981\u5220\u9664\u4e00\u4e2a\u6307\u5411\u6d3e\u751f\u7c7b\u7684\u57fa\u7c7b\u6307\u9488\u65f6\uff0c\u5e94\u8be5\u628a\u6790\u6784\u51fd\u6570\u58f0\u660e\u4e3a\u865a\u51fd\u6570\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u53ea\u8981\u4e00\u4e2a\u7c7b\u6709\u53ef\u80fd\u4f1a\u88ab\u5176\u5b83\u7c7b\u6240\u7ee7\u627f\uff0c \u5c31\u5e94\u8be5\u58f0\u660e\u865a\u6790\u6784\u51fd\u6570(\u54ea\u6015\u8be5\u6790\u6784\u51fd\u6570\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c)\u3002 class A { public: virtual void vfunc1(); virtual void vfunc2(); void func1(); void func2(); private: int m_data1, m_data2; }; class B : public A { public: virtual void vfunc1(); void func1(); private: int m_data3; }; class C: public B { public: virtual void vfunc2(); void func2(); private: int m_data1, m_data4; }; \u901a\u8fc7\u865a\u51fd\u6570\u8868\u8c03\u7528\u865a\u51fd\u6570 class CTest { public: virtual void Test1(void){cout<< \"CTest Test1\\n\";} virtual void Test2(void){cout<< \"CTest Test2\\n\";} }; typedef void(*fun)(); void testT(){ CTest cc; typedef long long int64; // 64\u4f4d\u673a\u4e0a\uff0c\u6307\u9488\u5927\u5c0f\u662f8\u4e2aByte, \u6307\u9488+1\u504f\u79fb64\u4f4d\u957f\u5ea6 int64* Vptr=(int64*)(&cc); //\u865a\u6307\u9488\u503c\u4ee3\u8868\u7684\u662f\u865a\u51fd\u6570\u8868\u5165\u53e3\u5730\u5740 int64* pVtbl = (int64*)*Vptr; //\u865a\u51fd\u6570\u8868\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u5143\u7d20\u662f\u51fd\u6570\u6307\u9488\uff0cpVtbl\u76f8\u5f53\u4e8e\u6570\u7ec4\u5143\u7d20\u9996\u5730\u5740 int64* pFirstVf = (int64*)(pVtbl[0]); //pVtbl[0] \u7b49\u4ef7\u4e8e *(pVtbl) int64* pFirstVf2 = (int64*)*pVtbl; int64* pSecondVf = (int64*)(pVtbl[1]); //pVtbl[1] \u7b49\u4ef7\u4e8e *(pVtbl+1) int64* pSecondVf2 = (int64*)*(pVtbl+1); fun pf; pf = (fun)pFirstVf; pf(); // CTest Test1 pf = (fun)pFirstVf2; pf(); //CTest Test1 pf = (fun)pSecondVf; pf(); //CTest Test2 pf = (fun)pSecondVf2; pf(); //CTest Test2 } \u591a\u91cd\u7ee7\u627f\u673a\u5236\u4e0b\u7684\u865a\u51fd\u6570\u8868 \u2003\u5b50\u7c7b\u5bf9\u8c61\u4f1a\u6709\u591a\u4e2a\u865a\u51fd\u6570\u6307\u9488\uff0c\u6307\u5411\u4e0d\u540c\u7684\u865a\u51fd\u6570\u8868\uff0c\u865a\u51fd\u6570\u6307\u9488\u987a\u5e8f\u6309\u7167\u6d3e\u751f\u987a\u5e8f\uff1b\u5982\u679c\u5b50\u7c7b\u6539\u5199\u4e86\u7236\u7c7b\u7684\u865a\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u4f1a\u7528\u5b50\u7c7b\u81ea\u5df1\u7684\u865a\u51fd\u6570\u8986\u76d6\u76f8\u5e94\u7684\u7236\u7c7b\u865a\u51fd\u6570\uff1b\u5982\u679c\u5b50\u7c7b\u6709\u65b0\u7684\u865a\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u6dfb\u52a0\u5230\u7b2c\u4e00\u4e2a\u865a\u51fd\u6570\u8868\u7684\u672b\u5c3e\u3002 \u865a\u51fd\u6570\u7684\u9759\u6001\u51b3\u8bae \u2003\u5728\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u865a\u51fd\u6570\u4e0d\u4f1a\u51fa\u73b0\u9884\u671f\u884c\u4e3a: \u5728\u57fa\u7c7b\u7684constructor\u548cdestructor\u5185\uff0c\u56e0\u4e3a\u5f53\u6211\u4eec\u6784\u9020\u6d3e\u751f\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4f1a\u9996\u5148\u8c03\u7528\u57fa\u7c7b\u7684constructor\uff0c\u82e5\u57fa\u7c7b\u4e2d\u5b58\u5728\u865a\u51fd\u6570\uff0c\u5219\u8c03\u7528\u7684\u662f\u4e00\u5b9a\u662f\u57fa\u7c7b\u81ea\u8eab\u7684\uff0c\u800c\u975e\u6d3e\u751f\u7c7b\u7684\uff0c\u56e0\u4e3a\u6b64\u65f6\u6d3e\u751f\u7c7b\u7684data members\u5c1a\u672a\u521d\u59cb\u5316\uff1b\u540c\u7406\uff0c\u5728\u57fa\u7c7bdeconstructor\u4e2d\u5b58\u5728\u865a\u51fd\u6570\u4e5f\u9002\u7528\u6b64\u89c4\u5219\uff0c\u56e0\u4e3a\u6d3e\u751f\u7c7b\u7684deconstructor\u5148\u88ab\u8c03\u7528\uff0c\u5176date members\u5df2\u7ecf\u88ab\u91ca\u653e\u3002 \u5f53\u6211\u4eec\u4f7f\u7528\u57fa\u7c7b\u7684\u5bf9\u8c61\uff0c\u800c\u975e\u6307\u9488\u6216\u5f15\u7528\u65f6\uff1b\u4e3a\u4e86\u80fd\u5728\u5355\u4e00\u5bf9\u8c61\u4e2d\u5c55\u73b0\u591a\u79cd\u578b\u522b\uff0c\u591a\u6001\u9700\u8981\u4e00\u5c42\u95f4\u63a5\u6027\uff0c\u5728C++\u4e2d\uff0c \u60df\u6709\u4ee5\u57fa\u7c7b\u7684\u6307\u9488\u548c\u5f15\u7528\u624d\u80fd\u652f\u6301\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u6982\u5ff5 \u3002\u5f53\u6211\u4eec\u4e3a\u57fa\u7c7b\u58f0\u660e\u4e00\u4e2a\u5b9e\u9645\u5bf9\u8c61\u65f6\uff0c\u540c\u65f6\u4e5f\u5c31\u914d\u7f6e\u51fa\u8db3\u4ee5\u5bb9\u7eb3\u8be5\u5bf9\u8c61\u7684\u5b9e\u9645\u5185\u5b58\u7a7a\u95f4\uff0c\u5982\u679c\u4f20\u5165\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff0c\u90a3\u4e48\u5c31\u4e0d\u4e00\u5b9a\u6709\u8db3\u591f\u7684\u5185\u5b58\u653e\u7f6e\u6d3e\u751f\u7c7b\u7684\u5404\u4e2adata members, \u90a3\u4e9b\u5c5e\u4e8e\u6d3e\u751f\u7c7b\u800c\u975e\u57fa\u7c7b\u7684\u6210\u5458\u5c06\u88ab\u5207\u6389\u3002 \u7eaf\u865a\u51fd\u6570 \u5728\u666e\u901a\u7684\u7eaf\u865a\u51fd\u6570\u540e\u9762\u52a0\u4e0a\u201c=0\u201d\uff0c eg. virtual void test() = 0; \u2003\u4f55\u65f6\u4f7f\u7528\u7eaf\u865a\u51fd\u6570: \u5f53\u60f3\u5728\u57fa\u7c7b\u4e2d\u62bd\u8c61\u51fa\u4e00\u4e2a\u65b9\u6cd5\uff0c\u4e14\u8be5\u57fa\u7c7b\u53ea\u505a\u80fd\u88ab\u7ee7\u627f\uff08\u5373\u4e3a\u62bd\u8c61\u57fa\u7c7b\uff09\uff0c\u800c\u4e0d\u80fd\u88ab\u5b9e\u4f8b\u5316\uff1b \u8fd9\u4e2a\u65b9\u6cd5\u5fc5\u987b\u5728\u6d3e\u751f\u7c7b(derived class)\u4e2d\u88ab\u5b9e\u73b0\uff1b \u5982\u679c\u6ee1\u8db3\u4ee5\u4e0a\u4e24\u70b9\uff0c\u53ef\u4ee5\u8003\u8651\u5c06\u8be5\u65b9\u6cd5\u7533\u660e\u4e3apure virtual function; \u53ef\u4ee5\u4e3a\u7eaf\u865a\u51fd\u6570\u63d0\u4f9b\u5b9a\u4e49\uff0c\u4e0d\u8fc7\u51fd\u6570\u4f53\u5fc5\u987b\u5b9a\u4e49\u5728\u7c7b\u7684\u5916\u90e8\u3002","title":"virtual"},{"location":"c_base/virtual/#about-virtual-function","text":"","title":"About Virtual Function"},{"location":"c_base/virtual/#c","text":"\u5728c++\u4e2d\uff0c\u4e00\u4e2a\u57fa\u7c7b\u7684\u6307\u9488\u6216\u8005\u5f15\u7528\u53ef\u4ee5\u6307\u5411\u6216\u8005\u5f15\u7528\u6d3e\u751f\u7c7b\u7684\u5bf9\u8c61\u3002\u5bf9\u4e8e\u57fa\u7c7b\u4e2d\u7684\u865a\u51fd\u6570\uff0c\u5176\u542b\u4e49\u662f\uff1a\u5f53\u901a\u8fc7\u57fa\u7c7b\u7684\u6307\u9488\u6216\u8005\u5f15\u7528\u8c03\u7528\u8be5\u6210\u5458\u51fd\u6570\u65f6\uff0c\u82e5\u6d3e\u751f\u7c7b\u8986\u76d6(override)\u4e86\u57fa\u7c7b\u4e2d\u7684\u865a\u6210\u5458\u51fd\u6570\uff0c\u5c06\u6839\u636e\u6307\u9488\u5b9e\u9645\u6307\u5411\u7684\u5bf9\u8c61\u7c7b\u578b\u786e\u5b9a\u8c03\u7528\u7684\u51fd\u6570\uff0c\u800c\u975e\u6307\u9488\u7684\u7c7b\u578b\u3002 \u2003\u4e0a\u8ff0\u884c\u4e3a\u4e5f\u53ef\u4ee5\u79f0\u4e3a\u52a8\u6001\u7ed1\u5b9a\uff08\u8fd0\u884c\u65f6\u7ed1\u5b9a\uff09\uff0c\u5373\u51fd\u6570\u7684\u8fd0\u884c\u7248\u672c\u7531\u5b9e\u53c2\u51b3\u5b9a\uff0c\u5728\u8fd0\u884c\u65f6\u9009\u62e9\u51fd\u6570\u7684\u7248\u672c\u3002 class Base{ public: virtual void test(){ cout << \u201c\u57fa\u7c7b\u65b9\u6cd5\u201d}; virtual ~Base(){}; } class Derived:public Base{ public: void test(){ cout << \u201c\u6d3e\u751f\u7c7b\u65b9\u6cd5\u201d}; } \u53ea\u9700\u5c06\u57fa\u7c7b\u4e2d\u7684\u6210\u5458\u51fd\u6570\u58f0\u660e\u4e3a\u865a\u51fd\u6570\u5373\u53ef\uff0c\u6d3e\u751f\u7c7b\u4e2d\u91cd\u5199\u7684virtual\u51fd\u6570\u81ea\u52a8\u6210\u4e3a\u865a\u51fd\u6570\uff1b \u6d3e\u751f\u7c7b\u82e5\u5b58\u5728\u548c\u7236\u7c7b\u865a\u51fd\u6570\u540c\u540d\u4f46\u53c2\u6570\u7c7b\u578b\u4e0d\u540c\u7684\u51fd\u6570\u65f6\uff0c\u4f1a\u5bfc\u81f4\u7236\u7c7b\u4e2d\u7684\u8fd9\u4e2a\u865a\u51fd\u6570\u5bf9\u4e8e\u5b50\u7c7b\u5bf9\u8c61\u4e0d\u53ef\u89c1\u3002\u6b64\u65f6\u53ef\u901a\u8fc7 Derived.Base::fcn() \u6765\u8c03\u7528\u88ab\u9690\u85cf\u7684\u51fd\u6570 \u57fa\u7c7b\u4e2d\u7684\u6790\u6784\u51fd\u6570\u5fc5\u987b\u4e3a\u865a\u51fd\u6570 \uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u5bf9\u8c61\u91ca\u653e\u9519\u8bef\u3002\u5982\u679c\u57fa\u7c7b\u7684\u6790\u6784\u51fd\u6570\u4e0d\u662f\u865a\u51fd\u6570\uff0c\u5219\u5220\u9664\u4e00\u4e2a\u57fa\u7c7b\u7684\u6307\u9488\u7684\u65f6\u5019\uff0cC++\u4e0d\u7ba1\u8fd9\u4e2a\u6307\u9488\u6307\u5411\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u8fd8\u662f\u4e00\u4e2a\u6d3e\u751f\u7c7b\u7684\u5bf9\u8c61\uff0c\u8c03\u7528\u7684\u90fd\u662f\u57fa\u7c7b\u7684\u6790\u6784\u51fd\u6570\u800c\u4e0d\u662f\u6d3e\u751f\u7c7b\u7684\u3002\u5982\u679c\u5b9e\u9645\u6307\u5411\u7684\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4f9d\u8d56\u4e8e\u6d3e\u751f\u7c7b\u7684\u6790\u6784\u51fd\u6570\u7684\u4ee3\u7801\u6765\u91ca\u653e\u8d44\u6e90\uff0c\u8fd9\u6837\u505a\u5c31\u4f1a\u9020\u6210\u8d44\u6e90\u6cc4\u6f0f\u3002\u5982\u679c\u57fa\u7c7b\u7684\u6790\u6784\u51fd\u6570\u662f\u865a\u51fd\u6570\uff0c\u5e76\u4e14\u6d3e\u751f\u7c7b\u63d0\u4f9b\u81ea\u5df1\u7684\u6790\u6784\u51fd\u6570\uff0c\u5219\u5220\u9664\u57fa\u7c7b\u6307\u9488\u65f6\uff0c\u4f1a\u8c03\u7528\u6d3e\u751f\u7c7b\u7684\u6790\u6784\u51fd\u6570\u3002 \u865a\u51fd\u6570\u7684\u4f7f\u7528\u5c06\u5bfc\u81f4\u7c7b\u5bf9\u8c61\u5360\u7528\u66f4\u5927\u7684\u5185\u5b58\u7a7a\u95f4\u3002\u7f16\u8bd1\u5668\u7ed9\u6bcf\u4e00\u4e2a\u5305\u62ec\u865a\u51fd\u6570\u7684\u5bf9\u8c61\u6dfb\u52a0\u4e86\u4e00\u4e2a\u9690\u85cf\u6210\u5458\uff1a\u6307\u5411\u865a\u51fd\u6570\u8868\u7684\u6307\u9488 vptr \u3002 \u2003 \u865a\u51fd\u6570\u8868\u662f\u7f16\u8bd1\u5668\u5728\u7f16\u8bd1\u65f6\u8bbe\u7f6e\u7684\u9759\u6001\u6570\u7ec4\uff0c\u5c5e\u4e8e\u7c7b\u800c\u975e\u67d0\u4e2a\u5177\u4f53\u7684\u5b9e\u4f8b \u3002\u865a\u51fd\u6570\u8868\u5305\u542b\u53ef\u7531\u7c7b\u7684\u5bf9\u8c61\u8c03\u7528\u7684\u6bcf\u4e2a\u865a\u51fd\u6570\u7684\u4e00\u4e2a\u6761\u76ee\u3002\u6b64\u8868\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488\uff0c\u6307\u5411\u8be5\u7c7b\u53ef\u8bbf\u95ee\u7684\u51fd\u6570\u3002 \u2003vptr\u5728\u521b\u5efa\u7c7b\u5b9e\u4f8b\u65f6\u81ea\u52a8\u8bbe\u7f6e\uff0c\u4ee5\u4fbf\u6307\u5411\u8be5\u7c7b\u7684\u865a\u51fd\u6570\u8868(\u4e0ethis\u6307\u9488\u4e0d\u540c\uff0cthis\u6307\u9488\u5b9e\u9645\u4e0a\u662f\u7f16\u8bd1\u5668\u7528\u6765\u89e3\u6790\u81ea\u5f15\u7528\u7684\u51fd\u6570\u53c2\u6570\uff0cvptr\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u6307\u9488)\u3002\u5f53\u6d3e\u751f\u7c7b\u91cd\u65b0\u5b9a\u4e49\u865a\u51fd\u6570\u65f6\uff0c\u5219\u5c06\u8be5\u51fd\u6570\u7684\u5730\u5740\u6dfb\u52a0\u5230\u865a\u51fd\u6570\u8868\u4e2d\u3002\u65e0\u8bba\u4e00\u4e2a\u7c7b\u5bf9\u8c61\u4e2d\u5b9a\u4e49\u4e86\u591a\u5c11\u4e2a\u865a\u51fd\u6570\uff0c\u865a\u51fd\u6570\u6307\u9488\u53ea\u6709\u4e00\u4e2a\u3002\u76f8\u5e94\u5730\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u7684\u5927\u5c0f\u8981\u6bd4\u6ca1\u6709\u865a\u51fd\u6570\u65f6\u59274\u4e2a\u5b57\u8282\uff0832\u4f4d\u4e3b\u673a, 64\u4f4d\u673a\u5668\u5219\u4e3a8\u5b57\u8282)\u3002 \u6784\u9020\u51fd\u6570\u4e0d\u53ef\u4ee5\u58f0\u660e\u4e3a\u865a\u51fd\u6570\uff1a\u5c3d\u7ba1\u865a\u51fd\u6570\u8868vtable\u662f\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u5df2\u7ecf\u5efa\u7acb\u7684\uff0c\u4f46\u6307\u5411\u865a\u51fd\u6570\u8868\u7684\u6307\u9488vptr\u662f\u5728\u8fd0\u884c\u9636\u6bb5\u5b9e\u4f8b\u5316\u5bf9\u8c61\u65f6\u624d\u4ea7\u751f\u7684 \u3002 \u5982\u679c\u6784\u9020\u51fd\u6570\u662f\u865a\u7684\uff0c\u5c31\u9700\u8981\u901a\u8fc7\u865a\u6307\u9488\u6307\u5411\u7684\u865a\u51fd\u6570\u8868\u6765\u8c03\u7528\uff0c\u53ef\u662f\u6b64\u65f6\u5bf9\u8c61\u8fd8\u6ca1\u6709\u5b9e\u4f8b\u5316\uff0c\u5c1a\u672a\u5206\u914d\u5185\u5b58\uff0c\u5c31\u6ca1\u6709\u865a\u6307\u9488\uff0c\u6240\u4ee5\u6784\u9020\u51fd\u6570\u4e0d\u80fd\u662f\u865a\u51fd\u6570\u3002 \u9759\u6001\u51fd\u6570\u4e0d\u53ef\u4ee5\u58f0\u660e\u4e3a\u865a\u51fd\u6570: static\u6210\u5458\u51fd\u6570\u4e0d\u5c5e\u4e8e\u4efb\u4f55\u7c7b\u5bf9\u8c61\u6216\u7c7b\u5b9e\u4f8b\uff0c\u4e14\u865a\u51fd\u6570\u4f9d\u9760vptr\u548cvtable\u6765\u5904\u7406\u3002vptr\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u5728\u7c7b\u7684\u6784\u9020\u51fd\u6570\u4e2d\u521b\u5efa\u751f\u6210\uff0c\u901a\u8fc7this\u6307\u9488\u6765\u8bbf\u95ee\u5b83\uff0c\u9759\u6001\u6210\u5458\u51fd\u6570\u6ca1\u6709this\u6307\u9488\uff0c\u6240\u4ee5\u65e0\u6cd5\u8bbf\u95eevptr\u3002 \u6790\u6784\u51fd\u6570\u53ef\u4ee5\u58f0\u660e\u4e3a\u865a\u51fd\u6570\u3002\u5982\u679c\u6211\u4eec\u9700\u8981\u5220\u9664\u4e00\u4e2a\u6307\u5411\u6d3e\u751f\u7c7b\u7684\u57fa\u7c7b\u6307\u9488\u65f6\uff0c\u5e94\u8be5\u628a\u6790\u6784\u51fd\u6570\u58f0\u660e\u4e3a\u865a\u51fd\u6570\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u53ea\u8981\u4e00\u4e2a\u7c7b\u6709\u53ef\u80fd\u4f1a\u88ab\u5176\u5b83\u7c7b\u6240\u7ee7\u627f\uff0c \u5c31\u5e94\u8be5\u58f0\u660e\u865a\u6790\u6784\u51fd\u6570(\u54ea\u6015\u8be5\u6790\u6784\u51fd\u6570\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c)\u3002 class A { public: virtual void vfunc1(); virtual void vfunc2(); void func1(); void func2(); private: int m_data1, m_data2; }; class B : public A { public: virtual void vfunc1(); void func1(); private: int m_data3; }; class C: public B { public: virtual void vfunc2(); void func2(); private: int m_data1, m_data4; }; \u901a\u8fc7\u865a\u51fd\u6570\u8868\u8c03\u7528\u865a\u51fd\u6570 class CTest { public: virtual void Test1(void){cout<< \"CTest Test1\\n\";} virtual void Test2(void){cout<< \"CTest Test2\\n\";} }; typedef void(*fun)(); void testT(){ CTest cc; typedef long long int64; // 64\u4f4d\u673a\u4e0a\uff0c\u6307\u9488\u5927\u5c0f\u662f8\u4e2aByte, \u6307\u9488+1\u504f\u79fb64\u4f4d\u957f\u5ea6 int64* Vptr=(int64*)(&cc); //\u865a\u6307\u9488\u503c\u4ee3\u8868\u7684\u662f\u865a\u51fd\u6570\u8868\u5165\u53e3\u5730\u5740 int64* pVtbl = (int64*)*Vptr; //\u865a\u51fd\u6570\u8868\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u5143\u7d20\u662f\u51fd\u6570\u6307\u9488\uff0cpVtbl\u76f8\u5f53\u4e8e\u6570\u7ec4\u5143\u7d20\u9996\u5730\u5740 int64* pFirstVf = (int64*)(pVtbl[0]); //pVtbl[0] \u7b49\u4ef7\u4e8e *(pVtbl) int64* pFirstVf2 = (int64*)*pVtbl; int64* pSecondVf = (int64*)(pVtbl[1]); //pVtbl[1] \u7b49\u4ef7\u4e8e *(pVtbl+1) int64* pSecondVf2 = (int64*)*(pVtbl+1); fun pf; pf = (fun)pFirstVf; pf(); // CTest Test1 pf = (fun)pFirstVf2; pf(); //CTest Test1 pf = (fun)pSecondVf; pf(); //CTest Test2 pf = (fun)pSecondVf2; pf(); //CTest Test2 } \u591a\u91cd\u7ee7\u627f\u673a\u5236\u4e0b\u7684\u865a\u51fd\u6570\u8868 \u2003\u5b50\u7c7b\u5bf9\u8c61\u4f1a\u6709\u591a\u4e2a\u865a\u51fd\u6570\u6307\u9488\uff0c\u6307\u5411\u4e0d\u540c\u7684\u865a\u51fd\u6570\u8868\uff0c\u865a\u51fd\u6570\u6307\u9488\u987a\u5e8f\u6309\u7167\u6d3e\u751f\u987a\u5e8f\uff1b\u5982\u679c\u5b50\u7c7b\u6539\u5199\u4e86\u7236\u7c7b\u7684\u865a\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u4f1a\u7528\u5b50\u7c7b\u81ea\u5df1\u7684\u865a\u51fd\u6570\u8986\u76d6\u76f8\u5e94\u7684\u7236\u7c7b\u865a\u51fd\u6570\uff1b\u5982\u679c\u5b50\u7c7b\u6709\u65b0\u7684\u865a\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u6dfb\u52a0\u5230\u7b2c\u4e00\u4e2a\u865a\u51fd\u6570\u8868\u7684\u672b\u5c3e\u3002","title":"\u865a\u51fd\u6570\u5b9e\u73b0\u4e86C++\u7684\u591a\u6001"},{"location":"c_base/virtual/#_1","text":"\u5728\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u865a\u51fd\u6570\u4e0d\u4f1a\u51fa\u73b0\u9884\u671f\u884c\u4e3a: \u5728\u57fa\u7c7b\u7684constructor\u548cdestructor\u5185\uff0c\u56e0\u4e3a\u5f53\u6211\u4eec\u6784\u9020\u6d3e\u751f\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4f1a\u9996\u5148\u8c03\u7528\u57fa\u7c7b\u7684constructor\uff0c\u82e5\u57fa\u7c7b\u4e2d\u5b58\u5728\u865a\u51fd\u6570\uff0c\u5219\u8c03\u7528\u7684\u662f\u4e00\u5b9a\u662f\u57fa\u7c7b\u81ea\u8eab\u7684\uff0c\u800c\u975e\u6d3e\u751f\u7c7b\u7684\uff0c\u56e0\u4e3a\u6b64\u65f6\u6d3e\u751f\u7c7b\u7684data members\u5c1a\u672a\u521d\u59cb\u5316\uff1b\u540c\u7406\uff0c\u5728\u57fa\u7c7bdeconstructor\u4e2d\u5b58\u5728\u865a\u51fd\u6570\u4e5f\u9002\u7528\u6b64\u89c4\u5219\uff0c\u56e0\u4e3a\u6d3e\u751f\u7c7b\u7684deconstructor\u5148\u88ab\u8c03\u7528\uff0c\u5176date members\u5df2\u7ecf\u88ab\u91ca\u653e\u3002 \u5f53\u6211\u4eec\u4f7f\u7528\u57fa\u7c7b\u7684\u5bf9\u8c61\uff0c\u800c\u975e\u6307\u9488\u6216\u5f15\u7528\u65f6\uff1b\u4e3a\u4e86\u80fd\u5728\u5355\u4e00\u5bf9\u8c61\u4e2d\u5c55\u73b0\u591a\u79cd\u578b\u522b\uff0c\u591a\u6001\u9700\u8981\u4e00\u5c42\u95f4\u63a5\u6027\uff0c\u5728C++\u4e2d\uff0c \u60df\u6709\u4ee5\u57fa\u7c7b\u7684\u6307\u9488\u548c\u5f15\u7528\u624d\u80fd\u652f\u6301\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u6982\u5ff5 \u3002\u5f53\u6211\u4eec\u4e3a\u57fa\u7c7b\u58f0\u660e\u4e00\u4e2a\u5b9e\u9645\u5bf9\u8c61\u65f6\uff0c\u540c\u65f6\u4e5f\u5c31\u914d\u7f6e\u51fa\u8db3\u4ee5\u5bb9\u7eb3\u8be5\u5bf9\u8c61\u7684\u5b9e\u9645\u5185\u5b58\u7a7a\u95f4\uff0c\u5982\u679c\u4f20\u5165\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\uff0c\u90a3\u4e48\u5c31\u4e0d\u4e00\u5b9a\u6709\u8db3\u591f\u7684\u5185\u5b58\u653e\u7f6e\u6d3e\u751f\u7c7b\u7684\u5404\u4e2adata members, \u90a3\u4e9b\u5c5e\u4e8e\u6d3e\u751f\u7c7b\u800c\u975e\u57fa\u7c7b\u7684\u6210\u5458\u5c06\u88ab\u5207\u6389\u3002","title":"\u865a\u51fd\u6570\u7684\u9759\u6001\u51b3\u8bae"},{"location":"c_base/virtual/#_2","text":"\u5728\u666e\u901a\u7684\u7eaf\u865a\u51fd\u6570\u540e\u9762\u52a0\u4e0a\u201c=0\u201d\uff0c eg. virtual void test() = 0; \u2003\u4f55\u65f6\u4f7f\u7528\u7eaf\u865a\u51fd\u6570: \u5f53\u60f3\u5728\u57fa\u7c7b\u4e2d\u62bd\u8c61\u51fa\u4e00\u4e2a\u65b9\u6cd5\uff0c\u4e14\u8be5\u57fa\u7c7b\u53ea\u505a\u80fd\u88ab\u7ee7\u627f\uff08\u5373\u4e3a\u62bd\u8c61\u57fa\u7c7b\uff09\uff0c\u800c\u4e0d\u80fd\u88ab\u5b9e\u4f8b\u5316\uff1b \u8fd9\u4e2a\u65b9\u6cd5\u5fc5\u987b\u5728\u6d3e\u751f\u7c7b(derived class)\u4e2d\u88ab\u5b9e\u73b0\uff1b \u5982\u679c\u6ee1\u8db3\u4ee5\u4e0a\u4e24\u70b9\uff0c\u53ef\u4ee5\u8003\u8651\u5c06\u8be5\u65b9\u6cd5\u7533\u660e\u4e3apure virtual function; \u53ef\u4ee5\u4e3a\u7eaf\u865a\u51fd\u6570\u63d0\u4f9b\u5b9a\u4e49\uff0c\u4e0d\u8fc7\u51fd\u6570\u4f53\u5fc5\u987b\u5b9a\u4e49\u5728\u7c7b\u7684\u5916\u90e8\u3002","title":"\u7eaf\u865a\u51fd\u6570"},{"location":"os/0_index/","text":"\u8bf4\u660e \u2003linux os\u524d\u56db\u9879\u4e3b\u8981\u662f\u57fa\u4e8elinux 0.1x\u7248\u672c\u603b\u7ed3\u7684\u90e8\u5206\u57fa\u7840\uff0c\u5173\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u6838\u5fc3\u7684\u77e5\u8bc6\u70b9 \u4ece\u7b2c5\u9879\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u5f00\u59cb\u3002","title":"home"},{"location":"os/0_index/#_1","text":"linux os\u524d\u56db\u9879\u4e3b\u8981\u662f\u57fa\u4e8elinux 0.1x\u7248\u672c\u603b\u7ed3\u7684\u90e8\u5206\u57fa\u7840\uff0c\u5173\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u6838\u5fc3\u7684\u77e5\u8bc6\u70b9 \u4ece\u7b2c5\u9879\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u5f00\u59cb\u3002","title":"\u8bf4\u660e"},{"location":"os/1_introduction/","text":"\u7b80\u4ecb 16\u4f4dCPU\u5bc4\u5b58\u5668\u7ed3\u6784 1. I/O \u7aef\u53e3\u5bfb\u5740\u548c\u8bbf\u95ee\u63a7\u5236\u65b9\u5f0f \u2003 \u5728 CPU \u548c I/O \u9002\u914d\u5668\u4e4b\u95f4\u5f00\u59cb\u4f20\u8f93\u6570\u636e\u65f6\uff0c\u9996\u5148\u9700\u8981\u786e\u5b9a\u9002\u914d\u5668\u7684I/O\u4f4d\u7f6e\uff0c\u5373\u7aef\u53e3\u5730\u5740\u3002 \u7aef\u53e3\u5730\u5740\u7684\u8bbe\u7f6e\u65b9\u6cd5\u4e00\u822c\u6709\u4e24\u79cd \u7edf\u4e00\u7f16\u5740\u548c\u72ec\u7acb\u7f16\u5740 \u3002 \u2003 \u7aef\u53e3\u7edf\u4e00\u7f16\u5740\u7684\u539f\u7406\u662f\u628a I/O \u63a7\u5236\u5668\u4e2d\u7684\u7aef\u53e3\u5730\u5740\u5f52\u5165\u5b58\u50a8\u5668\u5bfb\u5740\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u5185\u3002\u56e0\u6b64\u8fd9\u79cd\u7f16\u5740\u65b9\u5f0f\u4e5f\u6210\u4e3a\u5b58\u50a8\u5668\u6620\u50cf\u7f16\u5740\u3002CPU \u8bbf\u95ee\u4e00\u4e2a\u7aef\u53e3\u7684\u64cd\u4f5c\u4e0e\u8bbf\u95ee\u5185\u5b58\u7684\u64cd\u4f5c\u4e00\u6837\uff0c\u4e5f\u4f7f\u7528\u8bbf\u95ee\u5185\u5b58\u7684\u6307\u4ee4\u3002 \u2003 \u7aef\u53e3\u72ec\u7acb\u7f16\u5740\u7684\u65b9\u6cd5\u662f\u628a I/O \u63a7\u5236\u5668\u548c\u63a7\u5236\u5361\u7684\u5bfb\u5740\u7a7a\u95f4\u5355\u72ec\u4f5c\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\u5bf9\u5f85\uff0c\u79f0\u4e3a I/O \u5730\u5740\u7a7a\u95f4\u3002\u6bcf\u4e2a\u7aef\u53e3\u6709\u4e00\u4e2a I/O \u5730\u5740\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5e76\u4e14\u4f7f\u7528\u4e13\u95e8\u7684 I/O \u6307\u4ee4\u6765\u8bbf\u95ee\u7aef\u53e3\u3002 2. \u4e3b\u5b58\u50a8\u5668\u3001BIOS \u548c CMOS \u5b58\u50a8\u5668 \u2003 \u5178\u578b PC \u673a\u4e0a\u901a\u5e38\u542b\u6709\u4e09\u79cd\u7c7b\u578b\u7684\u5b58\u50a8\u5668\uff0c\u4e00\u79cd\u662f\u7528\u6765\u8fd0\u884c\u7a0b\u5e8f\u548c\u4e34\u65f6\u4fdd\u5b58\u6570\u636e\u7684\u5185\u5b58\u5b58\u50a8\u5668\uff0c\u4e00\u79cd\u662f\u5b58\u653e\u7740\u7cfb\u7edf\u5f00\u673a\u8bca\u65ad\u548c\u521d\u59cb\u5316\u786c\u4ef6\u7a0b\u5e8f\u7684 ROM\uff08BIOS\uff09\uff0c\u53e6\u4e00\u79cd\u662f\u7528\u6765\u5b58\u653e\u5b58\u8ba1\u7b97\u673a\u5b9e\u65f6\u65f6\u949f\u4fe1\u606f\u548c\u7cfb\u7edf\u786c\u4ef6\u914d\u7f6e\u4fe1\u606f\u7684\u5c11\u91cf CMOS \u5b58\u50a8\u5668\u3002 \u542f\u52a8: \u2003 \u5f53\u8ba1\u7b97\u673a\u542f\u52a8\u65f6\uff0cCPU\u4f1a\u81ea\u52a8\u8bbe\u7f6e\u4ee3\u7801\u6bb5\u5bc4\u5b58\u5668CS=0xF000, IP=0xFFF0, \u6b64\u65f6CPU\u4ee3\u7801\u6307\u5411\u5185\u5b58\u4e2d\u6700\u540e\u4e00\u4e2a64KB\u7684\u6700\u540e16\u5b57\u8282\u5904\uff0c\u8fd9\u91cc\u6b63\u662f\u7cfb\u7edf ROM BIOS\u5b58\u653e\u7684\u4f4d\u7f6e\u3002\u5e76\u4e14 BIOS \u4f1a\u5728\u8fd9\u91cc\u5b58\u653e\u4e00\u6761\u8df3\u8f6c\u6307\u4ee4 JMP \u8df3\u8f6c\u5230 BIOS \u4ee3\u7801\u4e2d 64KB \u8303\u56f4\u5185\u7684\u67d0\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u6267\u884c\u3002 \u2003 \u56e0\u6b64\u4e3a\u4e86\u80fd\u591f\u6267\u884c\u6216\u8bbf\u95ee BIOS \u4e2d\u8d85\u8fc7 64KB \u8303\u56f4\u800c\u53c8\u8fdc\u8fdc\u4e0d\u5728 0--1M \u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u5176\u4ed6 BIOS \u4ee3\u7801 \u6216\u6570\u636e\uff0cBIOS \u7a0b\u5e8f\u4f1a\u9996\u5148\u4f7f\u7528 32 \u4f4d\u8bbf\u95ee\u65b9\u5f0f\u628a\u6570\u636e\u6bb5\u5bc4\u5b58\u5668\u7684\u8bbf\u95ee\u8303\u56f4\u8bbe\u7f6e\u6210 4G\uff08\u800c\u975e\u539f\u6765\u7684 64K\uff09\uff0c \u8fd9\u6837 CPU \u5c31\u53ef\u4ee5\u5728 0 \u5230 4G \u8303\u56f4\u5185\u6267\u884c\u548c\u64cd\u4f5c\u6570\u636e\u3002\u6b64\u540e\uff0cBIOS \u5728\u6267\u884c\u4e86\u4e00\u4e9b\u5217\u786c\u4ef6\u68c0\u6d4b\u548c\u521d\u59cb\u5316\u64cd\u4f5c \u4e4b\u540e\uff0c\u5c31\u4f1a\u628a\u4e0e\u539f\u6765 PC \u673a\u517c\u5bb9\u7684 64KB BIOS \u4ee3\u7801\u548c\u6570\u636e\u590d\u5236\u5230\u5185\u5b58\u4f4e\u7aef 1M \u672b\u7aef\u7684 64K \u5904\uff0c\u7136\u540e\u8df3\u8f6c\u5230 \u8fd9\u4e2a\u5730\u65b9\u5e76\u8ba9 CPU \u771f\u6b63\u8fd0\u884c\u5728\u5b9e\u5730\u5740\u6a21\u5f0f\u4e0b\uff0c\u6700\u540e BIOS \u5c31\u4f1a\u4ece\u786c\u76d8\u6216\u5176\u4ed6\u5757\u8bbe\u5907\u628a\u64cd\u4f5c\u7cfb\u7edf\u5f15\u5bfc\u7a0b\u5e8f\u52a0\u8f7d\u5230\u5185\u5b58 0x7c00 \u5904\uff0c\u5e76\u8df3\u8f6c\u5230\u8fd9\u4e2a\u5730\u65b9\u7ee7\u7eed\u6267\u884c\u5f15\u5bfc\u7a0b\u5e8f\u3002","title":"1_\u5f00\u59cb"},{"location":"os/1_introduction/#_1","text":"16\u4f4dCPU\u5bc4\u5b58\u5668\u7ed3\u6784","title":"\u7b80\u4ecb"},{"location":"os/1_introduction/#1-io","text":"\u5728 CPU \u548c I/O \u9002\u914d\u5668\u4e4b\u95f4\u5f00\u59cb\u4f20\u8f93\u6570\u636e\u65f6\uff0c\u9996\u5148\u9700\u8981\u786e\u5b9a\u9002\u914d\u5668\u7684I/O\u4f4d\u7f6e\uff0c\u5373\u7aef\u53e3\u5730\u5740\u3002 \u7aef\u53e3\u5730\u5740\u7684\u8bbe\u7f6e\u65b9\u6cd5\u4e00\u822c\u6709\u4e24\u79cd \u7edf\u4e00\u7f16\u5740\u548c\u72ec\u7acb\u7f16\u5740 \u3002 \u2003 \u7aef\u53e3\u7edf\u4e00\u7f16\u5740\u7684\u539f\u7406\u662f\u628a I/O \u63a7\u5236\u5668\u4e2d\u7684\u7aef\u53e3\u5730\u5740\u5f52\u5165\u5b58\u50a8\u5668\u5bfb\u5740\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u5185\u3002\u56e0\u6b64\u8fd9\u79cd\u7f16\u5740\u65b9\u5f0f\u4e5f\u6210\u4e3a\u5b58\u50a8\u5668\u6620\u50cf\u7f16\u5740\u3002CPU \u8bbf\u95ee\u4e00\u4e2a\u7aef\u53e3\u7684\u64cd\u4f5c\u4e0e\u8bbf\u95ee\u5185\u5b58\u7684\u64cd\u4f5c\u4e00\u6837\uff0c\u4e5f\u4f7f\u7528\u8bbf\u95ee\u5185\u5b58\u7684\u6307\u4ee4\u3002 \u2003 \u7aef\u53e3\u72ec\u7acb\u7f16\u5740\u7684\u65b9\u6cd5\u662f\u628a I/O \u63a7\u5236\u5668\u548c\u63a7\u5236\u5361\u7684\u5bfb\u5740\u7a7a\u95f4\u5355\u72ec\u4f5c\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\u5bf9\u5f85\uff0c\u79f0\u4e3a I/O \u5730\u5740\u7a7a\u95f4\u3002\u6bcf\u4e2a\u7aef\u53e3\u6709\u4e00\u4e2a I/O \u5730\u5740\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5e76\u4e14\u4f7f\u7528\u4e13\u95e8\u7684 I/O \u6307\u4ee4\u6765\u8bbf\u95ee\u7aef\u53e3\u3002","title":"1. I/O \u7aef\u53e3\u5bfb\u5740\u548c\u8bbf\u95ee\u63a7\u5236\u65b9\u5f0f"},{"location":"os/1_introduction/#2-bios-cmos","text":"\u5178\u578b PC \u673a\u4e0a\u901a\u5e38\u542b\u6709\u4e09\u79cd\u7c7b\u578b\u7684\u5b58\u50a8\u5668\uff0c\u4e00\u79cd\u662f\u7528\u6765\u8fd0\u884c\u7a0b\u5e8f\u548c\u4e34\u65f6\u4fdd\u5b58\u6570\u636e\u7684\u5185\u5b58\u5b58\u50a8\u5668\uff0c\u4e00\u79cd\u662f\u5b58\u653e\u7740\u7cfb\u7edf\u5f00\u673a\u8bca\u65ad\u548c\u521d\u59cb\u5316\u786c\u4ef6\u7a0b\u5e8f\u7684 ROM\uff08BIOS\uff09\uff0c\u53e6\u4e00\u79cd\u662f\u7528\u6765\u5b58\u653e\u5b58\u8ba1\u7b97\u673a\u5b9e\u65f6\u65f6\u949f\u4fe1\u606f\u548c\u7cfb\u7edf\u786c\u4ef6\u914d\u7f6e\u4fe1\u606f\u7684\u5c11\u91cf CMOS \u5b58\u50a8\u5668\u3002 \u542f\u52a8: \u2003 \u5f53\u8ba1\u7b97\u673a\u542f\u52a8\u65f6\uff0cCPU\u4f1a\u81ea\u52a8\u8bbe\u7f6e\u4ee3\u7801\u6bb5\u5bc4\u5b58\u5668CS=0xF000, IP=0xFFF0, \u6b64\u65f6CPU\u4ee3\u7801\u6307\u5411\u5185\u5b58\u4e2d\u6700\u540e\u4e00\u4e2a64KB\u7684\u6700\u540e16\u5b57\u8282\u5904\uff0c\u8fd9\u91cc\u6b63\u662f\u7cfb\u7edf ROM BIOS\u5b58\u653e\u7684\u4f4d\u7f6e\u3002\u5e76\u4e14 BIOS \u4f1a\u5728\u8fd9\u91cc\u5b58\u653e\u4e00\u6761\u8df3\u8f6c\u6307\u4ee4 JMP \u8df3\u8f6c\u5230 BIOS \u4ee3\u7801\u4e2d 64KB \u8303\u56f4\u5185\u7684\u67d0\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u6267\u884c\u3002 \u2003 \u56e0\u6b64\u4e3a\u4e86\u80fd\u591f\u6267\u884c\u6216\u8bbf\u95ee BIOS \u4e2d\u8d85\u8fc7 64KB \u8303\u56f4\u800c\u53c8\u8fdc\u8fdc\u4e0d\u5728 0--1M \u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u5176\u4ed6 BIOS \u4ee3\u7801 \u6216\u6570\u636e\uff0cBIOS \u7a0b\u5e8f\u4f1a\u9996\u5148\u4f7f\u7528 32 \u4f4d\u8bbf\u95ee\u65b9\u5f0f\u628a\u6570\u636e\u6bb5\u5bc4\u5b58\u5668\u7684\u8bbf\u95ee\u8303\u56f4\u8bbe\u7f6e\u6210 4G\uff08\u800c\u975e\u539f\u6765\u7684 64K\uff09\uff0c \u8fd9\u6837 CPU \u5c31\u53ef\u4ee5\u5728 0 \u5230 4G \u8303\u56f4\u5185\u6267\u884c\u548c\u64cd\u4f5c\u6570\u636e\u3002\u6b64\u540e\uff0cBIOS \u5728\u6267\u884c\u4e86\u4e00\u4e9b\u5217\u786c\u4ef6\u68c0\u6d4b\u548c\u521d\u59cb\u5316\u64cd\u4f5c \u4e4b\u540e\uff0c\u5c31\u4f1a\u628a\u4e0e\u539f\u6765 PC \u673a\u517c\u5bb9\u7684 64KB BIOS \u4ee3\u7801\u548c\u6570\u636e\u590d\u5236\u5230\u5185\u5b58\u4f4e\u7aef 1M \u672b\u7aef\u7684 64K \u5904\uff0c\u7136\u540e\u8df3\u8f6c\u5230 \u8fd9\u4e2a\u5730\u65b9\u5e76\u8ba9 CPU \u771f\u6b63\u8fd0\u884c\u5728\u5b9e\u5730\u5740\u6a21\u5f0f\u4e0b\uff0c\u6700\u540e BIOS \u5c31\u4f1a\u4ece\u786c\u76d8\u6216\u5176\u4ed6\u5757\u8bbe\u5907\u628a\u64cd\u4f5c\u7cfb\u7edf\u5f15\u5bfc\u7a0b\u5e8f\u52a0\u8f7d\u5230\u5185\u5b58 0x7c00 \u5904\uff0c\u5e76\u8df3\u8f6c\u5230\u8fd9\u4e2a\u5730\u65b9\u7ee7\u7eed\u6267\u884c\u5f15\u5bfc\u7a0b\u5e8f\u3002","title":"2. \u4e3b\u5b58\u50a8\u5668\u3001BIOS \u548c CMOS \u5b58\u50a8\u5668"},{"location":"os/2_as86/","text":"\u6c47\u7f16\u8bed\u6cd5 1. as86 \u2003\u6c47\u7f16\u5668\u7f16\u8bd1\u4ea7\u751f\u7684\u76ee\u6807\u6587\u4ef6 objfile \u901a\u5e38\u8d77\u7801\u5305\u542b\u4e09\u4e2a\u6bb5\u6216\u533a3\uff08section\uff09\uff0c\u5373\u6b63\u6587\u6bb5\uff08.text\uff09\u3001\u6570\u636e\u6bb5\uff08.data\uff09\u548c\u672a\u521d\u59cb\u5316\u6570\u636e\u6bb5\uff08.bss\uff09 \u2003as86 \u6c47\u7f16\u8bed\u8a00\u7a0b\u5e8f\u4e2d\uff0c\u51e1\u662f\u4ee5\u611f\u53f9\u53f7'!'\u6216\u5206\u53f7';'\u5f00\u59cb\u7684\u8bed\u53e5\u5176\u540e\u9762\u5747\u4e3a\u6ce8\u91ca\u6587\u5b57\u3002\u6ce8\u91ca\u8bed\u53e5\u53ef\u4ee5\u653e\u5728\u4efb\u4f55\u8bed\u53e5\u7684\u540e\u9762\uff0c\u4e5f\u53ef\u4ee5\u4ece\u4e00\u4e2a\u65b0\u884c\u5f00\u59cb\u3002 \u2003\u6c47\u7f16\u6307\u793a\u7b26(\u6c47\u7f16\u4f2a\u6307\u4ee4 or \u4f2a\u64cd\u4f5c\u7b26):\u4ee5\u5b57\u7b26\u2018.\u2019\u5f00\u59cb\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5728\u7f16\u8bd1\u65f6\u4ea7\u751f\u4efb\u4f55\u4ee3\u7801\u3002\u6c47\u7f16\u6307\u793a\u7b26\u7531\u4e00\u4e2a\u4f2a\u64cd\u4f5c\u7801\uff0c\u540e\u8ddf 0 \u4e2a\u6216\u591a\u4e2a\u64cd\u4f5c\u6570\u7ec4\u6210\u3002 \u4ee5\u4e0b\u9762\u4e3a\u4f8b\uff0cglobl\u5373\u662f\u4f2a\u64cd\u4f5c\u7801\uff0c\u540e\u9762\u7684\u6807\u53f7begtext\u5373\u662f\u64cd\u4f5c\u6570\u3002\uff08\u6807\u53f7\u5373\u540e\u9762\u5e26\u2018:\u2019\u7684\u6807\u8bc6\u7b26\uff09\u3002 eg. .globl begtext, begdata, begbss, endtext, enddata, endbss .text begtext: .data begdata: .bss begbss: .text \u2018globl'\u2019\u4f2a\u64cd\u4f5c\u7b26\u7528\u4e8e\u5b9a\u4e49\u968f\u540e\u7684\u6807\u53f7\u6807\u8bc6\u7b26\u662f\u5916\u90e8\u7684\u6216\u5168\u5c40\u7684\uff0c\u5e76\u4e14\u5373\u4f7f\u4e0d\u4f7f\u7528\u4e5f\u5f3a\u5236\u5f15\u5165; \u2018.text\u2019\u7528\u4e8e\u6807\u8bc6\u6b63\u6587\u6bb5\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u5e76\u628a\u5f53\u524d\u6bb5\u5207\u6362\u5230text\u6bb5; '.data'\u7528\u4e8e\u6807\u8bc6\u6570\u636e\u6bb5\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u5e76\u628a\u5f53\u524d\u6bb5\u5207\u6362\u5230 data\u6bb5\uff1b\u800c'.bbs'\u5219\u7528\u4e8e\u6807\u8bc6\u4e00\u4e2a\u672a\u521d\u59cb\u5316\u6570\u636e\u6bb5\u7684\u5f00\u59cb\uff0c\u5e76\u628a\u5f53\u524d\u6bb5\u6539\u53d8\u6210 bbs \u6bb5\u3002 \u2003\u7acb\u5373\u6570\u524d\u4e00\u5b9a\u8981\u52a0 '#' \uff0c\u5426\u5219\u5c06\u4f5c\u4e3a\u5185\u5b58\u5730\u5740\u4f7f\u7528\u800c\u4f7f\u8bed\u53e5\u53d8\u6210\u7edd\u5bf9\u5bfb\u5740\u8bed\u53e5\uff1a mov ax, #123; \uff01\u8fd9\u91cc\u5b58\u5165ax\u7684\u662f\u5341\u8fdb\u5236123\uff0c\u82e5\u5b58\u5165\u5341\u516d\u8fdb\u5236\uff0c\u5219\u4e3a0x123\u3002 \u628a\u4e00\u4e2a\u6807\u53f7\uff08\u4f8b\u5982 msg1\uff09\u7684\u5730\u5740\u503c\u653e\u5165\u5bc4\u5b58\u5668\u4e2d\u65f6\u4e5f\u4e00\u5b9a\u8981\u5728\u524d\u9762\u52a0'#'\uff0c\u5426\u5219\u4f1a\u53d8\u6210\u628a msg1 \u5730\u5740\u5904\u7684\u5185\u5bb9\u653e\u5230\u4e86\u5bc4\u5b58\u5668\u4e2d\u3002 mov ax, #msg1 \u2003\u5b9a\u4e49\u5b57\u7b26\u4e32\u9700\u8981\u4f2a\u64cd\u4f5c\u7b26\u2018.ascii\u2019,\u5e76\u4e14\u9700\u8981\u4f7f\u7528\u53cc\u5f15\u53f7\u62ec\u4f4f\u5b57\u7b26\u4e32\uff1b\u800c\u4f2a\u64cd\u4f5c\u7b26\u2019.asciiz\u2019\u8fd8\u4f1a\u5728\u5b57\u7b26\u4e32\u540e\u6dfb\u52a0\u4e00\u4e2aNULL(0)\u5b57\u7b26\uff1b \u5b9a\u4e49\u5b57\u7b26\u9700\u8981\u4f2a\u64cd\u4f5c\u7b26\u2019.byte\u2019\uff0c\u4f7f\u7528\u5355\u5f15\u53f7\u628a\u5b57\u7b26\u62ec\u4f4f\uff1b .ascii \u201chello world\u201d .byte 12 ! \u76f4\u63a5\u4f7f\u7528ascii\u7801 .byte \u2018D\u2019 \u2003'.org' \u5b9a\u4e49\u4e86\u5f53\u524d\u6c47\u7f16\u7684\u4f4d\u7f6e\u3002\u8fd9\u6761\u8bed\u53e5\u4f1a\u628a\u6c47\u7f16\u5668\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u5f53\u524d\u6bb5\u7684\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u8c03\u6574\u4e3a\u8be5\u4f2a\u64cd\u4f5c\u7b26\u8bed\u53e5\u4e0a\u7ed9\u51fa\u503c\u3002 \u2003\u4f2a\u64cd\u4f5c\u7b26 '.word' \u7528\u4e8e\u5728\u5f53\u524d\u4f4d\u7f6e\u5b9a\u4e49\u4e00\u4e2a\u53cc\u5b57\u8282\u5185\u5b58\u5bf9\u8c61\uff08\u53d8\u91cf\uff09\uff0c\u5176\u540e\u53ef\u4ee5\u662f\u4e00\u4e2a\u6570\u6216\u8005\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002 2. build and link for as86 as86 -0 -a -o boot.o boot.s ld86 -0 -s -o boot boot.o \u2003\u5176\u4e2d\u9009\u9879'-0'\u7528\u4e8e\u751f\u6210 8086 \u7684 16\u4f4d\u76ee\u6807\u7a0b\u5e8f\uff1b'-a'\u7528\u4e8e\u6307\u5b9a\u751f\u6210\u4e0e GNU as \u548c ld \u90e8\u5206\u517c\u5bb9\u7684\u4ee3\u7801\u3002'-s'\u9009\u9879\u7528\u4e8e\u544a\u8bc9\u94fe\u63a5\u5668\u8981\u53bb\u9664\u6700\u540e\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u7b26\u53f7\u4fe1\u606f\u3002'-o' \u6307\u5b9a\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u540d\u79f0\u3002 \u2003as86 \u6c47\u7f16\u5668\u4ec5\u7528\u4e8e\u7f16\u8bd1\u5185\u6838\u4e2d\u7684 boot/bootsect.s\u4ee5\u53ca\u5f15\u5bfc\u6247\u533a\u7a0b\u5e8f\u548c\u5b9e\u6a21\u5f0f\u4e0b\u7684\u8bbe\u7f6e\u7a0b\u5e8fboot/setup.s\u3002 \u5185\u6838\u4e2d\u5176\u4f59\u6240\u6709\u6c47\u7f16\u8bed\u8a00\u7a0b\u5e8f\uff08\u5305\u62ec C \u8bed\u8a00\u4ea7\u751f\u7684\u6c47\u7f16\u7a0b\u5e8f\uff09\u5747\u4f7f\u7528 gas \uff08\u7b80\u79f0as\uff09\u6765\u7f16\u8bd1\uff0c\u5e76\u4e0e C\u8bed\u8a00\u7a0b\u5e8f\u7f16\u8bd1\u4ea7\u751f\u7684\u6a21\u5757\u94fe\u63a5. 3. AT&T\u2014\u2014as\u8bed\u6cd5 3.1 \u6c47\u7f16\u5668\u4f7f\u7528 AT&T \u7cfb\u7edf V \u7684\u6c47\u7f16\u8bed\u6cd5\uff08\u4e0b\u9762\u7b80\u79f0\u4e3a AT&T \u8bed\u6cd5\uff09\u3002\u8fd9\u79cd\u8bed\u6cd5\u4e0e Intel \u6c47\u7f16\u7a0b\u5e8f\u4f7f\u7528\u7684\u8bed\u6cd5\uff08\u7b80\u79f0 Intel \u8bed\u6cd5\uff09\u5f88\u4e0d\u4e00\u6837\uff0c\u5b83\u4eec\u4e4b\u95f4\u7684\u4e3b\u8981\u533a\u522b\u6709\u4ee5\u4e0b\u51e0\u70b9\uff1a AT&T \u8bed\u6cd5\u4e2d\u7acb\u5373\u64cd\u4f5c\u6570\u524d\u9762\u8981\u52a0\u4e00\u4e2a\u5b57\u7b26 '$' \uff1b\u5bc4\u5b58\u5668\u64cd\u4f5c\u6570\u540d\u524d\u8981\u52a0\u5b57\u7b26\u767e\u5206\u53f7 '%' ; \u7edd\u5bf9\u8df3\u8f6c/\u8c03\u7528\uff08\u76f8\u5bf9\u4e8e\u4e0e\u7a0b\u5e8f\u8ba1\u6570\u5668\u6709\u5173\u7684\u8df3\u8f6c/\u8c03\u7528\uff09\u64cd\u4f5c\u6570\u524d\u9762\u8981\u52a0\u661f\u53f7'*'\u3002\u800c Intel \u6c47\u7f16\u8bed\u6cd5\u5747\u6ca1\u6709\u8fd9\u4e9b\u9650\u5236\u3002 AT&T \u8bed\u6cd5\u4e0e Intel \u8bed\u6cd5\u4f7f\u7528\u7684\u6e90\u548c\u76ee\u7684\u64cd\u4f5c\u6570\u6b21\u5e8f\u6b63\u597d\u76f8\u53cd\u3002AT&T \u7684\u6e90\u548c\u76ee\u7684\u64cd\u4f5c\u6570\u662f\u4ece\u5de6\u5230\u53f3 '\u6e90, \u76ee\u7684'\u3002\u4f8b\u5982 Intel \u7684\u8bed\u53e5 'add eax, 4' \u5bf9\u5e94 AT&T \u7684 'addl $4, %eax'\u3002 AT&T \u8bed\u6cd5\u4e2d\u5185\u5b58\u64cd\u4f5c\u6570\u7684\u957f\u5ea6\uff08\u5bbd\u5ea6\uff09\u7531\u64cd\u4f5c\u7801\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u6765\u786e\u5b9a\u3002\u64cd\u4f5c\u7801\u540e\u7f00'b'\u3001'w'\u548c'l'\u5206\u522b\u6307\u793a\u5185\u5b58\u5f15\u7528\u5bbd\u5ea6\u4e3a 8 \u4f4d\u5b57\u8282\uff08byte\uff09\u300116 \u4f4d\u5b57\uff08word\uff09\u548c 32 \u4f4d\u957f\u5b57\uff08long\uff09\u3002sIntel \u8bed\u6cd5\u5219\u901a\u8fc7\u5728\u5185\u5b58\u64cd\u4f5c\u6570\u524d\u4f7f\u7528\u524d\u7f00'byte prt'\u3001'word ptr'\u548c'dword ptr'\u6765\u8fbe\u5230\u540c\u6837\u76ee\u7684\u3002\u56e0\u6b64\uff0cIntel \u7684\u8bed\u53e5'mov al, byte ptr foo'\u5bf9\u5e94\u4e8e AT&T \u7684\u8bed\u53e5'movb $foo, %al'\u3002 AT&T \u8bed\u6cd5\u4e2d\u7acb\u5373\u5f62\u5f0f\u7684\u8fdc\u8df3\u8f6c\u548c\u8fdc\u8c03\u7528\u4e3a'ljmp/lcall $section, $offset'\uff0c\u800c Intel \u7684\u662f 'jmp/call far section:offset'\u3002\u540c\u6837\uff0cAT&T \u8bed\u6cd5\u4e2d\u8fdc\u8fd4\u56de\u6307\u4ee4'lret $stack-adjust'\u5bf9\u5e94 Intel\u7684'ret far stack-adjust'\u3002 \u7b26\u53f7 :(Label)\u662f\u540e\u9762\u7d27\u968f\u4e00\u4e2a\u5192\u53f7\u7684\u7b26\u53f7\u3002\u6b64\u65f6\u8be5\u7b26\u53f7\u4ee3\u8868\u6d3b\u52a8\u4f4d\u7f6e\u8ba1\u6570\u5668\u7684\u5f53\u524d\u503c\uff1b\u7b26\u53f7\u540d\u4ee5\u4e00\u4e2a\u5b57\u6bcd\u6216'._'\u5b57\u7b26\u4e4b\u4e00\u5f00\u59cb\u3002\u5c40\u90e8\u7b26\u53f7\u7528\u4e8e\u534f\u52a9\u7f16\u8bd1\u5668\u548c\u7a0b\u5e8f\u5458\u4e34\u65f6\u4f7f\u7528\u540d\u79f0\u3002\u5728\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\u5171\u6709 10 \u4e2a\u5c40\u90e8\u7b26\u53f7\u540d\uff08'0'...'9'\uff09\u53ef\u4f9b\u91cd\u590d\u4f7f\u7528\u3002\u4e3a\u4e86\u5b9a\u4e49\u4e00\u4e2a\u5c40\u90e8\u7b26\u53f7\uff0c\u53ea\u8981\u5199\u51fa\u5f62\u5982'N:'\u7684\u6807\u53f7\uff08\u5176\u4e2d N \u4ee3\u8868\u4efb\u4f55\u6570\u5b57\uff09\u3002\u82e5\u662f\u5f15\u7528\u524d\u9762\u6700\u8fd1\u5b9a\u4e49\u7684\u8fd9\u4e2a\u7b26\u53f7\uff0c\u9700\u8981\u5199\u6210'Nb'\uff1b\u82e5\u9700\u5f15\u7528\u4e0b\u4e00\u4e2a\u5b9a\u4e49\u7684\u5c40\u90e8\u6807\u53f7\uff0c\u5219\u9700\u8981\u5199\u6210'Nf'\u3002jmp 1b \u8df3\u8f6c\u5230\u4e4b\u524d\u7684\u6807\u53f71\u5904\uff1bjmp 1f \u8df3\u8f6c\u5230\u4e4b\u540e\u7684\u6807\u53f71\u5904 \u7279\u6b8a\u7b26\u53f7'.'\u8868\u793a as \u6c47\u7f16\u7684\u5f53\u524d\u5730\u5740\u3002 \u6bcf\u4e2a\u533a\u90fd\u6709\u4e00\u4e2a\u4f4d\u7f6e\u8ba1\u6570\u5668\uff08Location Counter\uff09\uff0c\u5b83\u4f1a\u5bf9\u6bcf\u4e2a\u6c47\u7f16\u8fdb\u8be5\u533a\u7684\u5b57\u8282\u8fdb\u884c\u8ba1\u6570\u3002 \u5185\u5b58\u5f15\u7528 section:disp(base, index, scale) 3.2 \u6240\u6709\u6c47\u7f16\u547d\u4ee4\u7684\u540d\u79f0\u90fd\u4ee5'.'\u5f00\u59cb\uff0c\u5176\u4f59\u662f\u5b57\u7b26\uff0c\u5e76\u4e14\u5927\u5c0f\u5199\u65e0\u5173\u3002\u4f46\u662f\u901a\u5e38\u90fd\u4f7f\u7528\u5c0f\u5199\u5b57\u7b26\u3002 .align abs-expr1, abs-expr2, abs-expr3 .align\u7684\u4f5c\u7528\u5728\u4e8e\u5bf9\u6307\u4ee4\u6216\u8005\u6570\u636e\u7684\u5b58\u653e\u5730\u5740\u8fdb\u884c\u5bf9\u9f50\uff0c\u6709\u4e9bCPU\u67b6\u6784\u8981\u6c42\u56fa\u5b9a\u7684\u6307\u4ee4\u957f\u5ea6\u5e76\u4e14\u5b58\u653e\u5730\u5740\u76f8\u5bf9\u4e8e2\u7684\u5e42\u6307\u6570\u5706\u6574\uff0c\u5426\u5219\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\uff0c\u6bd4\u5982ARM\uff1b\u6709\u4e9b\u7cfb\u7edf\u5374\u4e0d\u9700\u8981\uff0c\u5982\u679c\u4e0d\u9075\u5faa\u5730\u5740\u7684\u5706\u6574\u89c4\u5219\uff0c\u7a0b\u5e8f\u4f9d\u7136\u53ef\u4ee5\u6b63\u786e\u6267\u884c\uff0c\u53ea\u662f\u964d\u4f4e\u4e86\u4e00\u4e9b\u6267\u884c\u6548\u7387\uff0c\u6bd4\u5982i386\u3002.align\u7684\u4f5c\u7528\u8303\u56f4\u53ea\u9650\u4e8e\u7d27\u8ddf\u5b83\u7684\u90a3\u6761\u6307\u4ee4\u6216\u8005\u6570\u636e\uff0c\u800c\u63a5\u4e0b\u6765\u7684\u6307\u4ee4\u6216\u8005\u6570\u636e\u7684\u5730\u5740\u7531\u4e0a\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u548c\u5176\u957f\u5ea6\u51b3\u5b9a\u3002 abs-expr1\u5728\u4e0d\u540c\u683c\u5f0f\u7684\u76ee\u6807\u6587\u4ef6\u4e0a\u542b\u4e49\u4e0d\u540c\uff0c\u5728a.out\uff08assembler and link editor output \uff09\u8be5\u8868\u8fbe\u5f0f\u503c\u662f\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u589e\u52a0\u540e\u5176\u4e8c\u8fdb\u5236\u503c\u6700\u53f3\u9762 0 \u503c\u4f4d\u7684\u4e2a\u6570\uff0c\u5373\u662f 2 \u7684 \u6b21\u65b9\u503c\u3002\u4f8b\u5982\uff0c'.align 3'\u8868\u793a\u628a\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u589e\u52a0\u5230 8 \u7684\u500d\u6570\u4e0a\u3002\u5982\u679c\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u672c\u8eab\u5c31\u662f 8 \u7684\u500d\u6570\uff0c\u90a3\u4e48\u5c31\u65e0\u9700\u6539\u53d8\u3002\u4f46\u662f\u5bf9\u4e8e\u4f7f\u7528 ELF\uff08Executable and Linking Format \uff09\u683c\u5f0f\u7684 80X86 \u7cfb\u7edf\uff0c\u8be5\u8868\u8fbe\u5f0f\u503c\u76f4\u63a5\u5c31\u662f\u8981\u6c42\u5bf9\u5176\u7684\u5b57\u8282\u6570\u3002\u4f8b\u5982'.align 8'\u5c31\u662f\u628a\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u589e\u52a0\u5230 8 \u7684\u500d\u6570\u4e0a\u3002 abs-expr2 \u7ed9\u51fa\u7528\u4e8e\u5bf9\u9f50\u800c\u586b\u5145\u7684\u5b57\u8282\u503c abs-expr3 \u7528\u4e8e\u6307\u793a\u5bf9\u9f50\u64cd\u4f5c\u5141\u8bb8\u586b\u5145\u8df3\u8fc7\u7684\u6700\u5927\u5b57\u8282\u6570\u3002\u5982\u679c\u5bf9\u9f50\u64cd\u4f5c\u8981\u6c42\u8df3\u8fc7\u7684\u5b57\u8282\u6570\u5927\u4e8e\u8fd9\u4e2a\u6700\u5927\u503c\uff0c\u90a3\u4e48\u8be5\u5bf9\u9f50\u64cd\u4f5c\u5c31\u88ab\u53d6\u6d88\u3002 .global symbol(\u6216\u8005.globl symbol) \u8be5\u6c47\u7f16\u547d\u4ee4\u4f1a\u4f7f\u5f97\u94fe\u63a5\u5668 ld \u80fd\u770b\u89c1\u7b26\u53f7 symbol\u3002\u5982\u679c\u5728\u6211\u4eec\u7684\u76ee\u6807\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u7b26\u53f7 symbol\uff0c\u90a3\u4e48\u5b83\u7684\u503c\u5c06\u80fd\u88ab\u94fe\u63a5\u8fc7\u7a0b\u4e2d\u7684\u5176\u4ed6\u76ee\u6807\u6587\u4ef6\u4f7f\u7528\u3002\u82e5\u76ee\u6807\u6587\u4ef6\u4e2d\u6ca1\u6709\u5b9a\u4e49\u8be5\u7b26\u53f7\uff0c\u90a3\u4e48\u5b83\u7684\u5c5e\u6027\u5c06\u4ece\u94fe\u63a5\u8fc7\u7a0b\u4e2d\u5176\u4ed6\u76ee\u6807\u6587\u4ef6\u7684\u540c\u540d\u7b26\u53f7\u4e2d\u83b7\u5f97\u3002 .string \"string\" \u5b9a\u4e49\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u9017\u53f7\u5206\u5f00\u7684\u5b57\u7b26\u4e32\u3002\u5728\u5b57\u7b26\u4e32\u4e2d\u53ef\u4ee5\u4f7f\u7528\u8f6c\u4e49\u5b57\u7b26\u3002\u6bcf\u4e2a\u5b57\u7b26\u4e32\u90fd\u81ea\u52a8\u9644\u52a0\u4e00\u4e2aNULL \u5b57\u7b26\u7ed3\u5c3e\u3002 .ascii \"string\"... \u4ece\u4f4d\u7f6e\u8ba1\u6570\u5668\u6240\u503c\u5f53\u524d\u4f4d\u7f6e\u4e3a\u5b57\u7b26\u4e32\u5206\u914d\u7a7a\u95f4\u5e76\u5b58\u50a8\u5b57\u7b26\u4e32\u3002\u53ef\u4f7f\u7528\u9017\u53f7\u5206\u5f00\u5199\u51fa\u591a\u4e2a\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\uff0c'.ascii \"Hellow world!\", \"My assembler\"'\u3002\u8be5\u6c47\u7f16\u547d\u4ee4\u4f1a\u8ba9 as \u628a\u8fd9\u4e9b\u5b57\u7b26\u4e32\u6c47\u7f16\u5728\u8fde\u7eed\u7684\u5730\u5740\u4f4d\u7f6e\u5904\uff0c\u6bcf\u4e2a\u5b57\u7b26\u4e32\u540e\u9762\u4e0d\u4f1a\u81ea\u52a8\u6dfb\u52a0 0\uff08NULL\uff09\u5b57\u8282\u3002 .asciz \"string\"... \u8be5\u6c47\u7f16\u547d\u4ee4\u4e0e'.ascii'\u7c7b\u4f3c\uff0c\u4f46\u662f\u6bcf\u4e2a\u5b57\u7b26\u4e32\u540e\u9762\u4f1a\u81ea\u52a8\u6dfb\u52a0 NULL \u5b57\u7b26\u3002 .byte expressions \u8be5\u6c47\u7f16\u547d\u4ee4\u5b9a\u4e49 0 \u4e2a\u6216\u591a\u4e2a\u7528\u9017\u53f7\u5206\u5f00\u7684\u5b57\u8282\u503c\u3002\u6bcf\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u662f\u4e00\u4e2a\u5b57\u8282\u3002 .quad bignums \u6307\u5b9a 0 \u4e2a\u6216\u591a\u4e2a\u7528\u9017\u53f7\u5206\u5f00\u7684 8 \u5b57\u8282\u5927\u6570 bignum\u3002\u5982\u679c\u5927\u6570\u653e\u4e0d\u8fdb 8 \u4e2a\u5b57\u8282\u4e2d\uff0c\u5219\u53d6\u4f4e8\u4e2a\u5b57\u8282\u3002 3.3 \u2003\u867d\u7136 as \u901a\u5e38\u7528\u6765\u7f16\u5199\u7eaf 32 \u4f4d\u7684 80X86 \u4ee3\u7801\uff0c\u4f46\u662f 1995 \u5e74\u540e\u5b83\u5bf9\u7f16\u5199\u8fd0\u884c\u4e8e\u5b9e\u6a21\u5f0f\u6216 16 \u4f4d\u4fdd\u62a4\u6a21\u5f0f\u7684\u4ee3\u7801\u4e5f\u63d0\u4f9b\u6709\u9650\u7684\u652f\u6301\u3002\u4e3a\u4e86\u8ba9 as \u6c47\u7f16\u65f6\u4ea7\u751f 16 \u4f4d\u4ee3\u7801\uff0c\u9700\u8981\u5728\u8fd0\u884c\u4e8e 16 \u4f4d\u6a21\u5f0f\u7684\u6307\u4ee4\u8bed\u53e5\u4e4b\u524d\u6dfb\u52a0\u6c47\u7f16\u547d\u4ee4'.code16'\uff0c\u5e76\u4e14\u4f7f\u7528\u6c47\u7f16\u547d\u4ee4'.code32'\u8ba9 as \u6c47\u7f16\u5668\u5207\u6362\u56de 32 \u4f4d\u4ee3\u7801\u6c47\u7f16\u65b9\u5f0f\u3002as \u4e0d\u533a\u5206 16 \u4f4d\u548c 32 \u4f4d\u6c47\u7f16\u8bed\u53e5\uff0c\u5728 16 \u4f4d\u548c 32 \u4f4d\u6a21\u5f0f\u4e0b\u6bcf\u6761\u6307\u4ee4\u7684\u529f\u80fd\u5b8c\u5168\u4e00\u6837\u800c\u4e0e\u6a21\u5f0f\u65e0\u5173\u3002as\u603b\u662f\u4e3a\u6c47\u7f16\u8bed\u53e5\u4ea7\u751f 32 \u4f4d\u7684\u6307\u4ee4\u4ee3\u7801\u800c\u4e0d\u7ba1\u6307\u4ee4\u5c06\u8fd0\u884c\u5728 16 \u4f4d\u8fd8\u662f 32 \u4f4d\u6a21\u5f0f\u4e0b\u3002\u5982\u679c\u4f7f\u7528\u6c47\u7f16\u547d\u4ee4'.code16'\u8ba9 as \u5904\u4e8e 16 \u4f4d\u6a21\u5f0f\u4e0b\uff0c\u90a3\u4e48 as \u4f1a\u81ea\u52a8\u4e3a\u6240\u6709\u6307\u4ee4\u52a0\u4e0a\u4e00\u4e2a\u5fc5\u8981\u7684\u64cd\u4f5c\u6570\u5bbd\u5ea6\u524d\u7f00\u800c\u8ba9\u6307\u4ee4\u8fd0\u884c\u5728 16 \u4f4d\u6a21\u5f0f. \u2003\u7531\u4e8e\u5728 1991 \u5e74\u5f00\u53d1 Linux \u5185\u6838 0.12 \u65f6 as \u6c47\u7f16\u5668\u8fd8\u4e0d\u652f\u6301 16 \u4f4d\u4ee3\u7801\uff0c\u56e0\u6b64\u5728\u7f16\u5199\u548c\u6c47\u7f16 0.12 \u5185\u6838\u5b9e\u6a21\u5f0f\u4e0b\u7684\u5f15\u5bfc\u542f\u52a8\u4ee3\u7801\u548c\u521d\u59cb\u5316\u6c47\u7f16\u7a0b\u5e8f\u65f6\u4f7f\u7528\u4e86\u524d\u9762\u4ecb\u7ecd\u7684 as86 \u6c47\u7f16\u5668. 4 \u5d4c\u5165\u5f0f\u6c47\u7f16 \u2003\u57fa\u672c\u683c\u5f0f: __asm__ __volatile__(\u201c\u6c47\u7f16\u8bed\u53e5\u201d : \u8f93\u51fa\u5bc4\u5b58\u5668 : \u8f93\u5165\u5bc4\u5b58\u5668 : \u4f1a\u88ab\u4fee\u6539\u7684\u5bc4\u5b58\u5668); \u9664\u7b2c 1 \u884c\u4ee5\u5916\uff0c\u540e\u9762\u5e26\u5192\u53f7\u7684\u884c\u82e5\u4e0d\u4f7f\u7528\u5c31\u90fd\u53ef\u4ee5\u7701\u7565\u3002\u5176\u4e2d\uff0c\u201c__asm__\u201d\u662f\u5185\u8054\u6c47\u7f16\u8bed\u53e5\u5173\u952e\u8bcd; __volatile__\"\u8868\u793a\u7f16\u8bd1\u5668\u4e0d\u8981\u4f18\u5316\u4ee3\u7801;\u201c\u6c47\u7f16\u8bed\u53e5\u201d\u662f\u4f60\u5199\u6c47\u7f16\u6307\u4ee4\u7684\u5730\u65b9; \u201c\u4f1a\u88ab\u4fee\u6539\u7684\u5bc4\u5b58\u5668\u201d\u8868\u793a\u4f60\u5df2\u5bf9\u5176\u4e2d\u5217\u51fa\u7684\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u8fdb\u884c\u4e86\u6539\u52a8\uff0cgcc \u7f16\u8bd1\u5668\u4e0d\u80fd\u518d\u4f9d\u8d56\u4e8e\u5b83\u539f\u5148\u5bf9\u8fd9\u4e9b\u5bc4\u5b58\u5668\u52a0\u8f7d\u7684\u503c\u3002\u5982\u679c\u5fc5\u8981\u7684\u8bdd\uff0cgcc \u9700\u8981\u91cd\u65b0\u52a0\u8f7d\u8fd9\u4e9b\u5bc4\u5b58\u5668\u3002 __asm__ __violate__ (\"movl %1,%0\" : \"=r\" (result) : \"m\" (input)); \u2003\"movl %1,%0\"\u662f\u6307\u4ee4\u6a21\u677f\uff1b\"%0\"\u548c\"%1\"\u4ee3\u8868\u6307\u4ee4\u7684\u64cd\u4f5c\u6570\uff0c\u79f0\u4e3a\u5360\u4f4d\u7b26\uff0c\u5185\u5d4c\u6c47\u7f16\u9760\u5b83\u4eec\u5c06C \u8bed\u8a00\u8868\u8fbe\u5f0f\u4e0e\u6307\u4ee4\u64cd\u4f5c\u6570\u76f8\u5bf9\u5e94\u3002\u6307\u4ee4\u6a21\u677f\u540e\u9762\u7528\u5c0f\u62ec\u53f7\u62ec\u8d77\u6765\u7684\u662fC\u8bed\u8a00\u8868\u8fbe\u5f0f\uff0c\u672c\u4f8b\u4e2d\u53ea\u6709\u4e24\u4e2a\uff1a\"result\"\u548c\"input\"\uff0c\u4ed6\u4eec\u6309\u7167\u51fa\u73b0\u7684\u987a\u5e8f\u5206 \u522b\u4e0e\u6307\u4ee4\u64cd\u4f5c\u6570\"%0\"\uff0c\"%1\"\u5bf9\u5e94\uff1b\u6ce8\u610f\u5bf9\u5e94\u987a\u5e8f\uff1a\u7b2c\u4e00\u4e2aC \u8868\u8fbe\u5f0f\u5bf9\u5e94\"%0\"\uff1b\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u5bf9\u5e94\"%1\"\uff0c\u4f9d\u6b21\u7c7b\u63a8\uff0c\u64cd\u4f5c\u6570\u81f3\u591a\u670910 \u4e2a\uff0c\u5206\u522b\u7528\"%0\",\"%1\"....\"%9\"\u8868\u793a\u3002 \u2003\"result\"\u524d\u9762\u7684\u9650\u5236\u5b57\u7b26\u4e32\u662f\"=r\"\uff0c\u5176\u4e2d\"=\"\u8868\u793a\"result\"\u662f\u8f93\u51fa\u64cd\u4f5c\u6570\uff0c\"r\" \u8868\u793a\u9700\u8981\u5c06\"result\"\u4e0e\u67d0\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u76f8\u5173\u8054\uff0c\u5148\u5c06\u64cd\u4f5c\u6570\u7684\u503c\u8bfb\u5165\u5bc4\u5b58\u5668\uff0c\u7136\u540e\u5728\u6307\u4ee4\u4e2d\u4f7f\u7528\u76f8\u5e94\u5bc4\u5b58\u5668\uff0c\u800c\u4e0d\u662f\"result\"\u672c\u8eab\u3002 \u2003\"input\"\u524d\u7684\"m\"\u8868\u793a\u64cd\u4f5c\u6570\u653e\u5728\u5185\u5b58\uff0c\u800c\u4e0d\u662f\u5bc4\u5b58\u5668\u4e2d\u3002 \u2003\"r\"\u548c\"m\"\u90fd\u662f\u9650\u5236\u7b26;C\u8868\u8fbe\u5f0f\u6216\u8005\u53d8\u91cf\u4e0e\u5bc4\u5b58\u5668\u7684\u5173\u7cfb\u7531GCC\u81ea\u52a8\u5904\u7406\uff0c\u6211\u4eec\u53ea\u9700\u4f7f\u7528\u9650\u5236\u5b57\u7b26\u4e32\u6307\u5bfcGCC\u5982\u4f55\u5904\u7406\u5373\u53ef\u3002 \u5206\u7c7b \u9650\u5b9a\u7b26 \u63cf\u8ff0 \u901a\u7528\u5bc4\u5b58\u5668 \"a\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165eax \u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u5047\u8bbeeax\u5df2\u7ecf\u88ab\u4f7f\u7528\uff0c\u90a3\u600e\u4e48\u529e\uff1f \u5176\u5b9e\u5f88\u7b80\u5355\uff1a\u56e0\u4e3aGCC \u77e5\u9053eax \u5df2\u7ecf\u88ab\u4f7f\u7528\uff0c\u5b83\u5728\u8fd9\u6bb5\u6c47\u7f16\u4ee3\u7801 \u7684\u8d77\u59cb\u5904\u63d2\u5165\u4e00\u6761\u8bed\u53e5pushl %eax\uff0c\u5c06eax \u5185\u5bb9\u4fdd\u5b58\u5230\u5806\u6808\uff0c\u7136 \u540e\u5728\u8fd9\u6bb5\u4ee3\u7801\u7ed3\u675f\u5904\u518d\u589e\u52a0\u4e00\u6761\u8bed\u53e5popl %eax\uff0c\u6062\u590deax\u7684\u5185\u5bb9. \"b\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165ebx \"c\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165ecx \"d\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165edx \"s\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165esi \"d\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165edi \"q\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165eax\uff0cebx\uff0cecx\uff0cedx\u4e2d\u7684\u4e00\u4e2a \"r\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165\u901a\u7528\u5bc4\u5b58\u5668\uff0c\u4e5f\u5c31\u662feax\uff0cebx\uff0cecx\uff0c edx\uff0cesi\uff0cedi\u4e2d\u7684\u4e00\u4e2a \"A\" \u628aeax\u548cedx\u5408\u6210\u4e00\u4e2a64 \u4f4d\u7684\u5bc4\u5b58\u5668(use long longs) \u5185\u5b58 \"m\" \u5185\u5b58\u53d8\u91cf \"o\" \u64cd\u4f5c\u6570\u4e3a\u5185\u5b58\u53d8\u91cf\uff0c\u4f46\u662f\u5176\u5bfb\u5740\u65b9\u5f0f\u662f\u504f\u79fb\u91cf\u7c7b\u578b\uff0c \u4e5f\u5373\u662f\u57fa\u5740\u5bfb\u5740\uff0c\u6216\u8005\u662f\u57fa\u5740\u52a0\u53d8\u5740\u5bfb\u5740 \"V\" \u64cd\u4f5c\u6570\u4e3a\u5185\u5b58\u53d8\u91cf\uff0c\u4f46\u5bfb\u5740\u65b9\u5f0f\u4e0d\u662f\u504f\u79fb\u91cf\u7c7b\u578b \" \" \u64cd\u4f5c\u6570\u4e3a\u5185\u5b58\u53d8\u91cf\uff0c\u4f46\u5bfb\u5740\u65b9\u5f0f\u4e3a\u81ea\u52a8\u589e\u91cf \"p\" \u64cd\u4f5c\u6570\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5185\u5b58\u5730\u5740\uff08\u6307\u9488\uff09 \u5bc4\u5b58\u5668\u6216\u5185\u5b58 \"g\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165eax\uff0cebx\uff0cecx\uff0cedx\u4e2d\u7684\u4e00\u4e2a\u6216\u8005\u4f5c\u4e3a\u5185\u5b58\u53d8\u91cf \"X\" \u64cd\u4f5c\u6570\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b \u7acb\u5373\u6570 \"I\" 0-31\u4e4b\u95f4\u7684\u7acb\u5373\u6570\uff08\u7528\u4e8e32\u4f4d\u79fb\u4f4d\u6307\u4ee4\uff09 \"J\" 0-63\u4e4b\u95f4\u7684\u7acb\u5373\u6570\uff08\u7528\u4e8e64\u4f4d\u79fb\u4f4d\u6307\u4ee4\uff09 \"N\" 0-255\u4e4b\u95f4\u7684\u7acb\u5373\u6570\uff08\u7528\u4e8eout\u6307\u4ee4\uff09 \"i\" \u7acb\u5373\u6570 \"n\" \u7acb\u5373\u6570\uff0c\u6709\u4e9b\u7cfb\u7edf\u4e0d\u652f\u6301\u9664\u5b57\u4ee5\u5916\u7684\u7acb\u5373\u6570\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u5e94\u8be5\u4f7f\u7528\"n\"\u800c\u4e0d\u662f\"i\" \u5339\u914d \"0\"\uff0c \u8868\u793a\u7528\u5b83\u9650\u5236\u7684\u64cd\u4f5c\u6570\u4e0e\u67d0\u4e2a\u6307\u5b9a\u7684\u64cd\u4f5c\u6570\u5339\u914d\uff0c \"1\" ... \"9\" \u4e5f\u5373\u8be5\u64cd\u4f5c\u6570\u5c31\u662f\u6307\u5b9a\u7684\u90a3\u4e2a\u64cd\u4f5c\u6570\uff0c\u4f8b\u5982\"0\" \u53bb\u63cf\u8ff0\"\uff051\"\u64cd\u4f5c\u6570\uff0c\u90a3\u4e48\"%1\"\u5f15\u7528\u7684\u5176\u5b9e\u5c31 \u662f\"%0\"\u64cd\u4f5c\u6570\uff0c\u6ce8\u610f\u4f5c\u4e3a\u9650\u5b9a\u7b26\u5b57\u6bcd\u76840\uff0d9 \u4e0e \u6307\u4ee4\u4e2d\u7684\"\uff050\"\uff0d\"\uff059\"\u7684\u533a\u522b\uff0c\u524d\u8005\u63cf\u8ff0\u64cd\u4f5c\u6570\uff0c \u540e\u8005\u4ee3\u8868\u64cd\u4f5c\u6570\u3002 : \"=D\" (addr), \"=c\" (cnt) : \"d\" (port), \"0\" (addr), \"1\" (cnt) \u8fd9\u91cc\u76840 \u8868\u793a\u8f93\u5165\u90e8\u5206\u7684addr\u4e0e\u8f93\u51fa\u90e8\u5206\u7684addr\u662f\u540c\u4e00\u4e2a\u53d8\u91cf\uff0c \u5373\u5b83\u4eec\u4f7f\u7528\u76f8\u540c\u5bc4\u5b58\u5668\uff0c\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u4f7f\u7528\u8be5\u5bc4\u5b58\u5668\u539f\u6709\u7684\u503c\u3002 : \"=a\" (__res) : \"0\" (__NR_read), \"b\" ((long)(fd)), \"c\" ((long)(buf)), \"d\" ((long)(n))); \u8fd9\u91cc__res\u662f%0\u64cd\u4f5c\u6570, __NR_read\u662f%1\u64cd\u4f5c\u6570, \u7528\"0\"\u63cf\u8ff0%1\u64cd\u4f5c\u6570, \u5219%1\u5f15\u7528\u7684\u5373\u662f%0, \u5373eax\u5bc4\u5b58\u5668\u3002 & \u8be5\u8f93\u51fa\u64cd\u4f5c\u6570\u4e0d\u80fd\u4f7f\u7528\u8fc7\u548c\u8f93\u5165\u64cd\u4f5c\u6570\u76f8\u540c\u7684\u5bc4\u5b58\u5668 \u64cd\u4f5c\u6570\u7c7b\u578b \"=\" \u64cd\u4f5c\u6570\u5728\u6307\u4ee4\u4e2d\u662f\u53ea\u5199\u7684\uff08\u8f93\u51fa\u64cd\u4f5c\u6570\uff09 \"+\" \u64cd\u4f5c\u6570\u5728\u6307\u4ee4\u4e2d\u662f\u8bfb\u5199\u7c7b\u578b\u7684\uff08\u8f93\u5165\u8f93\u51fa\u64cd\u4f5c\u6570\uff09 \u6d6e\u70b9\u6570 \"f\" \u6d6e\u70b9\u5bc4\u5b58\u5668 \"t\" \u7b2c\u4e00\u4e2a\u6d6e\u70b9\u5bc4\u5b58\u5668 \"u\" \u7b2c\u4e8c\u4e2a\u6d6e\u70b9\u5bc4\u5b58\u5668 \"G\" \u6807\u51c6\u768480387\u6d6e\u70b9\u5e38\u6570 % \u8be5\u64cd\u4f5c\u6570\u53ef\u4ee5\u548c\u4e0b\u4e00\u4e2a\u64cd\u4f5c\u6570\u4ea4\u6362\u4f4d\u7f6e \u4f8b\u5982addl\u7684\u4e24\u4e2a\u64cd\u4f5c\u6570\u53ef\u4ee5\u4ea4\u6362\u987a\u5e8f \uff08\u5f53\u7136\u4e24\u4e2a\u64cd\u4f5c\u6570\u90fd\u4e0d\u80fd\u662f\u7acb\u5373\u6570\uff09 # \u90e8\u5206\u6ce8\u91ca\uff0c\u4ece\u8be5\u5b57\u7b26\u5230\u5176\u540e\u7684\u9017\u53f7\u4e4b\u95f4\u6240\u6709\u5b57\u6bcd\u88ab\u5ffd\u7565 * \u8868\u793a\u5982\u679c\u9009\u7528\u5bc4\u5b58\u5668\uff0c\u5219\u5176\u540e\u7684\u5b57\u6bcd\u88ab\u5ffd\u7565 \u2003 C\u51fd\u6570\u8c03\u7528\u673a\u5236 \uff1a\u8981\u5728\u8fdb\u5165\u51fd\u6570\u65f6\u4e3a\u51fd\u6570\u7684\u5c40\u90e8\u53d8\u91cf\u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5e76\u4e14\u5728\u9000\u51fa\u51fd\u6570\u65f6\u6536\u56de\u8fd9\u90e8\u5206\u7a7a\u95f4\uff0c\u6570\u636e\u7684\u4f20\u9012\u548c\u5c40\u90e8\u53d8\u91cf\u5b58\u50a8\u7a7a\u95f4\u7684\u5206\u914d\u4e0e\u56de\u6536\u5219\u901a\u8fc7\u6808\u64cd\u4f5c\u6765\u5b9e\u73b0\u3002 \u5355\u4e2a\u51fd\u6570\u8c03\u7528\u64cd\u4f5c\u6240\u4f7f\u7528\u7684\u6808\u90e8\u5206\u88ab\u79f0\u4e3a\u6808\u5e27\uff08Stack frame\uff09\u7ed3\u6784 \uff0c\u6808\u5e27\u7ed3\u6784\u7684\u4e24\u7aef\u7531\u4e24\u4e2a\u6307\u9488\u6765\u6307\u5b9a\u3002\u5bc4\u5b58\u5668 ebp \u901a\u5e38\u7528\u4f5c\u5e27\u6307\u9488\uff08frame pointer\uff09\uff0c\u800c esp \u5219\u7528\u4f5c\u6808\u6307\u9488\uff08stack pointer\uff09\u3002\u5728\u51fd\u6570\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6808\u6307\u9488 esp \u4f1a\u968f\u7740\u6570\u636e\u7684\u5165\u6808\u548c\u51fa\u6808\u800c\u79fb\u52a8\uff0c\u56e0\u6b64\u51fd\u6570\u4e2d\u5bf9\u5927\u90e8\u5206\u6570\u636e\u7684\u8bbf\u95ee\u90fd\u57fa\u4e8e\u5e27\u6307\u9488 ebp \u8fdb\u884c\u3002","title":"2_\u6c47\u7f16\u8bed\u6cd5"},{"location":"os/2_as86/#_1","text":"","title":"\u6c47\u7f16\u8bed\u6cd5"},{"location":"os/2_as86/#1-as86","text":"\u6c47\u7f16\u5668\u7f16\u8bd1\u4ea7\u751f\u7684\u76ee\u6807\u6587\u4ef6 objfile \u901a\u5e38\u8d77\u7801\u5305\u542b\u4e09\u4e2a\u6bb5\u6216\u533a3\uff08section\uff09\uff0c\u5373\u6b63\u6587\u6bb5\uff08.text\uff09\u3001\u6570\u636e\u6bb5\uff08.data\uff09\u548c\u672a\u521d\u59cb\u5316\u6570\u636e\u6bb5\uff08.bss\uff09 \u2003as86 \u6c47\u7f16\u8bed\u8a00\u7a0b\u5e8f\u4e2d\uff0c\u51e1\u662f\u4ee5\u611f\u53f9\u53f7'!'\u6216\u5206\u53f7';'\u5f00\u59cb\u7684\u8bed\u53e5\u5176\u540e\u9762\u5747\u4e3a\u6ce8\u91ca\u6587\u5b57\u3002\u6ce8\u91ca\u8bed\u53e5\u53ef\u4ee5\u653e\u5728\u4efb\u4f55\u8bed\u53e5\u7684\u540e\u9762\uff0c\u4e5f\u53ef\u4ee5\u4ece\u4e00\u4e2a\u65b0\u884c\u5f00\u59cb\u3002 \u2003\u6c47\u7f16\u6307\u793a\u7b26(\u6c47\u7f16\u4f2a\u6307\u4ee4 or \u4f2a\u64cd\u4f5c\u7b26):\u4ee5\u5b57\u7b26\u2018.\u2019\u5f00\u59cb\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5728\u7f16\u8bd1\u65f6\u4ea7\u751f\u4efb\u4f55\u4ee3\u7801\u3002\u6c47\u7f16\u6307\u793a\u7b26\u7531\u4e00\u4e2a\u4f2a\u64cd\u4f5c\u7801\uff0c\u540e\u8ddf 0 \u4e2a\u6216\u591a\u4e2a\u64cd\u4f5c\u6570\u7ec4\u6210\u3002 \u4ee5\u4e0b\u9762\u4e3a\u4f8b\uff0cglobl\u5373\u662f\u4f2a\u64cd\u4f5c\u7801\uff0c\u540e\u9762\u7684\u6807\u53f7begtext\u5373\u662f\u64cd\u4f5c\u6570\u3002\uff08\u6807\u53f7\u5373\u540e\u9762\u5e26\u2018:\u2019\u7684\u6807\u8bc6\u7b26\uff09\u3002 eg. .globl begtext, begdata, begbss, endtext, enddata, endbss .text begtext: .data begdata: .bss begbss: .text \u2018globl'\u2019\u4f2a\u64cd\u4f5c\u7b26\u7528\u4e8e\u5b9a\u4e49\u968f\u540e\u7684\u6807\u53f7\u6807\u8bc6\u7b26\u662f\u5916\u90e8\u7684\u6216\u5168\u5c40\u7684\uff0c\u5e76\u4e14\u5373\u4f7f\u4e0d\u4f7f\u7528\u4e5f\u5f3a\u5236\u5f15\u5165; \u2018.text\u2019\u7528\u4e8e\u6807\u8bc6\u6b63\u6587\u6bb5\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u5e76\u628a\u5f53\u524d\u6bb5\u5207\u6362\u5230text\u6bb5; '.data'\u7528\u4e8e\u6807\u8bc6\u6570\u636e\u6bb5\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c\u5e76\u628a\u5f53\u524d\u6bb5\u5207\u6362\u5230 data\u6bb5\uff1b\u800c'.bbs'\u5219\u7528\u4e8e\u6807\u8bc6\u4e00\u4e2a\u672a\u521d\u59cb\u5316\u6570\u636e\u6bb5\u7684\u5f00\u59cb\uff0c\u5e76\u628a\u5f53\u524d\u6bb5\u6539\u53d8\u6210 bbs \u6bb5\u3002 \u2003\u7acb\u5373\u6570\u524d\u4e00\u5b9a\u8981\u52a0 '#' \uff0c\u5426\u5219\u5c06\u4f5c\u4e3a\u5185\u5b58\u5730\u5740\u4f7f\u7528\u800c\u4f7f\u8bed\u53e5\u53d8\u6210\u7edd\u5bf9\u5bfb\u5740\u8bed\u53e5\uff1a mov ax, #123; \uff01\u8fd9\u91cc\u5b58\u5165ax\u7684\u662f\u5341\u8fdb\u5236123\uff0c\u82e5\u5b58\u5165\u5341\u516d\u8fdb\u5236\uff0c\u5219\u4e3a0x123\u3002 \u628a\u4e00\u4e2a\u6807\u53f7\uff08\u4f8b\u5982 msg1\uff09\u7684\u5730\u5740\u503c\u653e\u5165\u5bc4\u5b58\u5668\u4e2d\u65f6\u4e5f\u4e00\u5b9a\u8981\u5728\u524d\u9762\u52a0'#'\uff0c\u5426\u5219\u4f1a\u53d8\u6210\u628a msg1 \u5730\u5740\u5904\u7684\u5185\u5bb9\u653e\u5230\u4e86\u5bc4\u5b58\u5668\u4e2d\u3002 mov ax, #msg1 \u2003\u5b9a\u4e49\u5b57\u7b26\u4e32\u9700\u8981\u4f2a\u64cd\u4f5c\u7b26\u2018.ascii\u2019,\u5e76\u4e14\u9700\u8981\u4f7f\u7528\u53cc\u5f15\u53f7\u62ec\u4f4f\u5b57\u7b26\u4e32\uff1b\u800c\u4f2a\u64cd\u4f5c\u7b26\u2019.asciiz\u2019\u8fd8\u4f1a\u5728\u5b57\u7b26\u4e32\u540e\u6dfb\u52a0\u4e00\u4e2aNULL(0)\u5b57\u7b26\uff1b \u5b9a\u4e49\u5b57\u7b26\u9700\u8981\u4f2a\u64cd\u4f5c\u7b26\u2019.byte\u2019\uff0c\u4f7f\u7528\u5355\u5f15\u53f7\u628a\u5b57\u7b26\u62ec\u4f4f\uff1b .ascii \u201chello world\u201d .byte 12 ! \u76f4\u63a5\u4f7f\u7528ascii\u7801 .byte \u2018D\u2019 \u2003'.org' \u5b9a\u4e49\u4e86\u5f53\u524d\u6c47\u7f16\u7684\u4f4d\u7f6e\u3002\u8fd9\u6761\u8bed\u53e5\u4f1a\u628a\u6c47\u7f16\u5668\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u5f53\u524d\u6bb5\u7684\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u8c03\u6574\u4e3a\u8be5\u4f2a\u64cd\u4f5c\u7b26\u8bed\u53e5\u4e0a\u7ed9\u51fa\u503c\u3002 \u2003\u4f2a\u64cd\u4f5c\u7b26 '.word' \u7528\u4e8e\u5728\u5f53\u524d\u4f4d\u7f6e\u5b9a\u4e49\u4e00\u4e2a\u53cc\u5b57\u8282\u5185\u5b58\u5bf9\u8c61\uff08\u53d8\u91cf\uff09\uff0c\u5176\u540e\u53ef\u4ee5\u662f\u4e00\u4e2a\u6570\u6216\u8005\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002","title":"1. as86"},{"location":"os/2_as86/#2-build-and-link-for-as86","text":"as86 -0 -a -o boot.o boot.s ld86 -0 -s -o boot boot.o \u2003\u5176\u4e2d\u9009\u9879'-0'\u7528\u4e8e\u751f\u6210 8086 \u7684 16\u4f4d\u76ee\u6807\u7a0b\u5e8f\uff1b'-a'\u7528\u4e8e\u6307\u5b9a\u751f\u6210\u4e0e GNU as \u548c ld \u90e8\u5206\u517c\u5bb9\u7684\u4ee3\u7801\u3002'-s'\u9009\u9879\u7528\u4e8e\u544a\u8bc9\u94fe\u63a5\u5668\u8981\u53bb\u9664\u6700\u540e\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u7b26\u53f7\u4fe1\u606f\u3002'-o' \u6307\u5b9a\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u540d\u79f0\u3002 \u2003as86 \u6c47\u7f16\u5668\u4ec5\u7528\u4e8e\u7f16\u8bd1\u5185\u6838\u4e2d\u7684 boot/bootsect.s\u4ee5\u53ca\u5f15\u5bfc\u6247\u533a\u7a0b\u5e8f\u548c\u5b9e\u6a21\u5f0f\u4e0b\u7684\u8bbe\u7f6e\u7a0b\u5e8fboot/setup.s\u3002 \u5185\u6838\u4e2d\u5176\u4f59\u6240\u6709\u6c47\u7f16\u8bed\u8a00\u7a0b\u5e8f\uff08\u5305\u62ec C \u8bed\u8a00\u4ea7\u751f\u7684\u6c47\u7f16\u7a0b\u5e8f\uff09\u5747\u4f7f\u7528 gas \uff08\u7b80\u79f0as\uff09\u6765\u7f16\u8bd1\uff0c\u5e76\u4e0e C\u8bed\u8a00\u7a0b\u5e8f\u7f16\u8bd1\u4ea7\u751f\u7684\u6a21\u5757\u94fe\u63a5.","title":"2. build and link for as86"},{"location":"os/2_as86/#3-attas","text":"","title":"3. AT&amp;T\u2014\u2014as\u8bed\u6cd5"},{"location":"os/2_as86/#31","text":"\u6c47\u7f16\u5668\u4f7f\u7528 AT&T \u7cfb\u7edf V \u7684\u6c47\u7f16\u8bed\u6cd5\uff08\u4e0b\u9762\u7b80\u79f0\u4e3a AT&T \u8bed\u6cd5\uff09\u3002\u8fd9\u79cd\u8bed\u6cd5\u4e0e Intel \u6c47\u7f16\u7a0b\u5e8f\u4f7f\u7528\u7684\u8bed\u6cd5\uff08\u7b80\u79f0 Intel \u8bed\u6cd5\uff09\u5f88\u4e0d\u4e00\u6837\uff0c\u5b83\u4eec\u4e4b\u95f4\u7684\u4e3b\u8981\u533a\u522b\u6709\u4ee5\u4e0b\u51e0\u70b9\uff1a AT&T \u8bed\u6cd5\u4e2d\u7acb\u5373\u64cd\u4f5c\u6570\u524d\u9762\u8981\u52a0\u4e00\u4e2a\u5b57\u7b26 '$' \uff1b\u5bc4\u5b58\u5668\u64cd\u4f5c\u6570\u540d\u524d\u8981\u52a0\u5b57\u7b26\u767e\u5206\u53f7 '%' ; \u7edd\u5bf9\u8df3\u8f6c/\u8c03\u7528\uff08\u76f8\u5bf9\u4e8e\u4e0e\u7a0b\u5e8f\u8ba1\u6570\u5668\u6709\u5173\u7684\u8df3\u8f6c/\u8c03\u7528\uff09\u64cd\u4f5c\u6570\u524d\u9762\u8981\u52a0\u661f\u53f7'*'\u3002\u800c Intel \u6c47\u7f16\u8bed\u6cd5\u5747\u6ca1\u6709\u8fd9\u4e9b\u9650\u5236\u3002 AT&T \u8bed\u6cd5\u4e0e Intel \u8bed\u6cd5\u4f7f\u7528\u7684\u6e90\u548c\u76ee\u7684\u64cd\u4f5c\u6570\u6b21\u5e8f\u6b63\u597d\u76f8\u53cd\u3002AT&T \u7684\u6e90\u548c\u76ee\u7684\u64cd\u4f5c\u6570\u662f\u4ece\u5de6\u5230\u53f3 '\u6e90, \u76ee\u7684'\u3002\u4f8b\u5982 Intel \u7684\u8bed\u53e5 'add eax, 4' \u5bf9\u5e94 AT&T \u7684 'addl $4, %eax'\u3002 AT&T \u8bed\u6cd5\u4e2d\u5185\u5b58\u64cd\u4f5c\u6570\u7684\u957f\u5ea6\uff08\u5bbd\u5ea6\uff09\u7531\u64cd\u4f5c\u7801\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u6765\u786e\u5b9a\u3002\u64cd\u4f5c\u7801\u540e\u7f00'b'\u3001'w'\u548c'l'\u5206\u522b\u6307\u793a\u5185\u5b58\u5f15\u7528\u5bbd\u5ea6\u4e3a 8 \u4f4d\u5b57\u8282\uff08byte\uff09\u300116 \u4f4d\u5b57\uff08word\uff09\u548c 32 \u4f4d\u957f\u5b57\uff08long\uff09\u3002sIntel \u8bed\u6cd5\u5219\u901a\u8fc7\u5728\u5185\u5b58\u64cd\u4f5c\u6570\u524d\u4f7f\u7528\u524d\u7f00'byte prt'\u3001'word ptr'\u548c'dword ptr'\u6765\u8fbe\u5230\u540c\u6837\u76ee\u7684\u3002\u56e0\u6b64\uff0cIntel \u7684\u8bed\u53e5'mov al, byte ptr foo'\u5bf9\u5e94\u4e8e AT&T \u7684\u8bed\u53e5'movb $foo, %al'\u3002 AT&T \u8bed\u6cd5\u4e2d\u7acb\u5373\u5f62\u5f0f\u7684\u8fdc\u8df3\u8f6c\u548c\u8fdc\u8c03\u7528\u4e3a'ljmp/lcall $section, $offset'\uff0c\u800c Intel \u7684\u662f 'jmp/call far section:offset'\u3002\u540c\u6837\uff0cAT&T \u8bed\u6cd5\u4e2d\u8fdc\u8fd4\u56de\u6307\u4ee4'lret $stack-adjust'\u5bf9\u5e94 Intel\u7684'ret far stack-adjust'\u3002 \u7b26\u53f7 :(Label)\u662f\u540e\u9762\u7d27\u968f\u4e00\u4e2a\u5192\u53f7\u7684\u7b26\u53f7\u3002\u6b64\u65f6\u8be5\u7b26\u53f7\u4ee3\u8868\u6d3b\u52a8\u4f4d\u7f6e\u8ba1\u6570\u5668\u7684\u5f53\u524d\u503c\uff1b\u7b26\u53f7\u540d\u4ee5\u4e00\u4e2a\u5b57\u6bcd\u6216'._'\u5b57\u7b26\u4e4b\u4e00\u5f00\u59cb\u3002\u5c40\u90e8\u7b26\u53f7\u7528\u4e8e\u534f\u52a9\u7f16\u8bd1\u5668\u548c\u7a0b\u5e8f\u5458\u4e34\u65f6\u4f7f\u7528\u540d\u79f0\u3002\u5728\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\u5171\u6709 10 \u4e2a\u5c40\u90e8\u7b26\u53f7\u540d\uff08'0'...'9'\uff09\u53ef\u4f9b\u91cd\u590d\u4f7f\u7528\u3002\u4e3a\u4e86\u5b9a\u4e49\u4e00\u4e2a\u5c40\u90e8\u7b26\u53f7\uff0c\u53ea\u8981\u5199\u51fa\u5f62\u5982'N:'\u7684\u6807\u53f7\uff08\u5176\u4e2d N \u4ee3\u8868\u4efb\u4f55\u6570\u5b57\uff09\u3002\u82e5\u662f\u5f15\u7528\u524d\u9762\u6700\u8fd1\u5b9a\u4e49\u7684\u8fd9\u4e2a\u7b26\u53f7\uff0c\u9700\u8981\u5199\u6210'Nb'\uff1b\u82e5\u9700\u5f15\u7528\u4e0b\u4e00\u4e2a\u5b9a\u4e49\u7684\u5c40\u90e8\u6807\u53f7\uff0c\u5219\u9700\u8981\u5199\u6210'Nf'\u3002jmp 1b \u8df3\u8f6c\u5230\u4e4b\u524d\u7684\u6807\u53f71\u5904\uff1bjmp 1f \u8df3\u8f6c\u5230\u4e4b\u540e\u7684\u6807\u53f71\u5904 \u7279\u6b8a\u7b26\u53f7'.'\u8868\u793a as \u6c47\u7f16\u7684\u5f53\u524d\u5730\u5740\u3002 \u6bcf\u4e2a\u533a\u90fd\u6709\u4e00\u4e2a\u4f4d\u7f6e\u8ba1\u6570\u5668\uff08Location Counter\uff09\uff0c\u5b83\u4f1a\u5bf9\u6bcf\u4e2a\u6c47\u7f16\u8fdb\u8be5\u533a\u7684\u5b57\u8282\u8fdb\u884c\u8ba1\u6570\u3002 \u5185\u5b58\u5f15\u7528 section:disp(base, index, scale)","title":"3.1"},{"location":"os/2_as86/#32","text":"\u6240\u6709\u6c47\u7f16\u547d\u4ee4\u7684\u540d\u79f0\u90fd\u4ee5'.'\u5f00\u59cb\uff0c\u5176\u4f59\u662f\u5b57\u7b26\uff0c\u5e76\u4e14\u5927\u5c0f\u5199\u65e0\u5173\u3002\u4f46\u662f\u901a\u5e38\u90fd\u4f7f\u7528\u5c0f\u5199\u5b57\u7b26\u3002 .align abs-expr1, abs-expr2, abs-expr3 .align\u7684\u4f5c\u7528\u5728\u4e8e\u5bf9\u6307\u4ee4\u6216\u8005\u6570\u636e\u7684\u5b58\u653e\u5730\u5740\u8fdb\u884c\u5bf9\u9f50\uff0c\u6709\u4e9bCPU\u67b6\u6784\u8981\u6c42\u56fa\u5b9a\u7684\u6307\u4ee4\u957f\u5ea6\u5e76\u4e14\u5b58\u653e\u5730\u5740\u76f8\u5bf9\u4e8e2\u7684\u5e42\u6307\u6570\u5706\u6574\uff0c\u5426\u5219\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\uff0c\u6bd4\u5982ARM\uff1b\u6709\u4e9b\u7cfb\u7edf\u5374\u4e0d\u9700\u8981\uff0c\u5982\u679c\u4e0d\u9075\u5faa\u5730\u5740\u7684\u5706\u6574\u89c4\u5219\uff0c\u7a0b\u5e8f\u4f9d\u7136\u53ef\u4ee5\u6b63\u786e\u6267\u884c\uff0c\u53ea\u662f\u964d\u4f4e\u4e86\u4e00\u4e9b\u6267\u884c\u6548\u7387\uff0c\u6bd4\u5982i386\u3002.align\u7684\u4f5c\u7528\u8303\u56f4\u53ea\u9650\u4e8e\u7d27\u8ddf\u5b83\u7684\u90a3\u6761\u6307\u4ee4\u6216\u8005\u6570\u636e\uff0c\u800c\u63a5\u4e0b\u6765\u7684\u6307\u4ee4\u6216\u8005\u6570\u636e\u7684\u5730\u5740\u7531\u4e0a\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u548c\u5176\u957f\u5ea6\u51b3\u5b9a\u3002 abs-expr1\u5728\u4e0d\u540c\u683c\u5f0f\u7684\u76ee\u6807\u6587\u4ef6\u4e0a\u542b\u4e49\u4e0d\u540c\uff0c\u5728a.out\uff08assembler and link editor output \uff09\u8be5\u8868\u8fbe\u5f0f\u503c\u662f\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u589e\u52a0\u540e\u5176\u4e8c\u8fdb\u5236\u503c\u6700\u53f3\u9762 0 \u503c\u4f4d\u7684\u4e2a\u6570\uff0c\u5373\u662f 2 \u7684 \u6b21\u65b9\u503c\u3002\u4f8b\u5982\uff0c'.align 3'\u8868\u793a\u628a\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u589e\u52a0\u5230 8 \u7684\u500d\u6570\u4e0a\u3002\u5982\u679c\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u672c\u8eab\u5c31\u662f 8 \u7684\u500d\u6570\uff0c\u90a3\u4e48\u5c31\u65e0\u9700\u6539\u53d8\u3002\u4f46\u662f\u5bf9\u4e8e\u4f7f\u7528 ELF\uff08Executable and Linking Format \uff09\u683c\u5f0f\u7684 80X86 \u7cfb\u7edf\uff0c\u8be5\u8868\u8fbe\u5f0f\u503c\u76f4\u63a5\u5c31\u662f\u8981\u6c42\u5bf9\u5176\u7684\u5b57\u8282\u6570\u3002\u4f8b\u5982'.align 8'\u5c31\u662f\u628a\u4f4d\u7f6e\u8ba1\u6570\u5668\u503c\u589e\u52a0\u5230 8 \u7684\u500d\u6570\u4e0a\u3002 abs-expr2 \u7ed9\u51fa\u7528\u4e8e\u5bf9\u9f50\u800c\u586b\u5145\u7684\u5b57\u8282\u503c abs-expr3 \u7528\u4e8e\u6307\u793a\u5bf9\u9f50\u64cd\u4f5c\u5141\u8bb8\u586b\u5145\u8df3\u8fc7\u7684\u6700\u5927\u5b57\u8282\u6570\u3002\u5982\u679c\u5bf9\u9f50\u64cd\u4f5c\u8981\u6c42\u8df3\u8fc7\u7684\u5b57\u8282\u6570\u5927\u4e8e\u8fd9\u4e2a\u6700\u5927\u503c\uff0c\u90a3\u4e48\u8be5\u5bf9\u9f50\u64cd\u4f5c\u5c31\u88ab\u53d6\u6d88\u3002 .global symbol(\u6216\u8005.globl symbol) \u8be5\u6c47\u7f16\u547d\u4ee4\u4f1a\u4f7f\u5f97\u94fe\u63a5\u5668 ld \u80fd\u770b\u89c1\u7b26\u53f7 symbol\u3002\u5982\u679c\u5728\u6211\u4eec\u7684\u76ee\u6807\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u7b26\u53f7 symbol\uff0c\u90a3\u4e48\u5b83\u7684\u503c\u5c06\u80fd\u88ab\u94fe\u63a5\u8fc7\u7a0b\u4e2d\u7684\u5176\u4ed6\u76ee\u6807\u6587\u4ef6\u4f7f\u7528\u3002\u82e5\u76ee\u6807\u6587\u4ef6\u4e2d\u6ca1\u6709\u5b9a\u4e49\u8be5\u7b26\u53f7\uff0c\u90a3\u4e48\u5b83\u7684\u5c5e\u6027\u5c06\u4ece\u94fe\u63a5\u8fc7\u7a0b\u4e2d\u5176\u4ed6\u76ee\u6807\u6587\u4ef6\u7684\u540c\u540d\u7b26\u53f7\u4e2d\u83b7\u5f97\u3002 .string \"string\" \u5b9a\u4e49\u4e00\u4e2a\u6216\u591a\u4e2a\u7528\u9017\u53f7\u5206\u5f00\u7684\u5b57\u7b26\u4e32\u3002\u5728\u5b57\u7b26\u4e32\u4e2d\u53ef\u4ee5\u4f7f\u7528\u8f6c\u4e49\u5b57\u7b26\u3002\u6bcf\u4e2a\u5b57\u7b26\u4e32\u90fd\u81ea\u52a8\u9644\u52a0\u4e00\u4e2aNULL \u5b57\u7b26\u7ed3\u5c3e\u3002 .ascii \"string\"... \u4ece\u4f4d\u7f6e\u8ba1\u6570\u5668\u6240\u503c\u5f53\u524d\u4f4d\u7f6e\u4e3a\u5b57\u7b26\u4e32\u5206\u914d\u7a7a\u95f4\u5e76\u5b58\u50a8\u5b57\u7b26\u4e32\u3002\u53ef\u4f7f\u7528\u9017\u53f7\u5206\u5f00\u5199\u51fa\u591a\u4e2a\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\uff0c'.ascii \"Hellow world!\", \"My assembler\"'\u3002\u8be5\u6c47\u7f16\u547d\u4ee4\u4f1a\u8ba9 as \u628a\u8fd9\u4e9b\u5b57\u7b26\u4e32\u6c47\u7f16\u5728\u8fde\u7eed\u7684\u5730\u5740\u4f4d\u7f6e\u5904\uff0c\u6bcf\u4e2a\u5b57\u7b26\u4e32\u540e\u9762\u4e0d\u4f1a\u81ea\u52a8\u6dfb\u52a0 0\uff08NULL\uff09\u5b57\u8282\u3002 .asciz \"string\"... \u8be5\u6c47\u7f16\u547d\u4ee4\u4e0e'.ascii'\u7c7b\u4f3c\uff0c\u4f46\u662f\u6bcf\u4e2a\u5b57\u7b26\u4e32\u540e\u9762\u4f1a\u81ea\u52a8\u6dfb\u52a0 NULL \u5b57\u7b26\u3002 .byte expressions \u8be5\u6c47\u7f16\u547d\u4ee4\u5b9a\u4e49 0 \u4e2a\u6216\u591a\u4e2a\u7528\u9017\u53f7\u5206\u5f00\u7684\u5b57\u8282\u503c\u3002\u6bcf\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u662f\u4e00\u4e2a\u5b57\u8282\u3002 .quad bignums \u6307\u5b9a 0 \u4e2a\u6216\u591a\u4e2a\u7528\u9017\u53f7\u5206\u5f00\u7684 8 \u5b57\u8282\u5927\u6570 bignum\u3002\u5982\u679c\u5927\u6570\u653e\u4e0d\u8fdb 8 \u4e2a\u5b57\u8282\u4e2d\uff0c\u5219\u53d6\u4f4e8\u4e2a\u5b57\u8282\u3002","title":"3.2"},{"location":"os/2_as86/#33","text":"\u867d\u7136 as \u901a\u5e38\u7528\u6765\u7f16\u5199\u7eaf 32 \u4f4d\u7684 80X86 \u4ee3\u7801\uff0c\u4f46\u662f 1995 \u5e74\u540e\u5b83\u5bf9\u7f16\u5199\u8fd0\u884c\u4e8e\u5b9e\u6a21\u5f0f\u6216 16 \u4f4d\u4fdd\u62a4\u6a21\u5f0f\u7684\u4ee3\u7801\u4e5f\u63d0\u4f9b\u6709\u9650\u7684\u652f\u6301\u3002\u4e3a\u4e86\u8ba9 as \u6c47\u7f16\u65f6\u4ea7\u751f 16 \u4f4d\u4ee3\u7801\uff0c\u9700\u8981\u5728\u8fd0\u884c\u4e8e 16 \u4f4d\u6a21\u5f0f\u7684\u6307\u4ee4\u8bed\u53e5\u4e4b\u524d\u6dfb\u52a0\u6c47\u7f16\u547d\u4ee4'.code16'\uff0c\u5e76\u4e14\u4f7f\u7528\u6c47\u7f16\u547d\u4ee4'.code32'\u8ba9 as \u6c47\u7f16\u5668\u5207\u6362\u56de 32 \u4f4d\u4ee3\u7801\u6c47\u7f16\u65b9\u5f0f\u3002as \u4e0d\u533a\u5206 16 \u4f4d\u548c 32 \u4f4d\u6c47\u7f16\u8bed\u53e5\uff0c\u5728 16 \u4f4d\u548c 32 \u4f4d\u6a21\u5f0f\u4e0b\u6bcf\u6761\u6307\u4ee4\u7684\u529f\u80fd\u5b8c\u5168\u4e00\u6837\u800c\u4e0e\u6a21\u5f0f\u65e0\u5173\u3002as\u603b\u662f\u4e3a\u6c47\u7f16\u8bed\u53e5\u4ea7\u751f 32 \u4f4d\u7684\u6307\u4ee4\u4ee3\u7801\u800c\u4e0d\u7ba1\u6307\u4ee4\u5c06\u8fd0\u884c\u5728 16 \u4f4d\u8fd8\u662f 32 \u4f4d\u6a21\u5f0f\u4e0b\u3002\u5982\u679c\u4f7f\u7528\u6c47\u7f16\u547d\u4ee4'.code16'\u8ba9 as \u5904\u4e8e 16 \u4f4d\u6a21\u5f0f\u4e0b\uff0c\u90a3\u4e48 as \u4f1a\u81ea\u52a8\u4e3a\u6240\u6709\u6307\u4ee4\u52a0\u4e0a\u4e00\u4e2a\u5fc5\u8981\u7684\u64cd\u4f5c\u6570\u5bbd\u5ea6\u524d\u7f00\u800c\u8ba9\u6307\u4ee4\u8fd0\u884c\u5728 16 \u4f4d\u6a21\u5f0f. \u2003\u7531\u4e8e\u5728 1991 \u5e74\u5f00\u53d1 Linux \u5185\u6838 0.12 \u65f6 as \u6c47\u7f16\u5668\u8fd8\u4e0d\u652f\u6301 16 \u4f4d\u4ee3\u7801\uff0c\u56e0\u6b64\u5728\u7f16\u5199\u548c\u6c47\u7f16 0.12 \u5185\u6838\u5b9e\u6a21\u5f0f\u4e0b\u7684\u5f15\u5bfc\u542f\u52a8\u4ee3\u7801\u548c\u521d\u59cb\u5316\u6c47\u7f16\u7a0b\u5e8f\u65f6\u4f7f\u7528\u4e86\u524d\u9762\u4ecb\u7ecd\u7684 as86 \u6c47\u7f16\u5668.","title":"3.3"},{"location":"os/2_as86/#4","text":"\u57fa\u672c\u683c\u5f0f: __asm__ __volatile__(\u201c\u6c47\u7f16\u8bed\u53e5\u201d : \u8f93\u51fa\u5bc4\u5b58\u5668 : \u8f93\u5165\u5bc4\u5b58\u5668 : \u4f1a\u88ab\u4fee\u6539\u7684\u5bc4\u5b58\u5668); \u9664\u7b2c 1 \u884c\u4ee5\u5916\uff0c\u540e\u9762\u5e26\u5192\u53f7\u7684\u884c\u82e5\u4e0d\u4f7f\u7528\u5c31\u90fd\u53ef\u4ee5\u7701\u7565\u3002\u5176\u4e2d\uff0c\u201c__asm__\u201d\u662f\u5185\u8054\u6c47\u7f16\u8bed\u53e5\u5173\u952e\u8bcd; __volatile__\"\u8868\u793a\u7f16\u8bd1\u5668\u4e0d\u8981\u4f18\u5316\u4ee3\u7801;\u201c\u6c47\u7f16\u8bed\u53e5\u201d\u662f\u4f60\u5199\u6c47\u7f16\u6307\u4ee4\u7684\u5730\u65b9; \u201c\u4f1a\u88ab\u4fee\u6539\u7684\u5bc4\u5b58\u5668\u201d\u8868\u793a\u4f60\u5df2\u5bf9\u5176\u4e2d\u5217\u51fa\u7684\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u8fdb\u884c\u4e86\u6539\u52a8\uff0cgcc \u7f16\u8bd1\u5668\u4e0d\u80fd\u518d\u4f9d\u8d56\u4e8e\u5b83\u539f\u5148\u5bf9\u8fd9\u4e9b\u5bc4\u5b58\u5668\u52a0\u8f7d\u7684\u503c\u3002\u5982\u679c\u5fc5\u8981\u7684\u8bdd\uff0cgcc \u9700\u8981\u91cd\u65b0\u52a0\u8f7d\u8fd9\u4e9b\u5bc4\u5b58\u5668\u3002 __asm__ __violate__ (\"movl %1,%0\" : \"=r\" (result) : \"m\" (input)); \u2003\"movl %1,%0\"\u662f\u6307\u4ee4\u6a21\u677f\uff1b\"%0\"\u548c\"%1\"\u4ee3\u8868\u6307\u4ee4\u7684\u64cd\u4f5c\u6570\uff0c\u79f0\u4e3a\u5360\u4f4d\u7b26\uff0c\u5185\u5d4c\u6c47\u7f16\u9760\u5b83\u4eec\u5c06C \u8bed\u8a00\u8868\u8fbe\u5f0f\u4e0e\u6307\u4ee4\u64cd\u4f5c\u6570\u76f8\u5bf9\u5e94\u3002\u6307\u4ee4\u6a21\u677f\u540e\u9762\u7528\u5c0f\u62ec\u53f7\u62ec\u8d77\u6765\u7684\u662fC\u8bed\u8a00\u8868\u8fbe\u5f0f\uff0c\u672c\u4f8b\u4e2d\u53ea\u6709\u4e24\u4e2a\uff1a\"result\"\u548c\"input\"\uff0c\u4ed6\u4eec\u6309\u7167\u51fa\u73b0\u7684\u987a\u5e8f\u5206 \u522b\u4e0e\u6307\u4ee4\u64cd\u4f5c\u6570\"%0\"\uff0c\"%1\"\u5bf9\u5e94\uff1b\u6ce8\u610f\u5bf9\u5e94\u987a\u5e8f\uff1a\u7b2c\u4e00\u4e2aC \u8868\u8fbe\u5f0f\u5bf9\u5e94\"%0\"\uff1b\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u5bf9\u5e94\"%1\"\uff0c\u4f9d\u6b21\u7c7b\u63a8\uff0c\u64cd\u4f5c\u6570\u81f3\u591a\u670910 \u4e2a\uff0c\u5206\u522b\u7528\"%0\",\"%1\"....\"%9\"\u8868\u793a\u3002 \u2003\"result\"\u524d\u9762\u7684\u9650\u5236\u5b57\u7b26\u4e32\u662f\"=r\"\uff0c\u5176\u4e2d\"=\"\u8868\u793a\"result\"\u662f\u8f93\u51fa\u64cd\u4f5c\u6570\uff0c\"r\" \u8868\u793a\u9700\u8981\u5c06\"result\"\u4e0e\u67d0\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u76f8\u5173\u8054\uff0c\u5148\u5c06\u64cd\u4f5c\u6570\u7684\u503c\u8bfb\u5165\u5bc4\u5b58\u5668\uff0c\u7136\u540e\u5728\u6307\u4ee4\u4e2d\u4f7f\u7528\u76f8\u5e94\u5bc4\u5b58\u5668\uff0c\u800c\u4e0d\u662f\"result\"\u672c\u8eab\u3002 \u2003\"input\"\u524d\u7684\"m\"\u8868\u793a\u64cd\u4f5c\u6570\u653e\u5728\u5185\u5b58\uff0c\u800c\u4e0d\u662f\u5bc4\u5b58\u5668\u4e2d\u3002 \u2003\"r\"\u548c\"m\"\u90fd\u662f\u9650\u5236\u7b26;C\u8868\u8fbe\u5f0f\u6216\u8005\u53d8\u91cf\u4e0e\u5bc4\u5b58\u5668\u7684\u5173\u7cfb\u7531GCC\u81ea\u52a8\u5904\u7406\uff0c\u6211\u4eec\u53ea\u9700\u4f7f\u7528\u9650\u5236\u5b57\u7b26\u4e32\u6307\u5bfcGCC\u5982\u4f55\u5904\u7406\u5373\u53ef\u3002 \u5206\u7c7b \u9650\u5b9a\u7b26 \u63cf\u8ff0 \u901a\u7528\u5bc4\u5b58\u5668 \"a\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165eax \u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u5047\u8bbeeax\u5df2\u7ecf\u88ab\u4f7f\u7528\uff0c\u90a3\u600e\u4e48\u529e\uff1f \u5176\u5b9e\u5f88\u7b80\u5355\uff1a\u56e0\u4e3aGCC \u77e5\u9053eax \u5df2\u7ecf\u88ab\u4f7f\u7528\uff0c\u5b83\u5728\u8fd9\u6bb5\u6c47\u7f16\u4ee3\u7801 \u7684\u8d77\u59cb\u5904\u63d2\u5165\u4e00\u6761\u8bed\u53e5pushl %eax\uff0c\u5c06eax \u5185\u5bb9\u4fdd\u5b58\u5230\u5806\u6808\uff0c\u7136 \u540e\u5728\u8fd9\u6bb5\u4ee3\u7801\u7ed3\u675f\u5904\u518d\u589e\u52a0\u4e00\u6761\u8bed\u53e5popl %eax\uff0c\u6062\u590deax\u7684\u5185\u5bb9. \"b\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165ebx \"c\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165ecx \"d\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165edx \"s\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165esi \"d\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165edi \"q\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165eax\uff0cebx\uff0cecx\uff0cedx\u4e2d\u7684\u4e00\u4e2a \"r\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165\u901a\u7528\u5bc4\u5b58\u5668\uff0c\u4e5f\u5c31\u662feax\uff0cebx\uff0cecx\uff0c edx\uff0cesi\uff0cedi\u4e2d\u7684\u4e00\u4e2a \"A\" \u628aeax\u548cedx\u5408\u6210\u4e00\u4e2a64 \u4f4d\u7684\u5bc4\u5b58\u5668(use long longs) \u5185\u5b58 \"m\" \u5185\u5b58\u53d8\u91cf \"o\" \u64cd\u4f5c\u6570\u4e3a\u5185\u5b58\u53d8\u91cf\uff0c\u4f46\u662f\u5176\u5bfb\u5740\u65b9\u5f0f\u662f\u504f\u79fb\u91cf\u7c7b\u578b\uff0c \u4e5f\u5373\u662f\u57fa\u5740\u5bfb\u5740\uff0c\u6216\u8005\u662f\u57fa\u5740\u52a0\u53d8\u5740\u5bfb\u5740 \"V\" \u64cd\u4f5c\u6570\u4e3a\u5185\u5b58\u53d8\u91cf\uff0c\u4f46\u5bfb\u5740\u65b9\u5f0f\u4e0d\u662f\u504f\u79fb\u91cf\u7c7b\u578b \" \" \u64cd\u4f5c\u6570\u4e3a\u5185\u5b58\u53d8\u91cf\uff0c\u4f46\u5bfb\u5740\u65b9\u5f0f\u4e3a\u81ea\u52a8\u589e\u91cf \"p\" \u64cd\u4f5c\u6570\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5185\u5b58\u5730\u5740\uff08\u6307\u9488\uff09 \u5bc4\u5b58\u5668\u6216\u5185\u5b58 \"g\" \u5c06\u8f93\u5165\u53d8\u91cf\u653e\u5165eax\uff0cebx\uff0cecx\uff0cedx\u4e2d\u7684\u4e00\u4e2a\u6216\u8005\u4f5c\u4e3a\u5185\u5b58\u53d8\u91cf \"X\" \u64cd\u4f5c\u6570\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b \u7acb\u5373\u6570 \"I\" 0-31\u4e4b\u95f4\u7684\u7acb\u5373\u6570\uff08\u7528\u4e8e32\u4f4d\u79fb\u4f4d\u6307\u4ee4\uff09 \"J\" 0-63\u4e4b\u95f4\u7684\u7acb\u5373\u6570\uff08\u7528\u4e8e64\u4f4d\u79fb\u4f4d\u6307\u4ee4\uff09 \"N\" 0-255\u4e4b\u95f4\u7684\u7acb\u5373\u6570\uff08\u7528\u4e8eout\u6307\u4ee4\uff09 \"i\" \u7acb\u5373\u6570 \"n\" \u7acb\u5373\u6570\uff0c\u6709\u4e9b\u7cfb\u7edf\u4e0d\u652f\u6301\u9664\u5b57\u4ee5\u5916\u7684\u7acb\u5373\u6570\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u5e94\u8be5\u4f7f\u7528\"n\"\u800c\u4e0d\u662f\"i\" \u5339\u914d \"0\"\uff0c \u8868\u793a\u7528\u5b83\u9650\u5236\u7684\u64cd\u4f5c\u6570\u4e0e\u67d0\u4e2a\u6307\u5b9a\u7684\u64cd\u4f5c\u6570\u5339\u914d\uff0c \"1\" ... \"9\" \u4e5f\u5373\u8be5\u64cd\u4f5c\u6570\u5c31\u662f\u6307\u5b9a\u7684\u90a3\u4e2a\u64cd\u4f5c\u6570\uff0c\u4f8b\u5982\"0\" \u53bb\u63cf\u8ff0\"\uff051\"\u64cd\u4f5c\u6570\uff0c\u90a3\u4e48\"%1\"\u5f15\u7528\u7684\u5176\u5b9e\u5c31 \u662f\"%0\"\u64cd\u4f5c\u6570\uff0c\u6ce8\u610f\u4f5c\u4e3a\u9650\u5b9a\u7b26\u5b57\u6bcd\u76840\uff0d9 \u4e0e \u6307\u4ee4\u4e2d\u7684\"\uff050\"\uff0d\"\uff059\"\u7684\u533a\u522b\uff0c\u524d\u8005\u63cf\u8ff0\u64cd\u4f5c\u6570\uff0c \u540e\u8005\u4ee3\u8868\u64cd\u4f5c\u6570\u3002 : \"=D\" (addr), \"=c\" (cnt) : \"d\" (port), \"0\" (addr), \"1\" (cnt) \u8fd9\u91cc\u76840 \u8868\u793a\u8f93\u5165\u90e8\u5206\u7684addr\u4e0e\u8f93\u51fa\u90e8\u5206\u7684addr\u662f\u540c\u4e00\u4e2a\u53d8\u91cf\uff0c \u5373\u5b83\u4eec\u4f7f\u7528\u76f8\u540c\u5bc4\u5b58\u5668\uff0c\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u4f7f\u7528\u8be5\u5bc4\u5b58\u5668\u539f\u6709\u7684\u503c\u3002 : \"=a\" (__res) : \"0\" (__NR_read), \"b\" ((long)(fd)), \"c\" ((long)(buf)), \"d\" ((long)(n))); \u8fd9\u91cc__res\u662f%0\u64cd\u4f5c\u6570, __NR_read\u662f%1\u64cd\u4f5c\u6570, \u7528\"0\"\u63cf\u8ff0%1\u64cd\u4f5c\u6570, \u5219%1\u5f15\u7528\u7684\u5373\u662f%0, \u5373eax\u5bc4\u5b58\u5668\u3002 & \u8be5\u8f93\u51fa\u64cd\u4f5c\u6570\u4e0d\u80fd\u4f7f\u7528\u8fc7\u548c\u8f93\u5165\u64cd\u4f5c\u6570\u76f8\u540c\u7684\u5bc4\u5b58\u5668 \u64cd\u4f5c\u6570\u7c7b\u578b \"=\" \u64cd\u4f5c\u6570\u5728\u6307\u4ee4\u4e2d\u662f\u53ea\u5199\u7684\uff08\u8f93\u51fa\u64cd\u4f5c\u6570\uff09 \"+\" \u64cd\u4f5c\u6570\u5728\u6307\u4ee4\u4e2d\u662f\u8bfb\u5199\u7c7b\u578b\u7684\uff08\u8f93\u5165\u8f93\u51fa\u64cd\u4f5c\u6570\uff09 \u6d6e\u70b9\u6570 \"f\" \u6d6e\u70b9\u5bc4\u5b58\u5668 \"t\" \u7b2c\u4e00\u4e2a\u6d6e\u70b9\u5bc4\u5b58\u5668 \"u\" \u7b2c\u4e8c\u4e2a\u6d6e\u70b9\u5bc4\u5b58\u5668 \"G\" \u6807\u51c6\u768480387\u6d6e\u70b9\u5e38\u6570 % \u8be5\u64cd\u4f5c\u6570\u53ef\u4ee5\u548c\u4e0b\u4e00\u4e2a\u64cd\u4f5c\u6570\u4ea4\u6362\u4f4d\u7f6e \u4f8b\u5982addl\u7684\u4e24\u4e2a\u64cd\u4f5c\u6570\u53ef\u4ee5\u4ea4\u6362\u987a\u5e8f \uff08\u5f53\u7136\u4e24\u4e2a\u64cd\u4f5c\u6570\u90fd\u4e0d\u80fd\u662f\u7acb\u5373\u6570\uff09 # \u90e8\u5206\u6ce8\u91ca\uff0c\u4ece\u8be5\u5b57\u7b26\u5230\u5176\u540e\u7684\u9017\u53f7\u4e4b\u95f4\u6240\u6709\u5b57\u6bcd\u88ab\u5ffd\u7565 * \u8868\u793a\u5982\u679c\u9009\u7528\u5bc4\u5b58\u5668\uff0c\u5219\u5176\u540e\u7684\u5b57\u6bcd\u88ab\u5ffd\u7565 \u2003 C\u51fd\u6570\u8c03\u7528\u673a\u5236 \uff1a\u8981\u5728\u8fdb\u5165\u51fd\u6570\u65f6\u4e3a\u51fd\u6570\u7684\u5c40\u90e8\u53d8\u91cf\u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5e76\u4e14\u5728\u9000\u51fa\u51fd\u6570\u65f6\u6536\u56de\u8fd9\u90e8\u5206\u7a7a\u95f4\uff0c\u6570\u636e\u7684\u4f20\u9012\u548c\u5c40\u90e8\u53d8\u91cf\u5b58\u50a8\u7a7a\u95f4\u7684\u5206\u914d\u4e0e\u56de\u6536\u5219\u901a\u8fc7\u6808\u64cd\u4f5c\u6765\u5b9e\u73b0\u3002 \u5355\u4e2a\u51fd\u6570\u8c03\u7528\u64cd\u4f5c\u6240\u4f7f\u7528\u7684\u6808\u90e8\u5206\u88ab\u79f0\u4e3a\u6808\u5e27\uff08Stack frame\uff09\u7ed3\u6784 \uff0c\u6808\u5e27\u7ed3\u6784\u7684\u4e24\u7aef\u7531\u4e24\u4e2a\u6307\u9488\u6765\u6307\u5b9a\u3002\u5bc4\u5b58\u5668 ebp \u901a\u5e38\u7528\u4f5c\u5e27\u6307\u9488\uff08frame pointer\uff09\uff0c\u800c esp \u5219\u7528\u4f5c\u6808\u6307\u9488\uff08stack pointer\uff09\u3002\u5728\u51fd\u6570\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6808\u6307\u9488 esp \u4f1a\u968f\u7740\u6570\u636e\u7684\u5165\u6808\u548c\u51fa\u6808\u800c\u79fb\u52a8\uff0c\u56e0\u6b64\u51fd\u6570\u4e2d\u5bf9\u5927\u90e8\u5206\u6570\u636e\u7684\u8bbf\u95ee\u90fd\u57fa\u4e8e\u5e27\u6307\u9488 ebp \u8fdb\u884c\u3002","title":"4 \u5d4c\u5165\u5f0f\u6c47\u7f16"},{"location":"os/3_80x86_protect_mode/","text":"\u4fdd\u62a4\u6a21\u5f0f 20\u4f4d\u5b9e\u6a21\u5f0f\u4e0b\uff0c\u5bfb\u5740\u4e00\u4e2a\u5185\u5b58\u5730\u5740\u4e3b\u8981\u4f7f\u7528\u6bb5\u57fa\u5730\u5740\u548c\u6bb5\u5185\u504f\u79fb\u503c\uff0c\u524d\u8005\u5b58\u653e\u5728\u6bb5\u5bc4\u5b58\u5668\u4e2d\uff0c\u540e\u8005\u5b58\u653e\u5728\u4efb\u4f55\u4e00\u4e2a\u53ef\u7528\u4e8e\u5bfb\u5740\u7684\u5bc4\u5b58\u5668\u4e2d\uff0c\u4e14\u7531\u4e8e\u5bc4\u5b58\u5668\u5927\u5c0f\u4e3a16\u4f4d\uff0c\u5373\u6bb5\u5185\u504f\u79fb\u503c\u6700\u5927\u4e3a2^16B=64KB\uff0c\u8bf4\u660e\u6bb5\u7684\u5927\u5c0f\u56fa\u5b9a\u4e3a64KB. 32\u4f4d\u4fdd\u62a4\u6a21\u5f0f\u5185\u5b58\u5bfb\u5740\u673a\u5236\u89c13.2.1\u5206\u6bb5\u673a\u5236 1. \u5185\u5b58\u7ba1\u7406\u5bc4\u5b58\u5668 GDTR\u3001LDTR\u3001IDTR \u548c TR \u90fd\u662f\u6bb5\u57fa\u5740\u5bc4\u5b58\u5668: GDTR : \u5168\u5c40\u63cf\u8ff0\u7b26\u5bc4\u5b58\u5668\uff0c\u57fa\u5730\u5740\u6307\u5b9aGDT \u8868\u5728\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u8d77\u59cb\u5730\u5740\uff0c\u8868\u957f\u5ea6\u6307\u660e GDT \u8868\u7684\u5b57\u8282\u957f\u5ea6\u503c\u3002\u6307\u4ee4 LGDT \u548c SGDT \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 GDTR \u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u3002 IDTR : \u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868\u5bc4\u5b58\u5668\uff0c\u5b58\u653e\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT \u7684 32 \u4f4d\u7ebf\u6027\u57fa\u5730\u5740\u548c 16 \u4f4d\u8868\u957f\u5ea6\u503c\u3002\u6307\u4ee4 LIDT \u548c SIDT \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 IDTR \u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u3002 LDTR : \u5b58\u653e\u5c40\u90e8\u63cf\u8ff0\u7b26\u8868 LDT \u7684 32 \u4f4d\u7ebf\u6027\u57fa\u5730\u5740\u300116 \u4f4d\u6bb5\u9650\u957f\u548c\u63cf\u8ff0\u7b26\u5c5e\u6027\u503c\uff1b\u6307\u4ee4LLDT \u548c SLDT \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 LDTR \u5bc4\u5b58\u5668\u7684\u6bb5\u63cf\u8ff0\u7b26\u90e8\u5206\u3002 \u5305\u542b LDT \u8868\u7684\u6bb5\u5fc5\u987b\u5728 GDT \u8868\u4e2d\u6709\u4e00\u4e2a\u6bb5\u63cf\u8ff0\u7b26\u9879 \u3002\u5f53\u4f7f\u7528 LLDT \u6307\u4ee4\u628a\u542b\u6709 LDT \u8868\u6bb5\u7684\u9009\u62e9\u7b26\u52a0\u8f7d\u8fdb LDTR \u65f6\uff0cLDT \u6bb5\u63cf\u8ff0\u7b26\u7684\u6bb5\u57fa\u5730\u5740\u3001\u6bb5\u9650\u957f\u5ea6\u4ee5\u53ca\u63cf\u8ff0\u7b26\u5c5e\u6027\u4f1a\u88ab\u81ea\u52a8\u5730\u52a0\u8f7d\u5230 LDTR \u4e2d\u3002 \u5f53\u8fdb\u884c\u4efb\u52a1\u5207\u6362\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u628a\u65b0\u4efb\u52a1 LDT\u7684\u6bb5\u9009\u62e9\u7b26\u548c\u6bb5\u63cf\u8ff0\u7b26\u81ea\u52a8\u5730\u52a0\u8f7d\u8fdb LDTR \u4e2d\u3002 TR : \u4efb\u52a1\u5bc4\u5b58\u5668\uff0c\u5b83\u5f15\u7528 GDT \u8868\u4e2d\u7684\u4e00\u4e2a TSS \u7c7b\u578b\u7684\u63cf\u8ff0\u7b26\u3002\u6307\u4ee4 LTR \u548c STR \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 TR \u5bc4\u5b58\u5668\u7684\u6bb5\u9009\u62e9\u7b26\u90e8\u5206\u3002\u5f53\u4f7f\u7528 LTR \u6307\u4ee4\u628a\u9009\u62e9\u7b26\u52a0\u8f7d\u8fdb\u4efb\u52a1\u5bc4\u5b58\u5668\u65f6\uff0cTSS \u63cf\u8ff0\u7b26\u4e2d\u7684\u6bb5\u57fa\u5730\u5740\u3001\u6bb5\u9650\u957f\u5ea6\u4ee5\u53ca\u63cf\u8ff0\u7b26\u5c5e\u6027\u4f1a\u88ab\u81ea\u52a8\u5730\u52a0\u8f7d\u5230\u4efb\u52a1\u5bc4\u5b58\u5668\u4e2d\u3002 \u5f53\u6267\u884c\u4efb\u52a1\u5207\u6362\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u628a\u65b0\u4efb\u52a1\u7684 TSS \u7684\u6bb5\u9009\u62e9\u7b26\u548c\u6bb5\u63cf\u8ff0\u7b26\u81ea\u52a8\u5730\u52a0\u8f7d\u8fdb\u4efb\u52a1\u5bc4\u5b58\u5668 TR \u4e2d\u3002 \u2003 \u4e8b\u5b9e\u4e0a\uff0c\u7531\u4e8e\u5207\u6362TSS\uff0c\u9700\u8981\u8017\u8d39\u8bb8\u591a\u65f6\u95f4\u5728\u4fdd\u5b58\u4e8e\u8d4b\u503c\u4e0a\uff0c\u540e\u6765\u7684linux\u7cfb\u7edf\u91c7\u7528\u5207\u6362\u5185\u6838\u6808\u6765\u6062\u590d\u548c\u4fdd\u5b58\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u3002 2.\u63a7\u5236\u5bc4\u5b58\u5668 CR0 \u4e2d\u542b\u6709\u63a7\u5236\u5904\u7406\u5668\u64cd\u4f5c\u6a21\u5f0f\u548c\u72b6\u6001\u7684\u7cfb\u7edf\u63a7\u5236\u6807\u5fd7\uff0c \u5176\u4e2dCR0\u4e2d\u7684\u4fdd\u62a4\u63a7\u5236\u4f4d\uff1a PE \uff1aCR0 \u7684\u4f4d 0 \u662f\u542f\u7528\u4fdd\u62a4\uff08Protection Enable\uff09\u6807\u5fd7\u3002\u5f53\u8bbe\u7f6e\u8be5\u4f4d\u65f6\u5373\u5f00\u542f\u4e86\u4fdd\u62a4\u6a21\u5f0f\uff1b\u5f53\u590d\u4f4d\u65f6\u5373\u8fdb\u5165\u5b9e\u5730\u5740\u6a21\u5f0f\u3002 PG \uff1aCR0 \u7684\u4f4d 31 \u662f\u5206\u9875\uff08Paging\uff09\u6807\u5fd7\u3002\u5f53\u8bbe\u7f6e\u8be5\u4f4d\u65f6\u5373\u5f00\u542f\u4e86\u5206\u9875\u673a\u5236\uff1b\u5f53\u590d\u4f4d\u65f6\u5219\u7981\u6b62\u5206\u9875\u673a\u5236\uff0c\u6b64\u65f6\u6240\u6709\u7ebf\u6027\u5730\u5740\u7b49\u540c\u4e8e\u7269\u7406\u5730\u5740\u3002\u5728\u5f00\u542f\u8fd9\u4e2a\u6807\u5fd7\u4e4b\u524d\u5fc5\u987b\u5df2\u7ecf\u6216\u8005\u540c\u65f6\u5f00\u542f PE \u6807\u5fd7\u3002\u5373\u82e5\u8981\u542f\u7528\u5206\u9875\u673a\u5236\uff0c\u90a3\u4e48 PE \u548c PG \u6807\u5fd7\u90fd\u8981\u7f6e\u4f4d\u3002\u5728\u4fee\u6539\u4e86 PE \u4f4d\u4e4b\u540e\u7a0b\u5e8f\u5fc5\u987b\u7acb\u523b\u4f7f\u7528\u4e00\u6761\u8df3\u8f6c\u6307\u4ee4\uff0c\u4ee5\u5237\u65b0\u5904\u7406\u5668\u6267\u884c\u7ba1\u9053\u4e2d\u5df2\u7ecf\u83b7\u53d6\u7684\u4e0d\u540c\u6a21\u5f0f\u4e0b\u7684\u4efb\u4f55\u6307\u4ee4\u3002\u5728\u8bbe\u7f6e PE \u4f4d\u4e4b\u524d\uff0c\u7a0b\u5e8f\u5fc5\u987b\u521d\u59cb\u5316\u51e0\u4e2a\u7cfb\u7edf\u6bb5\u548c\u63a7\u5236\u5bc4\u5b58\u5668\u3002 CR2 \u548c CR3 \u7528\u4e8e\u5206\u9875\u673a\u5236: CR3 \u542b\u6709\u5b58\u653e\u9875\u76ee\u5f55\u8868\u9875\u9762\u7684\u7269\u7406\u5730\u5740\uff0c\u56e0\u6b64 CR3 \u4e5f\u88ab\u79f0\u4e3a PDBR\u3002\u56e0\u4e3a\u9875\u76ee\u5f55\u8868\u9875\u9762\u662f\u9875\u5bf9\u9f50\u7684\uff0c\u6240\u4ee5\u8be5\u5bc4\u5b58\u5668\u53ea\u6709\u9ad8 20 \u4f4d\u662f\u6709\u6548\u7684\uff0c\u4e14CR3 \u4e2d\u52a0\u8f7d\u4e00\u4e2a\u65b0\u503c\u65f6\u4f4e12\u4f4d\u5fc5\u987b\u7f6e0\u3002 CR2 \u7528\u4e8e\u51fa\u73b0\u9875\u5f02\u5e38\u65f6\u62a5\u544a\u51fa\u9519\u4fe1\u606f\u3002\u5728\u62a5\u544a\u9875\u5f02\u5e38\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u628a\u5f15\u8d77\u5f02\u5e38\u7684\u7ebf\u6027\u5730\u5740\u5b58\u653e\u5728 CR2\u4e2d\u3002\u56e0\u6b64\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u9875\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5 CR2 \u7684\u5185\u5bb9\u6765\u786e\u5b9a\u7ebf\u6027\u5730\u5b58\u4e2d\u8bfb\u53d6\u9875\u8868\u9879\u65f6\uff0c\u5730\u5740\u7a7a\u95f4\u4e2d\u54ea\u4e00\u4e2a\u9875\u9762\u5f15\u53d1\u4e86\u5f02\u5e38\u3002 \u4f7f\u7528 MOV \u6307\u4ee4\u52a0\u8f7d CR3 \u65f6\u5177\u6709\u8ba9\u9875\u9ad8\u901f\u7f13\u51b2\u65e0\u6548\u7684\u526f\u4f5c\u7528\u3002\u4e3a\u4e86\u51cf\u5c11\u5730\u5740\u8f6c\u6362\u6240\u8981\u6c42\u7684\u603b\u7ebf\u5468\u671f\u6570\u91cf\uff0c\u6700\u8fd1\u8bbf\u95ee\u7684\u9875\u76ee\u5f55\u548c\u9875\u8868\u4f1a\u88ab\u5b58\u653e\u5728\u5904\u7406\u5668\u7684\u9875\u9ad8\u901f\u7f13\u51b2\u5668\u4ef6\u4e2d\uff0c\u8be5\u7f13\u51b2\u5668\u4ef6\u88ab\u79f0\u4e3a\u8f6c\u6362\u67e5\u627e\u7f13\u51b2\u533a TLB \uff08Translation Lookaside Buffer\uff09\u3002\u53ea\u6709\u5f53 TLB \u4e2d\u4e0d\u5305\u542b\u8981\u6c42\u7684\u9875\u8868\u9879\u65f6\u624d\u4f1a\u4f7f\u7528\u989d\u5916\u7684\u603b\u7ebf\u5468\u671f\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u9875\u8868\u9879\u3002 3.\u4fdd\u62a4\u6a21\u5f0f\u5185\u5b58\u7ba1\u7406 \u2003\u4efb\u4f55\u5b8c\u6574\u7684\u5185\u5b58\u7ba1\u7406\u7cfb\u7edf\u90fd\u5305\u542b\u4e24\u4e2a\u5173\u952e\u90e8\u5206\uff1a\u4fdd\u62a4\u548c\u5730\u5740\u53d8\u6362\u3002\u63d0\u4f9b\u4fdd\u62a4\u63aa\u65bd\u53ef\u4ee5\u9632\u6b62\u4e00\u4e2a\u4efb\u52a1\u8bbf \u95ee\u53e6\u4e00\u4e2a\u4efb\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u533a\u57df\u3002\u5730\u5740\u53d8\u6362\u80fd\u591f\u8ba9\u64cd\u4f5c\u7cfb\u7edf\u5728\u7ed9\u4efb\u52a1\u5206\u914d\u5185\u5b58\u65f6\u5177\u6709\u7075\u6d3b\u6027\uff0c\u5e76\u4e14\u56e0 \u4e3a\u6211\u4eec\u53ef\u4ee5\u8ba9\u67d0\u4e9b\u7269\u7406\u5730\u5740\u4e0d\u88ab\u4efb\u4f55\u903b\u8f91\u5730\u5740\u6240\u6620\u5c04\uff0c\u6240\u4ee5\u5728\u5730\u5740\u53d8\u6362\u8fc7\u7a0b\u4e2d\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e86\u5185\u5b58\u4fdd\u62a4\u529f\u80fd\u3002 \u200380x86CPU \u91c7\u7528\u7684\u662f\u5c0f\u7aef\u5bf9\u9f50(\u503c\u7684\u4f4e\u4f4d\u5b58\u653e\u5728\u5730\u5740\u4f4e\u4f4d) 3.1 \u5185\u5b58\u5bfb\u5740 \u2003\u6bb5\u5730\u5740\u90e8\u5206\u4f7f\u7528 16 \u4f4d\u7684\u6bb5\u9009\u62e9\u7b26\u6307\u5b9a\uff0c\u5176\u4e2d 14 \u4f4d\u53ef\u4ee5\u9009\u62e9 2^14 \u6b21\u65b9\u5373 16384(\u537316K) \u4e2a\u6bb5\u3002\u6bb5\u5185\u504f\u79fb\u5730\u5740\u90e8\u5206\u4f7f\u7528 32 \u4f4d\u7684\u503c\u6765\u6307\u5b9a\uff0c\u56e0\u6b64\u6bb5\u5185\u5730\u5740\u53ef\u4ee5\u662f 0 \u5230 4G\u3002\u5373\u4e00\u4e2a\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u53ef\u8fbe 4G\u3002\u7a0b\u5e8f\u4e2d\u7531 16 \u4f4d\u7684\u6bb5\u548c 32 \u4f4d\u7684\u504f\u79fb\u6784\u6210\u7684 48 \u4f4d\u5730\u5740\u6216\u957f\u6307\u9488\u79f0\u4e3a\u4e00\u4e2a\u903b\u8f91\u5730\u5740\uff08\u865a\u62df\u5730\u5740\uff09\u3002\u5b83\u552f\u4e00\u786e\u5b9a\u4e86\u4e00\u4e2a\u6570\u636e\u5bf9\u8c61\u7684\u6bb5\u5730\u5740\u548c\u6bb5\u5185\u504f\u79fb\u5730\u5740\u3002 \u2003\u3002\u5728\u4efb\u4f55\u6307\u5b9a\u65f6\u523b\u7531 CS \u5bfb\u5740\u7684\u6bb5\u79f0\u4e3a\u5f53\u524d\u4ee3\u7801\u6bb5\u3002\u6b64\u65f6EIP \u5bc4\u5b58\u5668\u4e2d\u5305\u542b\u4e86\u5f53\u524d\u4ee3\u7801\u6bb5\u5185\u4e0b\u4e00\u6761\u8981\u6267\u884c\u6307\u4ee4\u7684\u6bb5\u5185\u504f\u79fb\u5730\u5740\u3002\u56e0\u6b64\u8981\u6267\u884c\u6307\u4ee4\u7684\u5730\u5740\u53ef\u8868\u793a\u6210CS:[EIP]\u3002\u53ef\u4ee5\u901a\u8fc7\u6bb5\u95f4\u63a7\u5236\u8f6c\u79fb\u547d\u4ee4\u4e3aCS\u548cEIP\u8d4b\u65b0\u503c\uff0c\u4ece\u800c\u53ef\u4ee5\u628a\u6267\u884c\u4f4d\u7f6e\u6539\u53d8\u5230 \u5176\u4ed6\u7684\u4ee3\u7801\u6bb5\u4e2d\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u5728\u4e0d\u540c\u6bb5\u4e2d\u7a0b\u5e8f\u7684\u63a7\u5236\u4f20\u9012\u3002 \u2003eg\uff1acs\u4e2d\u5b58\u653e8\uff0c\u537300000000000000000000000000000100b\uff0c\u5219\u5bf9\u5e94GDT\u8868\u5f00\u59cb\u7684\u5730\u5740\u4e3a8\u7684\u4ee3\u7801\uff0c\u56e0\u4e3a\u6b64\u65f6\u7d22\u5f15\u4e3a1( \u5728 80X86 CPU\u4e2d\uff0c\u6bb5\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u53f3\u79fb 3 \u4f4d\u5373\u662f\u63cf\u8ff0\u7b26\u8868\u4e2d\u4e00\u4e2a\u63cf\u8ff0\u7b26\u7684\u7d22\u5f15\u503c\u3002 )\uff0c\u800c\u4e00\u4e2a\u6bb5\u63cf\u8ff0\u7b26\u5927\u5c0f\u4e3a8B\uff0c\u5219\u7d22\u5f151\u7684\u6bb5\u8d77\u59cb\u5730\u5740\u5373\u4e3a8\u3002 3.2 \u5730\u5740\u53d8\u6362 \u2003\u8ba1\u7b97\u673a\u4e2d\u7684\u7269\u7406\u5185\u5b58\u662f\u5b57\u8282\u7684\u7ebf\u6027\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5b57\u8282\u5177\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u7269\u7406\u5730\u5740\uff1b\u7a0b\u5e8f\u4e2d\u7684\u5730\u5740\u662f\u7531\u6bb5\u9009\u62e9\u7b26\u548c\u6bb5\u504f\u79fb\u91cf\u4e24\u90e8\u5206\u6784\u6210\u7684\u865a\u62df\u5730\u5740; \u903b\u8f91\u5730\u5740\u662f\u6307\u7531\u7a0b\u5e8f\u4ea7\u751f\u7684\u4e0e\u6bb5\u76f8\u5173\u7684\u504f\u79fb\u5730\u5740\u90e8\u5206\uff08\u901a\u5e38\u4e0d\u533a\u5206\u865a\u62df\u5730\u5740\u548c\u903b\u8f91\u5730\u5740\uff0c\u7edf\u79f0\u4e3a\u903b\u8f91\u5730\u5740\uff09; \u7269\u7406\u5730\u5740\u662fCPU \u5916\u90e8\u5730\u5740\u603b\u7ebf\u4e0a\u7684\u5bfb\u5740\u7269\u7406\u5185\u5b58\u7684\u5730\u5740\u4fe1\u53f7\u3002 \u2003\u903b\u8f91\u5730\u5740\u5e76\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8e\u8bbf\u95ee\u7269\u7406\u5185\u5b58\uff0c\u800c\u9700\u8981\u4f7f\u7528\u5730\u5740\u53d8\u6362\u673a\u5236\u5c06\u5b83\u53d8\u6362\u6216\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u5730\u5740\u4e0a\u3002\u5185\u5b58\u7ba1\u7406\u673a\u5236\u5373\u7528\u4e8e\u5c06\u8fd9\u79cd\u903b\u8f91\u5730\u5740\u8f6c\u6362\u6210\u7269\u7406\u5185\u5b58\u5730\u5740\u3002\u4e3a\u4e86\u51cf\u5c11\u786e\u5b9a\u5730\u5740\u53d8\u6362\u6240\u9700\u8981\u7684\u4fe1\u606f\uff0c\u53d8\u6362\u6216\u6620\u5c04\u901a\u5e38\u4ee5\u5185\u5b58\u5757\u4f5c\u4e3a\u64cd\u4f5c\u5355\u4f4d\u3002 \u5206\u6bb5\u673a\u5236\u548c\u5206\u9875\u673a\u5236 \u662f\u4e24\u79cd\u5e7f\u6cdb\u4f7f\u7528\u7684\u5730\u5740\u53d8\u6362\u6280\u672f\u3002\u5206\u6bb5\u548c\u5206\u9875\u64cd\u4f5c\u90fd\u4f7f\u7528\u9a7b\u7559\u5728\u5185\u5b58\u4e2d\u7684\u8868(GDT/LDT\u4e0e\u9875\u8868)\u6765\u6307\u5b9a\u5b83\u4eec\u5404\u81ea\u7684\u53d8\u6362\u4fe1 \u606f\u3002\u8fd9\u4e9b\u8868\u53ea\u80fd\u7531\u64cd\u4f5c\u7cfb\u7edf\u8bbf\u95ee\uff0c\u4ee5\u9632\u6b62\u5e94\u7528\u7a0b\u5e8f\u64c5\u81ea\u4fee\u6539\u3002 3.2.1 \u5206\u6bb5\u673a\u5236 \u2003\u5206\u6bb5\u673a\u5236\u53ef\u4ee5\u628a\u5904\u7406\u5668\u53ef\u5bfb\u5740\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5212\u5206\u6210\u4e00\u4e9b\u8f83\u5c0f\u7684\u79f0\u4e3a\u6bb5\u7684\u53d7\u4fdd\u62a4\u5730\u5740\u7a7a\u95f4\u533a\u57df\u3002\u6bb5\u53ef\u4ee5\u7528\u6765\u5b58\u653e\u7a0b\u5e8f\u7684\u4ee3\u7801\u3001\u6570\u636e\u548c\u5806\u6808\uff0c\u6216\u8005\u7528\u6765\u5b58\u653e\u7cfb\u7edf\u6570\u636e\u7ed3\u6784\uff08\u4f8b\u5982 TSS\u6216 LDT\uff09\u3002\u5982\u679c\u5904\u7406\u5668\u4e2d\u6709\u591a\u4e2a\u7a0b\u5e8f\u6216\u4efb\u52a1\u5728\u8fd0\u884c\uff0c\u90a3\u4e48\u6bcf\u4e2a\u7a0b\u5e8f\u53ef\u5206\u914d\u5404\u81ea\u7684\u4e00\u5957\u6bb5\u3002\u56e0\u6b64\u591a\u4e2a\u7a0b\u5e8f\uff08\u6216\u4efb\u52a1\uff09\u53ef\u4ee5\u8fd0\u884c\u5728\u540c\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\u800c\u4e0d\u4f1a\u4e92\u76f8\u5e72\u6270\u3002 \u2003\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u6240\u6709\u4f7f\u7528\u7684\u6bb5\u90fd\u5305\u542b\u5728\u5904\u7406\u5668\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u3002\u4e3a\u4e86\u5b9a\u4f4d\u6307\u5b9a\u6bb5\u4e2d\u7684\u4e00\u4e2a\u5b57\u8282\uff0c\u7a0b\u5e8f\u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2a\u903b\u8f91\u5730\u5740\u3002\u903b\u8f91\u5730\u5740\u5305\u62ec\u4e00\u4e2a\u6bb5\u9009\u62e9\u7b26\u548c\u4e00\u4e2a\u504f\u79fb\u91cf\u3002\u6bb5\u9009\u62e9\u7b26\u662f\u4e00\u4e2a\u6bb5\u7684\u552f\u4e00\u6807\u8bc6\u3002\u6bb5\u9009\u62e9\u7b26\u662f\u63d0\u6bb5\u63cf\u8ff0\u7b26\u8868\uff08\u4f8b\u5982\u5168\u5c40\u63cf\u8ff0\u7b26\u8868 GDT\u4e2d\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u79f0\u4e3a\u6bb5\u63cf\u8ff0\u7b26\uff09\u4e2d\u67d0\u4e00\u63cf\u8ff0\u7b26\u9879\u5728\u8868\u4e2d\u7684\u7d22\u5f15\u503c\u3002\u7d22\u5f15\u503c\u6307\u5b9a\u7684\u6bb5\u63cf\u8ff0\u7b26\u9879\u4e2d\u542b\u6709\u9700\u8981\u5bfb\u5740\u7684\u5185\u5b58\u6bb5\u7684\u6bb5\u57fa\u5730\u5740\u3001\u6bb5\u7684\u957f\u5ea6\u503c\u3001\u6bb5\u7684\u8bbf\u95ee\u7279\u6743\u7ea7\u3001\u6bb5\u7c7b\u578b\u3002\u903b\u8f91\u5730\u5740\u7684\u504f\u79fb\u91cf\u90e8\u5206\u52a0\u5230\u6bb5\u7684\u57fa\u5730\u5740\u4e0a\u5c31\u53ef\u4ee5\u5b9a\u4f4d\u5185\u5b58\u4e2d\u6bb5\u4e2d\u67d0\u4e2a\u5b57\u8282\u7684\u4f4d\u7f6e\u3002\u56e0\u6b64 \u57fa\u5730\u5740\u52a0\u4e0a\u504f\u79fb\u91cf\u5c31\u5f62\u6210\u4e86\u5904\u7406\u5668\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u5730\u5740\u3002 3.2.2 \u5206\u9875\u673a\u5236 \u2003\u5206\u9875\u673a\u5236\u4e3a\u4f20\u7edf\u9700\u6c42\u9875\u3001\u865a\u62df\u5185\u5b58\u7cfb\u7edf\u63d0\u4f9b\u4e86\u5b9e\u73b0\u673a\u5236\u3002\u5176\u4e2d\u865a\u62df\u5185\u5b58\u7cfb\u7edf\u7528\u4e8e\u5b9e\u73b0\u7a0b\u5e8f\u4ee3\u7801\u6309\u8981\u6c42\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u4e2d\u3002 \u2003\u4f7f\u7528 \u865a\u62df\u5b58\u50a8 \u6280\u672f\u3002\u865a\u62df\u5b58\u50a8\u662f\u4e00\u79cd\u5185\u5b58\u7ba1\u7406\u6280\u672f\uff0c\u4f7f\u7528\u8fd9\u79cd\u6280\u672f\u53ef\u8ba9\u7f16\u7a0b\u4eba\u5458\u4ea7\u751f\u5185\u5b58\u7a7a\u95f4\u8981\u6bd4\u8ba1\u7b97\u673a\u4e2d\u5b9e\u9645\u7269\u7406\u5185\u5b58\u5bb9\u91cf\u5927\u5f88\u591a\u7684\u9519\u89c9\u3002\u5728\u4f7f\u7528\u865a\u62df\u5b58\u50a8\u7684\u73af\u5883\u4e2d\uff0c\u5927\u5bb9\u91cf\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u9700\u8981\u4f7f\u7528\u5c0f\u5757\u7684\u7269\u7406\u5185\u5b58\uff08RAM \u6216 ROM\uff09\u4ee5\u53ca\u67d0\u4e9b\u5916\u90e8\u5b58\u50a8\u7a7a\u95f4\uff08\u4f8b\u5982\u5927\u5bb9\u91cf\u786c\u76d8\uff09\u6765\u6a21\u62df\u3002\u5f53\u4f7f\u7528\u5206\u9875\u65f6\uff0c\u6bcf\u4e2a\u6bb5\u88ab\u5212\u5206\u6210\u9875\u9762\uff08\u901a\u5e38\u6bcf\u9875\u4e3a 4KB \u5927\u5c0f\uff09\uff0c\u9875\u9762\u4f1a\u88ab\u5b58\u50a8\u4e8e\u7269\u7406\u5185\u5b58\u4e2d\u6216\u786c\u76d8\u4e0a\u3002\u64cd\u4f5c\u7cfb\u7edf\u901a\u8fc7\u7ef4\u62a4\u4e00\u4e2a\u9875\u76ee\u5f55\u548c\u4e00\u4e9b\u9875\u8868\u6765\u7559\u610f\u8fd9\u4e9b\u9875\u9762\u3002\u5f53\u7a0b\u5e8f\uff08\u6216\u4efb\u52a1\uff09\u8bd5\u56fe\u8bbf\u95ee\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u5730\u5740\u4f4d\u7f6e\u65f6\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u4f7f\u7528\u9875\u76ee\u5f55\u548c\u9875\u8868\u628a\u7ebf\u6027\u5730\u5740\u8f6c\u6362\u6210\u4e00\u4e2a\u7269\u7406\u5730\u5740\uff0c\u7136\u540e\u5728\u8be5\u5185\u5b58\u4f4d\u7f6e\u4e0a\u6267\u884c\u6240\u8981\u6c42\u7684\u64cd\u4f5c\uff08\u8bfb\u6216\u5199\uff09\u3002 \u5982\u679c\u5f53\u524d\u88ab\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5728\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u4e2d\u65ad\u7a0b\u5e8f\u7684\u6267\u884c\uff08\u901a\u8fc7\u4ea7\u751f\u4e00\u4e2a\u9875\u9519\u8bef\u5f02\u5e38\uff09\u3002\u7136\u540e\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u4ece\u786c\u76d8\u4e0a\u628a\u8be5\u9875\u9762\u8bfb\u5165\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u5e76\u7ee7\u7eed\u6267\u884c\u521a\u624d\u88ab\u4e2d\u65ad\u7684\u7a0b\u5e8f\u3002 3.2.2 \u4e24\u79cd\u673a\u5236\u533a\u522b \u5206\u9875\u4f7f\u7528\u4e86\u56fa\u5b9a\u957f\u5ea6\u7684\u9875\u9762\u3002 \u6bb5\u7684\u957f\u5ea6\u901a\u5e38\u4e0e\u5b58\u653e\u5728\u5176\u4e2d\u7684\u4ee3\u7801\u6216\u6570\u636e\u7ed3\u6784\u5177\u6709\u76f8\u540c\u7684\u957f\u5ea6\u3002\u4e0e\u6bb5\u4e0d\u540c\uff0c\u9875\u9762\u6709\u56fa\u5b9a\u7684\u957f\u5ea6\u3002\u5982\u679c\u4ec5\u4f7f\u7528\u5206\u6bb5\u5730\u5740\u8f6c\u6362\uff0c\u90a3\u4e48\u5b58\u50a8\u5728\u7269\u7406\u5185\u5b58\u4e2d\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5c06\u5305\u542b\u5176\u6240\u6709\u7684\u90e8\u5206\u3002\u4f46\u5982\u679c\u4f7f\u7528\u4e86\u5206\u9875\uff0c\u90a3\u4e48\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5c31\u53ef\u4ee5\u4e00\u90e8\u5206\u5b58\u50a8\u4e8e\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u800c\u53e6\u4e00\u90e8\u5206\u4fdd\u5b58\u5728\u78c1\u76d8\u4e2d\u3002 \u6bb5\u8868\u5b58\u50a8\u5728\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u9875\u8868\u5219\u4fdd\u5b58\u5728\u7269\u7406\u5730\u5740\u7a7a\u95f4\u3002 \u6bb5\u53d8\u6362\u8868\u53ef\u7531\u5206\u9875\u673a\u5236\u91cd\u65b0\u5b9a\u4f4d\u800c\u65e0\u9700\u6bb5\u673a\u5236\u7684\u4fe1\u606f\u6216\u5408\u4f5c\u3002\u6bb5\u53d8\u6362\u673a\u5236\u628a\u865a\u62df\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09\u53d8\u6362\u6210\u7ebf\u6027\u5730\u5740\uff0c\u5e76\u4e14\u5728\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u8bbf\u95ee\u81ea\u5df1\u7684\u8868\uff0c\u4f46\u662f\u5e76\u4e0d\u77e5\u6653\u5206\u9875\u673a\u5236\u628a\u8fd9\u4e9b\u7ebf\u6027\u5730\u5740\u8f6c\u6362\u5230\u7269\u7406\u5730\u5740\u7684\u8fc7\u7a0b\u3002\u7c7b\u4f3c\u5730\uff0c\u5206\u9875\u673a\u5236\u4e5f\u4e0d\u77e5\u9053\u7a0b\u5e8f\u4ea7\u751f\u5730\u5740\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u3002\u5206\u9875\u673a\u5236\u53ea\u662f\u7b80\u5355\u5730\u628a\u7ebf\u6027\u5730\u5740\u8f6c\u6362\u6210\u7269\u7406\u5730\u5740\uff0c\u5e76\u4e14\u5728\u7269\u7406\u5185\u5b58\u4e2d\u8bbf\u95ee\u81ea\u5df1\u7684\u8f6c\u6362\u8868\u3002 3.3 \u4fdd\u62a4 3.3.1 \u4efb\u52a1\u95f4\u4fdd\u62a4 \u2003\u901a\u8fc7\u7ed9\u6bcf\u4e2a\u4efb\u52a1\u4e0d\u540c\u7684\u865a\u62df\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09\u7a7a\u95f4\u6765\u5b8c\u5168\u9694\u79bb\u5404\u4e2a\u4efb\u52a1\u3002\u5176\u5b9e\u73b0\u539f\u7406\u662f \u5411\u6bcf\u4e2a\u4efb\u52a1\u63d0\u4f9b\u4e0d\u540c\u7684\u903b\u8f91\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u7684\u53d8\u6362\u6620\u5c04 \u3002\u53ea\u9700\u7ed9\u6bcf\u4e2a\u4efb\u52a1\u5404\u81ea\u72ec\u7acb\u7684\u6620\u5c04\u8868\uff0c\u6bcf\u4e2a\u4efb\u52a1\u5c31\u4f1a\u6709\u4e0d\u540c\u7684\u5730\u5740\u53d8\u6362\u51fd\u6570\u3002\u5728 80X86 \u4e2d\uff0c\u6bcf\u4e2a\u4efb\u52a1\u90fd\u6709\u81ea\u5df1\u7684\u6bb5\u8868\u548c\u9875\u8868\u3002\u5f53\u5904\u7406\u5668\u5207\u6362\u53bb\u6267\u884c\u4e00\u4e2a\u65b0\u4efb\u52a1\u65f6\uff0c\u4efb\u52a1\u5207\u6362\u7684\u5173\u952e\u90e8\u5206\u5c31\u662f\u5207\u6362\u5230\u65b0\u4efb\u52a1\u7684\u53d8\u6362\u8868\u3002 \u2003\u901a\u8fc7\u5728\u6240\u6709\u4efb\u52a1\u4e2d\u5b89\u6392\u5177\u6709\u76f8\u540c\u7684\u865a\u62df\u5230\u7269\u7406\u5730\u5740\u6620\u5c04\u90e8\u5206\uff0c\u5e76\u4e14\u628a\u64cd\u4f5c\u7cfb\u7edf\u5b58\u50a8\u5728\u8fd9\u4e2a\u516c\u5171\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u90e8\u5206\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u88ab\u6240\u6709\u4efb\u52a1\u5171\u4eab\u3002\u8fd9\u4e2a\u6240\u6709\u4efb\u52a1\u90fd\u5177\u6709\u7684\u76f8\u540c\u865a\u62df\u5730\u5740\u7a7a\u95f4\u90e8\u5206\u88ab\u79f0\u4e3a\u5168\u5c40\u5730\u5740\u7a7a\u95f4\uff08Global address space\uff09\u3002\u6bcf\u4e2a\u4efb\u52a1\u552f\u4e00\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u90e8\u5206\u88ab\u79f0\u4e3a\u5c40\u90e8\u5730\u5740\u7a7a\u95f4\uff08Local address space\uff09\u3002\u5c40\u90e8\u5730\u5740\u7a7a\u95f4\u542b\u6709\u9700\u8981\u4e0e\u7cfb\u7edf\u4e2d\u5176\u4ed6\u4efb\u52a1\u533a\u522b\u5f00\u7684\u79c1\u6709\u7684\u4ee3\u7801\u548c\u6570\u636e\u3002\u7531\u4e8e\u6bcf\u4e2a\u4efb\u52a1\u4e2d\u5177\u6709\u4e0d\u540c\u7684\u5c40\u90e8\u5730\u5740\u7a7a\u95f4\uff0c\u56e0\u6b64 \u4e24\u4e2a\u4e0d\u540c\u4efb\u52a1\u4e2d\u5bf9\u76f8\u540c\u865a\u62df\u5730\u5740\u5904\u7684\u5f15\u7528\u5c06\u8f6c\u6362\u5230\u4e0d\u540c\u7684\u7269\u7406\u5730\u5740\u5904\u3002\u6240\u6709\u4efb\u52a1\u5728\u5168\u5c40\u5730\u5740\u7a7a\u95f4\u4e2d\u5bf9\u76f8\u540c\u865a\u62df\u5730\u5740\u7684\u5f15\u7528\u5c06\u88ab\u8f6c\u6362\u5230\u540c\u4e00\u4e2a\u7269\u7406\u5730\u5740\u5904 \u3002\u8fd9\u7ed9\u516c\u5171\u4ee3\u7801\u548c\u6570\u636e\uff08\u4f8b\u5982\u64cd\u4f5c\u7cfb\u7edf\uff09\u7684\u5171\u4eab\u63d0\u4f9b\u4e86\u652f\u6301\u3002 \u2003\u865a\u62df\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09\u7a7a\u95f4\u53ef\u5305\u542b\u6700\u591a 16K \u7684\u6bb5(2^14,\uff0c16\u4f4d\u7684\u6bb5\u9009\u62e9\u7b26\u4e2d\u53ea\u6709\u9ad814\u4f4d\u53ef\u4ee5\u7528\u6765\u9009\u62e9)\uff0c\u800c\u6bcf\u4e2a\u6bb5\u6700\u957f\u53ef\u8fbe 4GB\uff0832\u4f4d\u504f\u79fb\u5730\u5740\uff09\uff0c\u4f7f\u5f97\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5bb9\u91cf\u8fbe\u5230 64TB\uff082 46 KB\uff09\u3002\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u548c\u7269\u7406\u5730\u5740\u7a7a\u95f4\u90fd\u662f 4GB\uff082^32KB\uff0c32\u4f4d\u5730\u5740\u603b\u7ebf\uff09\u3002\u5b9e\u9645\u4e0a\uff0c \u5982\u679c\u7981\u7528\u5206\u9875\u673a\u5236\uff0c\u90a3\u4e48\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5c31\u662f\u7269\u7406\u5730\u5740\u7a7a\u95f4\u3002 \u2003\u865a\u62df\u5730\u5740\u7a7a\u95f4\u88ab\u5206\u5272\u6210\u5927\u5c0f\u76f8\u7b49\u7684\u4e24\u534a\uff08\u5404\u81ea2^13\u4e2a\u6bb5\uff09\u3002\u4e00\u534a\u7531 GDT \u6765\u6620\u5c04\u53d8\u6362\u5230\u7ebf\u6027\u5730\u5740\uff0c\u53e6\u4e00\u534a\u5219\u7531 LDT \u6765\u6620\u5c04\u3002 \u2003 \u5f53\u53d1\u751f\u4efb\u52a1\u5207\u6362\u65f6\uff0cLDT \u4f1a\u66f4\u6362\u6210\u65b0\u4efb\u52a1\u7684 LDT\uff0c\u4f46\u662f GDT \u5e76\u4e0d\u4f1a\u6539\u53d8\u3002\u56e0\u6b64\uff0cGDT \u6240\u6620\u5c04\u7684\u4e00\u534a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u662f\u7cfb\u7edf\u4e2d\u6240\u6709\u4efb\u52a1\u5171\u6709\u7684\uff0c\u4f46\u662f LDT \u6240\u6620\u5c04\u7684\u53e6\u4e00\u534a\u5219\u5728\u4efb\u52a1\u5207\u6362\u65f6\u88ab\u6539\u53d8\u3002\u7cfb\u7edf\u4e2d\u6240\u6709\u4efb\u52a1\u5171\u4eab\u7684\u6bb5\u7531 GDT \u6765\u6620\u5c04\u3002 3.3.2 \u7279\u6743\u7ea7\u4fdd\u62a4 \u4fdd\u62a4\u673a\u5236\u5bf9\u4efb\u52a1\u8fdb\u884c\u64cd\u4f5c\uff0c\u4ee5\u4fdd\u62a4\u64cd\u4f5c\u7cfb\u7edf\u5185\u5b58\u6bb5\u548c\u5904\u7406\u5668\u7279\u6b8a\u7cfb\u7edf\u5bc4\u5b58\u5668\u4e0d\u88ab\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u3002 \u2003\u5728\u4e00\u4e2a\u4efb\u52a1\u4e2d\uff0c\u5b9a\u4e49\u4e86 4 \u4e2a\u6267\u884c\u7279\u6743\u7ea7\uff08Privilege Levels\uff09\uff0c\u7528\u4e8e\u4f9d\u636e\u6bb5\u4e2d\u542b\u6709\u6570\u636e\u7684\u654f\u611f\u5ea6\u4ee5\u53ca\u4efb\u52a1\u4e2d\u4e0d\u540c\u7a0b\u5e8f\u90e8\u5206\u7684\u53d7\u4fe1\u7a0b\u5ea6\uff0c\u6765\u9650\u5236\u5bf9\u4efb\u52a1\u4e2d\u5404\u6bb5\u7684\u8bbf\u95ee\u3002\u6700\u654f\u611f\u7684\u6570\u636e\u88ab\u8d4b\u4e88\u4e86\u6700\u9ad8\u7279\u6743\u7ea7\uff0c\u5b83\u4eec\u53ea\u80fd\u88ab\u4efb\u52a1\u4e2d\u6700\u53d7\u4fe1\u4efb\u7684\u90e8\u5206\u8bbf\u95ee\u3002\u4e0d\u592a\u654f\u611f\u7684\u6570\u636e\u88ab\u8d4b\u4e88\u8f83\u4f4e\u7684\u7279\u6743\u7ea7\uff0c\u5b83\u4eec\u53ef\u4ee5\u88ab\u4efb\u52a1\u4e2d\u8f83\u4f4e\u7279\u6743\u7ea7\u7684\u4ee3\u7801\u8bbf\u95ee\u3002 \u7279\u6743\u7ea7\u7528\u6570\u5b57 0 \u5230 3 \u8868\u793a\uff0c0 \u5177\u6709\u6700\u9ad8\u7279\u6743\u7ea7\uff0c3\u662f\u6700\u4f4e\u7279\u6743\u7ea7\u3002 4. \u5206\u6bb5\u673a\u5236 4.1 \u6bb5\u9009\u62e9\u7b26 \u2003TI=0 \u8868\u793a\u63cf\u8ff0\u7b26\u5728 GDT \u4e2d\uff1bTI=1 \u8868\u793a\u63cf\u8ff0\u7b26\u5728 LDT \u4e2d\u3002\u7d22\u5f15\u5b57\u6bb5\u7ed9\u51fa\u4e86\u63cf\u8ff0\u7b26\u5728 GDT \u6216 LDT \u8868\u4e2d\u7684\u7d22\u5f15\u9879\u53f7\u3002 RPL (Request Privilege Level)\uff0c\u8bf7\u6c42\u7279\u6743\u7ea7\u3002 4.2 \u6bb5\u63cf\u8ff0\u7b26 \u9897\u7c92\u5ea6G \uff1aG=0\uff0c\u6bb5\u9650\u957f\u5355\u4f4d\u662f1B\uff0cG=1\u5355\u4f4d\u662f4KB. \u6bb5\u7c7b\u578bTYPE : S=1\uff0c\u4ee3\u7801\u6216\u6570\u636e S=0\uff0c\u7cfb\u7edf \u63cf\u8ff0\u7b26\u7b2c10\u4f4dC\u4ee3\u8868\u4e00\u81f4\u6027\u6807\u5fd7: C=1\uff0c\u4e00\u81f4\u6027\u6bb5\uff1a\u64cd\u4f5c\u7cfb\u7edf\u62ff\u51fa\u6765\u88ab\u5171\u4eab\u7684\u4ee3\u7801\u6bb5,\u53ef\u4ee5\u88ab\u4f4e\u7279\u6743\u7ea7\u7684\u7528\u6237\u76f4\u63a5\u8c03\u7528\u8bbf\u95ee\u7684\u4ee3\u7801.\u8981\u6c42CPL >= DPL\u3002\u6545\u7279\u6743\u7ea7\u9ad8\u7684\u7a0b\u5e8f\u4e0d\u80fd\u8bbf\u95ee\u7279\u6743\u7ea7\u4f4e\u7684\u7a0b\u5e8f\u3002\u5f53CPL<DPL\u65f6\uff0c\u4f1a\u4ea7\u751f\u4e00\u822c\u4fdd\u62a4\u5f02\u5e38\u3002 C=0\uff0c\u975e\u4e00\u81f4\u6027\u6bb5\uff1a\u4e3a\u4e86\u907f\u514d\u4f4e\u7279\u6743\u7ea7\u7684\u8bbf\u95ee\u800c\u88ab\u64cd\u4f5c\u7cfb\u7edf\u4fdd\u62a4\u8d77\u6765\u7684\u7cfb\u7edf\u4ee3\u7801\uff08DPL=0\uff09\uff0c\u53ea\u5141\u8bb8\u540c\u7ea7\u8bbf\u95ee\uff0c\u5373CPL=DPL\uff0c\u4e14RPL<=CPL\u3002 4.3 \u7279\u6743\u7ea7 \u5f53\u524d\u7279\u6743\u7ea7CPL \uff08Current Privilege Level\uff09: CPL \u662f\u5f53\u524d\u6b63\u5728\u6267\u884c\u7a0b\u5e8f\u6216\u4efb\u52a1\u7684\u7279\u6743\u7ea7\u3002\u5b83 \u5b58\u653e\u5728CS \u548c SS \u6bb5\u5bc4\u5b58\u5668\u7684\u4f4d 0 \u548c\u4f4d 1 \u4e2d \u3002\u901a\u5e38\uff0cCPL \u7b49\u4e8e\u5f53\u524d\u4ee3\u7801\u6bb5\u7684\u7279\u6743\u7ea7\u3002\u5f53\u7a0b\u5e8f\u628a\u63a7\u5236\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u5177\u6709\u4e0d\u540c\u7279\u6743\u7ea7\u7684\u4ee3\u7801\u6bb5\u4e2d\u65f6\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u6539\u53d8 CPL\u3002\u5f53\u8bbf\u95ee\u4e00\u4e2a\u4e00\u81f4\u6027\uff08conforming\uff09\u4ee3\u7801\u6bb5\u65f6\uff0c\u5219\u5904\u7406\u5668\u5bf9 CPL \u7684\u8bbe\u7f6e\u6709\u4e9b\u4e0d\u540c\u3002\u7279\u6743\u7ea7\u503c\u9ad8\u4e8e\uff08\u5373\u4f4e\u7279\u6743\u7ea7\uff09\u6216\u7b49\u4e8e\u4e00\u81f4\u4ee3\u7801\u6bb5DPL \u7684\u4efb\u4f55\u6bb5\u90fd\u53ef\u4ee5\u8bbf\u95ee\u4e00\u81f4\u4ee3\u7801\u6bb5\u3002\u5e76\u4e14\u5f53\u5904\u7406\u5668\u8bbf\u95ee\u4e00\u4e2a\u7279\u6743\u7ea7\u4e0d\u540c\u4e8e CPL \u7684\u4e00\u81f4\u4ee3\u7801\u6bb5\u65f6\uff0cCPL \u5e76\u4e0d\u4f1a\u88ab\u4fee\u6539\u6210\u4e00\u81f4\u4ee3\u7801\u6bb5\u7684 DPL\u3002 \u63cf\u8ff0\u7b26\u7279\u6743\u7ea7DPL \uff08Descriptor Privilege Level\uff09: DPL \u662f\u4e00\u4e2a\u6bb5\u6216\u95e8\u7684\u7279\u6743\u7ea7\u3002\u5b83 \u5b58\u653e\u5728\u6bb5\u6216\u95e8\u63cf \u8ff0\u7b26\u7684 DPL \u5b57\u6bb5\u4e2d \u3002\u5728\u5f53\u524d\u6267\u884c\u4ee3\u7801\u6bb5\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u6bb5\u6216\u95e8\u65f6\uff0c\u6bb5\u6216\u95e8\u7684 DPL \u4f1a\u7528\u6765\u4e0e CPL \u4ee5\u53ca\u6bb5\u6216\u95e8\u9009\u62e9\u7b26\u4e2d\u7684 RPL\uff08\u89c1\u4e0b\u9762\u8bf4\u660e\uff09\u4f5c\u6bd4\u8f83\u3002 \u8bf7\u6c42\u7279\u6743\u7ea7RPL \uff08Request Privilege Level\uff09\uff1aRPL \u662f\u4e00\u79cd\u8d4b\u4e88\u6bb5\u9009\u62e9\u7b26\u7684\u8d85\u8d8a\u7279\u6743\u7ea7\uff0c\u5b83 \u5b58\u653e\u5728\u6bb5\u9009\u62e9\u7b26\u7684\u4f4d 0 \u548c\u4f4d 1 \u4e2d \u3002\u5904\u7406\u5668\u4f1a\u540c\u65f6\u68c0\u67e5 RPL \u548c CPL\uff0c\u4ee5\u786e\u5b9a\u662f\u5426\u5141\u8bb8\u8bbf\u95ee\u4e00\u4e2a\u6bb5\u3002\u5373\u4f7f\u7a0b\u5e8f\u6216\u4efb\u52a1\u5177\u6709\u8db3\u591f\u7684\u7279\u6743\u7ea7\uff08CPL\uff09\u6765\u8bbf\u95ee\u4e00\u4e2a\u6bb5\uff0c\u4f46\u662f\u5982\u679c\u63d0\u4f9b\u7684 RPL \u7279\u6743\u7ea7\u4e0d\u8db3\u7684\u8bdd\u8bbf\u95ee\u4e5f\u5c06\u88ab\u62d2\u7edd\u3002RPL \u53ef\u7528\u6765\u786e\u4fdd\u9ad8\u7279\u6743\u7ea7\u7684\u4ee3\u7801\u4e0d\u4f1a\u4ee3\u8868\u5e94\u7528\u7a0b\u5e8f\u53bb\u8bbf\u95ee\u4e00\u4e2a\u6bb5\uff0c\u9664\u975e\u5e94\u7528\u7a0b\u5e8f\u81ea\u5df1\u5177\u6709\u8bbf\u95ee\u8fd9\u4e2a\u6bb5\u7684\u6743\u9650\u3002 \u5f53\u4ee3\u7801\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u6bb5\u6216\u95e8\uff08\u8c03\u7528\u95e8\uff09\u65f6\uff0c\u8981\u6c42 DPL >= max{CPL, RPL}\u3002 5. \u5206\u9875\u673a\u5236 80X86 \u4f7f\u7528 4K\uff082^12\uff09\u5b57\u8282\u56fa\u5b9a\u5927\u5c0f\u7684\u9875\u9762\u3002\u6bcf\u4e2a\u9875\u9762\u5747\u662f 4KB\uff0c\u5e76\u4e14\u5bf9\u9f50\u4e8e 4K \u5730\u5740\u8fb9\u754c\u5904\u3002\u8fd9\u8868 \u793a\u5206\u9875\u673a\u5236\u628a 2^32\u5b57\u8282\uff084GB\uff09\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5212\u5206\u6210 2^20\uff081M = 1048576\uff09\u4e2a\u9875\u9762\u3002\u5206\u9875\u673a\u5236\u901a\u8fc7\u628a\u7ebf\u6027 \u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u9875\u9762\u91cd\u65b0\u5b9a\u4f4d\u5230\u7269\u7406\u5730\u5740\u7a7a\u95f4\u4e2d\u8fdb\u884c\u64cd\u4f5c\u3002\u7531\u4e8e 4K \u5927\u5c0f\u7684\u9875\u9762\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u8fdb\u884c\u6620\u5c04\uff0c\u5e76 \u4e14\u5bf9\u9f50\u4e8e 4K \u8fb9\u754c\uff0c\u56e0\u6b64 \u7ebf\u6027\u5730\u5740\u7684\u4f4e 12 \u6bd4\u7279\u4f4d\u53ef\u4f5c\u4e3a\u9875\u5185\u504f\u79fb\u91cf\u76f4\u63a5\u4f5c\u4e3a\u7269\u7406\u5730\u5740\u7684\u4f4e 12 \u4f4d\u3002\u5206\u9875\u673a\u5236\u6267\u884c\u7684\u91cd\u5b9a\u4f4d\u529f\u80fd\u53ef\u4ee5\u770b\u4f5c\u662f\u628a\u7ebf\u6027\u5730\u5740\u7684\u9ad8 20 \u4f4d\u8f6c\u6362\u5230\u5bf9\u5e94\u7269\u7406\u5730\u5740\u7684\u9ad8 20 \u4f4d\u3002 5.1 \u4e24\u7ea7\u9875\u8868\u7ed3\u6784 \u2003\u9875\u8868\u542b\u6709 2^20\uff081M\uff09\u4e2a\u8868\u9879\uff0c\u800c\u6bcf\u9879\u5360\u7528 4 \u5b57\u8282\u3002\u5982\u679c\u4f5c\u4e3a\u4e00\u4e2a\u8868\u6765\u5b58\u653e\u7684\u8bdd\uff0c\u5b83\u4eec\u6700\u591a\u5c06\u5360\u7528 \u8fde\u7eed4MB \u7684\u5185\u5b58(\u903b\u8f91\u5730\u5740\u4e2d\u63d0\u4f9b\u7684\u9875\u8868\u7684\u7d22\u5f15\u503c\uff0c\u53ea\u6709\u662f\u8fde\u7eed\u5185\u5b58\uff0c\u4e14\u6bcf\u4e2a\u8868\u9879\u5927\u5c0f\u56fa\u5b9a\uff0c\u624d\u53ef\u4ee5\u6839\u636e\u9996\u5730\u5740\u548c\u7d22\u5f15\u8ba1\u7b97\u4efb\u610f\u8868\u9879\u7684\u5730\u5740)\u3002\u56e0\u6b64\u4e3a\u4e86\u51cf\u5c11\u8fde\u7eed\u5185\u5b58\u5360\u7528\u91cf\uff0c80X86 \u4f7f\u7528\u4e86\u4e24\u7ea7\u8868\u3002 \u2003\u7b2c\u4e00\u7ea7\u8868\u79f0\u4e3a\u9875\u76ee\u5f55\uff0c\u7ebf\u6027\u5730\u5740\u7684\u6700\u9ad8 10 \u4f4d\uff08\u4f4d 31--22\uff09\u7528\u4f5c\u4e00\u7ea7\u8868\uff08\u9875\u76ee\u5f55\uff09\u4e2d\u7684\u7d22\u5f15\u503c\uff0c\u6765\u9009\u62e92 ^10\u4e2a\u4e8c\u7ea7\u8868\u4e4b\u4e00\u3002 \u56e0\u6b64\u4e00\u4e2a\u9875\u76ee\u5f55\u9879\u6240\u80fd\u5bfb\u627e\u7684\u5730\u5740\u7a7a\u95f4\u5927\u5c0f\u4e3a4MB\uff08=2^10\u9875 * 4KB\uff09. \u2003\u7b2c\u4e8c\u7ea7\u8868\u79f0\u4e3a\u9875\u8868(page table)\uff0c\u4e8c\u7ea7\u9875\u8868\u4f7f\u7528\u7ebf\u6027\u5730\u5740\u4e2d\u95f4 10 \u4f4d\uff08\u4f4d 21--12\uff09\u4f5c\u4e3a\u8868\u9879\u7d22\u5f15\u503c\uff0c\u4ee5\u83b7\u53d6\u542b\u6709\u9875\u9762 20 \u4f4d\u7269\u7406\u57fa\u5730\u5740\u7684\u8868\u9879\u3002 \u2003\u4e00\u4e2a\u9875\u9762\u5927\u5c0f\u4e3a4KB\uff0c\u6b63\u597d\u53ef\u4ee5\u88c5\u4e0b\u9875\u76ee\u5f55(2^10 4B=4KB)\uff0c\u800c\u4e00\u4e2a\u4e8c\u7ea7\u9875\u8868\u5305\u542b2^10\u4e2a\u9875\u8868\u9879\uff0c\u603b\u7684\u5927\u5c0f\u4e5f\u4e3a4KB\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728\u4e00\u4e2a\u9875\u9762\u4e2d\u3002\u8fd9\u6837\u4ec5\u9700\u4e24\u4e2a\u9875\u9762(8KB)\u5927\u5c0f\u5373\u53ef\u5bfb\u5740 \u2003\u901a\u8fc7\u4e8c\u7ea7\u8868\u7ed3\u6784\u4e8b\u5b9e\u4e0a\u5e76\u6ca1\u6709\u89e3\u51b3\u9700\u8981\u4f7f\u75284MB\u5185\u5b58\u6765\u5b58\u653e\u9875\u8868\u7684\u95ee\u9898\uff0c\u4f46\u662f\u5176 \u5141\u8bb8\u9875\u8868\u88ab\u5206\u6563\u5728\u5185\u5b58\u4e2d\u5404\u4e2a\u9875\u9762\u4e2d\uff0c\u800c\u975e\u4fdd\u5b58\u5728\u8fde\u7eed\u76844MB\u5185\u5b58\u5757\u4e2d\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u4e3a\u4e0d\u5b58\u5728\u7684\u6216\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u672a\u4f7f\u7528\u7684\u90e8\u5206\u5206\u914d\u4e8c\u7ea7\u9875\u8868 *\u3002\u867d\u7136\u76ee\u5f55\u8868\u9875\u9762\u5fc5\u987b\u603b\u662f\u5b58\u5728\u4e8e\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u4f46\u662f\u4e8c\u7ea7\u9875\u8868\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u518d\u5206\u914d\u3002\u8fd9\u4f7f\u5f97\u9875\u8868\u7ed3\u6784\u7684\u5927\u5c0f\u5bf9\u5e94\u4e8e\u5b9e\u9645\u4f7f\u7528\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5927\u5c0f\u3002 \u2003\u9875\u76ee\u5f55\u8868\u548c\u9875\u8868\u90fd\u5305\u542b\u4e00\u4e2a\u5b58\u5728\u5c5e\u6027P\uff0c\u524d\u8005\u6307\u660e\u5bf9\u5e94\u7684\u4e8c\u7ea7\u9875\u8868\u662f\u5426\u5b58\u5728\uff0c\u540e\u8005\u6307\u660e\u9875\u9762\u662f\u5426\u5b58\u5728\uff1b\u9875\u76ee\u5f55/\u9875\u8868\u4e2d\u6bcf\u4e2a\u8868\u9879\u5927\u5c0f\u4e3a 32 \u4f4d\uff0c\u53ea\u9700\u8981\u5176\u4e2d\u7684 20 \u4f4d\u6765\u5b58\u653e \u9875\u8868\u7684\u7d22\u5f15/\u9875\u9762\u7684\u7269\u7406\u57fa\u5730\u5740\uff0c\u5269\u4e0b\u7684 12\u4f4d\u53ef\u7528\u4e8e\u5b58\u653e\u4e00\u4e9b\u5c5e\u6027\u4fe1\u606f\u3002\u5982\u679c\u7a0b\u5e8f\u8bbf\u95ee\u7269\u7406\u5185\u5b58\u4e2d\u4e0d\u5b58\u5728\u7684\u9875\u9762\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u7f3a\u9875\u5f02\u5e38\u3002\u6b64\u65f6\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u5f02\u5e38\u5904\u7406\u8fc7\u7a0b\u628a\u7f3a\u5c11\u7684\u9875\u9762\u4ece\u78c1\u76d8\u4e0a\u8c03\u5165\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u5e76\u628a\u76f8\u5e94\u7269\u7406\u5730\u5740\u5b58\u653e\u5728\u8868\u9879\u4e2d\u3002 6 \u4fdd\u62a4 6.1 \u4ee3\u7801\u6bb5\u4e4b\u95f4\u8f6c\u79fb\u63a7\u5236\u65f6\u7684\u7279\u6743\u7ea7\u68c0\u67e5 \u7a0b\u5e8f\u63a7\u5236\u8f6c\u79fb\u6307\u4ee4 \u2003\u7a0b\u5e8f\u7684\u63a7\u5236\u8f6c\u79fb\u4f7f\u7528\u6307\u4ee4 JMP\u3001RET\u3001INT \u548c IRET \u4ee5\u53ca\u5f02\u5e38\u548c\u4e2d\u65ad\u673a\u5236\u6765\u5b9e\u73b0\u3002JMP \u6216 CALL \u6307\u4ee4\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u56db\u79cd\u65b9\u6cd5\u4e4b\u4e00\u6765\u5f15\u7528\u53e6\u5916\u4e00\u4e2a\u4ee3\u7801\u6bb5\uff1a \u76ee\u6807\u64cd\u4f5c\u6570\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u6bb5\u9009\u62e9\u7b26\uff1b \u76ee\u6807\u64cd\u4f5c\u6570\u6307\u5411\u4e00\u4e2a\u8c03\u7528\u95e8\u63cf\u8ff0\u7b26\uff0c\u800c\u8be5\u63cf\u8ff0\u7b26\u4e2d\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u9009\u62e9\u7b26\uff1b \u76ee\u6807\u64cd\u4f5c\u6570\u6307\u5411\u4e00\u4e2a TSS\uff0c\u800c\u8be5 TSS \u4e2d\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u9009\u62e9\u7b26\uff1b \u76ee\u6807\u64cd\u4f5c\u6570\u6307\u5411\u4e00\u4e2a\u4efb\u52a1\u95e8\uff0c\u8be5\u4efb\u52a1\u95e8\u6307\u5411\u4e00\u4e2a TSS\uff0c\u800c\u8be5 TSS \u4e2d\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u9009\u62e9\u7b26\uff1b \u95e8\u63cf\u8ff0\u7b26 \u8c03\u7528\u95e8 \uff08Call Gate\uff09\u7c7b\u578b TYPE=12 \u2003\u8c03\u7528\u95e8\u7528\u4e8e\u5728\u4e0d\u540c\u7279\u6743\u7ea7\u4e4b\u95f4\u5b9e\u73b0\u53d7\u63a7\u7684\u7a0b\u5e8f\u63a7\u5236\u8f6c\u79fb\u3002\u5b83\u4eec\u901a\u5e38\u4ec5\u7528\u4e8e\u4f7f\u7528\u7279\u6743\u7ea7\u4fdd\u62a4\u673a\u5236\u7684\u64cd\u4f5c; \u7cfb\u7edf\u4e2d\u8c03\u7528\u95e8\u63cf\u8ff0\u7b26\u4e00\u822c\u5b58\u653e\u5728GDT\u6216LDT\u4e2d\uff0c\u4e0d\u80fd\u5b58\u653e\u5728IDT\u4e2d\u3002 \u2003\u4e3a\u4e86\u8bbf\u95ee\u8c03\u7528\u95e8\uff0c\u6211\u4eec\u9700\u8981\u4e3a CALL \u6216 JMP \u6307\u4ee4\u7684\u64cd\u4f5c\u6570\u63d0\u4f9b\u4e00\u4e2a\u8fdc\u6307\u9488\u3002\u8be5\u6307\u9488\u4e2d\u7684\u6bb5\u9009\u62e9\u7b26\u7528\u4e8e\u6307\u5b9a\u8c03\u7528\u95e8\uff0c\u800c\u6307\u9488\u7684\u504f\u79fb\u503c\u867d\u7136\u9700\u8981\u4f46 CPU \u5e76\u4e0d\u4f1a\u7528\u5b83\u3002\u8be5\u504f\u79fb\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u4efb\u610f\u503c\u3002 P=1\u4ee3\u8868\u6bb5\u5b58\u5728 \u9677\u9631\u95e8 \uff08Trap Gate\uff09\u7c7b\u578b TYPE=15, \u5b58\u50a8\u5728IDT\u4e2d\u3002 \u4e2d\u65ad\u95e8 \uff08Interrupt Gate\uff09\uff0c\u7c7b\u578b TYPE=14, \u5b58\u50a8\u5728IDT\u4e2d\u3002 \u4efb\u52a1\u95e8 \uff08Task Gate\uff09\uff0c\u7c7b\u578b TYPE=5, \u53ef\u5b58\u50a8\u5728GDT\\LDT\\IDT\u4e2d\u3002 \u2003\u4e2d\u65ad\u95e8\u4e0e\u9677\u9631\u95e8\u552f\u4e00\u7684\u533a\u522b\u5728\u4e8e\u5904\u7406\u5668\u64cd\u4f5c EFLAGS \u5bc4\u5b58\u5668 IF \u6807\u5fd7\u7684\u65b9\u6cd5\u3002\u5f53\u901a\u8fc7\u4e2d\u65ad\u95e8\u8bbf\u95ee\u4e00\u4e2a \u5f02\u5e38\u6216\u4e2d\u65ad\u5904\u7406\u8fc7\u7a0b\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u590d\u4f4d IF \u6807\u5fd7\u4ee5\u9632\u6b62\u5176\u4ed6\u4e2d\u65ad\u5e72\u6270\u5f53\u524d\u4e2d\u65ad\u5904\u7406\u8fc7\u7a0b\u3002\u968f\u540e\u7684 IRET \u6307\u4ee4 \u5219\u4f1a\u7528\u4fdd\u5b58\u5728\u5806\u6808\u4e0a\u7684\u5185\u5bb9\u6062\u590d EFLAGS \u5bc4\u5b58\u5668\u7684 IF \u6807\u5fd7\u3002\u800c\u901a\u8fc7\u9677\u9631\u95e8\u8bbf\u95ee\u5904\u7406\u8fc7\u7a0b\u5e76\u4e0d\u4f1a\u5f71\u54cd IF \u6807 \u5fd7\u3002 \u5806\u6808\u5207\u6362(\u7528\u6237\u6808\u5207\u6362) \u2003\u6bcf\u5f53\u8c03\u7528\u95e8\u7528\u4e8e\u628a\u7a0b\u5e8f\u63a7\u5236\u8f6c\u79fb\u5230\u4e00\u4e2a\u66f4\u9ad8\u7ea7\u522b\u7684\u975e\u4e00\u81f4\u6027\u4ee3\u7801\u6bb5\u65f6\uff0cCPU \u4f1a\u81ea\u52a8\u5207\u6362\u5230\u76ee\u7684\u4ee3\u7801\u6bb5 \u7279\u6743\u7ea7\u7684\u5806\u6808\u53bb\u3002\u6267\u884c\u6808\u5207\u6362\u64cd\u4f5c\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u9ad8\u7279\u6743\u7ea7\u7a0b\u5e8f\u7531\u4e8e\u6808\u7a7a\u95f4\u4e0d\u8db3\u800c\u5f15\u8d77\u5d29\u6e83\uff0c\u540c\u65f6\u4e5f\u4e3a \u4e86\u9632\u6b62\u4f4e\u7279\u6743\u7ea7\u7a0b\u5e8f\u901a\u8fc7\u5171\u4eab\u7684\u5806\u6808\u6709\u610f\u6216\u65e0\u610f\u5730\u5e72\u6270\u9ad8\u7279\u6743\u7ea7\u7684\u7a0b\u5e8f\u3002 \u4efb\u52a1\u5207\u6362 TSS\\TR\u5bc4\u5b58\u5668\\TSS\u63cf\u8ff0\u7b26(\u4efb\u52a1\u95e8\u63cf\u8ff0\u7b26) : TSS(Task State Segment)\u662f\u4e00\u5757\u5927\u5c0f\u4e3a104\u5b57\u8282\u7684\u5185\u5b58\uff0c\u5b58\u50a8\u4e86\u5927\u90e8\u5206\u5bc4\u5b58\u5668\u7684\u503c TR\u5bc4\u5b58\u5668\u5b58\u50a8\u4e86TSS\u7684\u5730\u5740\uff0c\u5927\u5c0f\uff0c\u548cTSS\u9009\u62e9\u7b26(\u7528\u4ee5\u4eceGDT\u4e2d\u5b9a\u4f4dTSS\u63cf\u8ff0\u7b26) TSS\u63cf\u8ff0\u7b26\u662fGDT\u8868\u4e2d\u7684\u4e00\u9879\uff0c\u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8\u65f6\uff0c\u4eceTSS\u63cf\u8ff0\u7b26\u4e2d\u53d6\u503c\u521d\u59cb\u5316TR\u5bc4\u5b58\u5668 \u2003\u5904\u7406\u5668\u53ef\u4f7f\u7528\u4e00\u4e0b 4 \u79cd\u65b9\u5f0f\u4e4b\u4e00\u6267\u884c\u4efb\u52a1\u5207\u6362\u64cd\u4f5c: \u5f53\u524d\u4efb\u52a1\u5bf9 GDT \u4e2d\u7684 TSS \u63cf\u8ff0\u7b26\u6267\u884c JMP \u6216 CALL \u6307\u4ee4 \u5f53\u524d\u4efb\u52a1\u5bf9 GDT \u6216 LDT \u4e2d\u7684\u4efb\u52a1\u95e8\u63cf\u8ff0\u7b26\u6267\u884c JMP \u6216 CALL \u6307\u4ee4 \u4e2d\u65ad\u6216\u5f02\u5e38\u5411\u91cf\u6307\u5411 IDT \u8868\u4e2d\u7684\u4efb\u52a1\u95e8\u63cf\u8ff0\u7b26 \u5f53 EFLAGS \u4e2d\u7684 NT \u6807\u5fd7\u7f6e\u4f4d\u65f6\u5f53\u524d\u4efb\u52a1\u6267\u884c IRET \u6307\u4ee4\u3002 6.4 \u4e2d\u65ad\u548c\u5f02\u5e38\u5411\u91cf \u2003\u4e3a\u4e86\u6709\u52a9\u4e8e\u5904\u7406\u5f02\u5e38\u548c\u4e2d\u65ad\uff0c\u6bcf\u4e2a\u9700\u8981\u88ab\u5904\u7406\u5668\u8fdb\u884c\u7279\u6b8a\u5904\u7406\u7684\u5904\u7406\u5668\u5b9a\u4e49\u7684\u5f02\u5e38\u548c\u4e2d\u65ad\u6761\u4ef6\u90fd\u88ab\u8d4b\u4e88\u4e86\u4e00\u4e2a\u6807\u8bc6\u53f7\uff0c\u79f0\u4e3a\u5411\u91cf\uff08vector\uff09\u3002\u5904\u7406\u5668\u628a\u8d4b\u4e88\u5f02\u5e38\u6216\u4e2d\u65ad\u7684\u5411\u91cf\u7528\u4f5c\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT\uff08Interrupt Descriptor Table\uff09\u4e2d\u7684\u4e00\u4e2a\u7d22\u5f15\u53f7\uff0c\u6765\u5b9a\u4f4d\u4e00\u4e2a\u5f02\u5e38\u6216\u4e2d\u65ad\u7684\u5904\u7406\u7a0b\u5e8f\u5165\u53e3\u70b9\u4f4d\u7f6e\u3002 \u4e2d\u65ad\u6e90 \uff1a\u5916\u90e8\u786c\u4ef6\u4e2d\u65ad\u548c\u8f6f\u4ef6\u4ea7\u751f\u7684\u4e2d\u65ad \u5f02\u5e38\u6e90 \uff1a\u8f6f\u4ef6\u68c0\u6d4b\u5230\u7684\u7a0b\u5e8f\u9519\u8bef\u5f02\u5e38\u548c\u8f6f\u4ef6\u4ea7\u751f\u7684\u5f02\u5e38 \u2003\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT\uff08Interrupt Descriptor Table\uff09\u5c06\u6bcf\u4e2a\u5f02\u5e38\u6216\u4e2d\u65ad\u5411\u91cf\u5206\u522b\u4e0e\u5b83\u4eec\u7684\u5904\u7406\u8fc7\u7a0b\u8054\u7cfb\u8d77\u6765\u3002 \u4e0e GDT \u548c LDT \u8868\u7c7b\u4f3c\uff0cIDT \u4e5f\u662f\u7531 8 \u5b57\u8282\u957f\u63cf\u8ff0\u7b26\u7ec4\u6210\u7684\u4e00\u4e2a\u6570\u7ec4\u3002\u4e0e GDT \u4e0d\u540c\u7684\u662f\uff0c\u8868\u4e2d\u7b2c 1 \u9879\u53ef\u4ee5\u5305\u542b\u63cf\u8ff0\u7b26\u3002 7. \u8865\u5145 7.1 GDT \u2003GDT\u7684\u7b2c\u4e00\u9879\u89c4\u5b9a\u603b\u662f\u7a7a\u63cf\u8ff0\u7b26\uff1a\u56e0\u4e3a\u5f53LDTR\u5bc4\u5b58\u5668\u4e3a0\u65f6\uff0c\u6307\u5411\u7684\u6b63\u662fGDT\u4e2d\u7b2c\u4e00\u9879\uff0c\u7a7a\u63cf\u8ff0\u7b26\u8868\u660e\u5f53\u524d\u4efb\u52a1\u6ca1\u6709LDT\u3002 7.2 IRET and RET \u2003IRET \u6307\u4ee4\u4e0e RET \u6307\u4ee4\u7c7b\u4f3c\uff0c\u4f46 IRET \u8fd8\u4f1a\u628a\u4fdd\u5b58\u7684\u5bc4\u5b58\u5668\u5185\u5bb9\u6062\u590d\u5230 EFLAGS \u4e2d\u3002\u4e0d\u8fc7\u53ea\u6709\u5f53 CPL \u662f 0 \u65f6\u624d\u4f1a\u6062\u590d EFLAGS \u4e2d\u7684 IOPL \u5b57\u6bb5\uff0c\u5e76\u4e14\u53ea\u6709\u5f53 CPL<=IOPL \u65f6\uff0cIF \u6807\u5fd7\u624d\u4f1a\u88ab\u6539\u53d8\u3002 \u5982\u679c\u5f53\u8c03\u7528\u4e2d\u65ad\u5904\u7406\u8fc7\u7a0b\u65f6\u53d1\u751f\u4e86\u5806\u6808\u5207\u6362\uff0c\u90a3\u4e48\u5728\u8fd4\u56de\u65f6 IRET \u6307\u4ee4\u4f1a\u5207\u6362\u56de\u5230\u539f\u6765\u7684\u5806\u6808\u3002 7.3 EFLAGS IOPL \u7279\u6743\u7ea7\u5b57\u6bb5\uff1a\u4e24\u4e2a\u4f4d\u5bbd\uff0c\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u3002\u6307\u5b9a\u4e86\u8981\u6c42\u6267\u884cI/O\u6307\u4ee4\u7684\u7279\u6743\u7ea7\uff0c\u5982\u679cCPL<=IOPL\uff0cI/O\u6307\u4ee4\u53ef\u4ee5\u6267\u884c\uff0c\u5426\u5219\u53d1\u751f\u4e00\u4e2a\u4fdd\u62a4\u5f02\u5e38\u3002 NT \u5d4c\u5957\u4efb\u52a1\u4f4d\uff1a\u63a7\u5236IRET\u6307\u4ee4\u7684\u8fd0\u884c\u3002\u5982\u679cNT=0\uff0c\u7528\u6808\u4e2d\u4fdd\u5b58\u7684\u503c\u6062\u590dEFLAGS\u3001CS\u548cEIP\u6267\u884c\u5e38\u89c4\u7684\u4e2d\u65ad\u8fd4\u56de\u3002 \u5982\u679cNT=1\uff0c\u4e2d\u65ad\u8fd4\u56de\u7528\u4e00\u4efb\u52a1\u8f6c\u6362\u4ee3\u66ff\u4e0a\u8ff0\u8fc7\u7a0b\u3002 \u53ea\u6709\u5728\u7279\u6743\u7ea70\u4e0b\u6267\u884c\u7684\u7a0b\u5e8f\u624d\u80fd\u6539\u53d8VM\u53caIOPL\u5b57\u6bb5\u3002IF\u4f4d\u53ea\u80fd\u7531\u5177\u6709I/O\u7279\u6743\u7684\u7a0b\u5e8f\u6240\u6539\u53d8\u3002","title":"3_\u4fdd\u62a4\u6a21\u5f0f"},{"location":"os/3_80x86_protect_mode/#_1","text":"20\u4f4d\u5b9e\u6a21\u5f0f\u4e0b\uff0c\u5bfb\u5740\u4e00\u4e2a\u5185\u5b58\u5730\u5740\u4e3b\u8981\u4f7f\u7528\u6bb5\u57fa\u5730\u5740\u548c\u6bb5\u5185\u504f\u79fb\u503c\uff0c\u524d\u8005\u5b58\u653e\u5728\u6bb5\u5bc4\u5b58\u5668\u4e2d\uff0c\u540e\u8005\u5b58\u653e\u5728\u4efb\u4f55\u4e00\u4e2a\u53ef\u7528\u4e8e\u5bfb\u5740\u7684\u5bc4\u5b58\u5668\u4e2d\uff0c\u4e14\u7531\u4e8e\u5bc4\u5b58\u5668\u5927\u5c0f\u4e3a16\u4f4d\uff0c\u5373\u6bb5\u5185\u504f\u79fb\u503c\u6700\u5927\u4e3a2^16B=64KB\uff0c\u8bf4\u660e\u6bb5\u7684\u5927\u5c0f\u56fa\u5b9a\u4e3a64KB. 32\u4f4d\u4fdd\u62a4\u6a21\u5f0f\u5185\u5b58\u5bfb\u5740\u673a\u5236\u89c13.2.1\u5206\u6bb5\u673a\u5236","title":"\u4fdd\u62a4\u6a21\u5f0f"},{"location":"os/3_80x86_protect_mode/#1","text":"GDTR\u3001LDTR\u3001IDTR \u548c TR \u90fd\u662f\u6bb5\u57fa\u5740\u5bc4\u5b58\u5668: GDTR : \u5168\u5c40\u63cf\u8ff0\u7b26\u5bc4\u5b58\u5668\uff0c\u57fa\u5730\u5740\u6307\u5b9aGDT \u8868\u5728\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u8d77\u59cb\u5730\u5740\uff0c\u8868\u957f\u5ea6\u6307\u660e GDT \u8868\u7684\u5b57\u8282\u957f\u5ea6\u503c\u3002\u6307\u4ee4 LGDT \u548c SGDT \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 GDTR \u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u3002 IDTR : \u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868\u5bc4\u5b58\u5668\uff0c\u5b58\u653e\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT \u7684 32 \u4f4d\u7ebf\u6027\u57fa\u5730\u5740\u548c 16 \u4f4d\u8868\u957f\u5ea6\u503c\u3002\u6307\u4ee4 LIDT \u548c SIDT \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 IDTR \u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u3002 LDTR : \u5b58\u653e\u5c40\u90e8\u63cf\u8ff0\u7b26\u8868 LDT \u7684 32 \u4f4d\u7ebf\u6027\u57fa\u5730\u5740\u300116 \u4f4d\u6bb5\u9650\u957f\u548c\u63cf\u8ff0\u7b26\u5c5e\u6027\u503c\uff1b\u6307\u4ee4LLDT \u548c SLDT \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 LDTR \u5bc4\u5b58\u5668\u7684\u6bb5\u63cf\u8ff0\u7b26\u90e8\u5206\u3002 \u5305\u542b LDT \u8868\u7684\u6bb5\u5fc5\u987b\u5728 GDT \u8868\u4e2d\u6709\u4e00\u4e2a\u6bb5\u63cf\u8ff0\u7b26\u9879 \u3002\u5f53\u4f7f\u7528 LLDT \u6307\u4ee4\u628a\u542b\u6709 LDT \u8868\u6bb5\u7684\u9009\u62e9\u7b26\u52a0\u8f7d\u8fdb LDTR \u65f6\uff0cLDT \u6bb5\u63cf\u8ff0\u7b26\u7684\u6bb5\u57fa\u5730\u5740\u3001\u6bb5\u9650\u957f\u5ea6\u4ee5\u53ca\u63cf\u8ff0\u7b26\u5c5e\u6027\u4f1a\u88ab\u81ea\u52a8\u5730\u52a0\u8f7d\u5230 LDTR \u4e2d\u3002 \u5f53\u8fdb\u884c\u4efb\u52a1\u5207\u6362\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u628a\u65b0\u4efb\u52a1 LDT\u7684\u6bb5\u9009\u62e9\u7b26\u548c\u6bb5\u63cf\u8ff0\u7b26\u81ea\u52a8\u5730\u52a0\u8f7d\u8fdb LDTR \u4e2d\u3002 TR : \u4efb\u52a1\u5bc4\u5b58\u5668\uff0c\u5b83\u5f15\u7528 GDT \u8868\u4e2d\u7684\u4e00\u4e2a TSS \u7c7b\u578b\u7684\u63cf\u8ff0\u7b26\u3002\u6307\u4ee4 LTR \u548c STR \u5206\u522b\u7528\u4e8e\u52a0\u8f7d\u548c\u4fdd\u5b58 TR \u5bc4\u5b58\u5668\u7684\u6bb5\u9009\u62e9\u7b26\u90e8\u5206\u3002\u5f53\u4f7f\u7528 LTR \u6307\u4ee4\u628a\u9009\u62e9\u7b26\u52a0\u8f7d\u8fdb\u4efb\u52a1\u5bc4\u5b58\u5668\u65f6\uff0cTSS \u63cf\u8ff0\u7b26\u4e2d\u7684\u6bb5\u57fa\u5730\u5740\u3001\u6bb5\u9650\u957f\u5ea6\u4ee5\u53ca\u63cf\u8ff0\u7b26\u5c5e\u6027\u4f1a\u88ab\u81ea\u52a8\u5730\u52a0\u8f7d\u5230\u4efb\u52a1\u5bc4\u5b58\u5668\u4e2d\u3002 \u5f53\u6267\u884c\u4efb\u52a1\u5207\u6362\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u628a\u65b0\u4efb\u52a1\u7684 TSS \u7684\u6bb5\u9009\u62e9\u7b26\u548c\u6bb5\u63cf\u8ff0\u7b26\u81ea\u52a8\u5730\u52a0\u8f7d\u8fdb\u4efb\u52a1\u5bc4\u5b58\u5668 TR \u4e2d\u3002 \u2003 \u4e8b\u5b9e\u4e0a\uff0c\u7531\u4e8e\u5207\u6362TSS\uff0c\u9700\u8981\u8017\u8d39\u8bb8\u591a\u65f6\u95f4\u5728\u4fdd\u5b58\u4e8e\u8d4b\u503c\u4e0a\uff0c\u540e\u6765\u7684linux\u7cfb\u7edf\u91c7\u7528\u5207\u6362\u5185\u6838\u6808\u6765\u6062\u590d\u548c\u4fdd\u5b58\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u3002","title":"1. \u5185\u5b58\u7ba1\u7406\u5bc4\u5b58\u5668"},{"location":"os/3_80x86_protect_mode/#2","text":"CR0 \u4e2d\u542b\u6709\u63a7\u5236\u5904\u7406\u5668\u64cd\u4f5c\u6a21\u5f0f\u548c\u72b6\u6001\u7684\u7cfb\u7edf\u63a7\u5236\u6807\u5fd7\uff0c \u5176\u4e2dCR0\u4e2d\u7684\u4fdd\u62a4\u63a7\u5236\u4f4d\uff1a PE \uff1aCR0 \u7684\u4f4d 0 \u662f\u542f\u7528\u4fdd\u62a4\uff08Protection Enable\uff09\u6807\u5fd7\u3002\u5f53\u8bbe\u7f6e\u8be5\u4f4d\u65f6\u5373\u5f00\u542f\u4e86\u4fdd\u62a4\u6a21\u5f0f\uff1b\u5f53\u590d\u4f4d\u65f6\u5373\u8fdb\u5165\u5b9e\u5730\u5740\u6a21\u5f0f\u3002 PG \uff1aCR0 \u7684\u4f4d 31 \u662f\u5206\u9875\uff08Paging\uff09\u6807\u5fd7\u3002\u5f53\u8bbe\u7f6e\u8be5\u4f4d\u65f6\u5373\u5f00\u542f\u4e86\u5206\u9875\u673a\u5236\uff1b\u5f53\u590d\u4f4d\u65f6\u5219\u7981\u6b62\u5206\u9875\u673a\u5236\uff0c\u6b64\u65f6\u6240\u6709\u7ebf\u6027\u5730\u5740\u7b49\u540c\u4e8e\u7269\u7406\u5730\u5740\u3002\u5728\u5f00\u542f\u8fd9\u4e2a\u6807\u5fd7\u4e4b\u524d\u5fc5\u987b\u5df2\u7ecf\u6216\u8005\u540c\u65f6\u5f00\u542f PE \u6807\u5fd7\u3002\u5373\u82e5\u8981\u542f\u7528\u5206\u9875\u673a\u5236\uff0c\u90a3\u4e48 PE \u548c PG \u6807\u5fd7\u90fd\u8981\u7f6e\u4f4d\u3002\u5728\u4fee\u6539\u4e86 PE \u4f4d\u4e4b\u540e\u7a0b\u5e8f\u5fc5\u987b\u7acb\u523b\u4f7f\u7528\u4e00\u6761\u8df3\u8f6c\u6307\u4ee4\uff0c\u4ee5\u5237\u65b0\u5904\u7406\u5668\u6267\u884c\u7ba1\u9053\u4e2d\u5df2\u7ecf\u83b7\u53d6\u7684\u4e0d\u540c\u6a21\u5f0f\u4e0b\u7684\u4efb\u4f55\u6307\u4ee4\u3002\u5728\u8bbe\u7f6e PE \u4f4d\u4e4b\u524d\uff0c\u7a0b\u5e8f\u5fc5\u987b\u521d\u59cb\u5316\u51e0\u4e2a\u7cfb\u7edf\u6bb5\u548c\u63a7\u5236\u5bc4\u5b58\u5668\u3002 CR2 \u548c CR3 \u7528\u4e8e\u5206\u9875\u673a\u5236: CR3 \u542b\u6709\u5b58\u653e\u9875\u76ee\u5f55\u8868\u9875\u9762\u7684\u7269\u7406\u5730\u5740\uff0c\u56e0\u6b64 CR3 \u4e5f\u88ab\u79f0\u4e3a PDBR\u3002\u56e0\u4e3a\u9875\u76ee\u5f55\u8868\u9875\u9762\u662f\u9875\u5bf9\u9f50\u7684\uff0c\u6240\u4ee5\u8be5\u5bc4\u5b58\u5668\u53ea\u6709\u9ad8 20 \u4f4d\u662f\u6709\u6548\u7684\uff0c\u4e14CR3 \u4e2d\u52a0\u8f7d\u4e00\u4e2a\u65b0\u503c\u65f6\u4f4e12\u4f4d\u5fc5\u987b\u7f6e0\u3002 CR2 \u7528\u4e8e\u51fa\u73b0\u9875\u5f02\u5e38\u65f6\u62a5\u544a\u51fa\u9519\u4fe1\u606f\u3002\u5728\u62a5\u544a\u9875\u5f02\u5e38\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u628a\u5f15\u8d77\u5f02\u5e38\u7684\u7ebf\u6027\u5730\u5740\u5b58\u653e\u5728 CR2\u4e2d\u3002\u56e0\u6b64\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u9875\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5 CR2 \u7684\u5185\u5bb9\u6765\u786e\u5b9a\u7ebf\u6027\u5730\u5b58\u4e2d\u8bfb\u53d6\u9875\u8868\u9879\u65f6\uff0c\u5730\u5740\u7a7a\u95f4\u4e2d\u54ea\u4e00\u4e2a\u9875\u9762\u5f15\u53d1\u4e86\u5f02\u5e38\u3002 \u4f7f\u7528 MOV \u6307\u4ee4\u52a0\u8f7d CR3 \u65f6\u5177\u6709\u8ba9\u9875\u9ad8\u901f\u7f13\u51b2\u65e0\u6548\u7684\u526f\u4f5c\u7528\u3002\u4e3a\u4e86\u51cf\u5c11\u5730\u5740\u8f6c\u6362\u6240\u8981\u6c42\u7684\u603b\u7ebf\u5468\u671f\u6570\u91cf\uff0c\u6700\u8fd1\u8bbf\u95ee\u7684\u9875\u76ee\u5f55\u548c\u9875\u8868\u4f1a\u88ab\u5b58\u653e\u5728\u5904\u7406\u5668\u7684\u9875\u9ad8\u901f\u7f13\u51b2\u5668\u4ef6\u4e2d\uff0c\u8be5\u7f13\u51b2\u5668\u4ef6\u88ab\u79f0\u4e3a\u8f6c\u6362\u67e5\u627e\u7f13\u51b2\u533a TLB \uff08Translation Lookaside Buffer\uff09\u3002\u53ea\u6709\u5f53 TLB \u4e2d\u4e0d\u5305\u542b\u8981\u6c42\u7684\u9875\u8868\u9879\u65f6\u624d\u4f1a\u4f7f\u7528\u989d\u5916\u7684\u603b\u7ebf\u5468\u671f\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u9875\u8868\u9879\u3002","title":"2.\u63a7\u5236\u5bc4\u5b58\u5668"},{"location":"os/3_80x86_protect_mode/#3","text":"\u4efb\u4f55\u5b8c\u6574\u7684\u5185\u5b58\u7ba1\u7406\u7cfb\u7edf\u90fd\u5305\u542b\u4e24\u4e2a\u5173\u952e\u90e8\u5206\uff1a\u4fdd\u62a4\u548c\u5730\u5740\u53d8\u6362\u3002\u63d0\u4f9b\u4fdd\u62a4\u63aa\u65bd\u53ef\u4ee5\u9632\u6b62\u4e00\u4e2a\u4efb\u52a1\u8bbf \u95ee\u53e6\u4e00\u4e2a\u4efb\u52a1\u6216\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u533a\u57df\u3002\u5730\u5740\u53d8\u6362\u80fd\u591f\u8ba9\u64cd\u4f5c\u7cfb\u7edf\u5728\u7ed9\u4efb\u52a1\u5206\u914d\u5185\u5b58\u65f6\u5177\u6709\u7075\u6d3b\u6027\uff0c\u5e76\u4e14\u56e0 \u4e3a\u6211\u4eec\u53ef\u4ee5\u8ba9\u67d0\u4e9b\u7269\u7406\u5730\u5740\u4e0d\u88ab\u4efb\u4f55\u903b\u8f91\u5730\u5740\u6240\u6620\u5c04\uff0c\u6240\u4ee5\u5728\u5730\u5740\u53d8\u6362\u8fc7\u7a0b\u4e2d\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e86\u5185\u5b58\u4fdd\u62a4\u529f\u80fd\u3002 \u200380x86CPU \u91c7\u7528\u7684\u662f\u5c0f\u7aef\u5bf9\u9f50(\u503c\u7684\u4f4e\u4f4d\u5b58\u653e\u5728\u5730\u5740\u4f4e\u4f4d)","title":"3.\u4fdd\u62a4\u6a21\u5f0f\u5185\u5b58\u7ba1\u7406"},{"location":"os/3_80x86_protect_mode/#31","text":"\u6bb5\u5730\u5740\u90e8\u5206\u4f7f\u7528 16 \u4f4d\u7684\u6bb5\u9009\u62e9\u7b26\u6307\u5b9a\uff0c\u5176\u4e2d 14 \u4f4d\u53ef\u4ee5\u9009\u62e9 2^14 \u6b21\u65b9\u5373 16384(\u537316K) \u4e2a\u6bb5\u3002\u6bb5\u5185\u504f\u79fb\u5730\u5740\u90e8\u5206\u4f7f\u7528 32 \u4f4d\u7684\u503c\u6765\u6307\u5b9a\uff0c\u56e0\u6b64\u6bb5\u5185\u5730\u5740\u53ef\u4ee5\u662f 0 \u5230 4G\u3002\u5373\u4e00\u4e2a\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u53ef\u8fbe 4G\u3002\u7a0b\u5e8f\u4e2d\u7531 16 \u4f4d\u7684\u6bb5\u548c 32 \u4f4d\u7684\u504f\u79fb\u6784\u6210\u7684 48 \u4f4d\u5730\u5740\u6216\u957f\u6307\u9488\u79f0\u4e3a\u4e00\u4e2a\u903b\u8f91\u5730\u5740\uff08\u865a\u62df\u5730\u5740\uff09\u3002\u5b83\u552f\u4e00\u786e\u5b9a\u4e86\u4e00\u4e2a\u6570\u636e\u5bf9\u8c61\u7684\u6bb5\u5730\u5740\u548c\u6bb5\u5185\u504f\u79fb\u5730\u5740\u3002 \u2003\u3002\u5728\u4efb\u4f55\u6307\u5b9a\u65f6\u523b\u7531 CS \u5bfb\u5740\u7684\u6bb5\u79f0\u4e3a\u5f53\u524d\u4ee3\u7801\u6bb5\u3002\u6b64\u65f6EIP \u5bc4\u5b58\u5668\u4e2d\u5305\u542b\u4e86\u5f53\u524d\u4ee3\u7801\u6bb5\u5185\u4e0b\u4e00\u6761\u8981\u6267\u884c\u6307\u4ee4\u7684\u6bb5\u5185\u504f\u79fb\u5730\u5740\u3002\u56e0\u6b64\u8981\u6267\u884c\u6307\u4ee4\u7684\u5730\u5740\u53ef\u8868\u793a\u6210CS:[EIP]\u3002\u53ef\u4ee5\u901a\u8fc7\u6bb5\u95f4\u63a7\u5236\u8f6c\u79fb\u547d\u4ee4\u4e3aCS\u548cEIP\u8d4b\u65b0\u503c\uff0c\u4ece\u800c\u53ef\u4ee5\u628a\u6267\u884c\u4f4d\u7f6e\u6539\u53d8\u5230 \u5176\u4ed6\u7684\u4ee3\u7801\u6bb5\u4e2d\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u5728\u4e0d\u540c\u6bb5\u4e2d\u7a0b\u5e8f\u7684\u63a7\u5236\u4f20\u9012\u3002 \u2003eg\uff1acs\u4e2d\u5b58\u653e8\uff0c\u537300000000000000000000000000000100b\uff0c\u5219\u5bf9\u5e94GDT\u8868\u5f00\u59cb\u7684\u5730\u5740\u4e3a8\u7684\u4ee3\u7801\uff0c\u56e0\u4e3a\u6b64\u65f6\u7d22\u5f15\u4e3a1( \u5728 80X86 CPU\u4e2d\uff0c\u6bb5\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u53f3\u79fb 3 \u4f4d\u5373\u662f\u63cf\u8ff0\u7b26\u8868\u4e2d\u4e00\u4e2a\u63cf\u8ff0\u7b26\u7684\u7d22\u5f15\u503c\u3002 )\uff0c\u800c\u4e00\u4e2a\u6bb5\u63cf\u8ff0\u7b26\u5927\u5c0f\u4e3a8B\uff0c\u5219\u7d22\u5f151\u7684\u6bb5\u8d77\u59cb\u5730\u5740\u5373\u4e3a8\u3002","title":"3.1 \u5185\u5b58\u5bfb\u5740"},{"location":"os/3_80x86_protect_mode/#32","text":"\u8ba1\u7b97\u673a\u4e2d\u7684\u7269\u7406\u5185\u5b58\u662f\u5b57\u8282\u7684\u7ebf\u6027\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5b57\u8282\u5177\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u7269\u7406\u5730\u5740\uff1b\u7a0b\u5e8f\u4e2d\u7684\u5730\u5740\u662f\u7531\u6bb5\u9009\u62e9\u7b26\u548c\u6bb5\u504f\u79fb\u91cf\u4e24\u90e8\u5206\u6784\u6210\u7684\u865a\u62df\u5730\u5740; \u903b\u8f91\u5730\u5740\u662f\u6307\u7531\u7a0b\u5e8f\u4ea7\u751f\u7684\u4e0e\u6bb5\u76f8\u5173\u7684\u504f\u79fb\u5730\u5740\u90e8\u5206\uff08\u901a\u5e38\u4e0d\u533a\u5206\u865a\u62df\u5730\u5740\u548c\u903b\u8f91\u5730\u5740\uff0c\u7edf\u79f0\u4e3a\u903b\u8f91\u5730\u5740\uff09; \u7269\u7406\u5730\u5740\u662fCPU \u5916\u90e8\u5730\u5740\u603b\u7ebf\u4e0a\u7684\u5bfb\u5740\u7269\u7406\u5185\u5b58\u7684\u5730\u5740\u4fe1\u53f7\u3002 \u2003\u903b\u8f91\u5730\u5740\u5e76\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8e\u8bbf\u95ee\u7269\u7406\u5185\u5b58\uff0c\u800c\u9700\u8981\u4f7f\u7528\u5730\u5740\u53d8\u6362\u673a\u5236\u5c06\u5b83\u53d8\u6362\u6216\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u5730\u5740\u4e0a\u3002\u5185\u5b58\u7ba1\u7406\u673a\u5236\u5373\u7528\u4e8e\u5c06\u8fd9\u79cd\u903b\u8f91\u5730\u5740\u8f6c\u6362\u6210\u7269\u7406\u5185\u5b58\u5730\u5740\u3002\u4e3a\u4e86\u51cf\u5c11\u786e\u5b9a\u5730\u5740\u53d8\u6362\u6240\u9700\u8981\u7684\u4fe1\u606f\uff0c\u53d8\u6362\u6216\u6620\u5c04\u901a\u5e38\u4ee5\u5185\u5b58\u5757\u4f5c\u4e3a\u64cd\u4f5c\u5355\u4f4d\u3002 \u5206\u6bb5\u673a\u5236\u548c\u5206\u9875\u673a\u5236 \u662f\u4e24\u79cd\u5e7f\u6cdb\u4f7f\u7528\u7684\u5730\u5740\u53d8\u6362\u6280\u672f\u3002\u5206\u6bb5\u548c\u5206\u9875\u64cd\u4f5c\u90fd\u4f7f\u7528\u9a7b\u7559\u5728\u5185\u5b58\u4e2d\u7684\u8868(GDT/LDT\u4e0e\u9875\u8868)\u6765\u6307\u5b9a\u5b83\u4eec\u5404\u81ea\u7684\u53d8\u6362\u4fe1 \u606f\u3002\u8fd9\u4e9b\u8868\u53ea\u80fd\u7531\u64cd\u4f5c\u7cfb\u7edf\u8bbf\u95ee\uff0c\u4ee5\u9632\u6b62\u5e94\u7528\u7a0b\u5e8f\u64c5\u81ea\u4fee\u6539\u3002","title":"3.2 \u5730\u5740\u53d8\u6362"},{"location":"os/3_80x86_protect_mode/#321","text":"\u5206\u6bb5\u673a\u5236\u53ef\u4ee5\u628a\u5904\u7406\u5668\u53ef\u5bfb\u5740\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5212\u5206\u6210\u4e00\u4e9b\u8f83\u5c0f\u7684\u79f0\u4e3a\u6bb5\u7684\u53d7\u4fdd\u62a4\u5730\u5740\u7a7a\u95f4\u533a\u57df\u3002\u6bb5\u53ef\u4ee5\u7528\u6765\u5b58\u653e\u7a0b\u5e8f\u7684\u4ee3\u7801\u3001\u6570\u636e\u548c\u5806\u6808\uff0c\u6216\u8005\u7528\u6765\u5b58\u653e\u7cfb\u7edf\u6570\u636e\u7ed3\u6784\uff08\u4f8b\u5982 TSS\u6216 LDT\uff09\u3002\u5982\u679c\u5904\u7406\u5668\u4e2d\u6709\u591a\u4e2a\u7a0b\u5e8f\u6216\u4efb\u52a1\u5728\u8fd0\u884c\uff0c\u90a3\u4e48\u6bcf\u4e2a\u7a0b\u5e8f\u53ef\u5206\u914d\u5404\u81ea\u7684\u4e00\u5957\u6bb5\u3002\u56e0\u6b64\u591a\u4e2a\u7a0b\u5e8f\uff08\u6216\u4efb\u52a1\uff09\u53ef\u4ee5\u8fd0\u884c\u5728\u540c\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\u800c\u4e0d\u4f1a\u4e92\u76f8\u5e72\u6270\u3002 \u2003\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u6240\u6709\u4f7f\u7528\u7684\u6bb5\u90fd\u5305\u542b\u5728\u5904\u7406\u5668\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u3002\u4e3a\u4e86\u5b9a\u4f4d\u6307\u5b9a\u6bb5\u4e2d\u7684\u4e00\u4e2a\u5b57\u8282\uff0c\u7a0b\u5e8f\u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2a\u903b\u8f91\u5730\u5740\u3002\u903b\u8f91\u5730\u5740\u5305\u62ec\u4e00\u4e2a\u6bb5\u9009\u62e9\u7b26\u548c\u4e00\u4e2a\u504f\u79fb\u91cf\u3002\u6bb5\u9009\u62e9\u7b26\u662f\u4e00\u4e2a\u6bb5\u7684\u552f\u4e00\u6807\u8bc6\u3002\u6bb5\u9009\u62e9\u7b26\u662f\u63d0\u6bb5\u63cf\u8ff0\u7b26\u8868\uff08\u4f8b\u5982\u5168\u5c40\u63cf\u8ff0\u7b26\u8868 GDT\u4e2d\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u79f0\u4e3a\u6bb5\u63cf\u8ff0\u7b26\uff09\u4e2d\u67d0\u4e00\u63cf\u8ff0\u7b26\u9879\u5728\u8868\u4e2d\u7684\u7d22\u5f15\u503c\u3002\u7d22\u5f15\u503c\u6307\u5b9a\u7684\u6bb5\u63cf\u8ff0\u7b26\u9879\u4e2d\u542b\u6709\u9700\u8981\u5bfb\u5740\u7684\u5185\u5b58\u6bb5\u7684\u6bb5\u57fa\u5730\u5740\u3001\u6bb5\u7684\u957f\u5ea6\u503c\u3001\u6bb5\u7684\u8bbf\u95ee\u7279\u6743\u7ea7\u3001\u6bb5\u7c7b\u578b\u3002\u903b\u8f91\u5730\u5740\u7684\u504f\u79fb\u91cf\u90e8\u5206\u52a0\u5230\u6bb5\u7684\u57fa\u5730\u5740\u4e0a\u5c31\u53ef\u4ee5\u5b9a\u4f4d\u5185\u5b58\u4e2d\u6bb5\u4e2d\u67d0\u4e2a\u5b57\u8282\u7684\u4f4d\u7f6e\u3002\u56e0\u6b64 \u57fa\u5730\u5740\u52a0\u4e0a\u504f\u79fb\u91cf\u5c31\u5f62\u6210\u4e86\u5904\u7406\u5668\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u5730\u5740\u3002","title":"3.2.1 \u5206\u6bb5\u673a\u5236"},{"location":"os/3_80x86_protect_mode/#322","text":"\u5206\u9875\u673a\u5236\u4e3a\u4f20\u7edf\u9700\u6c42\u9875\u3001\u865a\u62df\u5185\u5b58\u7cfb\u7edf\u63d0\u4f9b\u4e86\u5b9e\u73b0\u673a\u5236\u3002\u5176\u4e2d\u865a\u62df\u5185\u5b58\u7cfb\u7edf\u7528\u4e8e\u5b9e\u73b0\u7a0b\u5e8f\u4ee3\u7801\u6309\u8981\u6c42\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u4e2d\u3002 \u2003\u4f7f\u7528 \u865a\u62df\u5b58\u50a8 \u6280\u672f\u3002\u865a\u62df\u5b58\u50a8\u662f\u4e00\u79cd\u5185\u5b58\u7ba1\u7406\u6280\u672f\uff0c\u4f7f\u7528\u8fd9\u79cd\u6280\u672f\u53ef\u8ba9\u7f16\u7a0b\u4eba\u5458\u4ea7\u751f\u5185\u5b58\u7a7a\u95f4\u8981\u6bd4\u8ba1\u7b97\u673a\u4e2d\u5b9e\u9645\u7269\u7406\u5185\u5b58\u5bb9\u91cf\u5927\u5f88\u591a\u7684\u9519\u89c9\u3002\u5728\u4f7f\u7528\u865a\u62df\u5b58\u50a8\u7684\u73af\u5883\u4e2d\uff0c\u5927\u5bb9\u91cf\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u9700\u8981\u4f7f\u7528\u5c0f\u5757\u7684\u7269\u7406\u5185\u5b58\uff08RAM \u6216 ROM\uff09\u4ee5\u53ca\u67d0\u4e9b\u5916\u90e8\u5b58\u50a8\u7a7a\u95f4\uff08\u4f8b\u5982\u5927\u5bb9\u91cf\u786c\u76d8\uff09\u6765\u6a21\u62df\u3002\u5f53\u4f7f\u7528\u5206\u9875\u65f6\uff0c\u6bcf\u4e2a\u6bb5\u88ab\u5212\u5206\u6210\u9875\u9762\uff08\u901a\u5e38\u6bcf\u9875\u4e3a 4KB \u5927\u5c0f\uff09\uff0c\u9875\u9762\u4f1a\u88ab\u5b58\u50a8\u4e8e\u7269\u7406\u5185\u5b58\u4e2d\u6216\u786c\u76d8\u4e0a\u3002\u64cd\u4f5c\u7cfb\u7edf\u901a\u8fc7\u7ef4\u62a4\u4e00\u4e2a\u9875\u76ee\u5f55\u548c\u4e00\u4e9b\u9875\u8868\u6765\u7559\u610f\u8fd9\u4e9b\u9875\u9762\u3002\u5f53\u7a0b\u5e8f\uff08\u6216\u4efb\u52a1\uff09\u8bd5\u56fe\u8bbf\u95ee\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u5730\u5740\u4f4d\u7f6e\u65f6\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u4f7f\u7528\u9875\u76ee\u5f55\u548c\u9875\u8868\u628a\u7ebf\u6027\u5730\u5740\u8f6c\u6362\u6210\u4e00\u4e2a\u7269\u7406\u5730\u5740\uff0c\u7136\u540e\u5728\u8be5\u5185\u5b58\u4f4d\u7f6e\u4e0a\u6267\u884c\u6240\u8981\u6c42\u7684\u64cd\u4f5c\uff08\u8bfb\u6216\u5199\uff09\u3002 \u5982\u679c\u5f53\u524d\u88ab\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5728\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u4e2d\u65ad\u7a0b\u5e8f\u7684\u6267\u884c\uff08\u901a\u8fc7\u4ea7\u751f\u4e00\u4e2a\u9875\u9519\u8bef\u5f02\u5e38\uff09\u3002\u7136\u540e\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u4ece\u786c\u76d8\u4e0a\u628a\u8be5\u9875\u9762\u8bfb\u5165\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u5e76\u7ee7\u7eed\u6267\u884c\u521a\u624d\u88ab\u4e2d\u65ad\u7684\u7a0b\u5e8f\u3002","title":"3.2.2 \u5206\u9875\u673a\u5236"},{"location":"os/3_80x86_protect_mode/#322_1","text":"\u5206\u9875\u4f7f\u7528\u4e86\u56fa\u5b9a\u957f\u5ea6\u7684\u9875\u9762\u3002 \u6bb5\u7684\u957f\u5ea6\u901a\u5e38\u4e0e\u5b58\u653e\u5728\u5176\u4e2d\u7684\u4ee3\u7801\u6216\u6570\u636e\u7ed3\u6784\u5177\u6709\u76f8\u540c\u7684\u957f\u5ea6\u3002\u4e0e\u6bb5\u4e0d\u540c\uff0c\u9875\u9762\u6709\u56fa\u5b9a\u7684\u957f\u5ea6\u3002\u5982\u679c\u4ec5\u4f7f\u7528\u5206\u6bb5\u5730\u5740\u8f6c\u6362\uff0c\u90a3\u4e48\u5b58\u50a8\u5728\u7269\u7406\u5185\u5b58\u4e2d\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5c06\u5305\u542b\u5176\u6240\u6709\u7684\u90e8\u5206\u3002\u4f46\u5982\u679c\u4f7f\u7528\u4e86\u5206\u9875\uff0c\u90a3\u4e48\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5c31\u53ef\u4ee5\u4e00\u90e8\u5206\u5b58\u50a8\u4e8e\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u800c\u53e6\u4e00\u90e8\u5206\u4fdd\u5b58\u5728\u78c1\u76d8\u4e2d\u3002 \u6bb5\u8868\u5b58\u50a8\u5728\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u9875\u8868\u5219\u4fdd\u5b58\u5728\u7269\u7406\u5730\u5740\u7a7a\u95f4\u3002 \u6bb5\u53d8\u6362\u8868\u53ef\u7531\u5206\u9875\u673a\u5236\u91cd\u65b0\u5b9a\u4f4d\u800c\u65e0\u9700\u6bb5\u673a\u5236\u7684\u4fe1\u606f\u6216\u5408\u4f5c\u3002\u6bb5\u53d8\u6362\u673a\u5236\u628a\u865a\u62df\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09\u53d8\u6362\u6210\u7ebf\u6027\u5730\u5740\uff0c\u5e76\u4e14\u5728\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u4e2d\u8bbf\u95ee\u81ea\u5df1\u7684\u8868\uff0c\u4f46\u662f\u5e76\u4e0d\u77e5\u6653\u5206\u9875\u673a\u5236\u628a\u8fd9\u4e9b\u7ebf\u6027\u5730\u5740\u8f6c\u6362\u5230\u7269\u7406\u5730\u5740\u7684\u8fc7\u7a0b\u3002\u7c7b\u4f3c\u5730\uff0c\u5206\u9875\u673a\u5236\u4e5f\u4e0d\u77e5\u9053\u7a0b\u5e8f\u4ea7\u751f\u5730\u5740\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u3002\u5206\u9875\u673a\u5236\u53ea\u662f\u7b80\u5355\u5730\u628a\u7ebf\u6027\u5730\u5740\u8f6c\u6362\u6210\u7269\u7406\u5730\u5740\uff0c\u5e76\u4e14\u5728\u7269\u7406\u5185\u5b58\u4e2d\u8bbf\u95ee\u81ea\u5df1\u7684\u8f6c\u6362\u8868\u3002","title":"3.2.2 \u4e24\u79cd\u673a\u5236\u533a\u522b"},{"location":"os/3_80x86_protect_mode/#33","text":"","title":"3.3 \u4fdd\u62a4"},{"location":"os/3_80x86_protect_mode/#331","text":"\u901a\u8fc7\u7ed9\u6bcf\u4e2a\u4efb\u52a1\u4e0d\u540c\u7684\u865a\u62df\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09\u7a7a\u95f4\u6765\u5b8c\u5168\u9694\u79bb\u5404\u4e2a\u4efb\u52a1\u3002\u5176\u5b9e\u73b0\u539f\u7406\u662f \u5411\u6bcf\u4e2a\u4efb\u52a1\u63d0\u4f9b\u4e0d\u540c\u7684\u903b\u8f91\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u7684\u53d8\u6362\u6620\u5c04 \u3002\u53ea\u9700\u7ed9\u6bcf\u4e2a\u4efb\u52a1\u5404\u81ea\u72ec\u7acb\u7684\u6620\u5c04\u8868\uff0c\u6bcf\u4e2a\u4efb\u52a1\u5c31\u4f1a\u6709\u4e0d\u540c\u7684\u5730\u5740\u53d8\u6362\u51fd\u6570\u3002\u5728 80X86 \u4e2d\uff0c\u6bcf\u4e2a\u4efb\u52a1\u90fd\u6709\u81ea\u5df1\u7684\u6bb5\u8868\u548c\u9875\u8868\u3002\u5f53\u5904\u7406\u5668\u5207\u6362\u53bb\u6267\u884c\u4e00\u4e2a\u65b0\u4efb\u52a1\u65f6\uff0c\u4efb\u52a1\u5207\u6362\u7684\u5173\u952e\u90e8\u5206\u5c31\u662f\u5207\u6362\u5230\u65b0\u4efb\u52a1\u7684\u53d8\u6362\u8868\u3002 \u2003\u901a\u8fc7\u5728\u6240\u6709\u4efb\u52a1\u4e2d\u5b89\u6392\u5177\u6709\u76f8\u540c\u7684\u865a\u62df\u5230\u7269\u7406\u5730\u5740\u6620\u5c04\u90e8\u5206\uff0c\u5e76\u4e14\u628a\u64cd\u4f5c\u7cfb\u7edf\u5b58\u50a8\u5728\u8fd9\u4e2a\u516c\u5171\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u90e8\u5206\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u88ab\u6240\u6709\u4efb\u52a1\u5171\u4eab\u3002\u8fd9\u4e2a\u6240\u6709\u4efb\u52a1\u90fd\u5177\u6709\u7684\u76f8\u540c\u865a\u62df\u5730\u5740\u7a7a\u95f4\u90e8\u5206\u88ab\u79f0\u4e3a\u5168\u5c40\u5730\u5740\u7a7a\u95f4\uff08Global address space\uff09\u3002\u6bcf\u4e2a\u4efb\u52a1\u552f\u4e00\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u90e8\u5206\u88ab\u79f0\u4e3a\u5c40\u90e8\u5730\u5740\u7a7a\u95f4\uff08Local address space\uff09\u3002\u5c40\u90e8\u5730\u5740\u7a7a\u95f4\u542b\u6709\u9700\u8981\u4e0e\u7cfb\u7edf\u4e2d\u5176\u4ed6\u4efb\u52a1\u533a\u522b\u5f00\u7684\u79c1\u6709\u7684\u4ee3\u7801\u548c\u6570\u636e\u3002\u7531\u4e8e\u6bcf\u4e2a\u4efb\u52a1\u4e2d\u5177\u6709\u4e0d\u540c\u7684\u5c40\u90e8\u5730\u5740\u7a7a\u95f4\uff0c\u56e0\u6b64 \u4e24\u4e2a\u4e0d\u540c\u4efb\u52a1\u4e2d\u5bf9\u76f8\u540c\u865a\u62df\u5730\u5740\u5904\u7684\u5f15\u7528\u5c06\u8f6c\u6362\u5230\u4e0d\u540c\u7684\u7269\u7406\u5730\u5740\u5904\u3002\u6240\u6709\u4efb\u52a1\u5728\u5168\u5c40\u5730\u5740\u7a7a\u95f4\u4e2d\u5bf9\u76f8\u540c\u865a\u62df\u5730\u5740\u7684\u5f15\u7528\u5c06\u88ab\u8f6c\u6362\u5230\u540c\u4e00\u4e2a\u7269\u7406\u5730\u5740\u5904 \u3002\u8fd9\u7ed9\u516c\u5171\u4ee3\u7801\u548c\u6570\u636e\uff08\u4f8b\u5982\u64cd\u4f5c\u7cfb\u7edf\uff09\u7684\u5171\u4eab\u63d0\u4f9b\u4e86\u652f\u6301\u3002 \u2003\u865a\u62df\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09\u7a7a\u95f4\u53ef\u5305\u542b\u6700\u591a 16K \u7684\u6bb5(2^14,\uff0c16\u4f4d\u7684\u6bb5\u9009\u62e9\u7b26\u4e2d\u53ea\u6709\u9ad814\u4f4d\u53ef\u4ee5\u7528\u6765\u9009\u62e9)\uff0c\u800c\u6bcf\u4e2a\u6bb5\u6700\u957f\u53ef\u8fbe 4GB\uff0832\u4f4d\u504f\u79fb\u5730\u5740\uff09\uff0c\u4f7f\u5f97\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5bb9\u91cf\u8fbe\u5230 64TB\uff082 46 KB\uff09\u3002\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u548c\u7269\u7406\u5730\u5740\u7a7a\u95f4\u90fd\u662f 4GB\uff082^32KB\uff0c32\u4f4d\u5730\u5740\u603b\u7ebf\uff09\u3002\u5b9e\u9645\u4e0a\uff0c \u5982\u679c\u7981\u7528\u5206\u9875\u673a\u5236\uff0c\u90a3\u4e48\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5c31\u662f\u7269\u7406\u5730\u5740\u7a7a\u95f4\u3002 \u2003\u865a\u62df\u5730\u5740\u7a7a\u95f4\u88ab\u5206\u5272\u6210\u5927\u5c0f\u76f8\u7b49\u7684\u4e24\u534a\uff08\u5404\u81ea2^13\u4e2a\u6bb5\uff09\u3002\u4e00\u534a\u7531 GDT \u6765\u6620\u5c04\u53d8\u6362\u5230\u7ebf\u6027\u5730\u5740\uff0c\u53e6\u4e00\u534a\u5219\u7531 LDT \u6765\u6620\u5c04\u3002 \u2003 \u5f53\u53d1\u751f\u4efb\u52a1\u5207\u6362\u65f6\uff0cLDT \u4f1a\u66f4\u6362\u6210\u65b0\u4efb\u52a1\u7684 LDT\uff0c\u4f46\u662f GDT \u5e76\u4e0d\u4f1a\u6539\u53d8\u3002\u56e0\u6b64\uff0cGDT \u6240\u6620\u5c04\u7684\u4e00\u534a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u662f\u7cfb\u7edf\u4e2d\u6240\u6709\u4efb\u52a1\u5171\u6709\u7684\uff0c\u4f46\u662f LDT \u6240\u6620\u5c04\u7684\u53e6\u4e00\u534a\u5219\u5728\u4efb\u52a1\u5207\u6362\u65f6\u88ab\u6539\u53d8\u3002\u7cfb\u7edf\u4e2d\u6240\u6709\u4efb\u52a1\u5171\u4eab\u7684\u6bb5\u7531 GDT \u6765\u6620\u5c04\u3002","title":"3.3.1 \u4efb\u52a1\u95f4\u4fdd\u62a4"},{"location":"os/3_80x86_protect_mode/#332","text":"\u4fdd\u62a4\u673a\u5236\u5bf9\u4efb\u52a1\u8fdb\u884c\u64cd\u4f5c\uff0c\u4ee5\u4fdd\u62a4\u64cd\u4f5c\u7cfb\u7edf\u5185\u5b58\u6bb5\u548c\u5904\u7406\u5668\u7279\u6b8a\u7cfb\u7edf\u5bc4\u5b58\u5668\u4e0d\u88ab\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u3002 \u2003\u5728\u4e00\u4e2a\u4efb\u52a1\u4e2d\uff0c\u5b9a\u4e49\u4e86 4 \u4e2a\u6267\u884c\u7279\u6743\u7ea7\uff08Privilege Levels\uff09\uff0c\u7528\u4e8e\u4f9d\u636e\u6bb5\u4e2d\u542b\u6709\u6570\u636e\u7684\u654f\u611f\u5ea6\u4ee5\u53ca\u4efb\u52a1\u4e2d\u4e0d\u540c\u7a0b\u5e8f\u90e8\u5206\u7684\u53d7\u4fe1\u7a0b\u5ea6\uff0c\u6765\u9650\u5236\u5bf9\u4efb\u52a1\u4e2d\u5404\u6bb5\u7684\u8bbf\u95ee\u3002\u6700\u654f\u611f\u7684\u6570\u636e\u88ab\u8d4b\u4e88\u4e86\u6700\u9ad8\u7279\u6743\u7ea7\uff0c\u5b83\u4eec\u53ea\u80fd\u88ab\u4efb\u52a1\u4e2d\u6700\u53d7\u4fe1\u4efb\u7684\u90e8\u5206\u8bbf\u95ee\u3002\u4e0d\u592a\u654f\u611f\u7684\u6570\u636e\u88ab\u8d4b\u4e88\u8f83\u4f4e\u7684\u7279\u6743\u7ea7\uff0c\u5b83\u4eec\u53ef\u4ee5\u88ab\u4efb\u52a1\u4e2d\u8f83\u4f4e\u7279\u6743\u7ea7\u7684\u4ee3\u7801\u8bbf\u95ee\u3002 \u7279\u6743\u7ea7\u7528\u6570\u5b57 0 \u5230 3 \u8868\u793a\uff0c0 \u5177\u6709\u6700\u9ad8\u7279\u6743\u7ea7\uff0c3\u662f\u6700\u4f4e\u7279\u6743\u7ea7\u3002","title":"3.3.2 \u7279\u6743\u7ea7\u4fdd\u62a4"},{"location":"os/3_80x86_protect_mode/#4","text":"","title":"4. \u5206\u6bb5\u673a\u5236"},{"location":"os/3_80x86_protect_mode/#41","text":"TI=0 \u8868\u793a\u63cf\u8ff0\u7b26\u5728 GDT \u4e2d\uff1bTI=1 \u8868\u793a\u63cf\u8ff0\u7b26\u5728 LDT \u4e2d\u3002\u7d22\u5f15\u5b57\u6bb5\u7ed9\u51fa\u4e86\u63cf\u8ff0\u7b26\u5728 GDT \u6216 LDT \u8868\u4e2d\u7684\u7d22\u5f15\u9879\u53f7\u3002 RPL (Request Privilege Level)\uff0c\u8bf7\u6c42\u7279\u6743\u7ea7\u3002","title":"4.1 \u6bb5\u9009\u62e9\u7b26"},{"location":"os/3_80x86_protect_mode/#42","text":"\u9897\u7c92\u5ea6G \uff1aG=0\uff0c\u6bb5\u9650\u957f\u5355\u4f4d\u662f1B\uff0cG=1\u5355\u4f4d\u662f4KB. \u6bb5\u7c7b\u578bTYPE : S=1\uff0c\u4ee3\u7801\u6216\u6570\u636e S=0\uff0c\u7cfb\u7edf \u63cf\u8ff0\u7b26\u7b2c10\u4f4dC\u4ee3\u8868\u4e00\u81f4\u6027\u6807\u5fd7: C=1\uff0c\u4e00\u81f4\u6027\u6bb5\uff1a\u64cd\u4f5c\u7cfb\u7edf\u62ff\u51fa\u6765\u88ab\u5171\u4eab\u7684\u4ee3\u7801\u6bb5,\u53ef\u4ee5\u88ab\u4f4e\u7279\u6743\u7ea7\u7684\u7528\u6237\u76f4\u63a5\u8c03\u7528\u8bbf\u95ee\u7684\u4ee3\u7801.\u8981\u6c42CPL >= DPL\u3002\u6545\u7279\u6743\u7ea7\u9ad8\u7684\u7a0b\u5e8f\u4e0d\u80fd\u8bbf\u95ee\u7279\u6743\u7ea7\u4f4e\u7684\u7a0b\u5e8f\u3002\u5f53CPL<DPL\u65f6\uff0c\u4f1a\u4ea7\u751f\u4e00\u822c\u4fdd\u62a4\u5f02\u5e38\u3002 C=0\uff0c\u975e\u4e00\u81f4\u6027\u6bb5\uff1a\u4e3a\u4e86\u907f\u514d\u4f4e\u7279\u6743\u7ea7\u7684\u8bbf\u95ee\u800c\u88ab\u64cd\u4f5c\u7cfb\u7edf\u4fdd\u62a4\u8d77\u6765\u7684\u7cfb\u7edf\u4ee3\u7801\uff08DPL=0\uff09\uff0c\u53ea\u5141\u8bb8\u540c\u7ea7\u8bbf\u95ee\uff0c\u5373CPL=DPL\uff0c\u4e14RPL<=CPL\u3002","title":"4.2 \u6bb5\u63cf\u8ff0\u7b26"},{"location":"os/3_80x86_protect_mode/#43","text":"\u5f53\u524d\u7279\u6743\u7ea7CPL \uff08Current Privilege Level\uff09: CPL \u662f\u5f53\u524d\u6b63\u5728\u6267\u884c\u7a0b\u5e8f\u6216\u4efb\u52a1\u7684\u7279\u6743\u7ea7\u3002\u5b83 \u5b58\u653e\u5728CS \u548c SS \u6bb5\u5bc4\u5b58\u5668\u7684\u4f4d 0 \u548c\u4f4d 1 \u4e2d \u3002\u901a\u5e38\uff0cCPL \u7b49\u4e8e\u5f53\u524d\u4ee3\u7801\u6bb5\u7684\u7279\u6743\u7ea7\u3002\u5f53\u7a0b\u5e8f\u628a\u63a7\u5236\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u5177\u6709\u4e0d\u540c\u7279\u6743\u7ea7\u7684\u4ee3\u7801\u6bb5\u4e2d\u65f6\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u6539\u53d8 CPL\u3002\u5f53\u8bbf\u95ee\u4e00\u4e2a\u4e00\u81f4\u6027\uff08conforming\uff09\u4ee3\u7801\u6bb5\u65f6\uff0c\u5219\u5904\u7406\u5668\u5bf9 CPL \u7684\u8bbe\u7f6e\u6709\u4e9b\u4e0d\u540c\u3002\u7279\u6743\u7ea7\u503c\u9ad8\u4e8e\uff08\u5373\u4f4e\u7279\u6743\u7ea7\uff09\u6216\u7b49\u4e8e\u4e00\u81f4\u4ee3\u7801\u6bb5DPL \u7684\u4efb\u4f55\u6bb5\u90fd\u53ef\u4ee5\u8bbf\u95ee\u4e00\u81f4\u4ee3\u7801\u6bb5\u3002\u5e76\u4e14\u5f53\u5904\u7406\u5668\u8bbf\u95ee\u4e00\u4e2a\u7279\u6743\u7ea7\u4e0d\u540c\u4e8e CPL \u7684\u4e00\u81f4\u4ee3\u7801\u6bb5\u65f6\uff0cCPL \u5e76\u4e0d\u4f1a\u88ab\u4fee\u6539\u6210\u4e00\u81f4\u4ee3\u7801\u6bb5\u7684 DPL\u3002 \u63cf\u8ff0\u7b26\u7279\u6743\u7ea7DPL \uff08Descriptor Privilege Level\uff09: DPL \u662f\u4e00\u4e2a\u6bb5\u6216\u95e8\u7684\u7279\u6743\u7ea7\u3002\u5b83 \u5b58\u653e\u5728\u6bb5\u6216\u95e8\u63cf \u8ff0\u7b26\u7684 DPL \u5b57\u6bb5\u4e2d \u3002\u5728\u5f53\u524d\u6267\u884c\u4ee3\u7801\u6bb5\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u6bb5\u6216\u95e8\u65f6\uff0c\u6bb5\u6216\u95e8\u7684 DPL \u4f1a\u7528\u6765\u4e0e CPL \u4ee5\u53ca\u6bb5\u6216\u95e8\u9009\u62e9\u7b26\u4e2d\u7684 RPL\uff08\u89c1\u4e0b\u9762\u8bf4\u660e\uff09\u4f5c\u6bd4\u8f83\u3002 \u8bf7\u6c42\u7279\u6743\u7ea7RPL \uff08Request Privilege Level\uff09\uff1aRPL \u662f\u4e00\u79cd\u8d4b\u4e88\u6bb5\u9009\u62e9\u7b26\u7684\u8d85\u8d8a\u7279\u6743\u7ea7\uff0c\u5b83 \u5b58\u653e\u5728\u6bb5\u9009\u62e9\u7b26\u7684\u4f4d 0 \u548c\u4f4d 1 \u4e2d \u3002\u5904\u7406\u5668\u4f1a\u540c\u65f6\u68c0\u67e5 RPL \u548c CPL\uff0c\u4ee5\u786e\u5b9a\u662f\u5426\u5141\u8bb8\u8bbf\u95ee\u4e00\u4e2a\u6bb5\u3002\u5373\u4f7f\u7a0b\u5e8f\u6216\u4efb\u52a1\u5177\u6709\u8db3\u591f\u7684\u7279\u6743\u7ea7\uff08CPL\uff09\u6765\u8bbf\u95ee\u4e00\u4e2a\u6bb5\uff0c\u4f46\u662f\u5982\u679c\u63d0\u4f9b\u7684 RPL \u7279\u6743\u7ea7\u4e0d\u8db3\u7684\u8bdd\u8bbf\u95ee\u4e5f\u5c06\u88ab\u62d2\u7edd\u3002RPL \u53ef\u7528\u6765\u786e\u4fdd\u9ad8\u7279\u6743\u7ea7\u7684\u4ee3\u7801\u4e0d\u4f1a\u4ee3\u8868\u5e94\u7528\u7a0b\u5e8f\u53bb\u8bbf\u95ee\u4e00\u4e2a\u6bb5\uff0c\u9664\u975e\u5e94\u7528\u7a0b\u5e8f\u81ea\u5df1\u5177\u6709\u8bbf\u95ee\u8fd9\u4e2a\u6bb5\u7684\u6743\u9650\u3002 \u5f53\u4ee3\u7801\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u6bb5\u6216\u95e8\uff08\u8c03\u7528\u95e8\uff09\u65f6\uff0c\u8981\u6c42 DPL >= max{CPL, RPL}\u3002","title":"4.3 \u7279\u6743\u7ea7"},{"location":"os/3_80x86_protect_mode/#5","text":"80X86 \u4f7f\u7528 4K\uff082^12\uff09\u5b57\u8282\u56fa\u5b9a\u5927\u5c0f\u7684\u9875\u9762\u3002\u6bcf\u4e2a\u9875\u9762\u5747\u662f 4KB\uff0c\u5e76\u4e14\u5bf9\u9f50\u4e8e 4K \u5730\u5740\u8fb9\u754c\u5904\u3002\u8fd9\u8868 \u793a\u5206\u9875\u673a\u5236\u628a 2^32\u5b57\u8282\uff084GB\uff09\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5212\u5206\u6210 2^20\uff081M = 1048576\uff09\u4e2a\u9875\u9762\u3002\u5206\u9875\u673a\u5236\u901a\u8fc7\u628a\u7ebf\u6027 \u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u9875\u9762\u91cd\u65b0\u5b9a\u4f4d\u5230\u7269\u7406\u5730\u5740\u7a7a\u95f4\u4e2d\u8fdb\u884c\u64cd\u4f5c\u3002\u7531\u4e8e 4K \u5927\u5c0f\u7684\u9875\u9762\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u8fdb\u884c\u6620\u5c04\uff0c\u5e76 \u4e14\u5bf9\u9f50\u4e8e 4K \u8fb9\u754c\uff0c\u56e0\u6b64 \u7ebf\u6027\u5730\u5740\u7684\u4f4e 12 \u6bd4\u7279\u4f4d\u53ef\u4f5c\u4e3a\u9875\u5185\u504f\u79fb\u91cf\u76f4\u63a5\u4f5c\u4e3a\u7269\u7406\u5730\u5740\u7684\u4f4e 12 \u4f4d\u3002\u5206\u9875\u673a\u5236\u6267\u884c\u7684\u91cd\u5b9a\u4f4d\u529f\u80fd\u53ef\u4ee5\u770b\u4f5c\u662f\u628a\u7ebf\u6027\u5730\u5740\u7684\u9ad8 20 \u4f4d\u8f6c\u6362\u5230\u5bf9\u5e94\u7269\u7406\u5730\u5740\u7684\u9ad8 20 \u4f4d\u3002","title":"5. \u5206\u9875\u673a\u5236"},{"location":"os/3_80x86_protect_mode/#51","text":"\u9875\u8868\u542b\u6709 2^20\uff081M\uff09\u4e2a\u8868\u9879\uff0c\u800c\u6bcf\u9879\u5360\u7528 4 \u5b57\u8282\u3002\u5982\u679c\u4f5c\u4e3a\u4e00\u4e2a\u8868\u6765\u5b58\u653e\u7684\u8bdd\uff0c\u5b83\u4eec\u6700\u591a\u5c06\u5360\u7528 \u8fde\u7eed4MB \u7684\u5185\u5b58(\u903b\u8f91\u5730\u5740\u4e2d\u63d0\u4f9b\u7684\u9875\u8868\u7684\u7d22\u5f15\u503c\uff0c\u53ea\u6709\u662f\u8fde\u7eed\u5185\u5b58\uff0c\u4e14\u6bcf\u4e2a\u8868\u9879\u5927\u5c0f\u56fa\u5b9a\uff0c\u624d\u53ef\u4ee5\u6839\u636e\u9996\u5730\u5740\u548c\u7d22\u5f15\u8ba1\u7b97\u4efb\u610f\u8868\u9879\u7684\u5730\u5740)\u3002\u56e0\u6b64\u4e3a\u4e86\u51cf\u5c11\u8fde\u7eed\u5185\u5b58\u5360\u7528\u91cf\uff0c80X86 \u4f7f\u7528\u4e86\u4e24\u7ea7\u8868\u3002 \u2003\u7b2c\u4e00\u7ea7\u8868\u79f0\u4e3a\u9875\u76ee\u5f55\uff0c\u7ebf\u6027\u5730\u5740\u7684\u6700\u9ad8 10 \u4f4d\uff08\u4f4d 31--22\uff09\u7528\u4f5c\u4e00\u7ea7\u8868\uff08\u9875\u76ee\u5f55\uff09\u4e2d\u7684\u7d22\u5f15\u503c\uff0c\u6765\u9009\u62e92 ^10\u4e2a\u4e8c\u7ea7\u8868\u4e4b\u4e00\u3002 \u56e0\u6b64\u4e00\u4e2a\u9875\u76ee\u5f55\u9879\u6240\u80fd\u5bfb\u627e\u7684\u5730\u5740\u7a7a\u95f4\u5927\u5c0f\u4e3a4MB\uff08=2^10\u9875 * 4KB\uff09. \u2003\u7b2c\u4e8c\u7ea7\u8868\u79f0\u4e3a\u9875\u8868(page table)\uff0c\u4e8c\u7ea7\u9875\u8868\u4f7f\u7528\u7ebf\u6027\u5730\u5740\u4e2d\u95f4 10 \u4f4d\uff08\u4f4d 21--12\uff09\u4f5c\u4e3a\u8868\u9879\u7d22\u5f15\u503c\uff0c\u4ee5\u83b7\u53d6\u542b\u6709\u9875\u9762 20 \u4f4d\u7269\u7406\u57fa\u5730\u5740\u7684\u8868\u9879\u3002 \u2003\u4e00\u4e2a\u9875\u9762\u5927\u5c0f\u4e3a4KB\uff0c\u6b63\u597d\u53ef\u4ee5\u88c5\u4e0b\u9875\u76ee\u5f55(2^10 4B=4KB)\uff0c\u800c\u4e00\u4e2a\u4e8c\u7ea7\u9875\u8868\u5305\u542b2^10\u4e2a\u9875\u8868\u9879\uff0c\u603b\u7684\u5927\u5c0f\u4e5f\u4e3a4KB\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728\u4e00\u4e2a\u9875\u9762\u4e2d\u3002\u8fd9\u6837\u4ec5\u9700\u4e24\u4e2a\u9875\u9762(8KB)\u5927\u5c0f\u5373\u53ef\u5bfb\u5740 \u2003\u901a\u8fc7\u4e8c\u7ea7\u8868\u7ed3\u6784\u4e8b\u5b9e\u4e0a\u5e76\u6ca1\u6709\u89e3\u51b3\u9700\u8981\u4f7f\u75284MB\u5185\u5b58\u6765\u5b58\u653e\u9875\u8868\u7684\u95ee\u9898\uff0c\u4f46\u662f\u5176 \u5141\u8bb8\u9875\u8868\u88ab\u5206\u6563\u5728\u5185\u5b58\u4e2d\u5404\u4e2a\u9875\u9762\u4e2d\uff0c\u800c\u975e\u4fdd\u5b58\u5728\u8fde\u7eed\u76844MB\u5185\u5b58\u5757\u4e2d\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u4e3a\u4e0d\u5b58\u5728\u7684\u6216\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u672a\u4f7f\u7528\u7684\u90e8\u5206\u5206\u914d\u4e8c\u7ea7\u9875\u8868 *\u3002\u867d\u7136\u76ee\u5f55\u8868\u9875\u9762\u5fc5\u987b\u603b\u662f\u5b58\u5728\u4e8e\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u4f46\u662f\u4e8c\u7ea7\u9875\u8868\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u518d\u5206\u914d\u3002\u8fd9\u4f7f\u5f97\u9875\u8868\u7ed3\u6784\u7684\u5927\u5c0f\u5bf9\u5e94\u4e8e\u5b9e\u9645\u4f7f\u7528\u7684\u7ebf\u6027\u5730\u5740\u7a7a\u95f4\u5927\u5c0f\u3002 \u2003\u9875\u76ee\u5f55\u8868\u548c\u9875\u8868\u90fd\u5305\u542b\u4e00\u4e2a\u5b58\u5728\u5c5e\u6027P\uff0c\u524d\u8005\u6307\u660e\u5bf9\u5e94\u7684\u4e8c\u7ea7\u9875\u8868\u662f\u5426\u5b58\u5728\uff0c\u540e\u8005\u6307\u660e\u9875\u9762\u662f\u5426\u5b58\u5728\uff1b\u9875\u76ee\u5f55/\u9875\u8868\u4e2d\u6bcf\u4e2a\u8868\u9879\u5927\u5c0f\u4e3a 32 \u4f4d\uff0c\u53ea\u9700\u8981\u5176\u4e2d\u7684 20 \u4f4d\u6765\u5b58\u653e \u9875\u8868\u7684\u7d22\u5f15/\u9875\u9762\u7684\u7269\u7406\u57fa\u5730\u5740\uff0c\u5269\u4e0b\u7684 12\u4f4d\u53ef\u7528\u4e8e\u5b58\u653e\u4e00\u4e9b\u5c5e\u6027\u4fe1\u606f\u3002\u5982\u679c\u7a0b\u5e8f\u8bbf\u95ee\u7269\u7406\u5185\u5b58\u4e2d\u4e0d\u5b58\u5728\u7684\u9875\u9762\uff0c\u5904\u7406\u5668\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u7f3a\u9875\u5f02\u5e38\u3002\u6b64\u65f6\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u5f02\u5e38\u5904\u7406\u8fc7\u7a0b\u628a\u7f3a\u5c11\u7684\u9875\u9762\u4ece\u78c1\u76d8\u4e0a\u8c03\u5165\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u5e76\u628a\u76f8\u5e94\u7269\u7406\u5730\u5740\u5b58\u653e\u5728\u8868\u9879\u4e2d\u3002","title":"5.1 \u4e24\u7ea7\u9875\u8868\u7ed3\u6784"},{"location":"os/3_80x86_protect_mode/#6","text":"","title":"6 \u4fdd\u62a4"},{"location":"os/3_80x86_protect_mode/#61","text":"\u7a0b\u5e8f\u63a7\u5236\u8f6c\u79fb\u6307\u4ee4 \u2003\u7a0b\u5e8f\u7684\u63a7\u5236\u8f6c\u79fb\u4f7f\u7528\u6307\u4ee4 JMP\u3001RET\u3001INT \u548c IRET \u4ee5\u53ca\u5f02\u5e38\u548c\u4e2d\u65ad\u673a\u5236\u6765\u5b9e\u73b0\u3002JMP \u6216 CALL \u6307\u4ee4\u53ef\u4ee5\u5229\u7528\u4ee5\u4e0b\u56db\u79cd\u65b9\u6cd5\u4e4b\u4e00\u6765\u5f15\u7528\u53e6\u5916\u4e00\u4e2a\u4ee3\u7801\u6bb5\uff1a \u76ee\u6807\u64cd\u4f5c\u6570\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u6bb5\u9009\u62e9\u7b26\uff1b \u76ee\u6807\u64cd\u4f5c\u6570\u6307\u5411\u4e00\u4e2a\u8c03\u7528\u95e8\u63cf\u8ff0\u7b26\uff0c\u800c\u8be5\u63cf\u8ff0\u7b26\u4e2d\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u9009\u62e9\u7b26\uff1b \u76ee\u6807\u64cd\u4f5c\u6570\u6307\u5411\u4e00\u4e2a TSS\uff0c\u800c\u8be5 TSS \u4e2d\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u9009\u62e9\u7b26\uff1b \u76ee\u6807\u64cd\u4f5c\u6570\u6307\u5411\u4e00\u4e2a\u4efb\u52a1\u95e8\uff0c\u8be5\u4efb\u52a1\u95e8\u6307\u5411\u4e00\u4e2a TSS\uff0c\u800c\u8be5 TSS \u4e2d\u542b\u6709\u76ee\u6807\u4ee3\u7801\u6bb5\u7684\u9009\u62e9\u7b26\uff1b \u95e8\u63cf\u8ff0\u7b26 \u8c03\u7528\u95e8 \uff08Call Gate\uff09\u7c7b\u578b TYPE=12 \u2003\u8c03\u7528\u95e8\u7528\u4e8e\u5728\u4e0d\u540c\u7279\u6743\u7ea7\u4e4b\u95f4\u5b9e\u73b0\u53d7\u63a7\u7684\u7a0b\u5e8f\u63a7\u5236\u8f6c\u79fb\u3002\u5b83\u4eec\u901a\u5e38\u4ec5\u7528\u4e8e\u4f7f\u7528\u7279\u6743\u7ea7\u4fdd\u62a4\u673a\u5236\u7684\u64cd\u4f5c; \u7cfb\u7edf\u4e2d\u8c03\u7528\u95e8\u63cf\u8ff0\u7b26\u4e00\u822c\u5b58\u653e\u5728GDT\u6216LDT\u4e2d\uff0c\u4e0d\u80fd\u5b58\u653e\u5728IDT\u4e2d\u3002 \u2003\u4e3a\u4e86\u8bbf\u95ee\u8c03\u7528\u95e8\uff0c\u6211\u4eec\u9700\u8981\u4e3a CALL \u6216 JMP \u6307\u4ee4\u7684\u64cd\u4f5c\u6570\u63d0\u4f9b\u4e00\u4e2a\u8fdc\u6307\u9488\u3002\u8be5\u6307\u9488\u4e2d\u7684\u6bb5\u9009\u62e9\u7b26\u7528\u4e8e\u6307\u5b9a\u8c03\u7528\u95e8\uff0c\u800c\u6307\u9488\u7684\u504f\u79fb\u503c\u867d\u7136\u9700\u8981\u4f46 CPU \u5e76\u4e0d\u4f1a\u7528\u5b83\u3002\u8be5\u504f\u79fb\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u4efb\u610f\u503c\u3002 P=1\u4ee3\u8868\u6bb5\u5b58\u5728 \u9677\u9631\u95e8 \uff08Trap Gate\uff09\u7c7b\u578b TYPE=15, \u5b58\u50a8\u5728IDT\u4e2d\u3002 \u4e2d\u65ad\u95e8 \uff08Interrupt Gate\uff09\uff0c\u7c7b\u578b TYPE=14, \u5b58\u50a8\u5728IDT\u4e2d\u3002 \u4efb\u52a1\u95e8 \uff08Task Gate\uff09\uff0c\u7c7b\u578b TYPE=5, \u53ef\u5b58\u50a8\u5728GDT\\LDT\\IDT\u4e2d\u3002 \u2003\u4e2d\u65ad\u95e8\u4e0e\u9677\u9631\u95e8\u552f\u4e00\u7684\u533a\u522b\u5728\u4e8e\u5904\u7406\u5668\u64cd\u4f5c EFLAGS \u5bc4\u5b58\u5668 IF \u6807\u5fd7\u7684\u65b9\u6cd5\u3002\u5f53\u901a\u8fc7\u4e2d\u65ad\u95e8\u8bbf\u95ee\u4e00\u4e2a \u5f02\u5e38\u6216\u4e2d\u65ad\u5904\u7406\u8fc7\u7a0b\u65f6\uff0c\u5904\u7406\u5668\u4f1a\u590d\u4f4d IF \u6807\u5fd7\u4ee5\u9632\u6b62\u5176\u4ed6\u4e2d\u65ad\u5e72\u6270\u5f53\u524d\u4e2d\u65ad\u5904\u7406\u8fc7\u7a0b\u3002\u968f\u540e\u7684 IRET \u6307\u4ee4 \u5219\u4f1a\u7528\u4fdd\u5b58\u5728\u5806\u6808\u4e0a\u7684\u5185\u5bb9\u6062\u590d EFLAGS \u5bc4\u5b58\u5668\u7684 IF \u6807\u5fd7\u3002\u800c\u901a\u8fc7\u9677\u9631\u95e8\u8bbf\u95ee\u5904\u7406\u8fc7\u7a0b\u5e76\u4e0d\u4f1a\u5f71\u54cd IF \u6807 \u5fd7\u3002 \u5806\u6808\u5207\u6362(\u7528\u6237\u6808\u5207\u6362) \u2003\u6bcf\u5f53\u8c03\u7528\u95e8\u7528\u4e8e\u628a\u7a0b\u5e8f\u63a7\u5236\u8f6c\u79fb\u5230\u4e00\u4e2a\u66f4\u9ad8\u7ea7\u522b\u7684\u975e\u4e00\u81f4\u6027\u4ee3\u7801\u6bb5\u65f6\uff0cCPU \u4f1a\u81ea\u52a8\u5207\u6362\u5230\u76ee\u7684\u4ee3\u7801\u6bb5 \u7279\u6743\u7ea7\u7684\u5806\u6808\u53bb\u3002\u6267\u884c\u6808\u5207\u6362\u64cd\u4f5c\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u9ad8\u7279\u6743\u7ea7\u7a0b\u5e8f\u7531\u4e8e\u6808\u7a7a\u95f4\u4e0d\u8db3\u800c\u5f15\u8d77\u5d29\u6e83\uff0c\u540c\u65f6\u4e5f\u4e3a \u4e86\u9632\u6b62\u4f4e\u7279\u6743\u7ea7\u7a0b\u5e8f\u901a\u8fc7\u5171\u4eab\u7684\u5806\u6808\u6709\u610f\u6216\u65e0\u610f\u5730\u5e72\u6270\u9ad8\u7279\u6743\u7ea7\u7684\u7a0b\u5e8f\u3002 \u4efb\u52a1\u5207\u6362 TSS\\TR\u5bc4\u5b58\u5668\\TSS\u63cf\u8ff0\u7b26(\u4efb\u52a1\u95e8\u63cf\u8ff0\u7b26) : TSS(Task State Segment)\u662f\u4e00\u5757\u5927\u5c0f\u4e3a104\u5b57\u8282\u7684\u5185\u5b58\uff0c\u5b58\u50a8\u4e86\u5927\u90e8\u5206\u5bc4\u5b58\u5668\u7684\u503c TR\u5bc4\u5b58\u5668\u5b58\u50a8\u4e86TSS\u7684\u5730\u5740\uff0c\u5927\u5c0f\uff0c\u548cTSS\u9009\u62e9\u7b26(\u7528\u4ee5\u4eceGDT\u4e2d\u5b9a\u4f4dTSS\u63cf\u8ff0\u7b26) TSS\u63cf\u8ff0\u7b26\u662fGDT\u8868\u4e2d\u7684\u4e00\u9879\uff0c\u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8\u65f6\uff0c\u4eceTSS\u63cf\u8ff0\u7b26\u4e2d\u53d6\u503c\u521d\u59cb\u5316TR\u5bc4\u5b58\u5668 \u2003\u5904\u7406\u5668\u53ef\u4f7f\u7528\u4e00\u4e0b 4 \u79cd\u65b9\u5f0f\u4e4b\u4e00\u6267\u884c\u4efb\u52a1\u5207\u6362\u64cd\u4f5c: \u5f53\u524d\u4efb\u52a1\u5bf9 GDT \u4e2d\u7684 TSS \u63cf\u8ff0\u7b26\u6267\u884c JMP \u6216 CALL \u6307\u4ee4 \u5f53\u524d\u4efb\u52a1\u5bf9 GDT \u6216 LDT \u4e2d\u7684\u4efb\u52a1\u95e8\u63cf\u8ff0\u7b26\u6267\u884c JMP \u6216 CALL \u6307\u4ee4 \u4e2d\u65ad\u6216\u5f02\u5e38\u5411\u91cf\u6307\u5411 IDT \u8868\u4e2d\u7684\u4efb\u52a1\u95e8\u63cf\u8ff0\u7b26 \u5f53 EFLAGS \u4e2d\u7684 NT \u6807\u5fd7\u7f6e\u4f4d\u65f6\u5f53\u524d\u4efb\u52a1\u6267\u884c IRET \u6307\u4ee4\u3002","title":"6.1 \u4ee3\u7801\u6bb5\u4e4b\u95f4\u8f6c\u79fb\u63a7\u5236\u65f6\u7684\u7279\u6743\u7ea7\u68c0\u67e5"},{"location":"os/3_80x86_protect_mode/#64","text":"\u4e3a\u4e86\u6709\u52a9\u4e8e\u5904\u7406\u5f02\u5e38\u548c\u4e2d\u65ad\uff0c\u6bcf\u4e2a\u9700\u8981\u88ab\u5904\u7406\u5668\u8fdb\u884c\u7279\u6b8a\u5904\u7406\u7684\u5904\u7406\u5668\u5b9a\u4e49\u7684\u5f02\u5e38\u548c\u4e2d\u65ad\u6761\u4ef6\u90fd\u88ab\u8d4b\u4e88\u4e86\u4e00\u4e2a\u6807\u8bc6\u53f7\uff0c\u79f0\u4e3a\u5411\u91cf\uff08vector\uff09\u3002\u5904\u7406\u5668\u628a\u8d4b\u4e88\u5f02\u5e38\u6216\u4e2d\u65ad\u7684\u5411\u91cf\u7528\u4f5c\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT\uff08Interrupt Descriptor Table\uff09\u4e2d\u7684\u4e00\u4e2a\u7d22\u5f15\u53f7\uff0c\u6765\u5b9a\u4f4d\u4e00\u4e2a\u5f02\u5e38\u6216\u4e2d\u65ad\u7684\u5904\u7406\u7a0b\u5e8f\u5165\u53e3\u70b9\u4f4d\u7f6e\u3002 \u4e2d\u65ad\u6e90 \uff1a\u5916\u90e8\u786c\u4ef6\u4e2d\u65ad\u548c\u8f6f\u4ef6\u4ea7\u751f\u7684\u4e2d\u65ad \u5f02\u5e38\u6e90 \uff1a\u8f6f\u4ef6\u68c0\u6d4b\u5230\u7684\u7a0b\u5e8f\u9519\u8bef\u5f02\u5e38\u548c\u8f6f\u4ef6\u4ea7\u751f\u7684\u5f02\u5e38 \u2003\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT\uff08Interrupt Descriptor Table\uff09\u5c06\u6bcf\u4e2a\u5f02\u5e38\u6216\u4e2d\u65ad\u5411\u91cf\u5206\u522b\u4e0e\u5b83\u4eec\u7684\u5904\u7406\u8fc7\u7a0b\u8054\u7cfb\u8d77\u6765\u3002 \u4e0e GDT \u548c LDT \u8868\u7c7b\u4f3c\uff0cIDT \u4e5f\u662f\u7531 8 \u5b57\u8282\u957f\u63cf\u8ff0\u7b26\u7ec4\u6210\u7684\u4e00\u4e2a\u6570\u7ec4\u3002\u4e0e GDT \u4e0d\u540c\u7684\u662f\uff0c\u8868\u4e2d\u7b2c 1 \u9879\u53ef\u4ee5\u5305\u542b\u63cf\u8ff0\u7b26\u3002","title":"6.4 \u4e2d\u65ad\u548c\u5f02\u5e38\u5411\u91cf"},{"location":"os/3_80x86_protect_mode/#7","text":"","title":"7. \u8865\u5145"},{"location":"os/3_80x86_protect_mode/#71-gdt","text":"GDT\u7684\u7b2c\u4e00\u9879\u89c4\u5b9a\u603b\u662f\u7a7a\u63cf\u8ff0\u7b26\uff1a\u56e0\u4e3a\u5f53LDTR\u5bc4\u5b58\u5668\u4e3a0\u65f6\uff0c\u6307\u5411\u7684\u6b63\u662fGDT\u4e2d\u7b2c\u4e00\u9879\uff0c\u7a7a\u63cf\u8ff0\u7b26\u8868\u660e\u5f53\u524d\u4efb\u52a1\u6ca1\u6709LDT\u3002","title":"7.1 GDT"},{"location":"os/3_80x86_protect_mode/#72-iret-and-ret","text":"IRET \u6307\u4ee4\u4e0e RET \u6307\u4ee4\u7c7b\u4f3c\uff0c\u4f46 IRET \u8fd8\u4f1a\u628a\u4fdd\u5b58\u7684\u5bc4\u5b58\u5668\u5185\u5bb9\u6062\u590d\u5230 EFLAGS \u4e2d\u3002\u4e0d\u8fc7\u53ea\u6709\u5f53 CPL \u662f 0 \u65f6\u624d\u4f1a\u6062\u590d EFLAGS \u4e2d\u7684 IOPL \u5b57\u6bb5\uff0c\u5e76\u4e14\u53ea\u6709\u5f53 CPL<=IOPL \u65f6\uff0cIF \u6807\u5fd7\u624d\u4f1a\u88ab\u6539\u53d8\u3002 \u5982\u679c\u5f53\u8c03\u7528\u4e2d\u65ad\u5904\u7406\u8fc7\u7a0b\u65f6\u53d1\u751f\u4e86\u5806\u6808\u5207\u6362\uff0c\u90a3\u4e48\u5728\u8fd4\u56de\u65f6 IRET \u6307\u4ee4\u4f1a\u5207\u6362\u56de\u5230\u539f\u6765\u7684\u5806\u6808\u3002","title":"7.2 IRET and RET"},{"location":"os/3_80x86_protect_mode/#73-eflags","text":"IOPL \u7279\u6743\u7ea7\u5b57\u6bb5\uff1a\u4e24\u4e2a\u4f4d\u5bbd\uff0c\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u3002\u6307\u5b9a\u4e86\u8981\u6c42\u6267\u884cI/O\u6307\u4ee4\u7684\u7279\u6743\u7ea7\uff0c\u5982\u679cCPL<=IOPL\uff0cI/O\u6307\u4ee4\u53ef\u4ee5\u6267\u884c\uff0c\u5426\u5219\u53d1\u751f\u4e00\u4e2a\u4fdd\u62a4\u5f02\u5e38\u3002 NT \u5d4c\u5957\u4efb\u52a1\u4f4d\uff1a\u63a7\u5236IRET\u6307\u4ee4\u7684\u8fd0\u884c\u3002\u5982\u679cNT=0\uff0c\u7528\u6808\u4e2d\u4fdd\u5b58\u7684\u503c\u6062\u590dEFLAGS\u3001CS\u548cEIP\u6267\u884c\u5e38\u89c4\u7684\u4e2d\u65ad\u8fd4\u56de\u3002 \u5982\u679cNT=1\uff0c\u4e2d\u65ad\u8fd4\u56de\u7528\u4e00\u4efb\u52a1\u8f6c\u6362\u4ee3\u66ff\u4e0a\u8ff0\u8fc7\u7a0b\u3002 \u53ea\u6709\u5728\u7279\u6743\u7ea70\u4e0b\u6267\u884c\u7684\u7a0b\u5e8f\u624d\u80fd\u6539\u53d8VM\u53caIOPL\u5b57\u6bb5\u3002IF\u4f4d\u53ea\u80fd\u7531\u5177\u6709I/O\u7279\u6743\u7684\u7a0b\u5e8f\u6240\u6539\u53d8\u3002","title":"7.3 EFLAGS"},{"location":"os/4_kernel_struct/","text":"Linux\u5185\u6838\u4f53\u7cfb\u7ed3\u6784 \u2003\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u7ed3\u6784\u6a21\u5f0f\u4e3b\u8981\u53ef\u5206\u4e3a\u6574\u4f53\u5f0f\u7684\u5355\u5185\u6838\u6a21\u5f0f\u548c\u5c42\u6b21\u5f0f\u7684\u5fae\u5185\u6838\u6a21\u5f0f\uff0c\u4ee5\u53ca\u8fd9\u4e24 \u8005\u7684\u6df7\u5408\u6a21\u5f0f\u3002 Linux 0.12 \u5185\u6838\u91c7\u7528\u7684\u662f\u5355\u5185\u6838\u6a21\u5f0f\u3002 \u2003\u5728\u5355\u5185\u6838\u6a21\u5f0f\u7684\u7cfb\u7edf\u4e2d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u6240\u63d0\u4f9b\u670d\u52a1\u7684\u6d41\u7a0b\u4e3a\uff1a\u5e94\u7528\u4e3b\u7a0b\u5e8f\u4f7f\u7528\u6307\u5b9a\u7684\u53c2\u6570\u503c\u6267\u884c\u7cfb\u7edf\u8c03 \u7528\u6307\u4ee4(int x80)\uff0c\u4f7f CPU \u4ece\u7528\u6237\u6001\uff08User Mode\uff09\u5207\u6362\u5230\u6838\u5fc3\u6001\uff08Kernel Model\uff09\uff0c\u7136\u540e\u64cd\u4f5c\u7cfb\u7edf\u6839\u636e\u5177\u4f53 \u7684\u53c2\u6570\u503c\u8c03\u7528\u7279\u5b9a\u7684\u7cfb\u7edf\u8c03\u7528\u670d\u52a1\u7a0b\u5e8f\uff0c\u800c\u8fd9\u4e9b\u670d\u52a1\u7a0b\u5e8f\u5219\u6839\u636e\u9700\u8981\u518d\u8c03\u7528\u5e95\u5c42\u7684\u4e00\u4e9b\u652f\u6301\u51fd\u6570\u4ee5\u5b8c\u6210 \u7279\u5b9a\u7684\u529f\u80fd\u3002\u5728\u5b8c\u6210\u4e86\u5e94\u7528\u7a0b\u5e8f\u6240\u8981\u6c42\u7684\u670d\u52a1\u540e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53c8\u4f7f CPU \u4ece\u6838\u5fc3\u6001\u5207\u6362\u56de\u7528\u6237\u6001\uff0c\u4ece\u800c\u8fd4\u56de \u5230\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7ee7\u7eed\u6267\u884c\u540e\u9762\u7684\u6307\u4ee4\u3002 \u2003\u57282.6\u7248\u672c\u524d, Linux\u7cfb\u7edf\u7684\u8fdb\u7a0b\u5728\u5185\u6838\u6001\u8fd0\u884c\u65f6\u4e0d\u4f1a\u88ab\u8c03\u5ea6\u7a0b\u5e8f\u5207\u6362\u3002\u5373\u8fdb\u7a0b\u5728\u5185\u6838\u6001\u7a0b\u5e8f\u4e2d\u8fd0\u884c\u65f6\u662f\u4e0d\u53ef\u62a2\u5360\u7684 \uff08nonpreemptive\uff09, \u4f46\u5f53\u5904\u4e8e\u7528\u6237\u6001\u7a0b\u5e8f\u4e2d\u8fd0\u884c\u65f6\u5219\u662f\u53ef\u4ee5\u88ab\u62a2\u5360\u7684\uff08preemptive\uff09\u3002 \u2003 Linux \u5185\u6838\u4e3b\u8981\u7531 5 \u4e2a\u6a21\u5757\u6784\u6210\uff0c\u5b83\u4eec\u5206\u522b\u662f\uff1a\u8fdb\u7a0b\u8c03\u5ea6\u6a21\u5757\u3001\u5185\u5b58\u7ba1\u7406\u6a21\u5757\u3001\u6587\u4ef6\u7cfb\u7edf\u6a21\u5757\u3001\u8fdb \u7a0b\u95f4\u901a\u4fe1\u6a21\u5757\u548c\u7f51\u7edc\u63a5\u53e3\u6a21\u5757\u3002 \u7cfb\u7edf\u8c03\u7528 \u2003linux os\u5728setup.s\u4e2d\u4f1a\u5c06\u7528\u6237\u7a0b\u5e8f\u53d1\u51fa\u7684\u8f6f\u4ef6\u4e2d\u65ad\u8bbe\u7f6e\u4e3a INT128\uff080x80\uff09\uff0c\u5e76\u79f0\u4e3a \u7cfb\u7edf\u8c03\u7528 \uff08System Call\uff09\u3002\u7cfb\u7edf\u8c03\u7528\u4e2d\u65ad\u662f\u7528\u6237\u7a0b\u5e8f\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\u7684\u552f\u4e00\u754c\u9762\u63a5\u53e3\u3002 \u7cfb\u7edf\u8c03\u7528\u8fc7\u7a0b:\u5f53\u5e94\u7528\u7a0b\u5e8f\u7ecf\u8fc7\u5e93\u51fd\u6570\u5411\u5185\u6838\u53d1\u51fa\u4e00\u4e2a\u4e2d\u65ad\u8c03\u7528 int 0x80 \u65f6\uff0c\u5c31\u5f00\u59cb\u6267\u884c\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\u3002\u5176\u4e2d\u5bc4\u5b58 \u5668 eax \u4e2d\u5b58\u653e\u7740\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c\u800c\u643a\u5e26\u7684\u53c2\u6570\u53ef \u4f9d\u6b21\u5b58\u653e\u5728\u5bc4\u5b58\u5668 ebx\u3001ecx \u548c edx \u4e2d \u3002\u56e0\u6b64 Linux 0.12 \u5185 \u6838\u4e2d\u7528\u6237\u7a0b\u5e8f\u80fd\u591f\u5411\u5185\u6838\u6700\u591a\u76f4\u63a5\u4f20\u9012\u4e09\u4e2a\u53c2\u6570\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u53c2\u6570\u3002 \u7cfb\u7edf\u542f\u52a8 \u2003PC \u7684\u7535\u6e90\u6253\u5f00\u540e\uff0c80x86 \u7ed3\u6784\u7684CPU \u5c06\u81ea\u52a8\u8fdb\u5165\u5b9e\u6a21\u5f0f\uff0c\u5e76\u4ece\u5730\u57400xFFFF0\u5f00\u59cb\u81ea\u52a8\u6267\u884c\u7a0b\u5e8f\u4ee3\u7801(cs:ip=0xFFFF:0), \u8fd9\u4e2a\u5730\u5740\u901a\u5e38\u662f ROM-BIOS \u4e2d\u7684\u5730\u5740\u3002PC \u673a\u7684 BIOS \u5c06\u6267\u884c\u7cfb\u7edf\u7684\u67d0\u4e9b\u786c\u4ef6\u68c0\u6d4b\u548c\u8bca\u65ad\u529f\u80fd\uff0c\u5e76\u5728\u7269\u7406\u5730\u5740 0 \u5904\u5f00\u59cb\u8bbe\u7f6e\u548c\u521d\u59cb\u5316\u4e2d\u65ad\u5411\u91cf\u3002\u6b64\u540e\uff0c\u5b83\u5c06\u78c1\u76d80\u78c1\u9053\u7b2c\u4e00\u4e2a\u6247\u533a\uff08\u78c1\u76d8\u5f15\u5bfc\u6247\u533a\uff0c512 \u5b57\u8282\uff09\u8bfb\u5165\u5185\u5b58\u7edd\u5bf9\u5730\u5740 0x7C00 \u5904(cs:ip=0x07c0:0)\u3002 \u5f53\u5b83\u88ab\u6267\u884c\u65f6\u5c31\u4f1a\u628a\u81ea\u5df1\u79fb\u52a8\u5230\u5185\u5b58\u7edd\u5bf9\u5730\u5740 0x90000\uff08576KB\uff09\u5904\uff0c\u5e76\u628a\u542f\u52a8\u8bbe\u5907\u76d8\u4e2d\u540e 2KB \u5b57\u8282\u4ee3\u7801\uff08boot/setup.S\uff09\u8bfb\u5165\u5230\u5185\u5b58 0x90200 \u5904\u3002\u800c\u5185\u6838\u7684\u5176\u4ed6\u90e8\u5206\uff08system \u6a21\u5757\uff09\u5219\u88ab\u8bfb\u5165\u5230\u4ece\u5185\u5b58\u5730\u5740 0x10000\uff0864KB\uff09\u5f00\u59cb\u5904, \u540e\u9762 setup \u7a0b\u5e8f\u5c06\u4f1a\u628a system \u6a21\u5757\u79fb\u52a8\u5230\u7269\u7406\u5185\u5b58\u8d77\u59cb\u4f4d\u7f6e\u5904\uff0c\u8fd9\u6837 system \u6a21\u5757\u4e2d\u4ee3\u7801\u7684\u5730\u5740\u4e5f\u5373\u7b49\u4e8e\u5b9e\u9645\u7684\u7269\u7406\u5730\u5740\uff0c\u4fbf\u4e8e\u5bf9\u5185\u6838\u4ee3\u7801\u548c\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u3002 bootsect.S setup.S: setup \u7a0b\u5e8f\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u5229\u7528 ROM BIOS \u7684\u4e2d\u65ad\u7a0b\u5e8f\u83b7\u53d6\u673a\u5668\u7684\u4e00\u4e9b\u57fa\u672c\u53c2\u6570\uff0c\u5e76\u4fdd\u5b58\u5728 0x90000 \u5f00\u59cb\u7684\u5185\u5b58\u5757\u4e2d\uff0c\u4f9b\u540e\u9762\u7a0b\u5e8f\u4f7f\u7528\u3002\u540c\u65f6\u628a system \u6a21\u5757\u5f80\u4e0b\u79fb\u52a8\u5230\u7269\u7406\u5730\u5740 0x00000 \u5f00\u59cb\u5904\uff0c\u8fd9\u6837\uff0csystem \u4e2d\u7684 head.s \u4ee3\u7801\u5c31\u5904\u5728 0x00000 \u5f00\u59cb\u5904\u4e86\u3002\u7136\u540e\u52a0\u8f7d\u63cf\u8ff0\u7b26\u8868\u57fa\u5730\u5740\u5230\u63cf\u8ff0\u7b26\u8868\u5bc4\u5b58\u5668\u4e2d\uff0c\u4e3a\u8fdb\u884c 32 \u4f4d\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u7684\u8fd0\u884c\u4f5c\u597d\u51c6\u5907\u3002\u63a5\u4e0b\u6765\u5bf9\u4e2d\u65ad\u63a7\u5236\u786c\u4ef6\u8fdb\u884c\u91cd\u65b0\u8bbe\u7f6e\uff0c\u6700\u540e\u901a\u8fc7\u8bbe\u7f6e\u673a\u5668\u63a7\u5236\u5bc4\u5b58\u5668CR0 \u5e76\u8df3\u8f6c\u5230 system \u6a21\u5757\u7684 head.s \u4ee3\u7801\u5f00\u59cb\u5904\uff0c\u4f7f CPU \u8fdb\u5165 32 \u4f4d\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u8fd0\u884c\u3002 head.s: head.s \u7a0b\u5e8f\u5728\u88ab\u7f16\u8bd1\u751f\u6210\u76ee\u6807\u6587\u4ef6\u540e\u4f1a\u4e0e\u5185\u6838\u5176\u4ed6\u7a0b\u5e8f\u7684\u76ee\u6807\u6587\u4ef6\u4e00\u8d77\u88ab\u94fe\u63a5\u6210 system \u6a21\u5757\u3002 \u2003\u8fd9\u6bb5\u7a0b\u5e8f\u9996\u5148\u52a0\u8f7d\u5404\u4e2a\u6570\u636e\u6bb5\u5bc4\u5b58\u5668\uff0c\u91cd\u65b0\u8bbe\u7f6e\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT\uff0c\u5171 256 \u9879\uff0c\u5e76\u4f7f\u5404\u4e2a\u8868\u9879\u5747\u6307\u5411\u4e00\u4e2a\u53ea\u62a5\u9519\u8bef\u7684\u54d1\u4e2d\u65ad\u5b50\u7a0b \u5e8f ignore_int\u3002\u8fd9\u4e2a\u54d1\u4e2d\u65ad\u5411\u91cf\u6307\u5411\u4e00\u4e2a\u9ed8\u8ba4\u7684\u201cignore_int\u201d\u5904\u7406\u8fc7\u7a0b( \u5982\u679c\u8bbe\u7f6e\u7684 IDT \u5c11\u4e8e 256 \u9879\uff0c\u90a3\u4e48\u5728\u4e00\u4e2a\u8981\u6c42\u7684\u4e2d\u65ad\u6240\u6307\u5b9a\u7684\u63cf\u8ff0\u7b26\u9879\u5927\u4e8e\u8bbe\u7f6e\u7684\u6700\u5927\u63cf\u8ff0\u7b26\u9879\u65f6\uff0cCPU\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e00\u822c\u4fdd\u62a4\u51fa\u9519\uff08\u5f02\u5e38 13\uff09\u3002\u53e6\u5916\uff0c\u5982\u679c\u786c\u4ef6\u51fa\u73b0\u95ee\u9898\u800c\u6ca1\u6709\u628a\u8bbe\u5907\u7684\u5411\u91cf\u653e\u5230\u6570\u636e\u603b\u7ebf\u4e0a\uff0c\u6b64\u65f6 CPU \u901a\u5e38\u4f1a\u4ece\u6570\u636e\u603b\u7ebf\u4e0a\u8bfb\u5165\u5168 1\uff080xff\uff09\u4f5c\u4e3a\u5411\u91cf\uff0c\u56e0\u6b64\u4f1a\u53bb\u8bfb\u53d6 IDT \u8868\u4e2d\u7684\u7b2c 256 \u9879\uff0c\u56e0\u6b64\u4e5f\u4f1a\u9020\u6210\u4e00\u822c\u4fdd\u62a4\u51fa\u9519\u3002 ); \u2003\u68c0\u67e5 A20 \u5730\u5740\u7ebf\u662f\u5426\u5df2\u7ecf\u6253\u5f00\uff0c\u6d4b\u8bd5\u7cfb\u7edf\u662f\u5426\u542b\u6709\u6570\u5b66\u534f\u5904\u7406\u5668\u3002\u7136\u540e\u521d\u59cb\u5316\u5185\u5b58\u9875\u76ee\u5f55\u8868\uff0c\u4e3a\u5185\u5b58\u7684\u5206\u9875\u7ba1\u7406\u4f5c\u597d\u51c6\u5907\u5de5\u4f5c\u3002\u6700\u540e\u8df3\u8f6c\u5230 system \u6a21\u5757\u4e2d\u7684\u521d\u59cb\u5316\u7a0b\u5e8f init/main.c \u4e2d\u7ee7\u7eed\u6267\u884c\u3002","title":"4_\u5185\u6838\u4f53\u7cfb\u7ed3\u6784"},{"location":"os/4_kernel_struct/#linux","text":"\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u7ed3\u6784\u6a21\u5f0f\u4e3b\u8981\u53ef\u5206\u4e3a\u6574\u4f53\u5f0f\u7684\u5355\u5185\u6838\u6a21\u5f0f\u548c\u5c42\u6b21\u5f0f\u7684\u5fae\u5185\u6838\u6a21\u5f0f\uff0c\u4ee5\u53ca\u8fd9\u4e24 \u8005\u7684\u6df7\u5408\u6a21\u5f0f\u3002 Linux 0.12 \u5185\u6838\u91c7\u7528\u7684\u662f\u5355\u5185\u6838\u6a21\u5f0f\u3002 \u2003\u5728\u5355\u5185\u6838\u6a21\u5f0f\u7684\u7cfb\u7edf\u4e2d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u6240\u63d0\u4f9b\u670d\u52a1\u7684\u6d41\u7a0b\u4e3a\uff1a\u5e94\u7528\u4e3b\u7a0b\u5e8f\u4f7f\u7528\u6307\u5b9a\u7684\u53c2\u6570\u503c\u6267\u884c\u7cfb\u7edf\u8c03 \u7528\u6307\u4ee4(int x80)\uff0c\u4f7f CPU \u4ece\u7528\u6237\u6001\uff08User Mode\uff09\u5207\u6362\u5230\u6838\u5fc3\u6001\uff08Kernel Model\uff09\uff0c\u7136\u540e\u64cd\u4f5c\u7cfb\u7edf\u6839\u636e\u5177\u4f53 \u7684\u53c2\u6570\u503c\u8c03\u7528\u7279\u5b9a\u7684\u7cfb\u7edf\u8c03\u7528\u670d\u52a1\u7a0b\u5e8f\uff0c\u800c\u8fd9\u4e9b\u670d\u52a1\u7a0b\u5e8f\u5219\u6839\u636e\u9700\u8981\u518d\u8c03\u7528\u5e95\u5c42\u7684\u4e00\u4e9b\u652f\u6301\u51fd\u6570\u4ee5\u5b8c\u6210 \u7279\u5b9a\u7684\u529f\u80fd\u3002\u5728\u5b8c\u6210\u4e86\u5e94\u7528\u7a0b\u5e8f\u6240\u8981\u6c42\u7684\u670d\u52a1\u540e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53c8\u4f7f CPU \u4ece\u6838\u5fc3\u6001\u5207\u6362\u56de\u7528\u6237\u6001\uff0c\u4ece\u800c\u8fd4\u56de \u5230\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7ee7\u7eed\u6267\u884c\u540e\u9762\u7684\u6307\u4ee4\u3002 \u2003\u57282.6\u7248\u672c\u524d, Linux\u7cfb\u7edf\u7684\u8fdb\u7a0b\u5728\u5185\u6838\u6001\u8fd0\u884c\u65f6\u4e0d\u4f1a\u88ab\u8c03\u5ea6\u7a0b\u5e8f\u5207\u6362\u3002\u5373\u8fdb\u7a0b\u5728\u5185\u6838\u6001\u7a0b\u5e8f\u4e2d\u8fd0\u884c\u65f6\u662f\u4e0d\u53ef\u62a2\u5360\u7684 \uff08nonpreemptive\uff09, \u4f46\u5f53\u5904\u4e8e\u7528\u6237\u6001\u7a0b\u5e8f\u4e2d\u8fd0\u884c\u65f6\u5219\u662f\u53ef\u4ee5\u88ab\u62a2\u5360\u7684\uff08preemptive\uff09\u3002 \u2003 Linux \u5185\u6838\u4e3b\u8981\u7531 5 \u4e2a\u6a21\u5757\u6784\u6210\uff0c\u5b83\u4eec\u5206\u522b\u662f\uff1a\u8fdb\u7a0b\u8c03\u5ea6\u6a21\u5757\u3001\u5185\u5b58\u7ba1\u7406\u6a21\u5757\u3001\u6587\u4ef6\u7cfb\u7edf\u6a21\u5757\u3001\u8fdb \u7a0b\u95f4\u901a\u4fe1\u6a21\u5757\u548c\u7f51\u7edc\u63a5\u53e3\u6a21\u5757\u3002","title":"Linux\u5185\u6838\u4f53\u7cfb\u7ed3\u6784"},{"location":"os/4_kernel_struct/#_1","text":"linux os\u5728setup.s\u4e2d\u4f1a\u5c06\u7528\u6237\u7a0b\u5e8f\u53d1\u51fa\u7684\u8f6f\u4ef6\u4e2d\u65ad\u8bbe\u7f6e\u4e3a INT128\uff080x80\uff09\uff0c\u5e76\u79f0\u4e3a \u7cfb\u7edf\u8c03\u7528 \uff08System Call\uff09\u3002\u7cfb\u7edf\u8c03\u7528\u4e2d\u65ad\u662f\u7528\u6237\u7a0b\u5e8f\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\u7684\u552f\u4e00\u754c\u9762\u63a5\u53e3\u3002 \u7cfb\u7edf\u8c03\u7528\u8fc7\u7a0b:\u5f53\u5e94\u7528\u7a0b\u5e8f\u7ecf\u8fc7\u5e93\u51fd\u6570\u5411\u5185\u6838\u53d1\u51fa\u4e00\u4e2a\u4e2d\u65ad\u8c03\u7528 int 0x80 \u65f6\uff0c\u5c31\u5f00\u59cb\u6267\u884c\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\u3002\u5176\u4e2d\u5bc4\u5b58 \u5668 eax \u4e2d\u5b58\u653e\u7740\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c\u800c\u643a\u5e26\u7684\u53c2\u6570\u53ef \u4f9d\u6b21\u5b58\u653e\u5728\u5bc4\u5b58\u5668 ebx\u3001ecx \u548c edx \u4e2d \u3002\u56e0\u6b64 Linux 0.12 \u5185 \u6838\u4e2d\u7528\u6237\u7a0b\u5e8f\u80fd\u591f\u5411\u5185\u6838\u6700\u591a\u76f4\u63a5\u4f20\u9012\u4e09\u4e2a\u53c2\u6570\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u53c2\u6570\u3002","title":"\u7cfb\u7edf\u8c03\u7528"},{"location":"os/4_kernel_struct/#_2","text":"PC \u7684\u7535\u6e90\u6253\u5f00\u540e\uff0c80x86 \u7ed3\u6784\u7684CPU \u5c06\u81ea\u52a8\u8fdb\u5165\u5b9e\u6a21\u5f0f\uff0c\u5e76\u4ece\u5730\u57400xFFFF0\u5f00\u59cb\u81ea\u52a8\u6267\u884c\u7a0b\u5e8f\u4ee3\u7801(cs:ip=0xFFFF:0), \u8fd9\u4e2a\u5730\u5740\u901a\u5e38\u662f ROM-BIOS \u4e2d\u7684\u5730\u5740\u3002PC \u673a\u7684 BIOS \u5c06\u6267\u884c\u7cfb\u7edf\u7684\u67d0\u4e9b\u786c\u4ef6\u68c0\u6d4b\u548c\u8bca\u65ad\u529f\u80fd\uff0c\u5e76\u5728\u7269\u7406\u5730\u5740 0 \u5904\u5f00\u59cb\u8bbe\u7f6e\u548c\u521d\u59cb\u5316\u4e2d\u65ad\u5411\u91cf\u3002\u6b64\u540e\uff0c\u5b83\u5c06\u78c1\u76d80\u78c1\u9053\u7b2c\u4e00\u4e2a\u6247\u533a\uff08\u78c1\u76d8\u5f15\u5bfc\u6247\u533a\uff0c512 \u5b57\u8282\uff09\u8bfb\u5165\u5185\u5b58\u7edd\u5bf9\u5730\u5740 0x7C00 \u5904(cs:ip=0x07c0:0)\u3002 \u5f53\u5b83\u88ab\u6267\u884c\u65f6\u5c31\u4f1a\u628a\u81ea\u5df1\u79fb\u52a8\u5230\u5185\u5b58\u7edd\u5bf9\u5730\u5740 0x90000\uff08576KB\uff09\u5904\uff0c\u5e76\u628a\u542f\u52a8\u8bbe\u5907\u76d8\u4e2d\u540e 2KB \u5b57\u8282\u4ee3\u7801\uff08boot/setup.S\uff09\u8bfb\u5165\u5230\u5185\u5b58 0x90200 \u5904\u3002\u800c\u5185\u6838\u7684\u5176\u4ed6\u90e8\u5206\uff08system \u6a21\u5757\uff09\u5219\u88ab\u8bfb\u5165\u5230\u4ece\u5185\u5b58\u5730\u5740 0x10000\uff0864KB\uff09\u5f00\u59cb\u5904, \u540e\u9762 setup \u7a0b\u5e8f\u5c06\u4f1a\u628a system \u6a21\u5757\u79fb\u52a8\u5230\u7269\u7406\u5185\u5b58\u8d77\u59cb\u4f4d\u7f6e\u5904\uff0c\u8fd9\u6837 system \u6a21\u5757\u4e2d\u4ee3\u7801\u7684\u5730\u5740\u4e5f\u5373\u7b49\u4e8e\u5b9e\u9645\u7684\u7269\u7406\u5730\u5740\uff0c\u4fbf\u4e8e\u5bf9\u5185\u6838\u4ee3\u7801\u548c\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u3002 bootsect.S setup.S: setup \u7a0b\u5e8f\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u5229\u7528 ROM BIOS \u7684\u4e2d\u65ad\u7a0b\u5e8f\u83b7\u53d6\u673a\u5668\u7684\u4e00\u4e9b\u57fa\u672c\u53c2\u6570\uff0c\u5e76\u4fdd\u5b58\u5728 0x90000 \u5f00\u59cb\u7684\u5185\u5b58\u5757\u4e2d\uff0c\u4f9b\u540e\u9762\u7a0b\u5e8f\u4f7f\u7528\u3002\u540c\u65f6\u628a system \u6a21\u5757\u5f80\u4e0b\u79fb\u52a8\u5230\u7269\u7406\u5730\u5740 0x00000 \u5f00\u59cb\u5904\uff0c\u8fd9\u6837\uff0csystem \u4e2d\u7684 head.s \u4ee3\u7801\u5c31\u5904\u5728 0x00000 \u5f00\u59cb\u5904\u4e86\u3002\u7136\u540e\u52a0\u8f7d\u63cf\u8ff0\u7b26\u8868\u57fa\u5730\u5740\u5230\u63cf\u8ff0\u7b26\u8868\u5bc4\u5b58\u5668\u4e2d\uff0c\u4e3a\u8fdb\u884c 32 \u4f4d\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u7684\u8fd0\u884c\u4f5c\u597d\u51c6\u5907\u3002\u63a5\u4e0b\u6765\u5bf9\u4e2d\u65ad\u63a7\u5236\u786c\u4ef6\u8fdb\u884c\u91cd\u65b0\u8bbe\u7f6e\uff0c\u6700\u540e\u901a\u8fc7\u8bbe\u7f6e\u673a\u5668\u63a7\u5236\u5bc4\u5b58\u5668CR0 \u5e76\u8df3\u8f6c\u5230 system \u6a21\u5757\u7684 head.s \u4ee3\u7801\u5f00\u59cb\u5904\uff0c\u4f7f CPU \u8fdb\u5165 32 \u4f4d\u4fdd\u62a4\u6a21\u5f0f\u4e0b\u8fd0\u884c\u3002 head.s: head.s \u7a0b\u5e8f\u5728\u88ab\u7f16\u8bd1\u751f\u6210\u76ee\u6807\u6587\u4ef6\u540e\u4f1a\u4e0e\u5185\u6838\u5176\u4ed6\u7a0b\u5e8f\u7684\u76ee\u6807\u6587\u4ef6\u4e00\u8d77\u88ab\u94fe\u63a5\u6210 system \u6a21\u5757\u3002 \u2003\u8fd9\u6bb5\u7a0b\u5e8f\u9996\u5148\u52a0\u8f7d\u5404\u4e2a\u6570\u636e\u6bb5\u5bc4\u5b58\u5668\uff0c\u91cd\u65b0\u8bbe\u7f6e\u4e2d\u65ad\u63cf\u8ff0\u7b26\u8868 IDT\uff0c\u5171 256 \u9879\uff0c\u5e76\u4f7f\u5404\u4e2a\u8868\u9879\u5747\u6307\u5411\u4e00\u4e2a\u53ea\u62a5\u9519\u8bef\u7684\u54d1\u4e2d\u65ad\u5b50\u7a0b \u5e8f ignore_int\u3002\u8fd9\u4e2a\u54d1\u4e2d\u65ad\u5411\u91cf\u6307\u5411\u4e00\u4e2a\u9ed8\u8ba4\u7684\u201cignore_int\u201d\u5904\u7406\u8fc7\u7a0b( \u5982\u679c\u8bbe\u7f6e\u7684 IDT \u5c11\u4e8e 256 \u9879\uff0c\u90a3\u4e48\u5728\u4e00\u4e2a\u8981\u6c42\u7684\u4e2d\u65ad\u6240\u6307\u5b9a\u7684\u63cf\u8ff0\u7b26\u9879\u5927\u4e8e\u8bbe\u7f6e\u7684\u6700\u5927\u63cf\u8ff0\u7b26\u9879\u65f6\uff0cCPU\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e00\u822c\u4fdd\u62a4\u51fa\u9519\uff08\u5f02\u5e38 13\uff09\u3002\u53e6\u5916\uff0c\u5982\u679c\u786c\u4ef6\u51fa\u73b0\u95ee\u9898\u800c\u6ca1\u6709\u628a\u8bbe\u5907\u7684\u5411\u91cf\u653e\u5230\u6570\u636e\u603b\u7ebf\u4e0a\uff0c\u6b64\u65f6 CPU \u901a\u5e38\u4f1a\u4ece\u6570\u636e\u603b\u7ebf\u4e0a\u8bfb\u5165\u5168 1\uff080xff\uff09\u4f5c\u4e3a\u5411\u91cf\uff0c\u56e0\u6b64\u4f1a\u53bb\u8bfb\u53d6 IDT \u8868\u4e2d\u7684\u7b2c 256 \u9879\uff0c\u56e0\u6b64\u4e5f\u4f1a\u9020\u6210\u4e00\u822c\u4fdd\u62a4\u51fa\u9519\u3002 ); \u2003\u68c0\u67e5 A20 \u5730\u5740\u7ebf\u662f\u5426\u5df2\u7ecf\u6253\u5f00\uff0c\u6d4b\u8bd5\u7cfb\u7edf\u662f\u5426\u542b\u6709\u6570\u5b66\u534f\u5904\u7406\u5668\u3002\u7136\u540e\u521d\u59cb\u5316\u5185\u5b58\u9875\u76ee\u5f55\u8868\uff0c\u4e3a\u5185\u5b58\u7684\u5206\u9875\u7ba1\u7406\u4f5c\u597d\u51c6\u5907\u5de5\u4f5c\u3002\u6700\u540e\u8df3\u8f6c\u5230 system \u6a21\u5757\u4e2d\u7684\u521d\u59cb\u5316\u7a0b\u5e8f init/main.c \u4e2d\u7ee7\u7eed\u6267\u884c\u3002","title":"\u7cfb\u7edf\u542f\u52a8"},{"location":"os/5_os/","text":"\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf \u64cd\u4f5c\u7cfb\u7edf \u2003\u7ba1\u7406\u8ba1\u7b97\u673a\u786c\u4ef6\u4e0e\u8f6f\u4ef6\u8d44\u6e90\u7684\u8ba1\u7b97\u673a\u7a0b\u5e8f\u3002\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u4e0e\u914d\u7f6e\u5185\u5b58\u3001\u51b3\u5b9a\u7cfb\u7edf\u8d44\u6e90\u4f9b\u9700\u7684\u4f18\u5148\u6b21\u5e8f\u3001\u63a7\u5236\u8f93\u5165\u8bbe\u5907\u4e0e\u8f93\u51fa\u8bbe\u5907\u3001\u64cd\u4f5c\u7f51\u7edc\u4e0e\u7ba1\u7406\u6587\u4ef6\u7cfb\u7edf\u7b49\u57fa\u672c\u4e8b\u52a1\u3002\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u63d0\u4f9b\u4e00\u4e2a\u8ba9\u7528\u6237\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u7684\u64cd\u4f5c\u754c\u9762\u3002 \u7528\u6237\u6001\u548c\u5185\u6838\u6001 \u5927\u591a\u6570\u73b0\u4ee3CPU\u63d0\u4f9b\u4e24\u79cd\u6267\u884c\u6a21\u5f0f\uff0c\u5185\u6838\u6001\u548c\u7528\u6237\u6001\u3002CPU\u53ef\u4ee5\u5728\u5185\u6838\u6001\u6267\u884c\u6307\u4ee4\u96c6\u4e2d\u7684\u6240\u6709\u6307\u4ee4\uff0c\u4ee5\u53ca\u4f7f\u7528\u6240\u6709\u7684\u786c\u4ef6\u8d44\u6e90\uff0c\u7528\u6237\u7a0b\u5e8f\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u6216\u8005\u89e6\u53d1\u67d0\u4e2a\u5f02\u5e38\uff0c\u4f1a\u9677\u5165\u5230\u5185\u6838\u6001\uff1b\u4f46\u5728\u7528\u6237\u6001\u65f6\uff0c\u53ea\u80fd\u6267\u884c\u90e8\u5206\u6307\u4ee4\uff0c\u4f7f\u7528\u90e8\u5206\u786c\u4ef6\u7684\u8d44\u6e90\u3002\u4e24\u79cd\u6267\u884c\u6a21\u5f0f\u4f7f\u5f97\u8bbe\u8ba1\u4eba\u5458\u53ea\u80fd\u5728\u7528\u6237\u6a21\u5f0f\u4e0b\u8fd0\u884c\u7528\u6237\u7a0b\u5e8f\uff0c\u4ece\u800c\u62d2\u7edd\u4ed6\u4eec\u8bbf\u95ee\u5173\u952e\u6307\u4ee4\u3002 \u7cfb\u7edf\u8c03\u7528 \u2003\u7cfb\u7edf\u8c03\u7528\u4e2d\u65ad\u662f\u7528\u6237\u7a0b\u5e8f\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\u7684\u552f\u4e00\u754c\u9762\u63a5\u53e3\uff1b\u5bf9\u4e8eintel x86, \u901a\u8fc7\u4e2d\u65ad\u6307\u4ee4int\u8fdb\u5165\u5185\u6838\u3002\u4f8b\u5982linux\u5728boot/setup.s\u4e2d\u4f1a\u5c06\u7528\u6237\u7a0b\u5e8f\u53d1\u51fa\u7684\u8f6f\u4ef6\u4e2d\u65ad\u8bbe\u7f6e\u4e3a int 128\uff080x80\uff09\uff0c\u8fd9\u6761\u6307\u4ee4\u4f1a\u89e6\u53d1\u4e00\u4e2a\u5f02\u5e38\u5bfc\u81f4\u7cfb\u7edf\u5207\u6362\u5230\u5185\u6838\u6001\uff0c\u5e76\u6267\u884c128\u53f7\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\uff0c\u5373\u7cfb\u7edf\u8c03\u7528\u5904\u7406\u7a0b\u5e8fsystem_call()\u3002 \u2003\u5bc4\u5b58\u5668 eax \u4e2d\u5b58\u653e\u7740\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c\u800c\u643a\u5e26\u7684\u53c2\u6570\u53ef \u4f9d\u6b21\u5b58\u653e\u5728\u5bc4\u5b58\u5668 ebx\u3001ecx\u3001edx\u3001esi\u548cedi\u4e2d \uff0c\u9700\u8981\u66f4\u591a\u53c2\u6570\u65f6\uff0c\u53ef\u4ee5\u7528\u5176\u4e2d\u4e00\u4e2a\u5bc4\u5b58\u5668\u5b58\u653e\u6307\u5411\u6240\u6709\u8fd9\u4e9b\u53c2\u6570\u5728\u7528\u6237\u7a7a\u95f4\u5730\u5740\u7684\u6307\u9488\u3002 \u7cfb\u7edf\u8c03\u7528\u8fc7\u7a0b: a. \u7528\u6237\u7a0b\u5e8f\u4e2d\u5305\u542b\u4e00\u6bb5\u542bint 0x80\u6307\u4ee4\u7684\u4ee3\u7801(\u901a\u5e38\u5728\u5e93\u51fd\u6570\u4e2d)\u3002 b. \u64cd\u4f5c\u7cfb\u7edf\u5199\u4e2d\u65ad\u5904\u7406\uff0c\u5e76\u83b7\u53d6\u60f3\u8c03\u7528\u7684\u5185\u6838\u7a0b\u5e8f\u7684\u7f16\u53f7\u3002 c. \u64cd\u4f5c\u7cfb\u7edf\u6839\u636e\u7f16\u53f7\u8f6c\u5230\u76f8\u5e94\u7684\u6267\u884c\u4ee3\u7801\u3002 \u5185\u5b58\u5c42\u6b21\u6a21\u578b \u5bc4\u5b58\u5668 -> \u9ad8\u901f\u7f13\u5b58 -> \u4e3b\u5b58 -> \u78c1\u76d8\uff0c \u8bbf\u95ee\u901f\u5ea6\u7531\u5feb\u5230\u6162\uff0c\u5bb9\u91cf\u7531\u5c0f\u5230\u5927\u3002 I/O\u7684\u4e09\u79cd\u65b9\u5f0f\uff1a 1\u300b\u7528\u6237\u7a0b\u5e8f\u53d1\u8d77\u7cfb\u7edf\u8c03\u7528\uff0c\u5185\u6838\u4f1a\u5c06\u5176\u8f6c\u6362\u4e3a\u76f8\u5e94\u9a71\u52a8\u7a0b\u5e8f\u7684\u7a0b\u5e8f\u8c03\u7528\uff0c\u7136\u540e\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u542f\u52a8I/O \u5e76\u5faa\u73af\u68c0\u67e5\u8be5\u8bbe\u5907\u662f\u5426\u5b8c\u6210\u5de5\u4f5c\u3002\u5f53I/O\u8c03\u7528\u5b8c\u6210\u540e\uff0c\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u628a\u6570\u636e\u9001\u5230\u6307\u5b9a\u7684\u5730\u65b9\u5e76\u8fd4\u56de\u3002 \u8fd9\u79cd\u65b9\u5f0f\u79f0\u4e3abusy waiting. \u8fd9\u79cd\u65b9\u5f0f\u7684\u7f3a\u70b9\u662f\u8981\u4e00\u76f4\u5360\u636eCPU\uff0cCPU\u4f1a\u4e00\u76f4\u8f6e\u8be2I/O\u8bbe\u5907\u76f4\u5230I/O\u64cd\u4f5c\u5b8c\u6210\u3002 2\u300b\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u542f\u52a8\u8bbe\u5907\u5e76\u4e14\u8ba9\u8be5\u8bbe\u5907\u5728\u64cd\u4f5c\u5b8c\u6210\u65f6\u53d1\u751f\u4e2d\u65ad\u3002\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u5728\u8be5\u65f6\u523b\u8fd4\u56de\uff0c \u64cd\u4f5c\u7cfb\u7edf\u63a5\u7740\u5728\u9700\u8981\u65f6\u963b\u585e\u8c03\u7528\u8005\u5e76\u5b89\u6392\u5176\u4ed6\u5de5\u4f5c\u8fdb\u884c\u3002\u5f53\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u68c0\u6d4b\u5230\u8be5\u8bbe\u5907\u64cd\u4f5c\u5b8c\u6210\u65f6\uff0c \u4f1a\u53d1\u51fa\u4e00\u4e2a\u4e2d\u65ad\u901a\u77e5\u64cd\u4f5c\u5b8c\u6210\u3002 3\u300b\u4f7f\u7528\u7279\u6b8a\u7684\u786c\u4ef6\uff1a\u76f4\u63a5\u5b58\u50a8\u5668\u8bbf\u95ee\uff08direct memory access\uff0c DMA\uff09\u82af\u7247\u3002 \u5b83\u53ef\u4ee5\u63a7\u5236\u5185\u5b58\u548c\u67d0\u4e9b\u63a7\u5236\u5668\u4e4b\u95f4\u7684\u4f4d\u6d41\uff0c\u800c\u65e0\u9700CPU\u7684\u5e72\u9884\u3002CPU\u4f1a\u5bf9DMA\u82af\u7247\u8fdb\u884c\u8bbe\u7f6e\uff0c\u8bf4\u660e\u9700\u8981\u4f20\u9001\u7684\u5b57\u8282\u6570\uff0c \u6709\u5173\u7684\u8bbe\u5907\u548c\u5185\u5b58\u5730\u5740\u4ee5\u53ca\u64cd\u4f5c\u65b9\u5411\u3002\u5f53DMA\u82af\u7247\u5b8c\u6210\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9020\u6210\u4e2d\u65ad\u3002 \u64cd\u4f5c\u7cfb\u7edf\u7ed3\u6784\uff1a\u5355\u4f53\u7ed3\u6784\u3001\u5206\u5c42\u7cfb\u7edf\u3001\u5fae\u5185\u6838\u3001\u5ba2\u6237-\u670d\u52a1\u7aef\u7cfb\u7edf\u3001\u865a\u62df\u673a\u548c\u5916\u6838\u3002 big-endian: \u5c06\u9ad8\u5e8f\u5b57\u8282\u5b58\u50a8\u5728\u8d77\u59cb\u5730\u5740; little-endian: \u5c06\u4f4e\u5e8f\u5b57\u8282\u5b58\u50a8\u5728\u8d77\u59cb\u5730\u5740(\u5730\u5740\u4f4e\u4f4d\u5b58\u50a8\u503c\u7684\u4f4e\u4f4d, \u5730\u5740\u9ad8\u4f4d\u5b58\u50a8\u503c\u7684\u9ad8\u4f4d) \u8fdb\u7a0b \u4e00\u4e2a\u6b63\u5728\u6267\u884c\u7a0b\u5e8f\u7684\u5b9e\u4f8b\uff0c\u7cfb\u7edf\u8fdb\u884c\u8d44\u6e90\u5206\u914d\u7684\u6700\u5c0f\u5355\u4f4d\u3002(\u5728 Linux \u5185\u6838\u4e2d\uff0c\u8fdb\u7a0b\u901a\u5e38\u88ab\u79f0\u4f5c\u4efb\u52a1\uff08task\uff09\uff0c\u800c\u628a\u8fd0\u884c\u5728\u7528\u6237\u7a7a\u95f4\u7684\u7a0b\u5e8f\u79f0\u4f5c\u8fdb\u7a0b) \u8fdb\u7a0b\u7684\u6982\u5ff5\u4e3b\u8981\u6709\u4e24\u70b9\uff1a \u7b2c\u4e00\uff0c \u8fdb\u7a0b\u662f\u4e00\u4e2a\u5b9e\u4f53\u3002\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u90fd\u6709\u5b83\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4 \uff0c\u865a\u62df\u5185\u5b58\u6280\u672f\u4f7f\u5f97\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u72ec\u5360\u6574\u4e2a\u5185\u5b58\u7a7a\u95f4\uff0c\u5730\u5740\u4ece\u96f6\u5f00\u59cb\uff0c\u76f4\u5230\u5185\u5b58\u4e0a\u9650\u3002 \u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u5c06\u8fd9\u90e8\u5206\u7a7a\u95f4\uff08\u4ece\u4f4e\u5730\u5740\u5230\u9ad8\u5730\u5740\uff09\u5206\u4e3a\u516d\u4e2a\u90e8\u5206\uff1a TEXT\u6bb5\uff1a\u6574\u4e2a\u7a0b\u5e8f\u7684\u4ee3\u7801\uff0c\u4ee5\u53ca\u6240\u6709\u7684\u5e38\u91cf\u3002\u8fd9\u90e8\u5206\u5185\u5b58\u662f\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\uff0c\u53ea\u8bfb\u7684; DATA\u6bb5\uff1a\u53c8\u79f0GVAR\uff1a\u5b58\u50a8\u5df2\u7ecf\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u53d8\u91cf; BSS(Block Started by Symbol)\u6bb5\uff1a\u5b58\u653e\u7a0b\u5e8f\u4e2d\u672a\u521d\u59cb\u5316\u7684\u6216\u8005\u521d\u59cb\u5316\u4e3a0\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u53d8\u91cf\u7684\u4e00\u5757\u5185\u5b58\u533a\u57df\u3002 \u7279\u70b9\u662f\u53ef\u8bfb\u5199\u7684\uff0c\u5728\u7a0b\u5e8f\u6267\u884c\u4e4b\u524dBSS\u6bb5\u4f1a\u81ea\u52a8\u6e050\u3002 HEAP\uff08\u5806\u7a7a\u95f4\uff09\uff1a\u52a8\u6001\u5185\u5b58\u533a\u57df\uff0c\u4f7f\u7528malloc\u6216new\u7533\u8bf7\u7684\u5185\u5b58; \u672a\u4f7f\u7528\u7684\u5185\u5b58; STACK\uff08\u6808\u7a7a\u95f4\uff09\uff1a\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u3001\u53c2\u6570\u3001\u8fd4\u56de\u503c\uff0c\u51fd\u6570\u8c03\u7528\u5f00\u59cb\u4f1a\u53c2\u6570\u5165\u6808\u3001\u5c40\u90e8\u53d8\u91cf\u5165\u6808\uff1b\u8c03\u7528\u7ed3\u675f\u4f9d\u6b21\u51fa\u6808\u3002 \u5176\u4e2d\u5806\u7a7a\u95f4\u548c\u6808\u7a7a\u95f4\u7684\u5927\u5c0f\u662f\u53ef\u53d8\u7684\uff0c\u5806\u7a7a\u95f4\u4ece\u4e0b\u5f80\u4e0a\u751f\u957f\uff0c\u6808\u7a7a\u95f4\u4ece\u4e0a\u5f80\u4e0b\u751f\u957f\u3002 \u7b2c\u4e8c\uff0c \u8fdb\u7a0b\u662f\u4e00\u4e2a\u201c\u6267\u884c\u4e2d\u7684\u7a0b\u5e8f\u201d\u3002 \u7a0b\u5e8f\u662f\u4e00\u4e2a\u6ca1\u6709\u751f\u547d\u7684\u5b9e\u4f53\uff0c\u53ea\u6709\u5904\u7406\u5668\u8d4b\u4e88\u7a0b\u5e8f\u751f\u547d\u65f6\uff08\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u4e4b\uff09\uff0c\u5b83\u624d\u80fd\u6210\u4e3a\u4e00\u4e2a\u6d3b\u52a8\u7684\u5b9e\u4f53\uff0c\u6211\u4eec\u79f0\u5176\u4e3a\u8fdb\u7a0b\u3002 \u8fdb\u7a0b=\u8d44\u6e90+\u6307\u4ee4\u6267\u884c\u5e8f\u5217: \u5c06\u8d44\u6e90\u548c\u6307\u4ee4\u6267\u884c\u5206\u5f00, \u4e00\u4e2a\u8d44\u6e90+\u591a\u4e2a\u6307\u4ee4\u6267\u884c\u5e8f\u5217, \u6307\u4ee4\u6267\u884c\u5e8f\u5217\u5373\u7ebf\u7a0b: \u4fdd\u7559\u4e86\u5e76\u53d1\u7684\u7279\u70b9, \u907f\u514d\u4e86\u8fdb\u7a0b\u8d44\u6e90\u5207\u6362\uff08\u5982\u6620\u5c04\u8868\u7684\u5207\u6362\uff09\u7684\u4ee3\u4ef7\u3002 \u8fdb\u7a0b\u7684\u5c42\u6b21\u7ed3\u6784 \u5f53\u8fdb\u7a0b\u521b\u5efa\u4e86\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u540e\uff0c\u7236\u8fdb\u7a0b\u548c\u5b50\u8fdb\u7a0b\u4ee5\u67d0\u79cd\u5f62\u5f0f\u7ee7\u7eed\u4fdd\u6301\u5173\u8054\u3002\u5b50\u8fdb\u7a0b\u81ea\u8eab\u53ef\u4ee5\u521b\u5efa\u66f4\u591a\u7684\u8fdb\u7a0b\uff0c\u7ec4\u6210\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5c42\u6b21\u7ed3\u6784\u3002\u5728UNIX\u4e2d\uff0c\u8fdb\u7a0b\u548c\u5b83\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\u4ee5\u53ca\u540e\u88d4\u5171\u540c\u7ec4\u6210\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\u3002\u800c\u5728windows\u4e2d\uff0c\u6240\u6709\u8fdb\u7a0b\u7684\u5730\u4f4d\u90fd\u662f\u76f8\u540c\u7684\uff0c\u4e0d\u8fc7\u5728\u521b\u5efa\u8fdb\u7a0b\u65f6\uff0c\u7236\u8fdb\u7a0b\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7279\u522b\u7684\u4ee4\u724c\uff08\u53e5\u67c4\uff09\uff0c\u7528\u4ee5\u63a7\u5236\u5b50\u8fdb\u7a0b\u3002 \u8fdb\u7a0b\u72b6\u6001 \u8fd0\u884c\u6001\uff1a\u8be5\u65f6\u523b\u8fdb\u7a0b\u5b9e\u9645\u5360\u7528CPU \u5c31\u7eea\u6001\uff1a\u53ef\u8fd0\u884c\uff0c\u62e5\u6709\u9664CPU\u4ee5\u5916\u7684\u6240\u6709\u6240\u9700\u8d44\u6e90\uff0c\u4f46\u56e0\u4e3a\u5176\u4ed6\u8fdb\u7a0b\u6b63\u5728\u8fd0\u884c\u800c\u6682\u65f6\u505c\u6b62 \u963b\u585e\u6001\uff1a\u8fdb\u7a0b\u7b49\u5f85\u76f4\u81f3\u67d0\u4e2a\u5916\u754c\u4e8b\u4ef6\u53d1\u751f\u624d\u80fd\u8f6c\u4e3a\u5c31\u7eea\u6001\uff0c\u5426\u5219\u5c06\u4e00\u76f4\u65e0\u6cd5\u6267\u884c \u2003(\u4e94\u72b6\u6001\u6a21\u578b\u4e0b\u8fd8\u6709\u65b0\u5efa\u6001\u548c\u7ec8\u6b62\u6001\uff0c \u524d\u8005\uff1a\u65b0\u5efa\u6001\u5bf9\u5e94\u4e8e\u8fdb\u7a0b\u521a\u521a\u88ab\u521b\u5efa\u7684\u72b6\u6001\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u521b\u5efa\u7684\u65b0\u8fdb\u7a0b\u521b\u5efaPCB\uff0c\u5206\u914d\u8d44\u6e90\uff0c\u5f53\u8fdb\u7a0b\u62e5\u6709\u9664CPU\u4ee5\u5916\u7684\u6240\u6709\u8d44\u6e90\u65f6\uff0c\u5c06\u8fdb\u5165\u5c31\u7eea\u6001\uff0c\u7b49\u5f85\u8c03\u5ea6\u6267\u884c\uff1b \u540e\u8005\uff1a\u8fdb\u7a0b\u7684\u7ec8\u6b62\u8981\u901a\u8fc7\u4e24\u4e2a\u6b65\u9aa4\uff0c\u9996\u5148\uff0c\u662f\u7b49\u5f85\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u5584\u540e\uff0c\u56de\u6536\u8d44\u6e90\uff1b\u7136\u540e\u64a4\u9500PCB\uff0c\u9000\u51fa\u4e3b\u5b58\u3002\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u5230\u8fbe\u4e86\u81ea\u7136\u7ed3\u675f\u70b9\uff0c\u6216\u662f\u51fa\u73b0\u4e86\u65e0\u6cd5\u514b\u670d\u7684\u9519\u8bef\uff0c\u6216\u662f\u88ab\u64cd\u4f5c\u7cfb\u7edf\u6240\u7ec8\u7ed3\uff0c\u6216\u662f\u88ab\u5176\u4ed6\u6709\u7ec8\u6b62\u6743\u7684\u8fdb\u7a0b\u6240\u7ec8\u7ed3\uff0c\u5b83\u5c06\u8fdb\u5165\u7ec8\u6b62\u6001\u3002\u8fdb\u5165\u7ec8\u6b62\u6001\u7684\u8fdb\u7a0b\u4ee5\u540e\u4e0d\u518d\u6267\u884c\uff0c\u4f46\u4f9d\u7136\u4fdd\u7559\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7b49\u5f85\u5584\u540e\u3002 \u2003 linux\u4e0b\u8fdb\u7a0b\u72b6\u6001 \u2003\u50f5\u5c38\u8fdb\u7a0b \u2003\u907f\u514d\u50f5\u5c38\u8fdb\u7a0b \u2003\u5176\u4e2d\u7684handler\u4e3a\u7236\u8fdb\u7a0b\u6ce8\u518c\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\uff0c\u5f53\u5b50\u8fdb\u7a0b\u9000\u51fa\u65f6\uff0c\u7236\u8fdb\u7a0b\u6536\u5230SIGCHLD\u4fe1\u53f7\uff0c\u5982\u679c\u7236\u8fdb\u7a0b\u6b64\u65f6\u6b63\u5728\u5904\u7406\u5176\u4ed6\u4e8b\u60c5\uff0c\u5219\u53ef\u4ee5\u8c03\u7528\u63d0\u524d\u6ce8\u518c\u7684handler\uff0c\u5728\u5176\u4e2d\u8c03\u7528wait/waitpid\uff0c\u6765\u83b7\u53d6\u5b50\u8fdb\u7a0b\u9000\u51fa\u72b6\u6001\uff0c\u7136\u540e\u56de\u6536\u5b50\u8fdb\u7a0b\u5269\u4f59\u4fe1\u606f\u3002 \u5bf9\u4e8e\u4ea7\u751f\u4fe1\u53f7\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4ea7\u751f\u4fe1\u53f7\u524d\u5229\u7528\u65b9\u6cd5 signal(int signum, sighandler_t handler) \u8bbe\u7f6e\u4fe1\u53f7\u7684\u5904\u7406\u3002 \u5982\u679c\u6ca1\u6709\u8c03\u7528\u6b64\u65b9\u6cd5\uff0c\u7cfb\u7edf\u5c31\u4f1a\u8c03\u7528\u9ed8\u8ba4\u5904\u7406\u65b9\u6cd5\uff1a\u4e2d\u6b62\u7a0b\u5e8f\uff0c\u663e\u793a\u63d0\u793a\u4fe1\u606f\u3002\u6211\u4eec\u53ef\u4ee5\u8c03\u7528\u7cfb\u7edf\u7684\u5904\u7406\u65b9\u6cd5\uff0c \u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5904\u7406\u65b9\u6cd5\u3002\u7cfb\u7edf\u91cc\u8fb9\u5b9a\u4e49\u4e86\u4e09\u79cd\u5904\u7406\u65b9\u6cd5\uff1a SIG_DFL: \u9ed8\u8ba4\u52a8\u4f5c\uff0c\u9ed8\u8ba4\u7684\u5904\u7406\u65b9\u5f0f\u662f\u4e0d\u7406\u4f1a\u8fd9\u4e2a\u4fe1\u53f7\uff0c\u4f46\u662f\u4e5f\u4e0d\u4f1a\u4e22\u5f03\u5b50\u8fdb\u884c\u72b6\u6001\uff0c\u6240\u4ee5\u5982\u679c\u4e0d\u7528wait/waitpid \u5bf9\u5176\u5b50\u8fdb\u884c\u8fdb\u884c\u72b6\u6001\u4fe1\u606f\u56de\u6536\uff0c\u4f1a\u4ea7\u751f\u50f5\u5c38\u8fdb\u7a0b\u3002 SIG_IGN: \u5ffd\u7565\u4fe1\u53f7\uff0c\u5b50\u8fdb\u7a0b\u72b6\u6001\u4fe1\u606f\u4f1a\u88ab\u4e22\u5f03\uff0c\u4e5f\u5c31\u662f\u81ea\u52a8\u56de\u6536\u4e86\uff0c\u6240\u4ee5\u4e0d\u4f1a\u4ea7\u751f\u50f5\u5c38\u8fdb\u7a0b\u3002 \u81ea\u5b9a\u4e49\u5904\u7406\u65b9\u5f0f\uff0c\u5982\u81ea\u5b9a\u4e49handler \u8fdb\u7a0b\u63cf\u8ff0\u7b26 \u5185\u6838\u628a\u8fdb\u7a0b\u7684\u5217\u8868\u5b58\u653e\u5728\u53eb\u505a\u4efb\u52a1\u961f\u5217\u7684\u53cc\u5411\u5faa\u73af\u94fe\u8868\u4e2d\uff0c\u94fe\u8868\u7684\u6bcf\u4e00\u9879\u7c7b\u578b\u90fd\u662ftask_struct,\u79f0\u4e3a\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u3001\u8fdb\u7a0b\u63a7\u5236\u5757(Process Control Block,PCB)\u3001\u8fdb\u7a0b\u8868\uff0c\u5305\u542b\u4e00\u4e2a\u5177\u4f53\u8fdb\u7a0b\u7684\u6240\u6709\u4fe1\u606f\u3002\u5982 (1)\u8fdb\u7a0b\u6807\u8bc6\u7b26(\u552f\u4e00)\uff0c PID (2)\u8fdb\u7a0b\u5f53\u524d\u72b6\u6001\uff0c\u901a\u5e38\u540c\u4e00\u72b6\u6001\u7684\u8fdb\u7a0b\u4f1a\u88ab\u653e\u5230\u540c\u4e00\u4e2a\u961f\u5217\uff1b (3)\u7a0b\u5e8f\u72b6\u6001\u5b57\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668 (4)\u6587\u4ef6\u63cf\u8ff0\u7b26 (5)\u8fdb\u7a0b\u4f18\u5148\u7ea7\uff1b\u8c03\u5ea6\u7b56\u7565 (6)\u6307\u5411\u7236\u8fdb\u7a0b\u3001\u5b50\u8fdb\u7a0b\u94fe\u8868\u3001\u5144\u5f1f\u8fdb\u7a0b\u7684\u6307\u9488 (7)flags, \u53cd\u5e94\u8fdb\u7a0b\u72b6\u6001\u7684\u4fe1\u606f\uff0c\u4f46\u4e0d\u662f\u8fd0\u884c\u72b6\u6001\uff0c\u7528\u4e8e\u5185\u6838\u8bc6\u522b\u8fdb\u7a0b\u5f53\u524d\u7684\u72b6\u6001\uff0c\u4ee5\u5907\u4e0b\u4e00\u6b65\u64cd\u4f5c; PF_FORKNOEXEC \u8fdb\u7a0b\u521a\u521b\u5efa\uff0c\u4f46\u8fd8\u6ca1\u6267\u884c\u3002 PF_SUPERPRIV \u8d85\u7ea7\u7528\u6237\u7279\u6743\u3002 (8)\u8fdb\u7a0b\u540c\u6b65\u4e0e\u901a\u4fe1\u673a\u5236\uff0c\u7528\u4e8e\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u4e92\u65a5\u3001\u540c\u6b65\u548c\u901a\u4fe1\u6240\u9700\u7684\u4fe1\u53f7\u91cf\u7b49\uff1b \u7528\u4e8e\u4fdd\u62a4\u8d44\u6e90\u5206\u914d\u6216\u91ca\u653e\u7684\u81ea\u65cb\u9501\uff1b (9)\u6307\u5411\u5185\u5b58\u63cf\u8ff0\u7b26(mm_struct)\u7684\u6307\u9488mm\u548cactive_mm\uff0cmm\u6307\u5411\u7684mm_struct\u7ed3\u6784\u63cf\u8ff0\u4e86\u4e00\u4e2a\u8fdb\u7a0b\u7684\u6574\u4e2a\u865a\u62df\u5730\u5740\u7a7a\u95f4\uff1b \u5bf9\u4e8e\u5185\u6838\u7ebf\u7a0b\u6765\u8bf4\uff0c\u6ca1\u6709\u5730\u5740\u7a7a\u95f4\uff0c\u56e0\u6b64\u5176mm\u57df\u4e3aNULL\uff0c\u800cactive_mm\u6307\u5411\u7684\u662f\u5207\u6362\u524d\u7684\u8fdb\u7a0b\u7684mm_struct. \u6307\u5411\u5185\u6838\u6808\u7684\u6307\u9488\uff0ctask_struct->stack. (9)\u8fdb\u7a0b\u76f8\u5173\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u4f8b\u5982\u8fdb\u7a0b\u521b\u5efa\u65f6\u95f4\u3001\u5728\u5185\u6838\u6001/\u7528\u6237\u6001\u7d2f\u8ba1\u8fd0\u884c\u65f6\u95f4\u7b49\u3002 \u2003 ps1. \u4e00\u4e2a\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e3b\u8981\u7531\u4e24\u4e2a\u6570\u636e\u7ed3\u6765\u63cf\u8ff0\u3002\u4e00\u4e2a\u662f\u6700\u9ad8\u5c42\u6b21\u7684\uff1amm_struct\uff0c\u4e00\u4e2a\u662f\u8f83\u9ad8\u5c42\u6b21\u7684\uff1avm_area_structs\u3002\u6700\u9ad8\u5c42\u6b21\u7684mm_struct\u7ed3\u6784\u63cf\u8ff0\u4e86\u4e00\u4e2a\u8fdb\u7a0b\u7684\u6574\u4e2a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u3002\u8f83\u9ad8\u5c42\u6b21\u7684\u7ed3\u6784vm_area_truct\u63cf\u8ff0\u4e86\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\u4e00\u4e2a\u533a\u95f4\uff08\u7b80\u79f0\u865a\u62df\u533a\uff09\u3002\u6bcf\u4e2a\u8fdb\u7a0b\u53ea\u6709\u4e00\u4e2amm_struct\u7ed3\u6784\uff0c\u5728\u6bcf\u4e2a\u8fdb\u7a0b\u7684task_struct\u7ed3\u6784\u4e2d\uff0c\u6709\u4e00\u4e2a\u6307\u5411\u8be5\u8fdb\u7a0b\u7684\u7ed3\u6784\u3002\u53ef\u4ee5\u8bf4\uff0cmm_struct\u7ed3\u6784\u662f\u5bf9\u6574\u4e2a\u7528\u6237\u7a7a\u95f4\u7684\u63cf\u8ff0\u3002 \u2003 ps2. \u6bcf\u4e2a\u8fdb\u7a0b\u88ab\u521b\u5efa\u7684\u65f6\u5019\uff0c\u5728\u751f\u6210\u8fdb\u7a0b\u63cf\u8ff0\u7b26task_struct\u7684\u540c\u65f6\uff0c\u4f1a\u751f\u6210\u4e24\u4e2a\u6808\uff0c\u4e00\u4e2a\u662f\u7528\u6237\u6808\uff0c\u4f4d\u4e8e\u7528\u6237\u5730\u5740\u7a7a\u95f4\uff1b\u4e00\u4e2a\u662f\u5185\u6838\u6808\uff0c\u4f4d\u4e8e\u5185\u6838\u7a7a\u95f4\u3002\u5f53\u8fdb\u7a0b\u5728\u7528\u6237\u5730\u5740\u7a7a\u95f4\u4e2d\u6267\u884c\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u7684\u662f\u7528\u6237\u6808\uff0cCPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u4e2d\u5b58\u7684\u662f\u7528\u6237\u6808\u7684\u5730\u5740\uff1b\u540c\u7406\uff0c\u5f53\u8fdb\u7a0b\u5728\u5185\u6838\u7a7a\u95f4\u6267\u884c\u65f6\uff0cCPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u4e2d\u653e\u7684\u662f\u5185\u6838\u6808\u7684\u5730\u5740\u3002 \u2003\u4f4d\u4e8e\u7528\u6237\u7a7a\u95f4\u7684\u8fdb\u7a0b\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\u65f6\uff0c\u5b83\u4f1a\u9677\u5165\u5185\u6838\uff0c\u8ba9\u5185\u6838\u4ee3\u5176\u6267\u884c\u3002\u6b64\u65f6\uff0c\u8fdb\u7a0b\u7528\u6237\u6808\u7684\u5730\u5740\u4f1a\u88ab\u5b58\u8fdb\u5185\u6838\u6808\u4e2d\uff0cCPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u4e2d\u7684\u5185\u5bb9\u4e5f\u4f1a\u53d8\u4e3a\u5185\u6838\u6808\u7684\u5730\u5740\u3002\u5f53\u7cfb\u7edf\u8c03\u7528\u6267\u884c\u5b8c\u6bd5\uff0c\u8fdb\u7a0b\u4ece\u5185\u6838\u6808\u627e\u5230\u7528\u6237\u6808\u7684\u5730\u5740\uff0c\u7ee7\u7eed\u5728\u7528\u6237\u7a7a\u95f4\u4e2d\u6267\u884c\uff0c\u6b64\u65f6CPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u5c31\u53d8\u4e3a\u4e86\u7528\u6237\u6808\u7684\u5730\u5740\u3002 \u2003 ps3. thread_info : \u5bf9\u4e8e\u5bc4\u5b58\u5668\u8f83\u5c11\u7684\u786c\u4ef6\u4f53\u7cfb\u7ed3\u6784\u6765\u8bf4\uff0c\u4f7f\u7528\u8fdb\u7a0b\u7684task_struct\u662f\u901a\u8fc7\u5b58\u653e\u5728\u8fdb\u7a0b\u5185\u6838\u6808\u6808\u9876\u7684struct thread_info\u6765\u5b9e\u73b0\u7684\uff0c\u5176task\u57df\u4e2d\u5b58\u653e\u4e86\u6307\u5411\u8be5\u4efb\u52a1\u5b9e\u9645task_struct\u7684\u6307\u9488\u3002 \u8fdb\u7a0b\u521b\u5efa \u2003 UNIX\u7cfb\u7edf\u91c7\u7528fork()\u548cexec()\u4e24\u4e2a\u5355\u72ec\u7684\u51fd\u6570\u6765\u5b8c\u6210\u8fdb\u7a0b\u7684\u521b\u5efa: \u2003fork()\u901a\u8fc7\u62f7\u8d1d\u5f53\u524d\u8fdb\u7a0b\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u5b50\u8fdb\u7a0b\u4e0e\u7236\u8fdb\u7a0b\u7684\u533a\u522b\u4ec5\u5728\u4e8ePID\u3001PPID(\u5b50\u8fdb\u7a0b\u7684PPID\u4e3a\u88ab\u62f7\u8d1d\u8fdb\u7a0b\u7684PID)\u548c\u67d0\u4e9b\u8d44\u6e90\u4e0e\u7edf\u8ba1\u91cf(\u4f8b\u5982\u6302\u8d77\u7684\u4fe1\u53f7\uff0c\u6ca1\u5fc5\u8981\u88ab\u62f7\u8d1d); \u2003exec()\u51fd\u6570\u8d1f\u8d23\u8bfb\u53d6\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u5c06\u5176\u8f7d\u5165\u5730\u5740\u7a7a\u95f4\u5f00\u59cb\u8fd0\u884c\u3002 \u2003 copy-on-write (\u5199\u65f6\u590d\u5236): \u4f20\u7edffork()\u7cfb\u7edf\u8c03\u7528\u76f4\u63a5\u62f7\u8d1d\u7236\u8fdb\u7a0b\u6240\u6709\u8d44\u6e90\u7ed9\u5b50\u8fdb\u7a0b\uff0c\u4e0d\u4ec5\u6548\u7387\u4f4e\u4e0b\uff0c\u4e14\u5982\u679c\u65b0\u8fdb\u7a0b\u6253\u7b97\u7acb\u5373\u6267\u884c\u4e00\u4e2a\u65b0\u7684\u6620\u50cf\uff0c\u62f7\u8d1d\u5c06\u524d\u529f\u5c3d\u5f03\uff1b\u800clinux\u7684fork()\u7cfb\u7edf\u8c03\u7528\u91c7\u7528\u5199\u65f6\u62f7\u8d1d\u6280\u672f\u6765\u63a8\u8fdf\u751a\u81f3\u514d\u9664\u62f7\u8d1d\u6570\u636e\uff0c\u5177\u4f53\u5b9e\u73b0\u4e3a: \u5728\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\uff0c\u5e76\u4e0d\u4f1a\u7acb\u523b\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u8d44\u6e90\u7ed9\u5b50\u8fdb\u7a0b\uff0c\u4e5f\u5373\u6b64\u65f6\u5185\u5b58\u4e0d\u4f1a\u4e3a\u5b50\u8fdb\u7a0b\u5206\u914d\u5b9e\u9645\u7684\u7269\u7406\u5185\u5b58\u9875\u9762\uff0c\u800c\u662f\u8ba9\u5b83\u5171\u4eab\u7236\u8fdb\u7a0b\u7684\u5185\u5b58\u9875\u9762\uff1b\u53ea\u6709\u5f53\u7236\u8fdb\u7a0b\u6216\u65b0\u8fdb\u7a0b\u4e2d\u4efb\u610f\u4e00\u4e2a\u6709\u5199\u5185\u5b58\u64cd\u4f5c\u65f6\uff0c\u7cfb\u7edf\u624d\u4f1a\u4e3a\u6267\u884c\u5199\u64cd\u4f5c\u7684\u8fdb\u7a0b\u5206\u914d\u76f8\u5173\u7684\u72ec\u81ea\u4f7f\u7528\u7684\u5185\u5b58\u9875\u9762\u3002 \u2003 fork() : linux\u901a\u8fc7clone()\u7cfb\u7edf\u8c03\u7528\u5b9e\u73b0fork()\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u53c2\u6570\u6807\u5fd7\u6765\u6307\u660e\u7236\u3001\u5b50\u8fdb\u7a0b\u9700\u8981\u5171\u4eab\u7684\u8d44\u6e90; \u4e8b\u5b9e\u4e0a fork()\u3001vfork()\u3001_clone()\u5e93\u51fd\u6570\u90fd\u6839\u636e\u5404\u81ea\u9700\u8981\u7684\u53c2\u6570\u6807\u5fd7\u6765\u8c03\u7528clone() , \u7136\u540e\u7531clone()\u6765\u8c03\u7528do_fork()\u6765\u5b8c\u6210\u521b\u5efa\u4e2d\u7684\u5927\u90e8\u5206\u5de5\u4f5c\uff0c\u8be5\u51fd\u6570\u8c03\u7528copy_process()\uff0c\u7136\u540e\u8ba9\u8fdb\u7a0b\u5f00\u59cb\u8fd0\u884c\uff0c\u5177\u4f53\u5b8c\u6210\u5de5\u4f5c\u4e3a\uff1a fork()=>clone()=>do_fork()=>copy_process() \u2003 vfork() :\u9664\u4e86\u4e0d\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u9875\u8868\u9879\uff0cvfork()\u548cfork()\u529f\u80fd\u76f8\u540c\u3002\u5b50\u8fdb\u7a0b\u4f5c\u4e3a\u7236\u8fdb\u7a0b\u7684\u4e00\u4e2a\u5355\u72ec\u7684\u7ebf\u7a0b\u5728\u5b83\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\u8fd0\u884c\uff0c\u7236\u8fdb\u7a0b\u88ab\u963b\u585e\uff0c\u76f4\u5230\u5b50\u8fdb\u7a0b\u9000\u51fa\u6216\u6267\u884cexec(), \u4e14\u5b50\u8fdb\u7a0b\u8fd0\u884c\u671f\u95f4\u4e0d\u80fd\u5411\u5730\u5740\u7a7a\u95f4\u4e2d\u5199\u5165\u3002 \u8fdb\u7a0b\u7ec8\u6b62 \u2003\u8c03\u7528exit()\u7cfb\u7edf\u8c03\u7528\uff0c\u6216\u8005\u63a5\u53d7\u65e0\u6cd5\u5904\u7406\u3001\u5ffd\u7565\u7684\u4fe1\u53f7\u6216\u5f02\u5e38\u65f6\u88ab\u52a8\u7ec8\u7ed3\u3002\u5927\u90e8\u5206\u5de5\u4f5c\u4f9d\u8d56do_exit()\u5b8c\u6210\uff0c\u6b64\u540e\u8fdb\u7a0b\u5904\u4e8eTASK_ZOMBIE\u72b6\u6001\uff0c\u5b58\u5728\u7684\u552f\u4e00\u76ee\u7684\u5c31\u662f\u5411\u7236\u8fdb\u7a0b\u63d0\u4f9b\u4fe1\u606f\uff0c \u7236\u8fdb\u7a0b\u68c0\u7d22\u5230\u4fe1\u606f\u540e(\u901a\u8fc7wait()\u7cfb\u7edf\u8c03\u7528\u65cf)\uff0c\u6216\u8005\u901a\u77e5\u5185\u6838\u90a3\u662f\u65e0\u5173\u4fe1\u606f\u540e\uff0c\u8be5\u8fdb\u7a0b\u6240\u6301\u6709\u7684\u5269\u4f59\u5185\u5b58\u4e5f\u88ab\u91ca\u653e \u3002 \u2003\u56e0\u6b64\u7236\u8fdb\u7a0b\u5728\u5b50\u8fdb\u7a0b\u524d\u9000\u51fa\uff0c\u5fc5\u987b\u4fdd\u8bc1\u5b50\u8fdb\u7a0b\u80fd\u627e\u5230\u4e00\u4e2a\u65b0\u7684\u7236\u4eb2\uff0c\u5426\u5219\u4f1a \u6210\u4e3a\u5b64\u513f\u8fdb\u7a0b\uff0c\u5728\u9000\u51fa\u65f6\u4e00\u76f4\u5904\u4e8eZOMBIE\u72b6\u6001\uff0c\u65e0\u6cd5\u91ca\u653e\u5269\u4f59\u5185\u5b58 \u3002\u901a\u5e38\u662f\u5728\u5f53\u524d\u7ebf\u7a0b\u7ec4\u5185\u627e\u4e00\u4e2a\u7ebf\u7a0b\u6216\u8005\u8ba9init\u8fdb\u7a0b\u4f5c\u4e3a\u7236\u8fdb\u7a0b\u3002 \u4e09\u4e2a\u7279\u6b8a\u8fdb\u7a0b idle\u8fdb\u7a0b(PID = 0), init\u8fdb\u7a0b(PID = 1)\u548ckthreadd(PID = 2) Linux\u4e2dPID\u4e3a0\u7684\u8fdb\u7a0b\u662f\u6240\u6709\u5176\u4ed6\u8fdb\u7a0b\u7684\u7956\u5148, \u4e5f\u79f0\u4f5c idle\u8fdb\u7a0b \u6216swapper\u8fdb\u7a0b(\u4ea4\u6362\u8fdb\u7a0b\uff0c\u56e0\u4e3ainit_task\u4e2d comm\u5b57\u6bb5\u5373\u4e3aswapper)\uff0c\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0c\u6839\u636e\u9884\u5b9a\u4e49\u7684INIT_TASK\u5b8f\u5b9a\u4e49\u5b8c\u6210\u521d\u59cb\u5316\uff0c\u751f\u6210\u8fdb\u7a0b\u63cf\u8ff0\u7b26init_task\uff0c 0\u53f7\u8fdb\u7a0b\u7684\u6210\u5458\u5927\u90e8\u5206\u662f\u9759\u6001\u5b9a\u4e49\u7684\uff0c\u5176\u6210\u5458\u521d\u59cb\u503c\u4e5f\u90fd\u901a\u8fc7\u5bf9\u5e94\u7684\u521d\u59cb\u5316\u5b8f\u6765\u521d\u59cb\u5316\uff0c\u5982INIT_MM\u3002 0\u53f7\u8fdb\u7a0b\u8c03\u7528start_kernel\u51fd\u6570\u6765\u5bf9\u5185\u6838\u5404\u4e2a\u91cd\u8981\u5b50\u7cfb\u7edf\u8fdb\u884c\u521d\u59cb\u5316(\u5982\u5185\u5b58\u3001CPU)\uff0c\u7136\u540e\u8c03\u7528rest_init() \u6765\u5b8c\u6210\u5269\u4f59\u7684\u90e8\u5206\u7684\u521d\u59cb\u5316\uff0c\u5728\u5176\u4e2d\u4f1a\u901a\u8fc7 pid = kernel_thread(kernel_init, NULL, CLONE_FS); pid = kernel_thread(kthreadd, NULL, CLONE_FS | CLONE_FILES); \u521b\u5efa\u4e24\u4e2a\u8fdb\u7a0b\uff1b \u524d\u8005\u5373\u4e3a1\u53f7\u8fdb\u7a0b(\u521a\u521b\u5efa\u65f6\u5c1a\u5c5e\u4e8e\u5185\u6838\u8fdb\u7a0b\uff0c\u5171\u4eab0\u53f7\u8fdb\u7a0b\u7684\u8d44\u6e90), \u5728kernel_init\u51fd\u6570\u4e2d\u6765\u5b8c\u6210\u5404\u79cd\u5916\u8bbe\u9a71\u52a8\u7684\u521d\u59cb\u5316\uff0c \u5e76\u5728\u6700\u540e\u8c03\u7528execve()\u6765\u52a0\u8f7dinit\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4e3a1\u53f7\u8fdb\u7a0b\u52a0\u8f7d\u72ec\u7acb\u7684\u5730\u5740\u8d44\u6e90\uff0c\u6b64\u65f61\u53f7\u8fdb\u7a0b\u7531\u5185\u6838\u6001\u8f6c\u53d8\u4e3a\u7528\u6237\u6001\uff0c \u5373\u6210\u4e3a init\u8fdb\u7a0b \u3002 \u540e\u8005\u662f\u75311\u53f7\u8fdb\u7a0b\u521b\u5efa\u7684\uff0c\u79f0\u4e3a2\u53f7\u8fdb\u7a0b(\u8fdb\u7a0b\u540d\u5373kthreadd)\uff0c\u59cb\u7ec8\u8fd0\u884c\u5728\u5185\u6838\u7a7a\u95f4, \u8d1f\u8d23\u6240\u6709\u5185\u6838\u7ebf\u7a0b\u7684\u8c03\u5ea6\u548c\u7ba1\u7406, \u662f\u6240\u6709\u5185\u6838\u7ebf\u7a0b\u7684\u7236\u7ebf\u7a0b\u3002\uff0c \u7ebf\u7a0b \u7ebf\u7a0b \u7ebf\u7a0b\uff08thread\uff09\u662f\u64cd\u4f5c\u7cfb\u7edf\u80fd\u591f\u8fdb\u884c\u8fd0\u7b97\u8c03\u5ea6\u7684\u6700\u5c0f\u5355\u4f4d\uff0c\u5b83\u88ab\u5305\u542b\u5728\u8fdb\u7a0b\u4e4b\u4e2d\uff0c\u662f\u8fdb\u7a0b\u4e2d\u7684\u5b9e\u9645\u8fd0\u4f5c\u5355\u4f4d\u3002 \u2003\u591a\u7ebf\u7a0b\uff1a1\u300b\u5e76\u884c\u5b9e\u4f53\u62e5\u6709\u5171\u4eab\u540c\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4\u548c\u6240\u6709\u53ef\u7528\u6570\u636e\u7684\u80fd\u529b\u3002\uff08\u5373\u4e00\u4e2a\u8fdb\u7a0b\u5305\u542b\u591a\u4e2a\u7ebf\u7a0b\uff0c \u5b83\u4eec\u5171\u4eab\u8be5\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\uff0c \u800c\u591a\u8fdb\u7a0b\u6709\u4e0d\u540c\u7684\u5730\u5740\u7a7a\u95f4\uff09\u3002 2\u300b\u7ebf\u7a0b\u6bd4\u8fdb\u7a0b\u66f4\u8f7b\u91cf\u7ea7\uff0c\u6bd4\u8fdb\u7a0b\u66f4\u5bb9\u6613\u521b\u5efa\uff0c\u4e5f\u66f4\u5bb9\u6613\u64a4\u9500\u3002 3\u300b\u82e5\u5b58\u5728\u5927\u91cf\u7684\u8ba1\u7b97\u548cI/O\u5904\u7406\uff0c\u62e5\u6709\u591a\u7ebf\u7a0b\u5141\u8bb8\u8fd9\u4e9b\u6d3b\u52a8\u5f7c\u6b64\u91cd\u53e0\u8fdb\u884c\u30024\u300b\u5728\u591aCPU\u7cfb\u7edf\u4e2d\uff0c\u591a\u7ebf\u7a0b\u53ef\u4ee5\u5b9e\u73b0\u771f\u6b63\u7684\u5e76\u884c\u3002 \u5728\u7528\u6237\u7a7a\u95f4\u7ba1\u7406\u7ebf\u7a0b\u65f6\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u9700\u8981\u6709\u5176\u4e13\u7528\u7684 \u7ebf\u7a0b\u8868 , \u7ebf\u7a0b\u8868\uff08or thread control block, TCB\uff09\uff1a\u8ddf\u8e2a\u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0b\uff0c\u8bb0\u5f55\u5404\u4e2a\u7ebf\u7a0b\u7684\u5c5e\u6027\uff0c \u5982\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u7a0b\u5e8f\u8ba1\u6570\u5668\uff0c\u5806\u6808\u6307\u9488\uff0c\u5bc4\u5b58\u5668\u548c\u72b6\u6001\u3002 \u7ebf\u7a0b\u5207\u6362\u4e0e\u8fdb\u7a0b\u5207\u6362 \u2003\u8fdb\u7a0b\u5207\u6362\u5206\u4e24\u6b65\uff1a1.\u5207\u6362\u9875\u76ee\u5f55\u4ee5\u4f7f\u7528\u65b0\u7684\u5730\u5740\u7a7a\u95f4\uff1b2.\u5207\u6362\u5185\u6838\u6808\u548c\u786c\u4ef6\u4e0a\u4e0b\u6587\u3002 \u2003\u5bf9\u4e8elinux\u6765\u8bf4\uff0c\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u7684\u6700\u5927\u533a\u522b\u5c31\u5728\u4e8e\u5730\u5740\u7a7a\u95f4\uff0c\u5bf9\u4e8e\u7ebf\u7a0b\u5207\u6362\uff0c\u7b2c1\u6b65\u662f\u4e0d\u9700\u8981\u505a\u7684\uff0c\u7b2c2\u6b65\u662f\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u5207\u6362\u90fd\u8981\u505a\u7684\u3002\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u7ebf\u7a0b\u662f\u5171\u4eab\u6240\u5728\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\uff0c\u56e0\u6b64\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0b\u8fdb\u884c\u7ebf\u7a0b\u5207\u6362\u65f6\u4e0d\u6d89\u53ca\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\u8f6c\u6362. \u7ebf\u7a0b\u5b9e\u73b0\u65b9\u5f0f : 1\u300b\u5728\u7528\u6237\u7a7a\u95f4\u5b9e\u73b0\u7ebf\u7a0b \uff1a\u7279\u70b9\uff1a \u6574\u4e2a\u7ebf\u7a0b\u5305\u653e\u5165\u7528\u6237\u7a7a\u95f4\u4e2d\uff0c\u5185\u6838\u5bf9\u7ebf\u7a0b\u5305\u4e00\u65e0\u6240\u77e5\u3002\u4ece\u5185\u6838\u89d2\u5ea6\u8003\u8651\uff0c\u5c31\u662f\u6309\u6b63\u5e38\u7684\u65b9\u5f0f\u7ba1\u7406\uff0c\u5373\u5355\u7ebf\u7a0b\u8fdb\u7a0b \u3002 \u7ebf\u7a0b\u5728\u4e00\u4e2a\u8fd0\u884c\u65f6\u7cfb\u7edf\u7684\u4e0a\u5c42\u8fd0\u884c\uff0c\u8be5\u8fd0\u884c\u65f6\u7cfb\u7edf\u662f\u4e00\u4e2a\u7ba1\u7406\u7ebf\u7a0b\u7684\u8fc7\u7a0b\u7684\u96c6\u5408\u3002 \u4f18\u70b9 \uff1a 1\u3001\u7528\u6237\u7ea7\u7ebf\u7a0b\u5305\u53ef\u4ee5\u5728\u4e0d\u652f\u6301\u7ebf\u7a0b\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u5b9e\u73b0\u3002 2\u3001\u7ebf\u7a0b\u5207\u6362\u6bd4\u5185\u6838\u5feb\u66f4\u591a\uff08\u56e0\u4e3a\u4fdd\u5b58\u8be5\u7ebf\u7a0b\u72b6\u6001\u7684\u8fc7\u7a0b\u548c\u8c03\u5ea6\u7a0b\u5e8f\u90fd\u662f\u672c\u5730\u8fc7\u7a0b\uff0c\u542f\u52a8\u5b83\u4eec\u6bd4\u8fdb\u884c\u5185\u6838\u8c03\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u4e0d\u9700\u8981\u9677\u5165\u5185\u6838\uff0c\u4e0d\u9700\u8981\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u4e5f\u4e0d\u9700\u8981\u5bf9\u5185\u5b58\u9ad8\u901f\u7f13\u5b58\u8fdb\u884c\u5237\u65b0\uff0c\u4f7f\u5f97\u7ebf\u7a0b\u8c03\u5ea6\u5341\u5206\u5feb\u6377\u3002 3\u3001\u5141\u8bb8\u6bcf\u4e2a\u8fdb\u7a0b\u6709\u81ea\u5df1\u5b9a\u5236\u7684\u8c03\u5ea6\u7b97\u6cd5\u3002 \u7f3a\u70b9 : 1\u3001\u7ebf\u7a0b\u53d1\u751fI/O\u6216\u9875\u9762\u6545\u969c\u5f15\u8d77\u7684\u963b\u585e\u65f6\uff0c\u5982\u679c\u8c03\u7528\u963b\u585e\u7cfb\u7edf\u8c03\u7528\u5219\u5185\u6838\u7531\u4e8e\u4e0d\u77e5\u9053\u6709\u591a\u7ebf\u7a0b\u7684\u5b58\u5728\uff0c\u800c\u4f1a\u963b\u585e\u6574\u4e2a\u8fdb\u7a0b\u4ece\u800c\u963b\u585e\u6240\u6709\u7ebf\u7a0b; 2\u3001\u7528\u6237\u7ea7\u7ebf\u7a0b\u53ea\u80fd\u5360\u7528\u4e00\u4e2a\u6838\uff0c\u65e0\u6cd5\u505a\u5230\u5e76\u884c\u5904\u7406\uff0c\u4e0d\u80fd\u5229\u7528\u591a\u6838\u7684\u4f18\u52bf\uff1b 3\u3001\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u5f00\u59cb\u8fd0\u884c\uff0c\u90a3\u4e48\u8be5\u8fdb\u7a0b\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b\u5c31\u4e0d\u80fd\u8fd0\u884c\uff0c\u9664\u975e\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u81ea\u52a8\u653e\u5f03CPU\uff1b \u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\u5185\u90e8\uff0c\u6ca1\u6709\u65f6\u949f\u4e2d\u65ad\uff0c\u6240\u4ee5\u4e0d\u53ef\u80fd\u7528\u8f6e\u8f6c\u8c03\u5ea6\u7684\u65b9\u5f0f\u8c03\u5ea6\u7ebf\u7a0b\u3002\u9664\u975e\u67d0\u4e2a\u7ebf\u7a0b\u6309\u7167\u81ea\u5df1\u7684\u610f\u5fd7\u8fdb\u5165\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u5426\u5219\u8c03\u5ea6\u7a0b\u5e8f\u5c31\u6ca1\u6709\u4efb\u4f55\u673a\u4f1a \u3002 2\u300b\u5728\u5185\u6838\u4e2d\u5b9e\u73b0\u7ebf\u7a0b \uff1a\u7279\u70b9\uff1a\u5185\u6838\u652f\u6301\u5e76\u7ba1\u7406\u7ebf\u7a0b\uff0c\u4e0d\u518d\u9700\u8981\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u4e5f\u6ca1\u6709\u7ebf\u7a0b\u8868\u3002\u5728\u5185\u6838\u4e2d\u6709\u7528\u6765\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u8868\u3002\u5f53\u67d0\u4e2a\u7ebf\u7a0b\u5e0c\u671b\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u6216\u64a4\u9500\u4e00\u4e2a\u5df2\u6709\u7ebf\u7a0b\u65f6\uff0c\u5b83\u8fdb\u884c\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\uff0c\u8fd9\u4e2a\u7cfb\u7edf\u8c03\u7528\u901a\u8fc7\u5bf9\u7ebf\u7a0b\u8868\u7684\u66f4\u65b0\u5b8c\u6210\u7ebf\u7a0b\u521b\u5efa\u6216\u64a4\u9500\u5de5\u4f5c\u3002 \u4f18\u70b9: 1\u3001\u6240\u6709\u80fd\u591f\u963b\u585e\u7ebf\u7a0b\u7684\u8c03\u7528\u90fd\u4ee5\u7cfb\u7edf\u8c03\u7528\u7684\u5f62\u5f0f\u5b9e\u73b0\u3002 2\u3001\u5982\u679c\u67d0\u4e2a\u7ebf\u7a0b\u5f15\u8d77\u4e86\u9875\u9762\u6545\u969c\uff0c\u5185\u6838\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u68c0\u67e5\u8be5\u8fdb\u7a0b\u662f\u5426\u6709\u4efb\u4f55\u5176\u4ed6\u53ef\u8fd0\u884c\u7684\u7ebf\u7a0b\u3002 \u7f3a\u70b9: 1.\u5185\u6838\u7ea7\u7ebf\u7a0b\u5207\u6362\u4ee3\u4ef7\u66f4\u5927\u30022\u3002\u5185\u6838\u7ea7\u7ebf\u7a0b\u6570\u91cf\u6709\u9650\uff0c\u6269\u5c55\u6027\u6bd4\u4e0d\u4e0a\u7528\u6237\u7ea7\u7ebf\u7a0b\u3002 \u20033\u300b \u6df7\u5408\u5b9e\u73b0\uff1a\u4f7f\u7528\u5185\u6838\u7ea7\u7ebf\u7a0b\uff0c\u7136\u540e\u5c06\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e0e\u67d0\u4e9b\u6216\u5168\u90e8\u5185\u6838\u7ebf\u7a0b\u591a\u8def\u590d\u7528\u3002 linux \u7ebf\u7a0b\u5b9e\u73b0 \u2003\u5b9e\u73b0\u673a\u5236\u4e0ewindows\u6709\u5f88\u5927\u5dee\u5f02\uff0c\u540e\u8005\u5728\u5185\u6838\u4e2d\u63d0\u4f9b\u4e86\u4e13\u95e8\u652f\u6301\u7ebf\u7a0b\u7684\u673a\u5236\uff0c\u5e76\u79f0\u5176\u4e3a\u8f7b\u91cf\u7ea7\u7ebf\u7a0b\u3002 \u2003\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u8fdb\u7a0b\u521b\u5efa\u8fc7\u7a0b\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5728\u8c03\u7528clone()\u662f\u9700\u8981\u4f20\u9012\u4e00\u4e9b\u53c2\u6570\u6807\u5fd7\u6765\u6307\u660e\u9700\u8981\u5171\u4eab\u7684\u8d44\u6e90\u3002 pid = clone(function, stack_ptr, sharing_flags, arg) \u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5728\u5f53\u524d\u8fdb\u7a0b\u6216\u65b0\u7684\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff0c\u5177\u4f53\u4f9d\u8d56\u4e8e\u53c2\u6570sharing_flags. sharing_flags\u662f\u4e00\u4e2a\u4f4d\u56fe\uff0c\u5e38\u89c1\u7684\u4f4d\u542b\u4e49\u6709: \u5185\u6838\u7ebf\u7a0b \u72ec\u7acb\u8fd0\u884c\u5728\u5185\u6838\u7a7a\u95f4\u7684\u6807\u51c6\u8fdb\u7a0b\uff0c\u548c\u666e\u901a\u8fdb\u7a0b\u7684\u533a\u522b\u5728\u4e8e\u5185\u6838\u7ebf\u7a0b\u6ca1\u6709\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\u3002\u5b83\u4eec\u53ea\u5728\u5185\u6838\u7a7a\u95f4\u8fd0\u884c\uff0c\u4ece\u4e0d\u5207\u6362\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u548c\u666e\u901a\u8fdb\u7a0b\u4e00\u6837\uff0c\u53ef\u4ee5\u88ab\u8c03\u5ea6\u548c\u62a2\u5360\u3002 \u8fdb\u7a0b\u8c03\u5ea6 \u591a\u4efb\u52a1: \u591a\u4efb\u52a1\u64cd\u4f5c\u7cfb\u7edf\u5c31\u662f\u80fd \u540c\u65f6\u5e76\u53d1\u4f4e\u4ea4\u4e92\u6267\u884c\u591a\u4e2a\u8fdb\u7a0b \u7684\u64cd\u4f5c\u7cfb\u7edf \u8fdb\u7a0b\u8c03\u5ea6\u7b56\u7565 \u51b3\u5b9a\u8c03\u5ea6\u7a0b\u5e8f\u4f55\u65f6\u8ba9\u4ec0\u4e48\u8fdb\u7a0b\u8fd0\u884c\uff0c\u8d1f\u8d23\u4f18\u5316\u4f7f\u7528\u5904\u7406\u5668\u65f6\u95f4\u3002 \u2003I/O\u6d88\u8017\u578b\u8fdb\u7a0b\uff1a\u8fd9\u91cc\u7684I/O\u662f\u4efb\u4f55\u7c7b\u578b\u7684\u53ef\u963b\u585e\u8d44\u6e90\uff0c\u8fdb\u7a0b\u7684\u5927\u90e8\u5206\u65f6\u95f4\u7528\u6765\u63d0\u4ea4I/O\u8bf7\u6c42\u6216\u662f\u7b49\u5f85I/O\u8bf7\u6c42\u3002 \u2003\u5904\u7406\u5668\u6d88\u8017\u578b\u8fdb\u7a0b\uff1a\u65f6\u95f4\u5927\u591a\u7528\u5728\u6267\u884c\u4ee3\u7801\u4e0a\uff0c\u9664\u975e\u88ab\u62a2\u5360\uff0c\u5426\u5219\u901a\u5e38\u4e00\u76f4\u5728\u8fd0\u884c\u3002 \u2003\u51fa\u4e8e\u7cfb\u7edf\u54cd\u5e94\u901f\u5ea6\u8003\u8651\uff0c\u8c03\u5ea6\u5668\u4f1a\u964d\u4f4e\u5904\u7406\u5668\u6d88\u8017\u578b\u8fdb\u7a0b\u7684\u8c03\u5ea6\u9891\u7387\uff0c\u800c\u5ef6\u957f\u5176\u6267\u884c\u65f6\u95f4\u3002 \u2003 \u8c03\u5ea6\u7b56\u7565\u901a\u5e38\u8981\u5728\u8fdb\u7a0b\u54cd\u5e94\u65f6\u95f4\u548c\u6700\u5927\u7cfb\u7edf\u5229\u7528\u7387(\u9ad8\u541e\u5410\u91cf)\u8fd9\u4e24\u4e2a\u76ee\u6807\u95f4\u5bfb\u6c42\u5e73\u8861 \u8fdb\u7a0b\u4f18\u5148\u7ea7\uff1alinux\u91c7\u7528\u4e86\u4e24\u79cd\u4f18\u5148\u7ea7\u8303\u56f4 \u2003nice\u503c\uff0c\u8303\u56f4[-20,19], \u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u5c0f, \u5728linux\u4e2d\uff0cnice\u503c\u4ee3\u8868\u65f6\u95f4\u7247\u6bd4\u4f8b\u3002 \u2003\u5b9e\u65f6\u4f18\u5148\u7ea7\uff0c\u9ed8\u8ba4\u8303\u56f4[0,99], \u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u4efb\u4f55\u5b9e\u65f6\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u90fd\u9ad8\u4e8e\u666e\u901a\u8fdb\u7a0b\u3002 \u65f6\u95f4\u7247 \u2003\u8868\u660e\u8fdb\u7a0b\u5728\u88ab\u62a2\u5360\u524d\u6240\u80fd\u6301\u7eed\u8fd0\u884c\u7684\u65f6\u95f4 Linux\u8fdb\u7a0b\u8c03\u5ea6\u7b97\u6cd5 \u5b8c\u5168\u516c\u5e73\u8c03\u5ea6(CFS): \u5176\u662f\u4e00\u4e2a\u9488\u5bf9\u666e\u901a\u8fdb\u7a0b\u7684\u8c03\u5ea6\u7c7b\u3002 \u2003 \u8bbe\u8ba1\u7406\u5ff5 :\u8fdb\u7a0b\u8c03\u5ea6\u7684\u6548\u679c\u5982\u540c\u7cfb\u7edf\u5177\u5907\u4e00\u4e2a\u7406\u60f3\u4e2d\u7684\u5b8c\u7f8e\u591a\u4efb\u52a1\u5904\u7406\u5668\uff0c\u5728\u8fd9\u79cd\u7cfb\u7edf\u4e2d\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u5c06\u83b7\u5f971/n\u7684\u5904\u7406\u5668\u65f6\u95f4(n\u662f\u53ef\u8fd0\u884c\u7684\u8fdb\u7a0b\u6570\u91cf)\u3002 \u2003 \u5185\u90e8\u903b\u8f91 :CFS\u5e76\u6ca1\u6709\u76f4\u63a5\u5206\u914d\u65f6\u95f4\u7247\u5230\u8fdb\u7a0b\uff0c\u800c\u662f\u5c06\u5904\u7406\u5668\u7684\u4f7f\u7528\u6bd4\u5212\u5206\u7ed9\u4e86\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u6bd4\u4f8b\u4f1a\u53d7\u5230nice\u503c\u7684\u5f71\u54cd\uff1b\u6bcf\u4e2a\u8fdb\u7a0b\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\uff0c\u5faa\u73af\u8f6e\u8f6c\uff0cCFS\u7136\u540e\u9009\u62e9\u8fd0\u884c\u6700\u5c11(vruntime\u6700\u5c0f)\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u8fd0\u884c\u8fdb\u7a0b\u3002 \u2003 \u5177\u4f53\u5b9e\u73b0 : CFS\u4f7f\u7528\u7ea2\u9ed1\u6811\u6765\u7ec4\u7ec7\u53ef\u8fd0\u884c\u8fdb\u7a0b\u961f\u5217\uff0c\u5e76\u7528\u5176\u8fc5\u901f\u627e\u5230\u6700\u5c0fvruntime\u503c\u7684\u8fdb\u7a0b\u3002 vruntime \uff0c\u865a\u8fd0\u884c\u65f6\uff0c \u5206\u914d\u7ed9\u8fdb\u7a0b\u7684\u8fd0\u884c\u65f6\u95f4=\u8c03\u5ea6\u5468\u671f*\u8fdb\u7a0b\u6743\u91cd / \u6240\u6709\u53ef\u8fd0\u884c\u8fdb\u7a0b\u6743\u91cd\u4e4b\u548c (\u5f0f1) vruntime = \u5b9e\u9645\u8fd0\u884c\u65f6\u95f4*1024/\u8fdb\u7a0b\u6743\u91cd = \u8c03\u5ea6\u5468\u671f*1024/\u6240\u6709\u53ef\u8fd0\u884c\u8fdb\u7a0b\u6743\u91cd\u4e4b\u548c (\u5f0f2\uff0c1024\u662fnice\u4e3a0\u7684\u8fdb\u7a0b\u7684\u6743\u91cd) \u2003\u867d\u7136\u8fdb\u7a0b\u7684\u6743\u91cd\u4e0d\u540c\uff0c\u4f46vruntime\u7684\u589e\u957f\u901f\u5ea6\u662f\u76f8\u540c\u7684\uff1b\u5bf9\u4e8evruntime\u8f83\u5c0f\u7684\u8fdb\u7a0b\uff0c\u8bf4\u660e\u5176\u4e4b\u524d\u8fd0\u884c\u65f6\u95f4\u77ed\uff0c\u4f1a\u88ab\u4f18\u5148\u8c03\u5ea6\uff0c \u8fd9\u5373CFS\u516c\u5e73\u8c03\u5ea6\u7684\u7531\u6765\u3002 \u4f11\u7720\u548c\u5524\u9192 \u2003\u7b49\u5f85\u961f\u5217\u662f\u7531\u7b49\u5f85\u67d0\u4e9b\u4e8b\u4ef6\u53d1\u751f\u7684\u8fdb\u7a0b\u7ec4\u6210\u7684\u7b80\u5355\u94fe\u8868\u3002 \u4e0a\u4e0b\u6587\u5207\u6362: \u4ece\u4e00\u4e2a\u53ef\u6267\u884c\u8fdb\u7a0b\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u53ef\u6267\u884c\u8fdb\u7a0b \u7531shcedule()\u8c03\u7528context_switch()\u5b8c\u6210\u4e24\u9879\u57fa\u672c\u5de5\u4f5c: \u628a\u865a\u62df\u5185\u5b58\u4ece\u4e0a\u4e00\u4e2a\u8fdb\u7a0b\u6620\u5c04\u5207\u6362\u5230\u65b0\u8fdb\u7a0b\uff1b\u4ece\u4e0a\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5904\u7406\u5668\u72b6\u6001\u5207\u6362\u5230\u65b0\u8fdb\u7a0b\u7684\u5904\u7406\u5668\u72b6\u6001\uff0c\u5305\u62ec\u4fdd\u5b58\u3001\u6062\u590d\u6808\u4fe1\u606f\u548c\u5bc4\u5b58\u5668\u4fe1\u606f\u3002 need_resched: \u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u5305\u542b\u4e00\u4e2aneed_resched\u6807\u5fd7\uff0c\u7528\u6765\u8868\u660e\u662f\u5426\u9700\u8981\u91cd\u65b0\u6267\u884c\u4e00\u6b21\u8c03\u5ea6\u3002 \u7528\u6237\u62a2\u5360\uff1a\u4ece\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\u7528\u6237\u7a7a\u95f4\u6216\u8005\u4ece\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u8fd4\u56de\u7528\u6237\u7a7a\u95f4\u65f6\uff0c\u5982\u679cneed_resched\u88ab\u8bbe\u7f6e\uff0c\u4f1a\u5bfc\u81f4schedule()\u88ab\u8c03\u7528\uff0c\u5185\u6838\u4f1a\u9009\u62e9\u4e00\u4e2a\u5176\u4ed6\u66f4\u5408\u9002\u7684\u8fdb\u7a0b\u8fd0\u884c\u3002 \u5185\u6838\u62a2\u5360\uff1a\u6bcf\u4e2a\u8fdb\u7a0b\u7684thread_info\u4e2d\u5f15\u5165\u4e86preemept_count\u8ba1\u6570\u5668\uff0c\u521d\u59cb\u4e3a0\uff0c\u4f7f\u7528\u9501\u65f6\uff0c+1\uff0c\u91ca\u653e\u9501\u65f6\uff0c-1\uff1b\u5f53\u4e3a0\u65f6\uff0c\u5185\u6838\u5c31\u53ef\u6267\u884c\u62a2\u5360\u3002 \u5185\u6838\u62a2\u5360\u4f1a\u53d1\u751f\u5728: \u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u6b63\u5728\u6267\u884c\uff0c\u4e14\u8fd4\u56de\u5185\u6838\u7a7a\u95f4\u4e4b\u524d\uff1b \u5185\u6838\u4ee3\u7801\u5177\u6709\u62a2\u5360\u6027\u7684\u65f6\u5019\uff1b \u5185\u6838\u4e2d\u7684\u4efb\u52a1\u663e\u793a\u8c03\u7528schedule\uff1b \u5982\u679c\u5185\u6838\u4e2d\u7684\u4efb\u52a1\u963b\u585e \u5b9e\u65f6\u8c03\u5ea6\u7b56\u7565 \u4e2d\u65ad \u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u7684\u5c40\u9650: \u4e2d\u65ad\u5904\u7406\u6d41\u7a0b\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u4e0a\u534a\u90e8\u662f\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u5b8c\u6210\u5bf9\u786c\u4ef6\u4e2d\u65ad\u7684\u5373\u65f6\u54cd\u5e94\uff1b\u4e0b\u534a\u90e8\u6267\u884c\u4e0e\u4e2d\u65ad\u5904\u7406\u5bc6\u5207\u76f8\u5173\u4f46\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u672c\u8eab\u4e0d\u6267\u884c\u7684\u5de5\u4f5c\u3002\u4e0b\u534a\u90e8\u4e00\u822c\u5728\u4e2d\u65ad\u5904\u7406\u8fd4\u56de\u540e\u5c31\u7acb\u5373\u6267\u884c\uff0c\u800c\u4e14\u6267\u884c\u671f\u95f4\u5141\u8bb8\u54cd\u5e94\u6240\u6709\u4e2d\u65ad\u3002 \u8fd9\u79cd\u8bbe\u8ba1\u53ef\u4f7f\u7cfb\u7edf\u5904\u4e8e\u4e2d\u65ad\u5c4f\u853d\u72b6\u6001\u7684\u65f6\u95f4\u5c3d\u53ef\u80fd\u77ed\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u7cfb\u7edf\u7684\u54cd\u5e94\u65f6\u95f4\u3002 \u4e0b\u534a\u90e8\u5b9e\u73b0\u673a\u5236\uff1a\u8f6f\u4e2d\u65ad\u3001tasklet\u3001\u5de5\u4f5c\u961f\u5217 \u5185\u6838\u540c\u6b65 \u5e76\u884c&\u5e76\u53d1 \u2003\u5982\u679c\u67d0\u4e2a\u7cfb\u7edf\u652f\u6301\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u52a8\u4f5c\uff08Action\uff09\u540c\u65f6\u5b58\u5728\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7cfb\u7edf\u5c31\u662f\u4e00\u4e2a\u5e76\u53d1(concurrent)\u7cfb\u7edf\u3002\u5982\u679c\u67d0\u4e2a\u7cfb\u7edf\u652f\u6301\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u52a8\u4f5c\u540c\u65f6\u6267\u884c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7cfb\u7edf\u5c31\u662f\u4e00\u4e2a\u5e76\u884c(parallel)\u7cfb\u7edf\u3002 \u2003\u5728\u5e76\u53d1\u7a0b\u5e8f\u4e2d\u53ef\u4ee5\u540c\u65f6\u62e5\u6709\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u7ebf\u7a0b\u3002\u8fd9\u610f\u5473\u7740\uff0c\u5982\u679c\u7a0b\u5e8f\u5728\u5355\u6838\u5904\u7406\u5668\u4e0a\u8fd0\u884c\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u7ebf\u7a0b\u5c06\u4ea4\u66ff\u5730\u6362\u5165\u6216\u8005\u6362\u51fa\u5185\u5b58\u3002\u8fd9\u4e9b\u7ebf\u7a0b\u662f\u540c\u65f6\u201c\u5b58\u5728\u201d\u7684\u2014\u2014\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5904\u4e8e\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u67d0\u4e2a\u72b6\u6001\u3002\u5982\u679c\u7a0b\u5e8f\u80fd\u591f\u5e76\u884c\u6267\u884c\uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u662f\u8fd0\u884c\u5728\u591a\u6838\u5904\u7406\u5668\u4e0a\u3002\u6b64\u65f6\uff0c\u7a0b\u5e8f\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5c06\u5206\u914d\u5230\u4e00\u4e2a\u72ec\u7acb\u7684\u5904\u7406\u5668\u6838\u4e0a\uff0c\u56e0\u6b64\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c\u3002 \u2003\u5e76\u884c\u201d\u6982\u5ff5\u662f\u201c\u5e76\u53d1\u201d\u6982\u5ff5\u7684\u4e00\u4e2a\u5b50\u96c6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u53ef\u4ee5\u7f16\u5199\u4e00\u4e2a\u62e5\u6709\u591a\u4e2a\u7ebf\u7a0b\u6216\u8005\u8fdb\u7a0b\u7684\u5e76\u53d1\u7a0b\u5e8f\uff0c\u4f46\u5982\u679c\u6ca1\u6709\u591a\u6838\u5904\u7406\u5668\u6765\u6267\u884c\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4ee5\u5e76\u884c\u65b9\u5f0f\u6765\u8fd0\u884c\u4ee3\u7801\u3002 \u540c\u6b65 \u4e34\u754c\u533a: \u5bf9\u5171\u4eab\u5185\u5b58\u8fdb\u884c\u8bbf\u95ee\u7684\u7a0b\u5e8f\u7247\u6bb5\u79f0\u4f5c\u4e34\u754c\u533a\u57df(critical region)\u6216\u4e34\u754c\u533a(critical section)\u3002 \u82e5\u4e24\u4e2a\u8fdb\u7a0b\u4e0d\u53ef\u80fd\u540c\u65f6\u5904\u4e8e\u4e34\u754c\u533a\u57df\uff0c\u5c31\u80fd\u907f\u514d\u7ade\u4e89\u6761\u4ef6\u3002 \u7ade\u6001\u6761\u4ef6\uff08race condition\uff09\uff1a\u5373\u591a\u4e2a\u8fdb\u7a0b\u8bfb\u5199\u67d0\u4e9b\u5171\u4eab\u6570\u636e\uff0c\u800c\u6700\u540e\u7684\u7ed3\u679c\u53d6\u51b3\u4e8e\u8fdb\u7a0b\u8fd0\u884c\u7684\u7cbe\u786e\u65f6\u5e8f\u3002 \u540c\u6b65: \u4e3a\u4e86\u5728\u907f\u514d\u7ade\u4e89\u6761\u4ef6\u7684\u540c\u65f6\uff0c\u4fdd\u8bc1\u4f7f\u7528\u5171\u4eab\u6570\u636e\u7684\u5e76\u53d1\u8fdb\u7a0b\u80fd\u6b63\u786e\u548c\u9ad8\u6548\u5730\u534f\u4f5c\uff0c\u9700\u8981\u6ee1\u8db34\u4e2a\u6761\u4ef6\uff1a 1\u3001\u4efb\u4f55\u4e24\u4e2a\u8fdb\u7a0b\u4e0d\u80fd\u540c\u65f6\u5904\u4e8e\u5176\u4e34\u754c\u533a\u3002 2\u3001\u4e0d\u8981\u5bf9CPU\u7684\u901f\u5ea6\u548c\u6570\u91cf\u505a\u4efb\u4f55\u5047\u8bbe\u3002 3\u3001\u4e34\u754c\u533a\u5916\u8fd0\u884c\u7684\u8fdb\u7a0b\u4e0d\u5f97\u963b\u585e\u5176\u4ed6\u8fdb\u7a0b\u3002 4\u3001\u4e0d\u5f97\u4f7f\u8fdb\u7a0b\u65e0\u9650\u671f\u7b49\u5f85\u8fdb\u5165\u4e34\u754c\u533a\u3002 \u9700\u8981\u8fdb\u7a0b\u540c\u6b65\u539f\u56e0 \u9501 \u52a0\u9501: \u8bbe\u7f6e\u4e00\u4e2a\u9501\u53d8\u91cf\uff0c\u53ef\u4ee5\u8bbe\u521d\u59cb\u4e3a0\uff0c\u6709\u8fdb\u7a0b\u60f3\u8fdb\u5165\u4e34\u754c\u533a\u65f6\uff0c\u5148\u5bf9\u9501\u53d8\u91cf\u6d4b\u8bd5\uff0c\u4e3a0\u5219\u8fdb\uff0c\u8fdb\u5165\u540e\u5c06\u5176\u8bbe\u4e3a1\u30020\u8868\u793a\u4e34\u754c\u533a\u6ca1\u8fdb\u7a0b\uff0c1\u4ee3\u8868\u5df2\u6709\u8fdb\u7a0b\u8fdb\u5165\u4e34\u754c\u533a\u3002\u4f46\u662f\u4ecd\u5b58\u5728\u95ee\u9898\uff0c\u5f53\u8fdb\u7a0ba\u628a\u9501\u53d8\u91cf\u8bbe\u4e3a1\u4e4b\u524d\u6070\u597d\u53c8\u6709\u8fdb\u7a0bb\u8fdb\u5165\u4e34\u754c\u533a\uff0c\u4e34\u754c\u533a\u5c06\u67092\u4e2a\u8fdb\u7a0b\u3002\u5bf9\u4e8e\u6b64\u95ee\u9898\uff0c\u4e00\u822c\u5bf9\u83b7\u5f97\u9501\u548c\u6539\u53d8\u9501\u53d8\u91cf\u91c7\u7528\u539f\u5b50\u64cd\u4f5c\uff0c\u5982\u4e0b\u9762\u7684TSL\u6307\u4ee4\u3002 TSL RX, LOCK\uff1a\u6d4b\u8bd5\u5e76\u52a0\u9501\uff0c\u5c06\u4e00\u4e2a\u5185\u5b58\u5b57\u8bfb\u53d6\u5230\u5bc4\u5b58\u5668RX\u4e2d\uff0c\u7136\u540e\u5728\u8be5\u5185\u5b58\u5730\u5740\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\uff0c\u5e76\u4fdd\u8bc1\u8bfb\u5199\u64cd\u4f5c\u4e0d\u53ef\u5206\u5272\u3002\u5176\u5b83cpu\u4e0d\u80fd\u5728TSL\u6307\u4ee4\u7ed3\u675f\u4e4b\u524d\u8bbf\u95ee\u8be5\u5185\u5b58\u5b57\u3002 \u6267\u884cTSL\u6307\u4ee4\uff08test and set lock\uff09\u7684cpu\u5c06\u9501\u4f4f\u5185\u5b58\u603b\u7ebf\uff0c\u9632\u6b62\u5176\u5b83cpu\u5728\u6b64\u6307\u4ee4\u5b8c\u6210\u524d\u8bbf\u95ee\u5185\u5b58\u3002 \u5177\u4f53\u65b9\u6cd5\uff1a\u4f7f\u7528\u4e00\u4e2a\u5171\u4eab\u53d8\u91cflock\uff0clock\u4e3a0\u65f6\u4efb\u4f55\u8fdb\u7a0b\u90fd\u80fd\u4f7f\u7528TSL\u6307\u4ee4\uff0c\u5e76\u5c06lock\u8bbe\u4e3a1\uff0c\u8bfb\u5199\u5171\u4eab\u5185\u5b58\uff1b\u64cd\u4f5c\u7ed3\u675f\u540e\uff0c\u5229\u7528move\u6307\u4ee4\u5c06lock\u91cd\u65b0\u8bbe\u4e3a0. \uff08\u53ef\u4f7f\u7528XCHG\u6307\u4ee4\u66ff\u4ee3TSL\uff0c\u5b83\u539f\u5b50\u6027\u5730\u4ea4\u6362\u4e24\u4e2a\u4f4d\u7f6e\u7684\u5185\u5bb9\u3002\uff09 \u6b7b\u9501 \u9501\u7684\u4e89\u7528 \u2003\u6307\u5f53\u9501\u6b63\u5728\u88ab\u5360\u7528\u65f6\uff0c\u6709\u5176\u4ed6\u8fdb\u7a0b\u8bd5\u56fe\u83b7\u5f97\u8be5\u9501\uff1b\u5f53\u6709\u591a\u4e2a\u8fdb\u7a0b\u90fd\u5728\u7b49\u5f85\u83b7\u5f97\u8be5\u9501\u65f6\uff0c\u9501\u5c31\u5904\u4e8e\u9ad8\u5ea6\u4e89\u7528\u72b6\u6001\u3002 \u2003\u9501\u7684\u4f5c\u7528\u4f7f\u5f97\u7a0b\u5e8f\u4ee5\u4e32\u884c\u65b9\u5f0f\u8bbf\u95ee\u8d44\u6e90\uff0c\u4f1a\u964d\u4f4e\u7cfb\u7edf\u6027\u80fd\u3002\u88ab\u9ad8\u5ea6\u4e89\u7528\u7684\u9501(\u9891\u7e41\u88ab\u5360\u7528\u6216\u957f\u65f6\u95f4\u88ab\u5360\u7528)\u4f1a\u6210\u4e3a\u7cfb\u7edf\u7684\u74f6\u9888\u3002 \u2003\u5f53\u9501\u4e89\u7528\u4e25\u91cd\u65f6\uff0c\u52a0\u9501\u592a\u7c97(\u52a0\u9501\u7684\u7c97\u7c92\u5ea6\u6307\u88ab\u4fdd\u62a4\u7684\u6570\u636e\u89c4\u6a21\uff0c\u8fc7\u7c97\u7684\u9501\u7528\u6765\u4fdd\u62a4\u5927\u5757\u6570\u636e\uff0c\u7cbe\u7ec6\u7684\u9501\u5219\u4fdd\u62a4\u8f83\u5c0f\u7684\u5143\u7d20)\u4f1a\u964d\u4f4e\u6269\u5c55\u6027\uff1b\u9501\u4e89\u7528\u4e0d\u660e\u663e\u65f6\uff0c\u52a0\u9501\u592a\u7ec6\u4f1a\u52a0\u5927\u7cfb\u7edf\u5f00\u9500\uff0c\u5e26\u6765\u6d6a\u8d39\u3002 \u5185\u6838\u540c\u6b65\u65b9\u6cd5 \u539f\u5b50\u64cd\u4f5c: \u4fdd\u8bc1\u6307\u4ee4\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u88ab\u6253\u65ad\uff0c\u5185\u6838\u63d0\u4f9b\u4e86\u4e24\u79cd\u539f\u5b50\u64cd\u4f5c\u63a5\u53e3\uff0c\u5206\u522b\u9488\u5bf9\u6574\u6570\u548c\u5355\u72ec\u7684\u4f4d\u8fdb\u884c\u64cd\u4f5c\u3002 \u81ea\u65cb\u9501 \uff1a\u662f\u6307\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u8bd5\u56fe\u83b7\u53d6\u9501\u7684\u65f6\u5019\uff0c\u5982\u679c\u9501\u5df2\u7ecf\u88ab\u5176\u5b83\u7ebf\u7a0b\u83b7\u53d6\uff0c\u90a3\u4e48\u8be5\u7ebf\u7a0b\u5c06\u5faa\u73af\u7b49\u5f85\uff0c\u7136\u540e\u4e0d\u65ad\u7684\u5224\u65ad\u9501\u662f\u5426\u80fd\u591f\u88ab\u6210\u529f\u83b7\u53d6\uff0c\u76f4\u5230\u83b7\u53d6\u5230\u9501\u624d\u4f1a\u9000\u51fa\u5faa\u73af\u3002\u81ea\u65cb\u9501\u4f1a\u9020\u6210\u5fd9\u7b49\u5f85\u3002\u56e0\u6b64 \u81ea\u65cb\u9501 \u4e00\u822c\u9002\u7528\u4e8e\u52a0\u9501\u65f6\u95f4\u4e0d\u957f\uff0c\u4e14\u4ee3\u7801\u4e0d\u4f1a\u7761\u7720(\u4f8b\u5982\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f) \uff0c\u53cd\u4e4b\u4f7f\u7528 \u4fe1\u53f7\u91cf \u66f4\u5408\u9002 \u3002 \u2003\u8bfb/\u5199\u81ea\u65cb\u9501\uff1a\u4e00\u4e2a\u6216\u591a\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5e76\u53d1\u5730\u6301\u6709\u8bfb\u8005\u9501\uff0c\u4f46\u540c\u65f6\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u4efb\u52a1\u6301\u6709\u5199\u9501\u3002\u56e0\u6b64 \u4e0d\u80fd\u5c06\u4e00\u4e2a\u9501\u7531\u8bfb\u9501\u5347\u7ea7\u4e3a\u5199\u9501\uff0c\u5426\u5219\u5982\u679c\u8bfb\u9501\u6ca1\u6709\u88ab\u91ca\u653e\uff0c\u5199\u9501\u5c06\u4f1a\u81ea\u65cb\uff0c\u7b49\u5f85\u6240\u6709\u8bfb\u8005\u91ca\u653e\u9501\uff0c\u5305\u62ec\u5176\u672c\u8eab\uff0c\u4ece\u800c\u9020\u6210\u6b7b\u9501 \u3002 \u4fe1\u53f7\u91cf \u2003\u4fe1\u53f7\u91cf\u4e0d\u4f1a\u7981\u6b62\u5185\u6838\u62a2\u5360\uff0c\u6301\u6709\u4fe1\u53f7\u91cf\u7684\u4ee3\u7801\u53ef\u4ee5\u88ab\u62a2\u5360; \u4e92\u65a5\u4f53(mutex) \u5b9e\u73b0\u4e92\u65a5\u7684\u7279\u5b9a\u7761\u7720\u9501\uff0c\u5176\u884c\u4e3a\u548c\u4f7f\u7528\u8ba1\u65701\u7684\u4e92\u65a5\u4fe1\u53f7\u91cf\u7c7b\u4f3c\uff0c\u4f46\u64cd\u4f5c\u63a5\u53e3\u66f4\u7b80\u5355\uff0c\u9650\u5236\u6027\u66f4\u5f3a\uff0c\u9002\u5e94\u4e8e\u5b9a\u5411\u6027\u5f3a\u7684\u573a\u666f\u3002 \u8fd9\u91cc\u7684\u4e92\u65a5\u4f53\u4e5f\u5305\u62ec\u4fe1\u53f7\u91cf\uff1b\u4e2d\u65ad\u4e0a\u4e0b\u6587\u4e2d\u4e0d\u80fd\u7761\u7720\uff0c\u56e0\u6b64\u53ea\u80fd\u4f7f\u7528\u81ea\u65cb\u9501 \u5b8c\u6210\u53d8\u91cf completion variable: \u5982\u679c\u5728\u5185\u6838\u4e2d \u4e00\u4e2a\u4efb\u52a1\u9700\u8981\u53d1\u51fa\u4fe1\u53f7\u901a\u77e5\u53e6\u4e00\u4efb\u52a1\u53d1\u751f\u4e86\u7279\u5b9a\u4e8b\u4ef6 \uff0c\u5229\u7528\u5b8c\u6210\u53d8\u91cf\u662f\u4f7f\u4e24\u4e2a\u4efb\u52a1\u5f97\u4ee5\u540c\u6b65\u7684\u7b80\u5355\u65b9\u6cd5\u3002\u5982\u679c\u4e00\u4e2a\u4efb\u52a1\u8981\u6267\u884c\u4e00\u4e9b\u5de5\u4f5c\u65f6\uff0c\u53e6\u4e00\u4e2a\u4efb\u52a1\u5c31\u4f1a\u5728\u5b8c\u6210\u53d8\u91cf\u4e0a\u7b49\u5f85\u3002\u5f53\u8fd9\u4e2a\u4efb\u52a1\u5b8c\u6210\u5de5\u4f5c\u65f6\uff0c\u5c31\u4f1a\u4f7f\u7528\u5b8c\u6210\u53d8\u91cf\u53bb\u5524\u9192\u5728\u7b49\u5f85\u7684\u4efb\u52a1\u3002 \u2003\u4f8b\u5982\u5f53\u5b50\u8fdb\u7a0b\u6267\u884c\u6216\u9000\u51fa\u65f6\uff0cvfork()\u7cfb\u7edf\u8c03\u7528\u4f7f\u7528\u8fd9\u4e9b\u5b8c\u6210\u53d8\u91cf\u6765\u5524\u9192\u7236\u8fdb\u7a0b\u3002 \u5185\u5b58\u7ba1\u7406 \u7406\u89e3\u5185\u5b58\u7a7a\u95f4 \u2003\u4ee532\u4f4dx86 CPU\u4e3a\u4f8b: 1\u3001x86 CPU\u91c7\u7528\u4e86\u6bb5\u9875\u5f0f\u5730\u5740\u6620\u5c04\u6a21\u578b\u3002\u8fdb\u7a0b\u4ee3\u7801\u4e2d\u7684\u5730\u5740\u4e3a\u903b\u8f91\u5730\u5740\uff0c \u7ecf\u8fc7\u6bb5\u9875\u5f0f\u5730\u5740\u6620\u5c04(\u5148\u6620\u5c04\u5230\u7ebf\u6027\u7a7a\u95f4\uff0c\u5f97\u5230\u7ebf\u6027\u5730\u5740\uff0c\u518d\u6839\u636e\u9875\u8868\u8fdb\u884c\u6620\u5c04)\u540e\uff0c\u624d\u771f\u6b63\u8bbf\u95ee\u7269\u7406\u5185\u5b58\u3002 2\u3001Linux\u7b80\u5316\u4e86\u5206\u6bb5\u673a\u5236,\u4f7f\u5f97\u865a\u62df\u5730\u5740\u4e0e\u7ebf\u6027\u5730\u5740\u603b\u662f\u4e00\u81f4,\u56e0\u6b64,Linux\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e5f\u4e3a0\uff5e4G,\u5e76\u88ab\u5206\u4e3a\u4e24\u90e8\u5206\u3002 \u6700\u9ad8\u76841GB(\u4ece\u865a\u62df\u5730\u57400xC0000000\u52300xFFFFFFFF)\u4f9b\u5185\u6838\u4f7f\u7528\uff0c\u79f0\u4e3a\u201c\u5185\u6838\u7a7a\u95f4\u201d; \u4f4e\u4f4d\u7f6e3GB(\u4ece\u865a\u62df\u5730\u57400x00000000\u52300xBFFFFFFF\uff09\uff0c\u4f9b\u5404\u4e2a\u8fdb\u7a0b\u4f7f\u7528\uff0c\u79f0\u4e3a\u201c\u7528\u6237\u7a7a\u95f4\u3002 \u56e0\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u8fdb\u5165\u5185\u6838\uff0c\u56e0\u6b64\uff0cLinux\u5185\u6838\u7531\u7cfb\u7edf\u5185\u7684\u6240\u6709\u8fdb\u7a0b\u5171\u4eab\u3002 \u4e8e\u662f\uff0c\u4ece\u5177\u4f53\u8fdb\u7a0b\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u67094GB\u7684\u865a\u62df\u7a7a\u95f4, \u5176\u4e2d3GB\u7528\u6237\u7a7a\u95f4\u4e3a\u5404\u8fdb\u7a0b\u72ec\u4eab\uff0c 1GB\u5185\u6838\u7a7a\u95f4\u4e3a\u6240\u6709\u8fdb\u7a0b\u548c\u5185\u6838\u5171\u4eab\u3002 \u7528\u6237\u8fdb\u7a0b\u6700\u5927\u53ef\u4ee5\u8bbf\u95ee3GB\uff0c\u5185\u6838\u4ee3\u7801\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709\u7269\u7406\u5185\u5b58\u3002 3\u3001\u5185\u6838\u7a7a\u95f4\u4e2d\u5b58\u653e\u7684\u662f\u5185\u6838\u4ee3\u7801\u548c\u6570\u636e\uff0c\u800c\u8fdb\u7a0b\u7684\u7528\u6237\u7a7a\u95f4\u4e2d\u5b58\u653e\u7684\u662f\u7528\u6237\u7a0b\u5e8f\u7684\u4ee3\u7801\u548c\u6570\u636e\u3002 \u4e0d\u7ba1\u662f\u5185\u6838\u7a7a\u95f4\u8fd8\u662f\u7528\u6237\u7a7a\u95f4\uff0c\u5b83\u4eec\u90fd\u5904\u4e8e\u865a\u62df\u7a7a\u95f4\u4e2d\u3002 4\u3001\u867d\u7136\u5185\u6838\u7a7a\u95f4\u5360\u636e\u4e86\u6bcf\u4e2a\u865a\u62df\u7a7a\u95f4\u4e2d\u7684\u6700\u9ad81GB\uff0c\u4f46\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u5374\u603b\u662f\u4ece\u6700\u4f4e\u5730\u5740(0x00000000)\u5f00\u59cb\u3002 \u5bf9\u5185\u6838\u7a7a\u95f4\u6765\u8bf4\uff0c\u5730\u5740\u6620\u5c04\u662f\u7ebf\u6027\u6620\u5c04\uff0c0xC0000000(\u53733GB)\u5c31\u662f\u7269\u7406\u5730\u5740\u4e0e\u7ebf\u6027\u5730\u5740\u4e4b\u95f4\u7684\u4f4d\u79fb\u91cf, \u5728Linux\u6e90\u7801\u4e2d\u53eb\u505aPAGE_OFFSET\u3002 5\u3001\u5b9e\u9645\u4e2d\uff0c\u5185\u6838\u5730\u5740\u7a7a\u95f40xc0000000 ~ 0xfffffff\u76841GB\u5730\u5740\u7a7a\u95f4\u5e76\u975e\u5168\u90e8\u7528\u6765\u8fdb\u884c\u7b80\u5355\u7684\u5730\u5740\u6620\u5c04\uff0c \u800c\u662f\u5212\u5206\u4e3a\u4e09\u90e8\u5206ZONE_DMA(<16MB), ZONE_NORMAL(16~896MB)\u548c ZONE_HIGHMEM(>=896MB), \u5176\u4e2dZONE_HIGHMEM\u79f0\u4f5c\u9ad8\u7aef\u5185\u5b58\uff0c\u5171128MB\u3002 6\u3001\u5f53\u5185\u6838\u60f3\u8bbf\u95ee\u9ad8\u4e8e896MB\u7684\u7269\u7406\u5185\u5b58\u65f6\uff0c\u4f1a\u4ece0xF8000000 ~ 0xFFFFFFFF\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u5185 \u627e\u4e00\u6bb5\u76f8\u5e94\u5927\u5c0f\u7a7a\u95f2\u7684\u903b\u8f91\u5730\u5740\u7a7a\u95f4\uff0c\u501f\u7528\u8fd9\u6bb5\u903b\u8f91\u5730\u5740\u7a7a\u95f4\uff0c\u5efa\u7acb\u6620\u5c04\u5230\u60f3\u8bbf\u95ee\u7684\u5b9e\u9645\u7269\u7406\u5185\u5b58\u3002 7\u3001task_struct\u4e2d\u7684PGD\u6210\u5458\u5b58\u653e\u7740\u6307\u5411\u5f53\u524d\u8fdb\u7a0b\u9875\u76ee\u5f55\u7684\u6307\u9488\uff0c\u5f53\u8be5\u8fdb\u7a0b\u88ab\u8c03\u5ea6\u8fdb\u5165\u8fd0\u884c\u6001\u65f6\uff0c \u5185\u6838\u5c06\u8be5\u8fdb\u7a0b\u7684\u7684\u9875\u76ee\u5f55\u8868\u7684\u7269\u7406\u5730\u5740\u88c5\u5165CR3\u5bc4\u5b58\u5668\uff0c\u56e0\u6b64 \u4e0d\u540c\u8fdb\u7a0b\u8bbf\u95ee\u865a\u62df\u7a7a\u95f4\u4e2d\u7684\u76f8\u540c\u5730\u5740\uff0c \u7ecf\u7531\u4e0d\u540c\u7684\u9875\u76ee\u5f55\u8868\u6620\u5c04\u5230\u4e0d\u540c\u7684\u7269\u7406\u5730\u5740\uff0c\u800c\u4e0d\u4f1a\u6df7\u6dc6\u3002 \u5185\u5b58\u7a7a\u95f4\u7684\u4e09\u79cd\u63cf\u8ff0\u5355\u4f4d: \u9875\uff1a \u533a\uff1a \u5b57\u8282\uff1a\u5185\u6838\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u4e09\u79cd\u51fd\u6570\u6216\u8005\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\u5185\u5b58\uff0c\u4e0d\u8fc7kmalloc\u548cvmalloc\u662f\u5206\u914d\u7684\u662f\u5185\u6838\u7684\u5185\u5b58,malloc\u5206\u914d\u7684\u662f\u7528\u6237\u7684\u5185\u5b58\u3002 malloc\\kmalloc\\vmalloc: 1\u3001 \u7531malloc()\u8fd4\u56de\u7684\u9875\u5728\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5185\u662f\u8fde\u7eed\u7684\uff0c\u4f46\u662f\u5e76\u4e0d\u4fdd\u8bc1\u5b83\u4eec\u5728\u7269\u7406RAM\u4e2d\u4e5f\u662f\u8fde\u7eed\u7684\uff1b kmalloc()\u51fd\u6570\u786e\u4fdd\u9875\u5728\u7269\u7406\u5730\u5740\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u865a\u62df\u5730\u5740\u81ea\u7136\u4e5f\u662f\u8fde\u7eed\u7684\uff1b vmalloc()\u51fd\u6570\u53ea\u786e\u4fdd\u9875\u5728\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5185\u662f\u8fde\u7eed\u7684\uff0c\u5b83\u901a\u8fc7\u5206\u914d\u975e\u8fde\u7eed\u7684\u7269\u7406\u5185\u5b58\u5757\uff0c \u518d\u4fee\u6b63\u9875\u8868\uff0c\u628a\u5185\u5b58\u6620\u5c04\u5230\u903b\u8f91\u5730\u5740\u7a7a\u95f4\u7684\u8fde\u7eed\u533a\u57df\u4e2d\uff0c\u6765\u5b9e\u73b0\u76ee\u7684\u3002 2\u3001vmalloc\u6bd4kmalloc\u8981\u6162\u3002\u5c3d\u7ba1\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u624d\u9700\u8981\u7269\u7406\u4e0a\u8fde\u7eed\u7684\u5185\u5b58\u5757\uff0c\u4f46\u662f\u5f88\u591a\u5185\u6838\u4ee3\u7801\u90fd\u7528kmalloc\u6765\u83b7\u5f97\u5185\u5b58\uff0c \u800c\u4e0d\u662fvmalloc\u3002\u8fd9\u4e3b\u8981\u662f\u51fa\u4e8e\u6027\u80fd\u7684\u8003\u8651\u3002vmalloc\u51fd\u6570\u4e3a\u4e86\u628a\u7269\u7406\u5185\u5b58\u4e0a\u4e0d\u8fde\u7eed\u7684\u9875\u8f6c\u6362\u4e3a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e0a\u8fde\u7eed\u7684\u9875\uff0c \u5fc5\u987b\u4e13\u95e8\u5efa\u7acb\u9875\u8868\u9879\u3002\u7cdf\u7cd5\u7684\u662f\uff0c\u901a\u8fc7vmalloc\u83b7\u5f97\u7684\u9875\u5fc5\u987b\u4e00\u4e2a\u4e2a\u5730\u8fdb\u884c\u6620\u5c04\uff0c\u56e0\u4e3a\u5b83\u4eec\u7269\u7406\u4e0a\u662f\u4e0d\u8fde\u7eed\u7684\uff0c \u8fd9\u5c31\u4f1a\u5bfc\u81f4\u6bd4\u76f4\u63a5\u5185\u5b58\u6620\u5c04\u5927\u5f97\u591a\u7684TLB(Traslation Lookaside Buffer, \u7528\u4ee5\u7f13\u5b58\u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u7684\u6620\u5c04\u5173\u7cfb)\u6296\u52a8\uff0c vmalloc\u4ec5\u5728\u4e0d\u5f97\u5df2\u65f6\u624d\u4f1a\u7528\uff0c\u4f8b\u5982\u4e3a\u4e86\u83b7\u5f97\u5927\u5757\u5185\u5b58\u65f6\uff0c\u800c\u7269\u7406\u7a7a\u95f4\u4e0d\u5b58\u5728\u5982\u6b64\u5927\u7684\u8fde\u7eed\u5185\u5b58\u3002 \u5185\u5b58\u788e\u7247 \u5185\u5b58\u788e\u7247\u901a\u5e38\u5206\u4e3a\u5185\u90e8\u788e\u7247\u548c\u5916\u90e8\u788e\u7247\uff1a 1\u3001\u5185\u90e8\u788e\u7247\u662f\u7531\u4e8e\u91c7\u7528\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u5206\u533a\uff0c\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u4e0d\u80fd\u5b8c\u5168\u4f7f\u7528\u5206\u7ed9\u5b83\u7684\u56fa\u5b9a\u5185\u5b58\u533a\u57df\u65f6\u5c31\u4ea7\u751f\u4e86\u5185\u90e8\u788e\u7247\uff0c\u901a\u5e38\u5185\u90e8\u788e\u7247\u96be\u4ee5\u5b8c\u5168\u907f\u514d\uff1b 2\u3001\u5916\u90e8\u788e\u7247\u662f\u7531\u4e8e\u67d0\u4e9b\u672a\u5206\u914d\u7684\u8fde\u7eed\u5185\u5b58\u533a\u57df\u592a\u5c0f\uff0c\u4ee5\u81f3\u4e8e\u4e0d\u80fd\u6ee1\u8db3\u4efb\u610f\u8fdb\u7a0b\u7684\u5185\u5b58\u5206\u914d\u8bf7\u6c42\uff0c\u4ece\u800c\u4e0d\u80fd\u88ab\u8fdb\u7a0b\u5229\u7528\u7684\u5185\u5b58\u533a\u57df\u3002 \u2003\u907f\u514d\u5916\u90e8\u788e\u7247\u7684\u65b9\u6cd5\u6709\u4e24\u79cd: 1\u3001 \u5229\u7528\u5206\u9875\u5355\u5143\u628a\u4e00\u7ec4\u975e\u8fde\u7eed\u7684\u7a7a\u95f2\u9875\u6620\u5c04\u5230\u8fde\u7eed\u7684\u7ebf\u6027\u5730\u5740 (\u4f7f\u7528\u5730\u5740\u8f6c\u6362\u6280\u672f\uff0c\u628a\u975e\u8fde\u7eed\u7684\u7269\u7406\u5730\u5740\u8f6c\u6362\u6210\u8fde\u7eed\u7684\u7ebf\u6027\u5730\u5740); \u73b0\u5728\u666e\u904d\u91c7\u7528\u7684\u6bb5\u9875\u5f0f\u5185\u5b58\u5206\u914d\u65b9\u5f0f\u5c31\u662f\u5c06\u8fdb\u7a0b\u7684\u5185\u5b58\u533a\u57df\u5206\u4e3a\u4e0d\u540c\u7684\u6bb5\uff0c\u7136\u540e\u5c06\u6bcf\u4e00\u6bb5\u7531\u591a\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u9875\u7ec4\u6210\u3002 \u901a\u8fc7\u9875\u8868\u673a\u5236\uff0c\u4f7f\u6bb5\u5185\u7684\u9875\u53ef\u4ee5\u4e0d\u5fc5\u8fde\u7eed\u5904\u4e8e\u540c\u4e00\u5185\u5b58\u533a\u57df\uff0c\u4ece\u800c\u51cf\u5c11\u4e86\u5916\u90e8\u788e\u7247 \uff0c\u7136\u800c\u540c\u4e00\u9875\u5185\u4ecd\u7136\u53ef\u80fd\u5b58\u5728\u5c11\u91cf\u7684\u5185\u90e8\u788e\u7247\uff0c\u53ea\u662f\u4e00\u9875\u7684\u5185\u5b58\u7a7a\u95f4\u672c\u5c31\u8f83\u5c0f\uff0c\u4ece\u800c\u4f7f\u53ef\u80fd\u5b58\u5728\u7684\u5185\u90e8\u788e\u7247\u4e5f\u8f83\u5c11\u3002 2\u3001\u5f00\u53d1\u4e00\u79cd\u9002\u5f53\u7684\u6280\u672f\u6765 \u8bb0\u5f55\u73b0\u5b58\u7684\u7a7a\u95f2\u7684\u8fde\u7eed\u9875\u5757\u7684\u60c5\u51b5\uff0c\u4ee5\u5c3d\u91cf\u907f\u514d\u4e3a\u6ee1\u8db3\u5bf9\u5c0f\u5757\u7684\u8bf7\u6c42\u800c\u5206\u5272\u5927\u7684\u7a7a\u95f2\u5757 ; \u5982\u4f19\u4f34\u7cfb\u7edf\u548cslab\u9ad8\u901f\u7f13\u5b58\u3002 \u4f19\u4f34\u7cfb\u7edf : \u628a\u7cfb\u7edf\u4e2d\u8981\u7ba1\u7406\u7684\u7269\u7406\u5185\u5b58\u6309\u7167\u9875\u9762\u4e2a\u6570\u5206\u6210\u4e8611\u4e2a\u7ec4\uff0c\u5bf9\u5e94\u5927\u5c0f\u4e0d\u540c\u7684\u8fde\u7eed\u5185\u5b58\u5757\uff0c\u6bcf\u7ec4\u4e2d\u7684\u5185\u5b58\u5757\u5927\u5c0f\u90fd\u76f8\u7b49\uff0c \u4e3a2\u7684\u5e42\u6b21\u4e2a\u7269\u7406\u9875\u3002\u90a3\u4e48\u7cfb\u7edf\u4e2d\u5c31\u5b58\u57282^0 ~ 2^10\u8fd9\u4e4811\u79cd\u5927\u5c0f\u4e0d\u540c\u7684\u5185\u5b58\u5757\uff0c\u5bf9\u5e94\u5185\u5b58\u5757\u5927\u5c0f4KB ~ 4MB\u3002 \u5185\u6838\u752811\u4e2a\u94fe\u8868\u6765\u7ba1\u740611\u79cd\u5927\u5c0f\u4e0d\u540c\u7684\u5185\u5b58\u5757\u3002 \u5f53\u5206\u914d\u5185\u5b58\u65f6\uff0c\u4f1a\u4f18\u5148\u4ece\u9700\u8981\u5206\u914d\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e0a\u67e5\u627e\u7a7a\u95f2\u5185\u5b58\u5757\uff0c\u5f53\u53d1\u73b0\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5757\u90fd\u5df2\u7ecf\u88ab\u4f7f\u7528\u540e\uff0c \u90a3\u4e48\u4f1a\u4ece\u66f4\u5927\u7ea7\u7684\u5185\u5b58\u5757\u4e0a\u5206\u914d\u4e00\u5757\u5185\u5b58\uff0c\u5e76\u4e14\u5206\u6210\u4e00\u534a\u7ed9\u6211\u4eec\u4f7f\u7528\uff0c\u5269\u4f59\u7684\u4e00\u534a\u91ca\u653e\u5230\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e0a\u3002 \u6bd4\u5982\u6211\u4eec\u60f3\u8981\u5206\u914d\u4e00\u4e2a8KB\u5927\u5c0f\u7684\u5185\u5b58\uff0c\u4f46\u662f\u53d1\u73b0\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5df2\u7ecf\u6ca1\u6709\u4e86\uff0c\u4f19\u4f34\u7cfb\u7edf\u4f1a\u4ece16KB\u7684\u94fe\u8868\u4e2d \u67e5\u627e\u4e00\u4e2a\u7a7a\u95f2\u5185\u5b58\u5757\uff0c\u5206\u6210\u4e24\u4e2a8KB\u5927\u5c0f\uff0c\u628a\u5176\u4e2d\u7684\u4e00\u4e2a8KB\u5927\u5c0f\u8fd4\u56de\u7ed9\u7533\u8bf7\u8005\u4f7f\u7528\uff0c \u5269\u4e0b\u76848KB\u653e\u52308KB\u5bf9\u5e94\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e2d\u8fdb\u884c\u7ba1\u7406 \u5f53\u91ca\u653e\u5185\u5b58\u65f6\uff0c\u4f1a\u626b\u63cf\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5757\u94fe\u8868\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u5730\u5740\u80fd\u591f\u8fde\u7eed\u5728\u4e00\u8d77\u7684\u5185\u5b58\u5757\uff0c\u5982\u679c\u53d1\u73b0\u6709\uff0c \u90a3\u4e48\u5c31\u5408\u5e76\u4e24\u4e2a\u5185\u5757\u653e\u7f6e\u5230\u66f4\u5927\u4e00\u7ea7\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e0a\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u6bd4\u5982\u6211\u4eec\u91ca\u653e8KB\u5927\u5c0f\u7684\u5185\u5b58\uff0c \u90a3\u4e48\u4f1a\u4ece\u5bf9\u5e94\u7684\u94fe\u8868\u626b\u63cf\u662f\u5426\u6709\u80fd\u591f\u5408\u5e76\u7684\u5185\u5b58\u5757\uff0c\u5982\u679c\u6709\u53e6\u4e00\u4e2a8KB\u5927\u5c0f\u7684\u5185\u5b58\u548c\u6211\u4eec\u4f7f\u7528\u7684\u5185\u5b58\u5730\u5740\u8fde\u7eed\uff0c \u90a3\u4e48\u5c31\u5408\u5e76\u5b83\u4eec\u7ec4\u6210\u4e00\u4e2a16KB\u5927\u5c0f\u7684\u5185\u5b58\u5757\uff0c\u7136\u540e\u63a5\u7740\u626b\u63cf16KB\u5927\u5c0f\u7684\u5185\u5b58\u5757\u94fe\u8868\uff0c\u7ee7\u7eed\u67e5\u627e\u5408\u5e76\u7684\u53ef\u80fd\u3002 slab\u5206\u914d\u5668 \u5185\u6838\u6808 \u5206\u914d\u51fd\u6570\u9009\u62e9 \u865a\u62df\u6587\u4ef6\u7cfb\u7edf UNIX\u6587\u4ef6\u7cfb\u7edf Unix\u4f7f\u7528\u56db\u79cd\u548c\u6587\u4ef6\u7cfb\u7edf\u76f8\u5173\u7684\u62bd\u8c61\u6982\u5ff5\uff1a\u6587\u4ef6\u3001\u76ee\u5f55\u9879\u3001\u7d22\u5f15\u8282\u70b9\u548c\u6302\u8f7d\u70b9(mounting point)\u3002 \u6587\u4ef6\u5171\u4eab \u548c\u8fdb\u7a0b\u76f8\u5173\u7684\u6570\u636e\u7ed3\u6784 files_struct: \u7531\u8fdb\u7a0b\u63cf\u8ff0\u7b26(struct task_struct)\u4e2d\u7684files\u76ee\u5f55\u9879\u6307\u5411\uff0c\u6240\u6709\u4e0e\u5355\u4e2a\u8fdb\u7a0b\u76f8\u5173\u7684\u4fe1\u606f(\u5982\u6253\u5f00\u7684\u6587\u4ef6\u53ca\u6587\u4ef6\u63cf\u8ff0\u7b26)\uff1b fs_struct: \u7531\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u4e2d\u7684fs\u57df\u6307\u5411\uff0c\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdb\u7a0b\u76f8\u5173\u7684\u4fe1\u606f\uff0c \u8be5\u7ed3\u6784\u4fdd\u5b58\u4e86\u5f53\u524d\u8fdb\u7a0b\u7684\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u548c\u6839\u76ee\u5f55\uff1b namespace\u7ed3\u6784\u4f53: \u7531\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u4e2d\u7684namespace\u57df\u6307\u5411\uff0clinux 2.4\u7248\u5185\u6838\u4ee5\u540e\uff0c\u5355\u8fdb\u7a0b\u547d\u540d\u7a7a\u95f4\u88ab\u52a0\u5165\u5230\u5185\u6838\u4e2d\uff0c\u5b83\u4f7f\u5f97\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u5728\u7cfb\u7edf\u4e2d\u90fd\u770b\u5230\u552f\u4e00\u7684\u5b89\u88c5\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u4ec5\u662f\u552f\u4e00\u7684\u6839\u76ee\u5f55\uff0c\u800c\u4e14\u662f\u552f\u4e00\u7684\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u7ed3\u6784\u3002 \u5757/IO \u5757\u8bbe\u5907 \u2003\u8bbe\u5907\u6700\u5c0f\u5bfb\u5740\u5355\u5143\u79f0\u4e3a\u6247\u533a\uff0c\u5927\u5c0f\u4e3a2\u7684\u6574\u6570\u500d\uff0c\u4e00\u822c\u4e3a512\u5b57\u8282\uff0c\u6216\u8005\u7c7b\u4f3cCD-ROM\u7684\u6247\u533a\u4e3a2KB\u3002 \u2003\u5757\u5728\u7269\u7406\u4e0a\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\u6570\u636e\u7247\uff0c\u5728\u903b\u8f91\u4e0a\u662f\u6587\u4ef6\u7cfb\u7edf\u7684\u62bd\u8c61\u2014\u2014\u53ea\u80fd\u57fa\u4e8e\u5757\u6765\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff1b\u5185\u6838\u6267\u884c\u7684\u6240\u6709\u78c1\u76d8\u64cd\u4f5c\u90fd\u662f\u57fa\u4e8e\u5757\u7684\uff0c\u5176\u5927\u5c0f\u4e3a\u591a\u4e2a\u6247\u533a\uff0c\u4e14\u4e3a2\u7684\u6574\u6570\u500d\uff0c\u5e76\u4e14\u4e0d\u80fd\u8d85\u8fc7\u4e00\u4e2a\u9875\u7684\u957f\u5ea6\u3002 \u7f13\u51b2\u533a\u4e0e\u7f13\u51b2\u533a\u5934 \u2003\u5f53\u4e00\u4e2a\u5757\u88ab\u8c03\u5165\u5185\u5b58\u540e\uff0c\u5373\u5728\u8bfb\u5165\u540e\u6216\u7b49\u5f85\u5199\u51fa\u65f6\uff0c\u5b83\u8981\u5b58\u50a8\u5728\u4e00\u4e2a\u7f13\u51b2\u533a\u4e2d\uff0c\u6bcf\u4e2a\u7f13\u51b2\u533a\u4e0e\u4e00\u4e2a\u5757\u5bf9\u5e94\uff0c\u5b83\u76f8\u5f53\u4e8e\u662f\u78c1\u76d8\u5757\u5728\u5185\u5b58\u4e2d\u7684\u8868\u793a\u3002 \u2003\u6bcf\u4e2a\u7f13\u51b2\u533a\u90fd\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u63cf\u8ff0\u7b26\uff0c\u7528buffer_head\u7ed3\u6784\u4f53\u63cf\u8ff0\uff0c\u79f0\u4f5c\u7f13\u51b2\u533a\u5934\uff0c\u5305\u542b\u4e00\u4e9b\u63a7\u5236\u4fe1\u606f(\u5982\u5757\u5c5e\u4e8e\u54ea\u4e00\u4e2a\u5757\u8bbe\u5907\uff0c\u5757\u5bf9\u5e94\u54ea\u4e2a\u7f13\u51b2\u533a)\u3002 \u7f13\u51b2\u533a\u5934\u7684\u76ee\u7684\u5728\u4e8e\u63cf\u8ff0\u78c1\u76d8\u5757\u548c\u7269\u7406\u5185\u5b58\u7f13\u51b2\u533a(\u5728\u7279\u5b9a\u9875\u9762\u4e0a\u7684\u5b57\u8282\u5e8f\u5217)\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb \u3002 bio\u7ed3\u6784\u4f53 \u2003\u4e0ebuffer_head\u533a\u522b\uff1a bio\u7ed3\u6784\u4f53\u4ee3\u8868\u7684\u662fI/O\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5305\u542b\u5185\u5b58\u4e2d\u7684\u591a\u4e2a\u9875(bio\u672c\u8eab\u4fbf\u4e8e\u6267\u884c\u5206\u6563-\u96c6\u4e2d\u7684\u5757I/O\u64cd\u4f5c\uff0c\u64cd\u4f5c\u7684\u6570\u636e\u6765\u81ea\u591a\u4e2a\u7269\u7406\u9875)\uff1b \u800cbuffer_head\u7ed3\u6784\u4f53\u4ee3\u8868\u7684\u662f\u4e00\u4e2a\u7f13\u51b2\u533a\uff0c\u63cf\u8ff0\u7684\u4ec5\u4ec5\u662f\u78c1\u76d8\u4e2d\u7684\u4e00\u4e2a\u5757\uff1b bio\u76f8\u8f83buffer_head\uff0c\u5c5e\u4e8e\u8f7b\u91cf\u7ea7\u7ed3\u6784\u4f53\uff0c\u56e0\u4e3a\u5b83\u53ea\u9700\u5305\u542b\u5757I/O\u64cd\u4f5c\u6240\u9700\u7684\u4fe1\u606f\u5373\u53ef\uff0c\u65e0\u9700\u5305\u542b\u4e0e\u7f13\u51b2\u533a\u672c\u8eab\u76f8\u5173\u7684\u4e0d\u5fc5\u8981\u4fe1\u606f\u3002 I/O\u63a7\u5236\u65b9\u5f0f I/O\u8c03\u5ea6 \u2003\u8bf7\u6c42\u961f\u5217: \u5757\u8bbe\u5907\u5c06\u5b83\u4eec\u6302\u8d77\u7684\u5757I/O\u8bf7\u6c42\u4fdd\u5b58\u5728\u8bf7\u6c42\u961f\u5217\u4e2d(requests_struct)\uff0c\u8be5\u961f\u5217\u5305\u542b\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u53ca\u76f8\u5173\u63a7\u5236\u4fe1\u606f\uff1b\u961f\u5217\u4e2d\u7684\u8bf7\u6c42(request)\u7531\u591a\u4e2abio\u7ed3\u6784\u4f53\u6784\u6210\u3002 \u2003I/O\u8c03\u5ea6\u7a0b\u5e8f\u5c06 \u78c1\u76d8I/O\u8d44\u6e90 \u5206\u914d\u7ed9\u7cfb\u7edf\u4e2d\u6240\u6709\u6302\u8d77\u7684 \u5757I/O\u8bf7\u6c42\uff0c\u5206\u914d\u662f\u901a\u8fc7\u5c06\u8bf7\u6c42\u961f\u5217\u4e2d\u6302\u8d77\u7684\u8bf7\u6c42\u5408\u5e76\u548c\u6392\u5e8f\u6765\u5b8c\u6210\u7684\uff0c\u4ee5\u6b64\u6765\u51cf\u5c11\u78c1\u76d8\u5bfb\u5740\u65f6\u95f4\u3002 \u2003\u8bf7\u6c42\u5408\u5e76: \u5c06\u4e24\u4e2a\u6216\u591a\u4e2a\u8bf7\u6c42\u5408\u5e76\u6210\u4e00\u4e2a\u65b0\u8bf7\u6c42\uff0c\u5982\u591a\u4e2a\u8bf7\u6c42\u8bbf\u95ee\u7684\u6247\u533a\u4f4d\u7f6e\u76f8\u90bb\uff1b \u2003\u8bf7\u6c42\u6392\u5e8f: \u5bf9\u4e8e\u64cd\u4f5c\u78c1\u76d8\u6247\u533a\u4f4d\u7f6e\u76f8\u8fd1\u7684\u4e0d\u540c\u8bf7\u6c42\uff0c\u5176\u5728\u961f\u5217\u4e2d\u7684\u4f4d\u7f6e\u5e94\u8be5\u4e5f\u76f8\u90bb\u3002 \u6574\u4e2a\u8bf7\u6c42\u961f\u5217\u6309\u8981\u8bbf\u95ee\u7684\u6247\u533a\u7684\u589e\u957f\u65b9\u5411\u6709\u5e8f\u6392\u5217\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u7f29\u77ed\u5355\u6b21\u8bf7\u6c42\u7684\u5bfb\u5740\u65f6\u95f4\uff0c\u8fd8\u53ef\u4ee5\u4fdd\u6301\u78c1\u76d8\u5934\u4ee5\u76f4\u7ebf\u65b9\u5411\u79fb\u52a8\uff0c\u7f29\u77ed\u4e86\u6240\u6709\u8bf7\u6c42\u7684\u78c1\u76d8\u5bfb\u5740\u65f6\u95f4\u3002\u8fd9\u79cdI/O\u8c03\u5ea6\u6392\u5e8f\u7b97\u6cd5\u79f0\u4f5c\u7535\u68af\u8c03\u5ea6\u3002 I/O\u8c03\u5ea6\u7b97\u6cd5 \u2003linus\u7535\u68af linux \u5185\u6838\u4ece2.6\u7248\u8d77\uff0c\u5e9f\u5f03\u4e86linus\u7535\u68af\u6cd5\uff0c\u63d0\u4f9b\u4e86\u4e0b\u9762\u56db\u79cd\u8c03\u5ea6\u7a0b\u5e8f\u3002 \u2003 \u6700\u7ec8\u671f\u9650I/O\u8c03\u5ea6\u7a0b\u5e8f \u2003 \u9884\u6d4bI/O\u8c03\u5ea6\u7a0b\u5e8f : \u5982\u679c\u6309\u7167\u6700\u7ec8\u671f\u9650I/O\u8c03\u5ea6\u7a0b\u5e8f\uff0c\u5f53\u7cfb\u7edf\u5904\u4e8e\u7e41\u5fd9\u7684\u5199\u64cd\u4f5c\u671f\u95f4\uff0c\u6bcf\u6b21\u63d0\u4ea4\u8bfb\u8bf7\u6c42\uff0cI/O\u8c03\u5ea6\u7a0b\u5e8f\u90fd\u4f1a\u8fc5\u901f\u5904\u7406\u8bfb\u8bf7\u6c42\uff0c\u7136\u540e\u8fd4\u56de\u518d\u5bfb\u5740\u8fdb\u884c\u8bfb\u64cd\u4f5c\uff0c\u8fd9\u65e0\u7591\u4f1a\u635f\u5bb3\u5168\u5c40\u541e\u5410\u91cf\u3002 \u2003 \u5b8c\u5168\u516c\u6b63\u7684\u6392\u961fI/O\u8c03\u5ea6\u7a0b\u5e8f(Complete Fair Queuing, CFQ) : \u6bcf\u4e00\u4e2a\u63d0\u4ea4I/O\u8bf7\u6c42\u7684\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u81ea\u5df1\u7684\u8bf7\u6c42\u961f\u5217\uff0c\u961f\u5217\u5185\u90e8\u7684\u64cd\u4f5c\u4e0e\u6700\u7ec8\u671f\u9650I/O\u8c03\u5ea6\u7a0b\u5e8f\u76f8\u540c\uff1bCFQ\u4ee5\u65f6\u95f4\u7247\u8f6e\u8f6c\u8c03\u5ea6\u961f\u5217\uff0c\u4ece\u6bcf\u4e2a\u961f\u5217\u4e2d\u9009\u53d6\u8bf7\u6c42\u6570\uff0c\u7136\u540e\u8fdb\u5165\u4e0b\u4e00\u6b21\u8c03\u5ea6\u3002 \u4ece\u800c\u5728\u8fdb\u7a0b\u7ea7\u522b\u7ef4\u6301\u4e86\u516c\u5e73 \u3002 \u2003 \u7a7a\u64cd\u4f5c\u7684I/O\u8c03\u5ea6\u7a0b\u5e8f : \u53ea\u6267\u884c\u5408\u5e76\uff0c\u4e0d\u8fdb\u884c\u6392\u5e8f\uff0c\u7ef4\u62a4\u8bf7\u6c42\u961f\u5217\u4ee5\u8fd1\u4e4eFIFO\u7684\u987a\u5e8f\u6392\u5217\uff0c\u5176\u662f\u4e13\u4e3a\u968f\u673a\u8bbf\u95ee\u8bbe\u5907\u800c\u8bbe\u8ba1\u7684\uff0c\u5b83\u4eec\u5bf9\u4e8e\u5bfb\u5740\u7684\u9700\u6c42\u5f88\u5c0f\uff0c\u65e0\u9700\u6392\u5e8f\u3002 \u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4 \u2003\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7531\u8fdb\u7a0b\u53ef\u5bfb\u5740\u7684\u865a\u62df\u5185\u5b58\u7ec4\u6210\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u8fde\u7eed\u7a7a\u95f4\uff0c\u5bf9\u4e8e32\u4f4d\u673a\u5668\uff0c\u8fdb\u7a0b\u53ef\u5bfb\u5740\u7684\u865a\u62df\u7a7a\u95f4\u5927\u5c0f\u4e3a4GB\u3002 \u2003\u5185\u5b58\u533a\u57df: \u53ef\u88ab\u8bbf\u95ee\u7684\u5408\u6cd5\u5730\u5740\u7a7a\u95f4\u3002 \u5185\u5b58\u63cf\u8ff0\u7b26: mm_struct\u7ed3\u6784\u4f53\uff0c\u5305\u542b\u4e86\u548c\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u6709\u5173\u7684\u5168\u90e8\u4fe1\u606f\u3002\u4e3b\u8981\u7684\u6210\u5458\u6709: 1\u3001mm_users: \u8bb0\u5f55\u6b63\u5728\u4f7f\u7528\u8be5\u5730\u5740\u7684\u8fdb\u7a0b\u6570\u76ee\uff0c\u5bf9\u4e8e\u5171\u4eab\u5730\u5740\u7a7a\u95f4\u7684\u7ebf\u7a0b\u800c\u8a00\uff0c\u8fd9\u4e2a\u503c\u7b49\u4e8e\u7ebf\u7a0b\u6570\u91cf\u3002 2\u3001mm_count: mm_struct\u7ed3\u6784\u4f53\u7684\u4e3b\u5f15\u7528\u8ba1\u6570\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u591a\u4e2a\u7ebf\u7a0b\u800c\u8a00\uff0c\u5176\u503c\u4e00\u76f4\u4e3a1\u3002\u5f53mm_user\u51cf\u4e3a0\u65f6\uff0cmm_count\u4e5f\u5c06\u4e3a0\uff0c\u8bf4\u660e\u6ca1\u6709\u6307\u5411\u8be5\u7ed3\u6784\u4f53\u7684\u5f15\u7528\u4e86\uff0cmm_struct\u5c06\u88ab\u64a4\u9500\u3002 3\u3001 mmap/mm_rb: \u5206\u522b\u4ee5\u94fe\u8868\u5f62\u5f0f\u548c\u7ea2\u9ed1\u6811\u5f62\u5f0f\u63cf\u8ff0\u5730\u5740\u7a7a\u95f4\u5185\u7684\u5168\u90e8\u5185\u5b58\u533a\u57df \u3002 \u524d\u8005\u9002\u5408\u904d\u5386\uff0c\u540e\u8005\u9002\u5408\u67e5\u627e\uff0c\u5982\u5728\u5730\u5740\u7a7a\u95f4\u4e2d\u5b9a\u4f4d\u7279\u5b9a\u5185\u5b58\u533a\u57df\u3002 4\u3001mm_list\uff1alist_head\u7c7b\u578b\u7684\u53cc\u5411\u94fe\u8868\uff0c\u6240\u6709\u7684mm_struct\u90fd\u901a\u8fc7\u6b64\u6210\u5458\u94fe\u63a5\u5728\u4e00\u8d77\uff1b\u94fe\u8868\u7684\u9996\u5143\u7d20\u662finit_mm\u5185\u5b58\u63cf\u8ff0\u7b26\uff0c\u4ee3\u8868init\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u3002\u64cd\u4f5c\u8be5\u94fe\u8868\u65f6\uff0c\u9700\u8981\u4f7f\u7528mm_lock\u9501\u6765\u9632\u6b62\u5e76\u53d1\u8bbf\u95ee\u3002 \u5206\u914d\u5185\u5b58\u63cf\u8ff0\u7b26 \u5185\u6838\u7ebf\u7a0b \u865a\u62df\u5185\u5b58\u533a\u57df \u2003\u6bcf\u4e2avm_areas_struct\u5bf9\u8c61\u90fd\u5bf9\u5e94\u4e8e\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u552f\u4e00\u533a\u95f4\uff0c\u540c\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4\u5185\u7684\u4e0d\u540c\u5185\u5b58\u533a\u57df\u4e0d\u80fd\u91cd\u53e0\uff1bvm_areas_struct\u4e2d\u7684vm_mm\u6210\u5458\u6307\u5411\u4e0e\u5176\u76f8\u5173\u7684mm_struct\uff1b\u4e0d\u540c\u7684\u72ec\u7acb\u8fdb\u7a0b\u5c06\u540c\u4e00\u4e2a\u6587\u4ef6\u6620\u5c04\u5230\u5730\u5740\u7a7a\u95f4\u65f6\uff0c\u5c06\u5404\u81ea\u6709\u4e00\u4e2avm_areas_struct\u7ed3\u6784\u4f53\u6765\u6807\u8bb0\u81ea\u5df1\u7684\u5185\u5b58\u533a\u57df\uff1b\u800c\u4e24\u4e2a\u7ebf\u7a0b\u5171\u4eab\u5730\u5740\u7a7a\u95f4\u65f6\uff0c\u5b83\u4eec\u4e5f\u540c\u65f6\u5171\u4eab\u5176\u4e2d\u6240\u6709\u7684vm_areas_struct\u7ed3\u6784\u4f53\u3002 \u2003 \u5f53\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u4e00\u4e2a\u865a\u62df\u5730\u5740\u65f6\uff0c\u9996\u5148\u5fc5\u987b\u5c06\u865a\u62df\u5730\u5740\u8f6c\u5316\u6210\u7269\u7406\u5730\u5740\uff0c\u8fd9\u4e2a\u662f\u901a\u8fc7\u5206\u9875\u6765\u5b8c\u6210\u7684\uff0clinux\u91c7\u7528\u4e09\u7ea7\u9875\u8868\uff1b \u2003TLB(Traslation Lookaside Buffer), \u4e00\u4e2a\u5c06\u865a\u62df\u5730\u5740\u6620\u5c04\u5230\u7269\u7406\u5730\u5740\u7684\u786c\u4ef6\u7f13\u5b58\uff0c\u5f53\u8bbf\u95ee\u865a\u62df\u5730\u5740\u65f6\uff0c\u5904\u7406\u5668\u9996\u5148\u68c0\u67e5TLB\u662f\u5426\u7f13\u5b58\u547d\u4e2d\uff0c\u5982\u679c\u662f\uff0c\u76f4\u63a5\u8fd4\u56de\u7269\u7406\u5730\u5740\uff0c\u5426\u5219\u518d\u901a\u8fc7\u9875\u8868\u6620\u5c04\u5230\u7269\u7406\u5730\u5740\u3002 \u7f13\u5b58 \u9875\u9ad8\u901f\u7f13\u5b58 \u662flinux\u5185\u6838\u5b9e\u73b0\u78c1\u76d8\u7f13\u5b58\uff0c\u4e3b\u8981\u7528\u6765\u51cf\u5c11\u5bf9\u78c1\u76d8\u7684I/O\u64cd\u4f5c\uff0c\u901a\u8fc7\u628a\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u7f13\u5b58\u5230\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u628a\u5bf9\u78c1\u76d8\u7684\u8bbf\u95ee\u8f6c\u53d8\u4e3a\u5bf9\u5185\u5b58\u7684\u8bbf\u95ee\u3002\u5176\u539f\u56e0\u4e3b\u8981\u662f\uff1a 1\u3001\u4ece\u5185\u5b58\u8bbf\u95ee\u6570\u636e\u7684\u901f\u5ea6\u8fdc\u5feb\u4e8e\u78c1\u76d8\u3002 2\u3001\u6570\u636e\u4e00\u65e6\u88ab\u8bbf\u95ee\uff0c\u77ed\u671f\u5185\u5c31\u5f88\u6709\u53ef\u80fd\u518d\u88ab\u8bbf\u95ee\u3002\u8fd9\u79cd\u77ed\u65f6\u671f\u5185\u96c6\u4e2d\u8bbf\u95ee\u4e00\u7247\u6570\u636e\u7684\u539f\u7406\u79f0\u4e3a \u4e34\u65f6\u5c40\u90e8\u539f\u7406 \u3002 \u5199\u7f13\u5b58 \u5f53\u8fdb\u7a0b\u5199\u78c1\u76d8\u65f6\uff0c\u4e00\u822c\u6709\u4e09\u79cd\u7b56\u7565\uff1a \u2003\u4e0d\u7f13\u5b58\uff0c\u76f4\u63a5\u5199\u5230\u78c1\u76d8\uff0c\u540c\u65f6\u4f7f\u7f13\u5b58\u5931\u6548\uff0c\uff08\u4e00\u822c\u4e0d\u4f7f\u7528\u8fd9\u79cd\u7b56\u7565\uff09\uff1b \u2003\u5199\u900f\u7f13\u5b58(write-through cache),\u5199\u64cd\u4f5c\u5c06\u81ea\u52a8\u66f4\u65b0\u5185\u5b58\u7f13\u5b58\uff0c\u540c\u65f6\u66f4\u65b0\u78c1\u76d8\u6587\u4ef6\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u7f13\u5b58\u4e00\u81f4\u6027\uff0c\u5373\u7f13\u5b58\u6570\u636e\u65f6\u523b\u548c\u78c1\u76d8\u6570\u636e\u4fdd\u5b58\u4e00\u81f4\uff1b \u2003\u56de\u5199(write-back)\uff0c\u7a0b\u5e8f\u6267\u884c\u64cd\u4f5c\u76f4\u63a5\u5199\u5230\u7f13\u5b58\uff0c\u78c1\u76d8\u6570\u636e\u4e0d\u4f1a\u7acb\u523b\u66f4\u65b0\uff0c\u800c\u662f\u5c06\u9875\u9ad8\u901f\u7f13\u5b58\u4e2d\u88ab\u5199\u5165\u7684\u9875\u9762\u6807\u8bb0\u6210\u2018dirty\u2019\uff0c\u5e76\u52a0\u5165\u5230\u810f\u9875\u94fe\u8868\u4e2d\u3002\u7136\u540e\u7531\u56de\u5199\u8fdb\u7a0b\u5468\u671f\u5730\u5c06\u810f\u9875\u94fe\u8868\u4e2d\u7684\u9875\u5199\u56de\u5230\u78c1\u76d8\u4e2d\uff0c\u4ece\u800c\u8ba9\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u548c\u5185\u5b58\u4e2d\u6700\u7ec8\u4e00\u81f4\u3002\u6700\u540e\u4f1a\u6e05\u7406dirty\u6807\u8bc6\u3002 \u56de\u6536\u7f13\u5b58: \u6700\u8fd1\u6700\u5c11\u4f7f\u7528(LRU)\u7b56\u7565\u548c\u53cc\u94fe\u7b56\u7565(\u7ef4\u62a4\u4e24\u4e2a\u94fe\u8868\uff1a\u6d3b\u8dc3\u94fe\u8868\u548c\u975e\u6d3b\u8dc3\u94fe\u8868)\u3002 linux \u9875\u9ad8\u901f\u7f13\u5b58 \u2003\u9875\u9ad8\u901f\u7f13\u5b58\u7f13\u5b58\u7684\u662f\u5185\u5b58\u9875\u9762\uff0c\u7f13\u5b58\u4e2d\u7684\u9875\u6765\u81ea\u5bf9\u6b63\u89c4\u6587\u4ef6\u3001\u5757\u8bbe\u5907\u6587\u4ef6\u548c\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u7684\u8bfb\u5199\u3002","title":"5_\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf"},{"location":"os/5_os/#_1","text":"","title":"\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf"},{"location":"os/5_os/#_2","text":"\u7ba1\u7406\u8ba1\u7b97\u673a\u786c\u4ef6\u4e0e\u8f6f\u4ef6\u8d44\u6e90\u7684\u8ba1\u7b97\u673a\u7a0b\u5e8f\u3002\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u7ba1\u7406\u4e0e\u914d\u7f6e\u5185\u5b58\u3001\u51b3\u5b9a\u7cfb\u7edf\u8d44\u6e90\u4f9b\u9700\u7684\u4f18\u5148\u6b21\u5e8f\u3001\u63a7\u5236\u8f93\u5165\u8bbe\u5907\u4e0e\u8f93\u51fa\u8bbe\u5907\u3001\u64cd\u4f5c\u7f51\u7edc\u4e0e\u7ba1\u7406\u6587\u4ef6\u7cfb\u7edf\u7b49\u57fa\u672c\u4e8b\u52a1\u3002\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u63d0\u4f9b\u4e00\u4e2a\u8ba9\u7528\u6237\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u7684\u64cd\u4f5c\u754c\u9762\u3002 \u7528\u6237\u6001\u548c\u5185\u6838\u6001 \u5927\u591a\u6570\u73b0\u4ee3CPU\u63d0\u4f9b\u4e24\u79cd\u6267\u884c\u6a21\u5f0f\uff0c\u5185\u6838\u6001\u548c\u7528\u6237\u6001\u3002CPU\u53ef\u4ee5\u5728\u5185\u6838\u6001\u6267\u884c\u6307\u4ee4\u96c6\u4e2d\u7684\u6240\u6709\u6307\u4ee4\uff0c\u4ee5\u53ca\u4f7f\u7528\u6240\u6709\u7684\u786c\u4ef6\u8d44\u6e90\uff0c\u7528\u6237\u7a0b\u5e8f\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u6216\u8005\u89e6\u53d1\u67d0\u4e2a\u5f02\u5e38\uff0c\u4f1a\u9677\u5165\u5230\u5185\u6838\u6001\uff1b\u4f46\u5728\u7528\u6237\u6001\u65f6\uff0c\u53ea\u80fd\u6267\u884c\u90e8\u5206\u6307\u4ee4\uff0c\u4f7f\u7528\u90e8\u5206\u786c\u4ef6\u7684\u8d44\u6e90\u3002\u4e24\u79cd\u6267\u884c\u6a21\u5f0f\u4f7f\u5f97\u8bbe\u8ba1\u4eba\u5458\u53ea\u80fd\u5728\u7528\u6237\u6a21\u5f0f\u4e0b\u8fd0\u884c\u7528\u6237\u7a0b\u5e8f\uff0c\u4ece\u800c\u62d2\u7edd\u4ed6\u4eec\u8bbf\u95ee\u5173\u952e\u6307\u4ee4\u3002 \u7cfb\u7edf\u8c03\u7528 \u2003\u7cfb\u7edf\u8c03\u7528\u4e2d\u65ad\u662f\u7528\u6237\u7a0b\u5e8f\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\u7684\u552f\u4e00\u754c\u9762\u63a5\u53e3\uff1b\u5bf9\u4e8eintel x86, \u901a\u8fc7\u4e2d\u65ad\u6307\u4ee4int\u8fdb\u5165\u5185\u6838\u3002\u4f8b\u5982linux\u5728boot/setup.s\u4e2d\u4f1a\u5c06\u7528\u6237\u7a0b\u5e8f\u53d1\u51fa\u7684\u8f6f\u4ef6\u4e2d\u65ad\u8bbe\u7f6e\u4e3a int 128\uff080x80\uff09\uff0c\u8fd9\u6761\u6307\u4ee4\u4f1a\u89e6\u53d1\u4e00\u4e2a\u5f02\u5e38\u5bfc\u81f4\u7cfb\u7edf\u5207\u6362\u5230\u5185\u6838\u6001\uff0c\u5e76\u6267\u884c128\u53f7\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\uff0c\u5373\u7cfb\u7edf\u8c03\u7528\u5904\u7406\u7a0b\u5e8fsystem_call()\u3002 \u2003\u5bc4\u5b58\u5668 eax \u4e2d\u5b58\u653e\u7740\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c\u800c\u643a\u5e26\u7684\u53c2\u6570\u53ef \u4f9d\u6b21\u5b58\u653e\u5728\u5bc4\u5b58\u5668 ebx\u3001ecx\u3001edx\u3001esi\u548cedi\u4e2d \uff0c\u9700\u8981\u66f4\u591a\u53c2\u6570\u65f6\uff0c\u53ef\u4ee5\u7528\u5176\u4e2d\u4e00\u4e2a\u5bc4\u5b58\u5668\u5b58\u653e\u6307\u5411\u6240\u6709\u8fd9\u4e9b\u53c2\u6570\u5728\u7528\u6237\u7a7a\u95f4\u5730\u5740\u7684\u6307\u9488\u3002 \u7cfb\u7edf\u8c03\u7528\u8fc7\u7a0b: a. \u7528\u6237\u7a0b\u5e8f\u4e2d\u5305\u542b\u4e00\u6bb5\u542bint 0x80\u6307\u4ee4\u7684\u4ee3\u7801(\u901a\u5e38\u5728\u5e93\u51fd\u6570\u4e2d)\u3002 b. \u64cd\u4f5c\u7cfb\u7edf\u5199\u4e2d\u65ad\u5904\u7406\uff0c\u5e76\u83b7\u53d6\u60f3\u8c03\u7528\u7684\u5185\u6838\u7a0b\u5e8f\u7684\u7f16\u53f7\u3002 c. \u64cd\u4f5c\u7cfb\u7edf\u6839\u636e\u7f16\u53f7\u8f6c\u5230\u76f8\u5e94\u7684\u6267\u884c\u4ee3\u7801\u3002 \u5185\u5b58\u5c42\u6b21\u6a21\u578b \u5bc4\u5b58\u5668 -> \u9ad8\u901f\u7f13\u5b58 -> \u4e3b\u5b58 -> \u78c1\u76d8\uff0c \u8bbf\u95ee\u901f\u5ea6\u7531\u5feb\u5230\u6162\uff0c\u5bb9\u91cf\u7531\u5c0f\u5230\u5927\u3002 I/O\u7684\u4e09\u79cd\u65b9\u5f0f\uff1a 1\u300b\u7528\u6237\u7a0b\u5e8f\u53d1\u8d77\u7cfb\u7edf\u8c03\u7528\uff0c\u5185\u6838\u4f1a\u5c06\u5176\u8f6c\u6362\u4e3a\u76f8\u5e94\u9a71\u52a8\u7a0b\u5e8f\u7684\u7a0b\u5e8f\u8c03\u7528\uff0c\u7136\u540e\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u542f\u52a8I/O \u5e76\u5faa\u73af\u68c0\u67e5\u8be5\u8bbe\u5907\u662f\u5426\u5b8c\u6210\u5de5\u4f5c\u3002\u5f53I/O\u8c03\u7528\u5b8c\u6210\u540e\uff0c\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u628a\u6570\u636e\u9001\u5230\u6307\u5b9a\u7684\u5730\u65b9\u5e76\u8fd4\u56de\u3002 \u8fd9\u79cd\u65b9\u5f0f\u79f0\u4e3abusy waiting. \u8fd9\u79cd\u65b9\u5f0f\u7684\u7f3a\u70b9\u662f\u8981\u4e00\u76f4\u5360\u636eCPU\uff0cCPU\u4f1a\u4e00\u76f4\u8f6e\u8be2I/O\u8bbe\u5907\u76f4\u5230I/O\u64cd\u4f5c\u5b8c\u6210\u3002 2\u300b\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u542f\u52a8\u8bbe\u5907\u5e76\u4e14\u8ba9\u8be5\u8bbe\u5907\u5728\u64cd\u4f5c\u5b8c\u6210\u65f6\u53d1\u751f\u4e2d\u65ad\u3002\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u5728\u8be5\u65f6\u523b\u8fd4\u56de\uff0c \u64cd\u4f5c\u7cfb\u7edf\u63a5\u7740\u5728\u9700\u8981\u65f6\u963b\u585e\u8c03\u7528\u8005\u5e76\u5b89\u6392\u5176\u4ed6\u5de5\u4f5c\u8fdb\u884c\u3002\u5f53\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u68c0\u6d4b\u5230\u8be5\u8bbe\u5907\u64cd\u4f5c\u5b8c\u6210\u65f6\uff0c \u4f1a\u53d1\u51fa\u4e00\u4e2a\u4e2d\u65ad\u901a\u77e5\u64cd\u4f5c\u5b8c\u6210\u3002 3\u300b\u4f7f\u7528\u7279\u6b8a\u7684\u786c\u4ef6\uff1a\u76f4\u63a5\u5b58\u50a8\u5668\u8bbf\u95ee\uff08direct memory access\uff0c DMA\uff09\u82af\u7247\u3002 \u5b83\u53ef\u4ee5\u63a7\u5236\u5185\u5b58\u548c\u67d0\u4e9b\u63a7\u5236\u5668\u4e4b\u95f4\u7684\u4f4d\u6d41\uff0c\u800c\u65e0\u9700CPU\u7684\u5e72\u9884\u3002CPU\u4f1a\u5bf9DMA\u82af\u7247\u8fdb\u884c\u8bbe\u7f6e\uff0c\u8bf4\u660e\u9700\u8981\u4f20\u9001\u7684\u5b57\u8282\u6570\uff0c \u6709\u5173\u7684\u8bbe\u5907\u548c\u5185\u5b58\u5730\u5740\u4ee5\u53ca\u64cd\u4f5c\u65b9\u5411\u3002\u5f53DMA\u82af\u7247\u5b8c\u6210\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9020\u6210\u4e2d\u65ad\u3002 \u64cd\u4f5c\u7cfb\u7edf\u7ed3\u6784\uff1a\u5355\u4f53\u7ed3\u6784\u3001\u5206\u5c42\u7cfb\u7edf\u3001\u5fae\u5185\u6838\u3001\u5ba2\u6237-\u670d\u52a1\u7aef\u7cfb\u7edf\u3001\u865a\u62df\u673a\u548c\u5916\u6838\u3002 big-endian: \u5c06\u9ad8\u5e8f\u5b57\u8282\u5b58\u50a8\u5728\u8d77\u59cb\u5730\u5740; little-endian: \u5c06\u4f4e\u5e8f\u5b57\u8282\u5b58\u50a8\u5728\u8d77\u59cb\u5730\u5740(\u5730\u5740\u4f4e\u4f4d\u5b58\u50a8\u503c\u7684\u4f4e\u4f4d, \u5730\u5740\u9ad8\u4f4d\u5b58\u50a8\u503c\u7684\u9ad8\u4f4d)","title":"\u64cd\u4f5c\u7cfb\u7edf"},{"location":"os/5_os/#_3","text":"\u4e00\u4e2a\u6b63\u5728\u6267\u884c\u7a0b\u5e8f\u7684\u5b9e\u4f8b\uff0c\u7cfb\u7edf\u8fdb\u884c\u8d44\u6e90\u5206\u914d\u7684\u6700\u5c0f\u5355\u4f4d\u3002(\u5728 Linux \u5185\u6838\u4e2d\uff0c\u8fdb\u7a0b\u901a\u5e38\u88ab\u79f0\u4f5c\u4efb\u52a1\uff08task\uff09\uff0c\u800c\u628a\u8fd0\u884c\u5728\u7528\u6237\u7a7a\u95f4\u7684\u7a0b\u5e8f\u79f0\u4f5c\u8fdb\u7a0b) \u8fdb\u7a0b\u7684\u6982\u5ff5\u4e3b\u8981\u6709\u4e24\u70b9\uff1a \u7b2c\u4e00\uff0c \u8fdb\u7a0b\u662f\u4e00\u4e2a\u5b9e\u4f53\u3002\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u90fd\u6709\u5b83\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4 \uff0c\u865a\u62df\u5185\u5b58\u6280\u672f\u4f7f\u5f97\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u72ec\u5360\u6574\u4e2a\u5185\u5b58\u7a7a\u95f4\uff0c\u5730\u5740\u4ece\u96f6\u5f00\u59cb\uff0c\u76f4\u5230\u5185\u5b58\u4e0a\u9650\u3002 \u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u5c06\u8fd9\u90e8\u5206\u7a7a\u95f4\uff08\u4ece\u4f4e\u5730\u5740\u5230\u9ad8\u5730\u5740\uff09\u5206\u4e3a\u516d\u4e2a\u90e8\u5206\uff1a TEXT\u6bb5\uff1a\u6574\u4e2a\u7a0b\u5e8f\u7684\u4ee3\u7801\uff0c\u4ee5\u53ca\u6240\u6709\u7684\u5e38\u91cf\u3002\u8fd9\u90e8\u5206\u5185\u5b58\u662f\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\uff0c\u53ea\u8bfb\u7684; DATA\u6bb5\uff1a\u53c8\u79f0GVAR\uff1a\u5b58\u50a8\u5df2\u7ecf\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u53d8\u91cf; BSS(Block Started by Symbol)\u6bb5\uff1a\u5b58\u653e\u7a0b\u5e8f\u4e2d\u672a\u521d\u59cb\u5316\u7684\u6216\u8005\u521d\u59cb\u5316\u4e3a0\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u53d8\u91cf\u7684\u4e00\u5757\u5185\u5b58\u533a\u57df\u3002 \u7279\u70b9\u662f\u53ef\u8bfb\u5199\u7684\uff0c\u5728\u7a0b\u5e8f\u6267\u884c\u4e4b\u524dBSS\u6bb5\u4f1a\u81ea\u52a8\u6e050\u3002 HEAP\uff08\u5806\u7a7a\u95f4\uff09\uff1a\u52a8\u6001\u5185\u5b58\u533a\u57df\uff0c\u4f7f\u7528malloc\u6216new\u7533\u8bf7\u7684\u5185\u5b58; \u672a\u4f7f\u7528\u7684\u5185\u5b58; STACK\uff08\u6808\u7a7a\u95f4\uff09\uff1a\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u3001\u53c2\u6570\u3001\u8fd4\u56de\u503c\uff0c\u51fd\u6570\u8c03\u7528\u5f00\u59cb\u4f1a\u53c2\u6570\u5165\u6808\u3001\u5c40\u90e8\u53d8\u91cf\u5165\u6808\uff1b\u8c03\u7528\u7ed3\u675f\u4f9d\u6b21\u51fa\u6808\u3002 \u5176\u4e2d\u5806\u7a7a\u95f4\u548c\u6808\u7a7a\u95f4\u7684\u5927\u5c0f\u662f\u53ef\u53d8\u7684\uff0c\u5806\u7a7a\u95f4\u4ece\u4e0b\u5f80\u4e0a\u751f\u957f\uff0c\u6808\u7a7a\u95f4\u4ece\u4e0a\u5f80\u4e0b\u751f\u957f\u3002 \u7b2c\u4e8c\uff0c \u8fdb\u7a0b\u662f\u4e00\u4e2a\u201c\u6267\u884c\u4e2d\u7684\u7a0b\u5e8f\u201d\u3002 \u7a0b\u5e8f\u662f\u4e00\u4e2a\u6ca1\u6709\u751f\u547d\u7684\u5b9e\u4f53\uff0c\u53ea\u6709\u5904\u7406\u5668\u8d4b\u4e88\u7a0b\u5e8f\u751f\u547d\u65f6\uff08\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u4e4b\uff09\uff0c\u5b83\u624d\u80fd\u6210\u4e3a\u4e00\u4e2a\u6d3b\u52a8\u7684\u5b9e\u4f53\uff0c\u6211\u4eec\u79f0\u5176\u4e3a\u8fdb\u7a0b\u3002 \u8fdb\u7a0b=\u8d44\u6e90+\u6307\u4ee4\u6267\u884c\u5e8f\u5217: \u5c06\u8d44\u6e90\u548c\u6307\u4ee4\u6267\u884c\u5206\u5f00, \u4e00\u4e2a\u8d44\u6e90+\u591a\u4e2a\u6307\u4ee4\u6267\u884c\u5e8f\u5217, \u6307\u4ee4\u6267\u884c\u5e8f\u5217\u5373\u7ebf\u7a0b: \u4fdd\u7559\u4e86\u5e76\u53d1\u7684\u7279\u70b9, \u907f\u514d\u4e86\u8fdb\u7a0b\u8d44\u6e90\u5207\u6362\uff08\u5982\u6620\u5c04\u8868\u7684\u5207\u6362\uff09\u7684\u4ee3\u4ef7\u3002 \u8fdb\u7a0b\u7684\u5c42\u6b21\u7ed3\u6784 \u5f53\u8fdb\u7a0b\u521b\u5efa\u4e86\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u540e\uff0c\u7236\u8fdb\u7a0b\u548c\u5b50\u8fdb\u7a0b\u4ee5\u67d0\u79cd\u5f62\u5f0f\u7ee7\u7eed\u4fdd\u6301\u5173\u8054\u3002\u5b50\u8fdb\u7a0b\u81ea\u8eab\u53ef\u4ee5\u521b\u5efa\u66f4\u591a\u7684\u8fdb\u7a0b\uff0c\u7ec4\u6210\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5c42\u6b21\u7ed3\u6784\u3002\u5728UNIX\u4e2d\uff0c\u8fdb\u7a0b\u548c\u5b83\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\u4ee5\u53ca\u540e\u88d4\u5171\u540c\u7ec4\u6210\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\u3002\u800c\u5728windows\u4e2d\uff0c\u6240\u6709\u8fdb\u7a0b\u7684\u5730\u4f4d\u90fd\u662f\u76f8\u540c\u7684\uff0c\u4e0d\u8fc7\u5728\u521b\u5efa\u8fdb\u7a0b\u65f6\uff0c\u7236\u8fdb\u7a0b\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7279\u522b\u7684\u4ee4\u724c\uff08\u53e5\u67c4\uff09\uff0c\u7528\u4ee5\u63a7\u5236\u5b50\u8fdb\u7a0b\u3002 \u8fdb\u7a0b\u72b6\u6001 \u8fd0\u884c\u6001\uff1a\u8be5\u65f6\u523b\u8fdb\u7a0b\u5b9e\u9645\u5360\u7528CPU \u5c31\u7eea\u6001\uff1a\u53ef\u8fd0\u884c\uff0c\u62e5\u6709\u9664CPU\u4ee5\u5916\u7684\u6240\u6709\u6240\u9700\u8d44\u6e90\uff0c\u4f46\u56e0\u4e3a\u5176\u4ed6\u8fdb\u7a0b\u6b63\u5728\u8fd0\u884c\u800c\u6682\u65f6\u505c\u6b62 \u963b\u585e\u6001\uff1a\u8fdb\u7a0b\u7b49\u5f85\u76f4\u81f3\u67d0\u4e2a\u5916\u754c\u4e8b\u4ef6\u53d1\u751f\u624d\u80fd\u8f6c\u4e3a\u5c31\u7eea\u6001\uff0c\u5426\u5219\u5c06\u4e00\u76f4\u65e0\u6cd5\u6267\u884c \u2003(\u4e94\u72b6\u6001\u6a21\u578b\u4e0b\u8fd8\u6709\u65b0\u5efa\u6001\u548c\u7ec8\u6b62\u6001\uff0c \u524d\u8005\uff1a\u65b0\u5efa\u6001\u5bf9\u5e94\u4e8e\u8fdb\u7a0b\u521a\u521a\u88ab\u521b\u5efa\u7684\u72b6\u6001\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u521b\u5efa\u7684\u65b0\u8fdb\u7a0b\u521b\u5efaPCB\uff0c\u5206\u914d\u8d44\u6e90\uff0c\u5f53\u8fdb\u7a0b\u62e5\u6709\u9664CPU\u4ee5\u5916\u7684\u6240\u6709\u8d44\u6e90\u65f6\uff0c\u5c06\u8fdb\u5165\u5c31\u7eea\u6001\uff0c\u7b49\u5f85\u8c03\u5ea6\u6267\u884c\uff1b \u540e\u8005\uff1a\u8fdb\u7a0b\u7684\u7ec8\u6b62\u8981\u901a\u8fc7\u4e24\u4e2a\u6b65\u9aa4\uff0c\u9996\u5148\uff0c\u662f\u7b49\u5f85\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u5584\u540e\uff0c\u56de\u6536\u8d44\u6e90\uff1b\u7136\u540e\u64a4\u9500PCB\uff0c\u9000\u51fa\u4e3b\u5b58\u3002\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u5230\u8fbe\u4e86\u81ea\u7136\u7ed3\u675f\u70b9\uff0c\u6216\u662f\u51fa\u73b0\u4e86\u65e0\u6cd5\u514b\u670d\u7684\u9519\u8bef\uff0c\u6216\u662f\u88ab\u64cd\u4f5c\u7cfb\u7edf\u6240\u7ec8\u7ed3\uff0c\u6216\u662f\u88ab\u5176\u4ed6\u6709\u7ec8\u6b62\u6743\u7684\u8fdb\u7a0b\u6240\u7ec8\u7ed3\uff0c\u5b83\u5c06\u8fdb\u5165\u7ec8\u6b62\u6001\u3002\u8fdb\u5165\u7ec8\u6b62\u6001\u7684\u8fdb\u7a0b\u4ee5\u540e\u4e0d\u518d\u6267\u884c\uff0c\u4f46\u4f9d\u7136\u4fdd\u7559\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7b49\u5f85\u5584\u540e\u3002 \u2003 linux\u4e0b\u8fdb\u7a0b\u72b6\u6001 \u2003\u50f5\u5c38\u8fdb\u7a0b \u2003\u907f\u514d\u50f5\u5c38\u8fdb\u7a0b \u2003\u5176\u4e2d\u7684handler\u4e3a\u7236\u8fdb\u7a0b\u6ce8\u518c\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\uff0c\u5f53\u5b50\u8fdb\u7a0b\u9000\u51fa\u65f6\uff0c\u7236\u8fdb\u7a0b\u6536\u5230SIGCHLD\u4fe1\u53f7\uff0c\u5982\u679c\u7236\u8fdb\u7a0b\u6b64\u65f6\u6b63\u5728\u5904\u7406\u5176\u4ed6\u4e8b\u60c5\uff0c\u5219\u53ef\u4ee5\u8c03\u7528\u63d0\u524d\u6ce8\u518c\u7684handler\uff0c\u5728\u5176\u4e2d\u8c03\u7528wait/waitpid\uff0c\u6765\u83b7\u53d6\u5b50\u8fdb\u7a0b\u9000\u51fa\u72b6\u6001\uff0c\u7136\u540e\u56de\u6536\u5b50\u8fdb\u7a0b\u5269\u4f59\u4fe1\u606f\u3002 \u5bf9\u4e8e\u4ea7\u751f\u4fe1\u53f7\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4ea7\u751f\u4fe1\u53f7\u524d\u5229\u7528\u65b9\u6cd5 signal(int signum, sighandler_t handler) \u8bbe\u7f6e\u4fe1\u53f7\u7684\u5904\u7406\u3002 \u5982\u679c\u6ca1\u6709\u8c03\u7528\u6b64\u65b9\u6cd5\uff0c\u7cfb\u7edf\u5c31\u4f1a\u8c03\u7528\u9ed8\u8ba4\u5904\u7406\u65b9\u6cd5\uff1a\u4e2d\u6b62\u7a0b\u5e8f\uff0c\u663e\u793a\u63d0\u793a\u4fe1\u606f\u3002\u6211\u4eec\u53ef\u4ee5\u8c03\u7528\u7cfb\u7edf\u7684\u5904\u7406\u65b9\u6cd5\uff0c \u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5904\u7406\u65b9\u6cd5\u3002\u7cfb\u7edf\u91cc\u8fb9\u5b9a\u4e49\u4e86\u4e09\u79cd\u5904\u7406\u65b9\u6cd5\uff1a SIG_DFL: \u9ed8\u8ba4\u52a8\u4f5c\uff0c\u9ed8\u8ba4\u7684\u5904\u7406\u65b9\u5f0f\u662f\u4e0d\u7406\u4f1a\u8fd9\u4e2a\u4fe1\u53f7\uff0c\u4f46\u662f\u4e5f\u4e0d\u4f1a\u4e22\u5f03\u5b50\u8fdb\u884c\u72b6\u6001\uff0c\u6240\u4ee5\u5982\u679c\u4e0d\u7528wait/waitpid \u5bf9\u5176\u5b50\u8fdb\u884c\u8fdb\u884c\u72b6\u6001\u4fe1\u606f\u56de\u6536\uff0c\u4f1a\u4ea7\u751f\u50f5\u5c38\u8fdb\u7a0b\u3002 SIG_IGN: \u5ffd\u7565\u4fe1\u53f7\uff0c\u5b50\u8fdb\u7a0b\u72b6\u6001\u4fe1\u606f\u4f1a\u88ab\u4e22\u5f03\uff0c\u4e5f\u5c31\u662f\u81ea\u52a8\u56de\u6536\u4e86\uff0c\u6240\u4ee5\u4e0d\u4f1a\u4ea7\u751f\u50f5\u5c38\u8fdb\u7a0b\u3002 \u81ea\u5b9a\u4e49\u5904\u7406\u65b9\u5f0f\uff0c\u5982\u81ea\u5b9a\u4e49handler \u8fdb\u7a0b\u63cf\u8ff0\u7b26 \u5185\u6838\u628a\u8fdb\u7a0b\u7684\u5217\u8868\u5b58\u653e\u5728\u53eb\u505a\u4efb\u52a1\u961f\u5217\u7684\u53cc\u5411\u5faa\u73af\u94fe\u8868\u4e2d\uff0c\u94fe\u8868\u7684\u6bcf\u4e00\u9879\u7c7b\u578b\u90fd\u662ftask_struct,\u79f0\u4e3a\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u3001\u8fdb\u7a0b\u63a7\u5236\u5757(Process Control Block,PCB)\u3001\u8fdb\u7a0b\u8868\uff0c\u5305\u542b\u4e00\u4e2a\u5177\u4f53\u8fdb\u7a0b\u7684\u6240\u6709\u4fe1\u606f\u3002\u5982 (1)\u8fdb\u7a0b\u6807\u8bc6\u7b26(\u552f\u4e00)\uff0c PID (2)\u8fdb\u7a0b\u5f53\u524d\u72b6\u6001\uff0c\u901a\u5e38\u540c\u4e00\u72b6\u6001\u7684\u8fdb\u7a0b\u4f1a\u88ab\u653e\u5230\u540c\u4e00\u4e2a\u961f\u5217\uff1b (3)\u7a0b\u5e8f\u72b6\u6001\u5b57\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668 (4)\u6587\u4ef6\u63cf\u8ff0\u7b26 (5)\u8fdb\u7a0b\u4f18\u5148\u7ea7\uff1b\u8c03\u5ea6\u7b56\u7565 (6)\u6307\u5411\u7236\u8fdb\u7a0b\u3001\u5b50\u8fdb\u7a0b\u94fe\u8868\u3001\u5144\u5f1f\u8fdb\u7a0b\u7684\u6307\u9488 (7)flags, \u53cd\u5e94\u8fdb\u7a0b\u72b6\u6001\u7684\u4fe1\u606f\uff0c\u4f46\u4e0d\u662f\u8fd0\u884c\u72b6\u6001\uff0c\u7528\u4e8e\u5185\u6838\u8bc6\u522b\u8fdb\u7a0b\u5f53\u524d\u7684\u72b6\u6001\uff0c\u4ee5\u5907\u4e0b\u4e00\u6b65\u64cd\u4f5c; PF_FORKNOEXEC \u8fdb\u7a0b\u521a\u521b\u5efa\uff0c\u4f46\u8fd8\u6ca1\u6267\u884c\u3002 PF_SUPERPRIV \u8d85\u7ea7\u7528\u6237\u7279\u6743\u3002 (8)\u8fdb\u7a0b\u540c\u6b65\u4e0e\u901a\u4fe1\u673a\u5236\uff0c\u7528\u4e8e\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u4e92\u65a5\u3001\u540c\u6b65\u548c\u901a\u4fe1\u6240\u9700\u7684\u4fe1\u53f7\u91cf\u7b49\uff1b \u7528\u4e8e\u4fdd\u62a4\u8d44\u6e90\u5206\u914d\u6216\u91ca\u653e\u7684\u81ea\u65cb\u9501\uff1b (9)\u6307\u5411\u5185\u5b58\u63cf\u8ff0\u7b26(mm_struct)\u7684\u6307\u9488mm\u548cactive_mm\uff0cmm\u6307\u5411\u7684mm_struct\u7ed3\u6784\u63cf\u8ff0\u4e86\u4e00\u4e2a\u8fdb\u7a0b\u7684\u6574\u4e2a\u865a\u62df\u5730\u5740\u7a7a\u95f4\uff1b \u5bf9\u4e8e\u5185\u6838\u7ebf\u7a0b\u6765\u8bf4\uff0c\u6ca1\u6709\u5730\u5740\u7a7a\u95f4\uff0c\u56e0\u6b64\u5176mm\u57df\u4e3aNULL\uff0c\u800cactive_mm\u6307\u5411\u7684\u662f\u5207\u6362\u524d\u7684\u8fdb\u7a0b\u7684mm_struct. \u6307\u5411\u5185\u6838\u6808\u7684\u6307\u9488\uff0ctask_struct->stack. (9)\u8fdb\u7a0b\u76f8\u5173\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u4f8b\u5982\u8fdb\u7a0b\u521b\u5efa\u65f6\u95f4\u3001\u5728\u5185\u6838\u6001/\u7528\u6237\u6001\u7d2f\u8ba1\u8fd0\u884c\u65f6\u95f4\u7b49\u3002 \u2003 ps1. \u4e00\u4e2a\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e3b\u8981\u7531\u4e24\u4e2a\u6570\u636e\u7ed3\u6765\u63cf\u8ff0\u3002\u4e00\u4e2a\u662f\u6700\u9ad8\u5c42\u6b21\u7684\uff1amm_struct\uff0c\u4e00\u4e2a\u662f\u8f83\u9ad8\u5c42\u6b21\u7684\uff1avm_area_structs\u3002\u6700\u9ad8\u5c42\u6b21\u7684mm_struct\u7ed3\u6784\u63cf\u8ff0\u4e86\u4e00\u4e2a\u8fdb\u7a0b\u7684\u6574\u4e2a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u3002\u8f83\u9ad8\u5c42\u6b21\u7684\u7ed3\u6784vm_area_truct\u63cf\u8ff0\u4e86\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\u4e00\u4e2a\u533a\u95f4\uff08\u7b80\u79f0\u865a\u62df\u533a\uff09\u3002\u6bcf\u4e2a\u8fdb\u7a0b\u53ea\u6709\u4e00\u4e2amm_struct\u7ed3\u6784\uff0c\u5728\u6bcf\u4e2a\u8fdb\u7a0b\u7684task_struct\u7ed3\u6784\u4e2d\uff0c\u6709\u4e00\u4e2a\u6307\u5411\u8be5\u8fdb\u7a0b\u7684\u7ed3\u6784\u3002\u53ef\u4ee5\u8bf4\uff0cmm_struct\u7ed3\u6784\u662f\u5bf9\u6574\u4e2a\u7528\u6237\u7a7a\u95f4\u7684\u63cf\u8ff0\u3002 \u2003 ps2. \u6bcf\u4e2a\u8fdb\u7a0b\u88ab\u521b\u5efa\u7684\u65f6\u5019\uff0c\u5728\u751f\u6210\u8fdb\u7a0b\u63cf\u8ff0\u7b26task_struct\u7684\u540c\u65f6\uff0c\u4f1a\u751f\u6210\u4e24\u4e2a\u6808\uff0c\u4e00\u4e2a\u662f\u7528\u6237\u6808\uff0c\u4f4d\u4e8e\u7528\u6237\u5730\u5740\u7a7a\u95f4\uff1b\u4e00\u4e2a\u662f\u5185\u6838\u6808\uff0c\u4f4d\u4e8e\u5185\u6838\u7a7a\u95f4\u3002\u5f53\u8fdb\u7a0b\u5728\u7528\u6237\u5730\u5740\u7a7a\u95f4\u4e2d\u6267\u884c\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u7684\u662f\u7528\u6237\u6808\uff0cCPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u4e2d\u5b58\u7684\u662f\u7528\u6237\u6808\u7684\u5730\u5740\uff1b\u540c\u7406\uff0c\u5f53\u8fdb\u7a0b\u5728\u5185\u6838\u7a7a\u95f4\u6267\u884c\u65f6\uff0cCPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u4e2d\u653e\u7684\u662f\u5185\u6838\u6808\u7684\u5730\u5740\u3002 \u2003\u4f4d\u4e8e\u7528\u6237\u7a7a\u95f4\u7684\u8fdb\u7a0b\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\u65f6\uff0c\u5b83\u4f1a\u9677\u5165\u5185\u6838\uff0c\u8ba9\u5185\u6838\u4ee3\u5176\u6267\u884c\u3002\u6b64\u65f6\uff0c\u8fdb\u7a0b\u7528\u6237\u6808\u7684\u5730\u5740\u4f1a\u88ab\u5b58\u8fdb\u5185\u6838\u6808\u4e2d\uff0cCPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u4e2d\u7684\u5185\u5bb9\u4e5f\u4f1a\u53d8\u4e3a\u5185\u6838\u6808\u7684\u5730\u5740\u3002\u5f53\u7cfb\u7edf\u8c03\u7528\u6267\u884c\u5b8c\u6bd5\uff0c\u8fdb\u7a0b\u4ece\u5185\u6838\u6808\u627e\u5230\u7528\u6237\u6808\u7684\u5730\u5740\uff0c\u7ee7\u7eed\u5728\u7528\u6237\u7a7a\u95f4\u4e2d\u6267\u884c\uff0c\u6b64\u65f6CPU\u5806\u6808\u6307\u9488\u5bc4\u5b58\u5668\u5c31\u53d8\u4e3a\u4e86\u7528\u6237\u6808\u7684\u5730\u5740\u3002 \u2003 ps3. thread_info : \u5bf9\u4e8e\u5bc4\u5b58\u5668\u8f83\u5c11\u7684\u786c\u4ef6\u4f53\u7cfb\u7ed3\u6784\u6765\u8bf4\uff0c\u4f7f\u7528\u8fdb\u7a0b\u7684task_struct\u662f\u901a\u8fc7\u5b58\u653e\u5728\u8fdb\u7a0b\u5185\u6838\u6808\u6808\u9876\u7684struct thread_info\u6765\u5b9e\u73b0\u7684\uff0c\u5176task\u57df\u4e2d\u5b58\u653e\u4e86\u6307\u5411\u8be5\u4efb\u52a1\u5b9e\u9645task_struct\u7684\u6307\u9488\u3002 \u8fdb\u7a0b\u521b\u5efa \u2003 UNIX\u7cfb\u7edf\u91c7\u7528fork()\u548cexec()\u4e24\u4e2a\u5355\u72ec\u7684\u51fd\u6570\u6765\u5b8c\u6210\u8fdb\u7a0b\u7684\u521b\u5efa: \u2003fork()\u901a\u8fc7\u62f7\u8d1d\u5f53\u524d\u8fdb\u7a0b\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u5b50\u8fdb\u7a0b\u4e0e\u7236\u8fdb\u7a0b\u7684\u533a\u522b\u4ec5\u5728\u4e8ePID\u3001PPID(\u5b50\u8fdb\u7a0b\u7684PPID\u4e3a\u88ab\u62f7\u8d1d\u8fdb\u7a0b\u7684PID)\u548c\u67d0\u4e9b\u8d44\u6e90\u4e0e\u7edf\u8ba1\u91cf(\u4f8b\u5982\u6302\u8d77\u7684\u4fe1\u53f7\uff0c\u6ca1\u5fc5\u8981\u88ab\u62f7\u8d1d); \u2003exec()\u51fd\u6570\u8d1f\u8d23\u8bfb\u53d6\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u5c06\u5176\u8f7d\u5165\u5730\u5740\u7a7a\u95f4\u5f00\u59cb\u8fd0\u884c\u3002 \u2003 copy-on-write (\u5199\u65f6\u590d\u5236): \u4f20\u7edffork()\u7cfb\u7edf\u8c03\u7528\u76f4\u63a5\u62f7\u8d1d\u7236\u8fdb\u7a0b\u6240\u6709\u8d44\u6e90\u7ed9\u5b50\u8fdb\u7a0b\uff0c\u4e0d\u4ec5\u6548\u7387\u4f4e\u4e0b\uff0c\u4e14\u5982\u679c\u65b0\u8fdb\u7a0b\u6253\u7b97\u7acb\u5373\u6267\u884c\u4e00\u4e2a\u65b0\u7684\u6620\u50cf\uff0c\u62f7\u8d1d\u5c06\u524d\u529f\u5c3d\u5f03\uff1b\u800clinux\u7684fork()\u7cfb\u7edf\u8c03\u7528\u91c7\u7528\u5199\u65f6\u62f7\u8d1d\u6280\u672f\u6765\u63a8\u8fdf\u751a\u81f3\u514d\u9664\u62f7\u8d1d\u6570\u636e\uff0c\u5177\u4f53\u5b9e\u73b0\u4e3a: \u5728\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\uff0c\u5e76\u4e0d\u4f1a\u7acb\u523b\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u8d44\u6e90\u7ed9\u5b50\u8fdb\u7a0b\uff0c\u4e5f\u5373\u6b64\u65f6\u5185\u5b58\u4e0d\u4f1a\u4e3a\u5b50\u8fdb\u7a0b\u5206\u914d\u5b9e\u9645\u7684\u7269\u7406\u5185\u5b58\u9875\u9762\uff0c\u800c\u662f\u8ba9\u5b83\u5171\u4eab\u7236\u8fdb\u7a0b\u7684\u5185\u5b58\u9875\u9762\uff1b\u53ea\u6709\u5f53\u7236\u8fdb\u7a0b\u6216\u65b0\u8fdb\u7a0b\u4e2d\u4efb\u610f\u4e00\u4e2a\u6709\u5199\u5185\u5b58\u64cd\u4f5c\u65f6\uff0c\u7cfb\u7edf\u624d\u4f1a\u4e3a\u6267\u884c\u5199\u64cd\u4f5c\u7684\u8fdb\u7a0b\u5206\u914d\u76f8\u5173\u7684\u72ec\u81ea\u4f7f\u7528\u7684\u5185\u5b58\u9875\u9762\u3002 \u2003 fork() : linux\u901a\u8fc7clone()\u7cfb\u7edf\u8c03\u7528\u5b9e\u73b0fork()\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u53c2\u6570\u6807\u5fd7\u6765\u6307\u660e\u7236\u3001\u5b50\u8fdb\u7a0b\u9700\u8981\u5171\u4eab\u7684\u8d44\u6e90; \u4e8b\u5b9e\u4e0a fork()\u3001vfork()\u3001_clone()\u5e93\u51fd\u6570\u90fd\u6839\u636e\u5404\u81ea\u9700\u8981\u7684\u53c2\u6570\u6807\u5fd7\u6765\u8c03\u7528clone() , \u7136\u540e\u7531clone()\u6765\u8c03\u7528do_fork()\u6765\u5b8c\u6210\u521b\u5efa\u4e2d\u7684\u5927\u90e8\u5206\u5de5\u4f5c\uff0c\u8be5\u51fd\u6570\u8c03\u7528copy_process()\uff0c\u7136\u540e\u8ba9\u8fdb\u7a0b\u5f00\u59cb\u8fd0\u884c\uff0c\u5177\u4f53\u5b8c\u6210\u5de5\u4f5c\u4e3a\uff1a fork()=>clone()=>do_fork()=>copy_process() \u2003 vfork() :\u9664\u4e86\u4e0d\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u9875\u8868\u9879\uff0cvfork()\u548cfork()\u529f\u80fd\u76f8\u540c\u3002\u5b50\u8fdb\u7a0b\u4f5c\u4e3a\u7236\u8fdb\u7a0b\u7684\u4e00\u4e2a\u5355\u72ec\u7684\u7ebf\u7a0b\u5728\u5b83\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\u8fd0\u884c\uff0c\u7236\u8fdb\u7a0b\u88ab\u963b\u585e\uff0c\u76f4\u5230\u5b50\u8fdb\u7a0b\u9000\u51fa\u6216\u6267\u884cexec(), \u4e14\u5b50\u8fdb\u7a0b\u8fd0\u884c\u671f\u95f4\u4e0d\u80fd\u5411\u5730\u5740\u7a7a\u95f4\u4e2d\u5199\u5165\u3002 \u8fdb\u7a0b\u7ec8\u6b62 \u2003\u8c03\u7528exit()\u7cfb\u7edf\u8c03\u7528\uff0c\u6216\u8005\u63a5\u53d7\u65e0\u6cd5\u5904\u7406\u3001\u5ffd\u7565\u7684\u4fe1\u53f7\u6216\u5f02\u5e38\u65f6\u88ab\u52a8\u7ec8\u7ed3\u3002\u5927\u90e8\u5206\u5de5\u4f5c\u4f9d\u8d56do_exit()\u5b8c\u6210\uff0c\u6b64\u540e\u8fdb\u7a0b\u5904\u4e8eTASK_ZOMBIE\u72b6\u6001\uff0c\u5b58\u5728\u7684\u552f\u4e00\u76ee\u7684\u5c31\u662f\u5411\u7236\u8fdb\u7a0b\u63d0\u4f9b\u4fe1\u606f\uff0c \u7236\u8fdb\u7a0b\u68c0\u7d22\u5230\u4fe1\u606f\u540e(\u901a\u8fc7wait()\u7cfb\u7edf\u8c03\u7528\u65cf)\uff0c\u6216\u8005\u901a\u77e5\u5185\u6838\u90a3\u662f\u65e0\u5173\u4fe1\u606f\u540e\uff0c\u8be5\u8fdb\u7a0b\u6240\u6301\u6709\u7684\u5269\u4f59\u5185\u5b58\u4e5f\u88ab\u91ca\u653e \u3002 \u2003\u56e0\u6b64\u7236\u8fdb\u7a0b\u5728\u5b50\u8fdb\u7a0b\u524d\u9000\u51fa\uff0c\u5fc5\u987b\u4fdd\u8bc1\u5b50\u8fdb\u7a0b\u80fd\u627e\u5230\u4e00\u4e2a\u65b0\u7684\u7236\u4eb2\uff0c\u5426\u5219\u4f1a \u6210\u4e3a\u5b64\u513f\u8fdb\u7a0b\uff0c\u5728\u9000\u51fa\u65f6\u4e00\u76f4\u5904\u4e8eZOMBIE\u72b6\u6001\uff0c\u65e0\u6cd5\u91ca\u653e\u5269\u4f59\u5185\u5b58 \u3002\u901a\u5e38\u662f\u5728\u5f53\u524d\u7ebf\u7a0b\u7ec4\u5185\u627e\u4e00\u4e2a\u7ebf\u7a0b\u6216\u8005\u8ba9init\u8fdb\u7a0b\u4f5c\u4e3a\u7236\u8fdb\u7a0b\u3002 \u4e09\u4e2a\u7279\u6b8a\u8fdb\u7a0b idle\u8fdb\u7a0b(PID = 0), init\u8fdb\u7a0b(PID = 1)\u548ckthreadd(PID = 2) Linux\u4e2dPID\u4e3a0\u7684\u8fdb\u7a0b\u662f\u6240\u6709\u5176\u4ed6\u8fdb\u7a0b\u7684\u7956\u5148, \u4e5f\u79f0\u4f5c idle\u8fdb\u7a0b \u6216swapper\u8fdb\u7a0b(\u4ea4\u6362\u8fdb\u7a0b\uff0c\u56e0\u4e3ainit_task\u4e2d comm\u5b57\u6bb5\u5373\u4e3aswapper)\uff0c\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0c\u6839\u636e\u9884\u5b9a\u4e49\u7684INIT_TASK\u5b8f\u5b9a\u4e49\u5b8c\u6210\u521d\u59cb\u5316\uff0c\u751f\u6210\u8fdb\u7a0b\u63cf\u8ff0\u7b26init_task\uff0c 0\u53f7\u8fdb\u7a0b\u7684\u6210\u5458\u5927\u90e8\u5206\u662f\u9759\u6001\u5b9a\u4e49\u7684\uff0c\u5176\u6210\u5458\u521d\u59cb\u503c\u4e5f\u90fd\u901a\u8fc7\u5bf9\u5e94\u7684\u521d\u59cb\u5316\u5b8f\u6765\u521d\u59cb\u5316\uff0c\u5982INIT_MM\u3002 0\u53f7\u8fdb\u7a0b\u8c03\u7528start_kernel\u51fd\u6570\u6765\u5bf9\u5185\u6838\u5404\u4e2a\u91cd\u8981\u5b50\u7cfb\u7edf\u8fdb\u884c\u521d\u59cb\u5316(\u5982\u5185\u5b58\u3001CPU)\uff0c\u7136\u540e\u8c03\u7528rest_init() \u6765\u5b8c\u6210\u5269\u4f59\u7684\u90e8\u5206\u7684\u521d\u59cb\u5316\uff0c\u5728\u5176\u4e2d\u4f1a\u901a\u8fc7 pid = kernel_thread(kernel_init, NULL, CLONE_FS); pid = kernel_thread(kthreadd, NULL, CLONE_FS | CLONE_FILES); \u521b\u5efa\u4e24\u4e2a\u8fdb\u7a0b\uff1b \u524d\u8005\u5373\u4e3a1\u53f7\u8fdb\u7a0b(\u521a\u521b\u5efa\u65f6\u5c1a\u5c5e\u4e8e\u5185\u6838\u8fdb\u7a0b\uff0c\u5171\u4eab0\u53f7\u8fdb\u7a0b\u7684\u8d44\u6e90), \u5728kernel_init\u51fd\u6570\u4e2d\u6765\u5b8c\u6210\u5404\u79cd\u5916\u8bbe\u9a71\u52a8\u7684\u521d\u59cb\u5316\uff0c \u5e76\u5728\u6700\u540e\u8c03\u7528execve()\u6765\u52a0\u8f7dinit\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4e3a1\u53f7\u8fdb\u7a0b\u52a0\u8f7d\u72ec\u7acb\u7684\u5730\u5740\u8d44\u6e90\uff0c\u6b64\u65f61\u53f7\u8fdb\u7a0b\u7531\u5185\u6838\u6001\u8f6c\u53d8\u4e3a\u7528\u6237\u6001\uff0c \u5373\u6210\u4e3a init\u8fdb\u7a0b \u3002 \u540e\u8005\u662f\u75311\u53f7\u8fdb\u7a0b\u521b\u5efa\u7684\uff0c\u79f0\u4e3a2\u53f7\u8fdb\u7a0b(\u8fdb\u7a0b\u540d\u5373kthreadd)\uff0c\u59cb\u7ec8\u8fd0\u884c\u5728\u5185\u6838\u7a7a\u95f4, \u8d1f\u8d23\u6240\u6709\u5185\u6838\u7ebf\u7a0b\u7684\u8c03\u5ea6\u548c\u7ba1\u7406, \u662f\u6240\u6709\u5185\u6838\u7ebf\u7a0b\u7684\u7236\u7ebf\u7a0b\u3002\uff0c","title":"\u8fdb\u7a0b"},{"location":"os/5_os/#_4","text":"\u7ebf\u7a0b \u7ebf\u7a0b\uff08thread\uff09\u662f\u64cd\u4f5c\u7cfb\u7edf\u80fd\u591f\u8fdb\u884c\u8fd0\u7b97\u8c03\u5ea6\u7684\u6700\u5c0f\u5355\u4f4d\uff0c\u5b83\u88ab\u5305\u542b\u5728\u8fdb\u7a0b\u4e4b\u4e2d\uff0c\u662f\u8fdb\u7a0b\u4e2d\u7684\u5b9e\u9645\u8fd0\u4f5c\u5355\u4f4d\u3002 \u2003\u591a\u7ebf\u7a0b\uff1a1\u300b\u5e76\u884c\u5b9e\u4f53\u62e5\u6709\u5171\u4eab\u540c\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4\u548c\u6240\u6709\u53ef\u7528\u6570\u636e\u7684\u80fd\u529b\u3002\uff08\u5373\u4e00\u4e2a\u8fdb\u7a0b\u5305\u542b\u591a\u4e2a\u7ebf\u7a0b\uff0c \u5b83\u4eec\u5171\u4eab\u8be5\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\uff0c \u800c\u591a\u8fdb\u7a0b\u6709\u4e0d\u540c\u7684\u5730\u5740\u7a7a\u95f4\uff09\u3002 2\u300b\u7ebf\u7a0b\u6bd4\u8fdb\u7a0b\u66f4\u8f7b\u91cf\u7ea7\uff0c\u6bd4\u8fdb\u7a0b\u66f4\u5bb9\u6613\u521b\u5efa\uff0c\u4e5f\u66f4\u5bb9\u6613\u64a4\u9500\u3002 3\u300b\u82e5\u5b58\u5728\u5927\u91cf\u7684\u8ba1\u7b97\u548cI/O\u5904\u7406\uff0c\u62e5\u6709\u591a\u7ebf\u7a0b\u5141\u8bb8\u8fd9\u4e9b\u6d3b\u52a8\u5f7c\u6b64\u91cd\u53e0\u8fdb\u884c\u30024\u300b\u5728\u591aCPU\u7cfb\u7edf\u4e2d\uff0c\u591a\u7ebf\u7a0b\u53ef\u4ee5\u5b9e\u73b0\u771f\u6b63\u7684\u5e76\u884c\u3002 \u5728\u7528\u6237\u7a7a\u95f4\u7ba1\u7406\u7ebf\u7a0b\u65f6\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u9700\u8981\u6709\u5176\u4e13\u7528\u7684 \u7ebf\u7a0b\u8868 , \u7ebf\u7a0b\u8868\uff08or thread control block, TCB\uff09\uff1a\u8ddf\u8e2a\u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0b\uff0c\u8bb0\u5f55\u5404\u4e2a\u7ebf\u7a0b\u7684\u5c5e\u6027\uff0c \u5982\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u7a0b\u5e8f\u8ba1\u6570\u5668\uff0c\u5806\u6808\u6307\u9488\uff0c\u5bc4\u5b58\u5668\u548c\u72b6\u6001\u3002 \u7ebf\u7a0b\u5207\u6362\u4e0e\u8fdb\u7a0b\u5207\u6362 \u2003\u8fdb\u7a0b\u5207\u6362\u5206\u4e24\u6b65\uff1a1.\u5207\u6362\u9875\u76ee\u5f55\u4ee5\u4f7f\u7528\u65b0\u7684\u5730\u5740\u7a7a\u95f4\uff1b2.\u5207\u6362\u5185\u6838\u6808\u548c\u786c\u4ef6\u4e0a\u4e0b\u6587\u3002 \u2003\u5bf9\u4e8elinux\u6765\u8bf4\uff0c\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u7684\u6700\u5927\u533a\u522b\u5c31\u5728\u4e8e\u5730\u5740\u7a7a\u95f4\uff0c\u5bf9\u4e8e\u7ebf\u7a0b\u5207\u6362\uff0c\u7b2c1\u6b65\u662f\u4e0d\u9700\u8981\u505a\u7684\uff0c\u7b2c2\u6b65\u662f\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u5207\u6362\u90fd\u8981\u505a\u7684\u3002\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\uff0c\u800c\u7ebf\u7a0b\u662f\u5171\u4eab\u6240\u5728\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\uff0c\u56e0\u6b64\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0b\u8fdb\u884c\u7ebf\u7a0b\u5207\u6362\u65f6\u4e0d\u6d89\u53ca\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\u8f6c\u6362. \u7ebf\u7a0b\u5b9e\u73b0\u65b9\u5f0f : 1\u300b\u5728\u7528\u6237\u7a7a\u95f4\u5b9e\u73b0\u7ebf\u7a0b \uff1a\u7279\u70b9\uff1a \u6574\u4e2a\u7ebf\u7a0b\u5305\u653e\u5165\u7528\u6237\u7a7a\u95f4\u4e2d\uff0c\u5185\u6838\u5bf9\u7ebf\u7a0b\u5305\u4e00\u65e0\u6240\u77e5\u3002\u4ece\u5185\u6838\u89d2\u5ea6\u8003\u8651\uff0c\u5c31\u662f\u6309\u6b63\u5e38\u7684\u65b9\u5f0f\u7ba1\u7406\uff0c\u5373\u5355\u7ebf\u7a0b\u8fdb\u7a0b \u3002 \u7ebf\u7a0b\u5728\u4e00\u4e2a\u8fd0\u884c\u65f6\u7cfb\u7edf\u7684\u4e0a\u5c42\u8fd0\u884c\uff0c\u8be5\u8fd0\u884c\u65f6\u7cfb\u7edf\u662f\u4e00\u4e2a\u7ba1\u7406\u7ebf\u7a0b\u7684\u8fc7\u7a0b\u7684\u96c6\u5408\u3002 \u4f18\u70b9 \uff1a 1\u3001\u7528\u6237\u7ea7\u7ebf\u7a0b\u5305\u53ef\u4ee5\u5728\u4e0d\u652f\u6301\u7ebf\u7a0b\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u5b9e\u73b0\u3002 2\u3001\u7ebf\u7a0b\u5207\u6362\u6bd4\u5185\u6838\u5feb\u66f4\u591a\uff08\u56e0\u4e3a\u4fdd\u5b58\u8be5\u7ebf\u7a0b\u72b6\u6001\u7684\u8fc7\u7a0b\u548c\u8c03\u5ea6\u7a0b\u5e8f\u90fd\u662f\u672c\u5730\u8fc7\u7a0b\uff0c\u542f\u52a8\u5b83\u4eec\u6bd4\u8fdb\u884c\u5185\u6838\u8c03\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u4e0d\u9700\u8981\u9677\u5165\u5185\u6838\uff0c\u4e0d\u9700\u8981\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u4e5f\u4e0d\u9700\u8981\u5bf9\u5185\u5b58\u9ad8\u901f\u7f13\u5b58\u8fdb\u884c\u5237\u65b0\uff0c\u4f7f\u5f97\u7ebf\u7a0b\u8c03\u5ea6\u5341\u5206\u5feb\u6377\u3002 3\u3001\u5141\u8bb8\u6bcf\u4e2a\u8fdb\u7a0b\u6709\u81ea\u5df1\u5b9a\u5236\u7684\u8c03\u5ea6\u7b97\u6cd5\u3002 \u7f3a\u70b9 : 1\u3001\u7ebf\u7a0b\u53d1\u751fI/O\u6216\u9875\u9762\u6545\u969c\u5f15\u8d77\u7684\u963b\u585e\u65f6\uff0c\u5982\u679c\u8c03\u7528\u963b\u585e\u7cfb\u7edf\u8c03\u7528\u5219\u5185\u6838\u7531\u4e8e\u4e0d\u77e5\u9053\u6709\u591a\u7ebf\u7a0b\u7684\u5b58\u5728\uff0c\u800c\u4f1a\u963b\u585e\u6574\u4e2a\u8fdb\u7a0b\u4ece\u800c\u963b\u585e\u6240\u6709\u7ebf\u7a0b; 2\u3001\u7528\u6237\u7ea7\u7ebf\u7a0b\u53ea\u80fd\u5360\u7528\u4e00\u4e2a\u6838\uff0c\u65e0\u6cd5\u505a\u5230\u5e76\u884c\u5904\u7406\uff0c\u4e0d\u80fd\u5229\u7528\u591a\u6838\u7684\u4f18\u52bf\uff1b 3\u3001\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u5f00\u59cb\u8fd0\u884c\uff0c\u90a3\u4e48\u8be5\u8fdb\u7a0b\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b\u5c31\u4e0d\u80fd\u8fd0\u884c\uff0c\u9664\u975e\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u81ea\u52a8\u653e\u5f03CPU\uff1b \u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\u5185\u90e8\uff0c\u6ca1\u6709\u65f6\u949f\u4e2d\u65ad\uff0c\u6240\u4ee5\u4e0d\u53ef\u80fd\u7528\u8f6e\u8f6c\u8c03\u5ea6\u7684\u65b9\u5f0f\u8c03\u5ea6\u7ebf\u7a0b\u3002\u9664\u975e\u67d0\u4e2a\u7ebf\u7a0b\u6309\u7167\u81ea\u5df1\u7684\u610f\u5fd7\u8fdb\u5165\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u5426\u5219\u8c03\u5ea6\u7a0b\u5e8f\u5c31\u6ca1\u6709\u4efb\u4f55\u673a\u4f1a \u3002 2\u300b\u5728\u5185\u6838\u4e2d\u5b9e\u73b0\u7ebf\u7a0b \uff1a\u7279\u70b9\uff1a\u5185\u6838\u652f\u6301\u5e76\u7ba1\u7406\u7ebf\u7a0b\uff0c\u4e0d\u518d\u9700\u8981\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u4e5f\u6ca1\u6709\u7ebf\u7a0b\u8868\u3002\u5728\u5185\u6838\u4e2d\u6709\u7528\u6765\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u8868\u3002\u5f53\u67d0\u4e2a\u7ebf\u7a0b\u5e0c\u671b\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u6216\u64a4\u9500\u4e00\u4e2a\u5df2\u6709\u7ebf\u7a0b\u65f6\uff0c\u5b83\u8fdb\u884c\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\uff0c\u8fd9\u4e2a\u7cfb\u7edf\u8c03\u7528\u901a\u8fc7\u5bf9\u7ebf\u7a0b\u8868\u7684\u66f4\u65b0\u5b8c\u6210\u7ebf\u7a0b\u521b\u5efa\u6216\u64a4\u9500\u5de5\u4f5c\u3002 \u4f18\u70b9: 1\u3001\u6240\u6709\u80fd\u591f\u963b\u585e\u7ebf\u7a0b\u7684\u8c03\u7528\u90fd\u4ee5\u7cfb\u7edf\u8c03\u7528\u7684\u5f62\u5f0f\u5b9e\u73b0\u3002 2\u3001\u5982\u679c\u67d0\u4e2a\u7ebf\u7a0b\u5f15\u8d77\u4e86\u9875\u9762\u6545\u969c\uff0c\u5185\u6838\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u68c0\u67e5\u8be5\u8fdb\u7a0b\u662f\u5426\u6709\u4efb\u4f55\u5176\u4ed6\u53ef\u8fd0\u884c\u7684\u7ebf\u7a0b\u3002 \u7f3a\u70b9: 1.\u5185\u6838\u7ea7\u7ebf\u7a0b\u5207\u6362\u4ee3\u4ef7\u66f4\u5927\u30022\u3002\u5185\u6838\u7ea7\u7ebf\u7a0b\u6570\u91cf\u6709\u9650\uff0c\u6269\u5c55\u6027\u6bd4\u4e0d\u4e0a\u7528\u6237\u7ea7\u7ebf\u7a0b\u3002 \u20033\u300b \u6df7\u5408\u5b9e\u73b0\uff1a\u4f7f\u7528\u5185\u6838\u7ea7\u7ebf\u7a0b\uff0c\u7136\u540e\u5c06\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e0e\u67d0\u4e9b\u6216\u5168\u90e8\u5185\u6838\u7ebf\u7a0b\u591a\u8def\u590d\u7528\u3002 linux \u7ebf\u7a0b\u5b9e\u73b0 \u2003\u5b9e\u73b0\u673a\u5236\u4e0ewindows\u6709\u5f88\u5927\u5dee\u5f02\uff0c\u540e\u8005\u5728\u5185\u6838\u4e2d\u63d0\u4f9b\u4e86\u4e13\u95e8\u652f\u6301\u7ebf\u7a0b\u7684\u673a\u5236\uff0c\u5e76\u79f0\u5176\u4e3a\u8f7b\u91cf\u7ea7\u7ebf\u7a0b\u3002 \u2003\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u8fdb\u7a0b\u521b\u5efa\u8fc7\u7a0b\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5728\u8c03\u7528clone()\u662f\u9700\u8981\u4f20\u9012\u4e00\u4e9b\u53c2\u6570\u6807\u5fd7\u6765\u6307\u660e\u9700\u8981\u5171\u4eab\u7684\u8d44\u6e90\u3002 pid = clone(function, stack_ptr, sharing_flags, arg) \u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5728\u5f53\u524d\u8fdb\u7a0b\u6216\u65b0\u7684\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff0c\u5177\u4f53\u4f9d\u8d56\u4e8e\u53c2\u6570sharing_flags. sharing_flags\u662f\u4e00\u4e2a\u4f4d\u56fe\uff0c\u5e38\u89c1\u7684\u4f4d\u542b\u4e49\u6709: \u5185\u6838\u7ebf\u7a0b \u72ec\u7acb\u8fd0\u884c\u5728\u5185\u6838\u7a7a\u95f4\u7684\u6807\u51c6\u8fdb\u7a0b\uff0c\u548c\u666e\u901a\u8fdb\u7a0b\u7684\u533a\u522b\u5728\u4e8e\u5185\u6838\u7ebf\u7a0b\u6ca1\u6709\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\u3002\u5b83\u4eec\u53ea\u5728\u5185\u6838\u7a7a\u95f4\u8fd0\u884c\uff0c\u4ece\u4e0d\u5207\u6362\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u548c\u666e\u901a\u8fdb\u7a0b\u4e00\u6837\uff0c\u53ef\u4ee5\u88ab\u8c03\u5ea6\u548c\u62a2\u5360\u3002","title":"\u7ebf\u7a0b"},{"location":"os/5_os/#_5","text":"\u591a\u4efb\u52a1: \u591a\u4efb\u52a1\u64cd\u4f5c\u7cfb\u7edf\u5c31\u662f\u80fd \u540c\u65f6\u5e76\u53d1\u4f4e\u4ea4\u4e92\u6267\u884c\u591a\u4e2a\u8fdb\u7a0b \u7684\u64cd\u4f5c\u7cfb\u7edf","title":"\u8fdb\u7a0b\u8c03\u5ea6"},{"location":"os/5_os/#_6","text":"\u51b3\u5b9a\u8c03\u5ea6\u7a0b\u5e8f\u4f55\u65f6\u8ba9\u4ec0\u4e48\u8fdb\u7a0b\u8fd0\u884c\uff0c\u8d1f\u8d23\u4f18\u5316\u4f7f\u7528\u5904\u7406\u5668\u65f6\u95f4\u3002 \u2003I/O\u6d88\u8017\u578b\u8fdb\u7a0b\uff1a\u8fd9\u91cc\u7684I/O\u662f\u4efb\u4f55\u7c7b\u578b\u7684\u53ef\u963b\u585e\u8d44\u6e90\uff0c\u8fdb\u7a0b\u7684\u5927\u90e8\u5206\u65f6\u95f4\u7528\u6765\u63d0\u4ea4I/O\u8bf7\u6c42\u6216\u662f\u7b49\u5f85I/O\u8bf7\u6c42\u3002 \u2003\u5904\u7406\u5668\u6d88\u8017\u578b\u8fdb\u7a0b\uff1a\u65f6\u95f4\u5927\u591a\u7528\u5728\u6267\u884c\u4ee3\u7801\u4e0a\uff0c\u9664\u975e\u88ab\u62a2\u5360\uff0c\u5426\u5219\u901a\u5e38\u4e00\u76f4\u5728\u8fd0\u884c\u3002 \u2003\u51fa\u4e8e\u7cfb\u7edf\u54cd\u5e94\u901f\u5ea6\u8003\u8651\uff0c\u8c03\u5ea6\u5668\u4f1a\u964d\u4f4e\u5904\u7406\u5668\u6d88\u8017\u578b\u8fdb\u7a0b\u7684\u8c03\u5ea6\u9891\u7387\uff0c\u800c\u5ef6\u957f\u5176\u6267\u884c\u65f6\u95f4\u3002 \u2003 \u8c03\u5ea6\u7b56\u7565\u901a\u5e38\u8981\u5728\u8fdb\u7a0b\u54cd\u5e94\u65f6\u95f4\u548c\u6700\u5927\u7cfb\u7edf\u5229\u7528\u7387(\u9ad8\u541e\u5410\u91cf)\u8fd9\u4e24\u4e2a\u76ee\u6807\u95f4\u5bfb\u6c42\u5e73\u8861 \u8fdb\u7a0b\u4f18\u5148\u7ea7\uff1alinux\u91c7\u7528\u4e86\u4e24\u79cd\u4f18\u5148\u7ea7\u8303\u56f4 \u2003nice\u503c\uff0c\u8303\u56f4[-20,19], \u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u5c0f, \u5728linux\u4e2d\uff0cnice\u503c\u4ee3\u8868\u65f6\u95f4\u7247\u6bd4\u4f8b\u3002 \u2003\u5b9e\u65f6\u4f18\u5148\u7ea7\uff0c\u9ed8\u8ba4\u8303\u56f4[0,99], \u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u4efb\u4f55\u5b9e\u65f6\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u90fd\u9ad8\u4e8e\u666e\u901a\u8fdb\u7a0b\u3002 \u65f6\u95f4\u7247 \u2003\u8868\u660e\u8fdb\u7a0b\u5728\u88ab\u62a2\u5360\u524d\u6240\u80fd\u6301\u7eed\u8fd0\u884c\u7684\u65f6\u95f4","title":"\u8fdb\u7a0b\u8c03\u5ea6\u7b56\u7565"},{"location":"os/5_os/#linux","text":"\u5b8c\u5168\u516c\u5e73\u8c03\u5ea6(CFS): \u5176\u662f\u4e00\u4e2a\u9488\u5bf9\u666e\u901a\u8fdb\u7a0b\u7684\u8c03\u5ea6\u7c7b\u3002 \u2003 \u8bbe\u8ba1\u7406\u5ff5 :\u8fdb\u7a0b\u8c03\u5ea6\u7684\u6548\u679c\u5982\u540c\u7cfb\u7edf\u5177\u5907\u4e00\u4e2a\u7406\u60f3\u4e2d\u7684\u5b8c\u7f8e\u591a\u4efb\u52a1\u5904\u7406\u5668\uff0c\u5728\u8fd9\u79cd\u7cfb\u7edf\u4e2d\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u5c06\u83b7\u5f971/n\u7684\u5904\u7406\u5668\u65f6\u95f4(n\u662f\u53ef\u8fd0\u884c\u7684\u8fdb\u7a0b\u6570\u91cf)\u3002 \u2003 \u5185\u90e8\u903b\u8f91 :CFS\u5e76\u6ca1\u6709\u76f4\u63a5\u5206\u914d\u65f6\u95f4\u7247\u5230\u8fdb\u7a0b\uff0c\u800c\u662f\u5c06\u5904\u7406\u5668\u7684\u4f7f\u7528\u6bd4\u5212\u5206\u7ed9\u4e86\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u6bd4\u4f8b\u4f1a\u53d7\u5230nice\u503c\u7684\u5f71\u54cd\uff1b\u6bcf\u4e2a\u8fdb\u7a0b\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\uff0c\u5faa\u73af\u8f6e\u8f6c\uff0cCFS\u7136\u540e\u9009\u62e9\u8fd0\u884c\u6700\u5c11(vruntime\u6700\u5c0f)\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u8fd0\u884c\u8fdb\u7a0b\u3002 \u2003 \u5177\u4f53\u5b9e\u73b0 : CFS\u4f7f\u7528\u7ea2\u9ed1\u6811\u6765\u7ec4\u7ec7\u53ef\u8fd0\u884c\u8fdb\u7a0b\u961f\u5217\uff0c\u5e76\u7528\u5176\u8fc5\u901f\u627e\u5230\u6700\u5c0fvruntime\u503c\u7684\u8fdb\u7a0b\u3002 vruntime \uff0c\u865a\u8fd0\u884c\u65f6\uff0c \u5206\u914d\u7ed9\u8fdb\u7a0b\u7684\u8fd0\u884c\u65f6\u95f4=\u8c03\u5ea6\u5468\u671f*\u8fdb\u7a0b\u6743\u91cd / \u6240\u6709\u53ef\u8fd0\u884c\u8fdb\u7a0b\u6743\u91cd\u4e4b\u548c (\u5f0f1) vruntime = \u5b9e\u9645\u8fd0\u884c\u65f6\u95f4*1024/\u8fdb\u7a0b\u6743\u91cd = \u8c03\u5ea6\u5468\u671f*1024/\u6240\u6709\u53ef\u8fd0\u884c\u8fdb\u7a0b\u6743\u91cd\u4e4b\u548c (\u5f0f2\uff0c1024\u662fnice\u4e3a0\u7684\u8fdb\u7a0b\u7684\u6743\u91cd) \u2003\u867d\u7136\u8fdb\u7a0b\u7684\u6743\u91cd\u4e0d\u540c\uff0c\u4f46vruntime\u7684\u589e\u957f\u901f\u5ea6\u662f\u76f8\u540c\u7684\uff1b\u5bf9\u4e8evruntime\u8f83\u5c0f\u7684\u8fdb\u7a0b\uff0c\u8bf4\u660e\u5176\u4e4b\u524d\u8fd0\u884c\u65f6\u95f4\u77ed\uff0c\u4f1a\u88ab\u4f18\u5148\u8c03\u5ea6\uff0c \u8fd9\u5373CFS\u516c\u5e73\u8c03\u5ea6\u7684\u7531\u6765\u3002 \u4f11\u7720\u548c\u5524\u9192 \u2003\u7b49\u5f85\u961f\u5217\u662f\u7531\u7b49\u5f85\u67d0\u4e9b\u4e8b\u4ef6\u53d1\u751f\u7684\u8fdb\u7a0b\u7ec4\u6210\u7684\u7b80\u5355\u94fe\u8868\u3002 \u4e0a\u4e0b\u6587\u5207\u6362: \u4ece\u4e00\u4e2a\u53ef\u6267\u884c\u8fdb\u7a0b\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u53ef\u6267\u884c\u8fdb\u7a0b \u7531shcedule()\u8c03\u7528context_switch()\u5b8c\u6210\u4e24\u9879\u57fa\u672c\u5de5\u4f5c: \u628a\u865a\u62df\u5185\u5b58\u4ece\u4e0a\u4e00\u4e2a\u8fdb\u7a0b\u6620\u5c04\u5207\u6362\u5230\u65b0\u8fdb\u7a0b\uff1b\u4ece\u4e0a\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5904\u7406\u5668\u72b6\u6001\u5207\u6362\u5230\u65b0\u8fdb\u7a0b\u7684\u5904\u7406\u5668\u72b6\u6001\uff0c\u5305\u62ec\u4fdd\u5b58\u3001\u6062\u590d\u6808\u4fe1\u606f\u548c\u5bc4\u5b58\u5668\u4fe1\u606f\u3002 need_resched: \u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u5305\u542b\u4e00\u4e2aneed_resched\u6807\u5fd7\uff0c\u7528\u6765\u8868\u660e\u662f\u5426\u9700\u8981\u91cd\u65b0\u6267\u884c\u4e00\u6b21\u8c03\u5ea6\u3002 \u7528\u6237\u62a2\u5360\uff1a\u4ece\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\u7528\u6237\u7a7a\u95f4\u6216\u8005\u4ece\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u8fd4\u56de\u7528\u6237\u7a7a\u95f4\u65f6\uff0c\u5982\u679cneed_resched\u88ab\u8bbe\u7f6e\uff0c\u4f1a\u5bfc\u81f4schedule()\u88ab\u8c03\u7528\uff0c\u5185\u6838\u4f1a\u9009\u62e9\u4e00\u4e2a\u5176\u4ed6\u66f4\u5408\u9002\u7684\u8fdb\u7a0b\u8fd0\u884c\u3002 \u5185\u6838\u62a2\u5360\uff1a\u6bcf\u4e2a\u8fdb\u7a0b\u7684thread_info\u4e2d\u5f15\u5165\u4e86preemept_count\u8ba1\u6570\u5668\uff0c\u521d\u59cb\u4e3a0\uff0c\u4f7f\u7528\u9501\u65f6\uff0c+1\uff0c\u91ca\u653e\u9501\u65f6\uff0c-1\uff1b\u5f53\u4e3a0\u65f6\uff0c\u5185\u6838\u5c31\u53ef\u6267\u884c\u62a2\u5360\u3002 \u5185\u6838\u62a2\u5360\u4f1a\u53d1\u751f\u5728: \u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u6b63\u5728\u6267\u884c\uff0c\u4e14\u8fd4\u56de\u5185\u6838\u7a7a\u95f4\u4e4b\u524d\uff1b \u5185\u6838\u4ee3\u7801\u5177\u6709\u62a2\u5360\u6027\u7684\u65f6\u5019\uff1b \u5185\u6838\u4e2d\u7684\u4efb\u52a1\u663e\u793a\u8c03\u7528schedule\uff1b \u5982\u679c\u5185\u6838\u4e2d\u7684\u4efb\u52a1\u963b\u585e \u5b9e\u65f6\u8c03\u5ea6\u7b56\u7565","title":"Linux\u8fdb\u7a0b\u8c03\u5ea6\u7b97\u6cd5"},{"location":"os/5_os/#_7","text":"\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u7684\u5c40\u9650: \u4e2d\u65ad\u5904\u7406\u6d41\u7a0b\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u4e0a\u534a\u90e8\u662f\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u5b8c\u6210\u5bf9\u786c\u4ef6\u4e2d\u65ad\u7684\u5373\u65f6\u54cd\u5e94\uff1b\u4e0b\u534a\u90e8\u6267\u884c\u4e0e\u4e2d\u65ad\u5904\u7406\u5bc6\u5207\u76f8\u5173\u4f46\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u672c\u8eab\u4e0d\u6267\u884c\u7684\u5de5\u4f5c\u3002\u4e0b\u534a\u90e8\u4e00\u822c\u5728\u4e2d\u65ad\u5904\u7406\u8fd4\u56de\u540e\u5c31\u7acb\u5373\u6267\u884c\uff0c\u800c\u4e14\u6267\u884c\u671f\u95f4\u5141\u8bb8\u54cd\u5e94\u6240\u6709\u4e2d\u65ad\u3002 \u8fd9\u79cd\u8bbe\u8ba1\u53ef\u4f7f\u7cfb\u7edf\u5904\u4e8e\u4e2d\u65ad\u5c4f\u853d\u72b6\u6001\u7684\u65f6\u95f4\u5c3d\u53ef\u80fd\u77ed\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u7cfb\u7edf\u7684\u54cd\u5e94\u65f6\u95f4\u3002 \u4e0b\u534a\u90e8\u5b9e\u73b0\u673a\u5236\uff1a\u8f6f\u4e2d\u65ad\u3001tasklet\u3001\u5de5\u4f5c\u961f\u5217","title":"\u4e2d\u65ad"},{"location":"os/5_os/#_8","text":"","title":"\u5185\u6838\u540c\u6b65"},{"location":"os/5_os/#_9","text":"\u5982\u679c\u67d0\u4e2a\u7cfb\u7edf\u652f\u6301\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u52a8\u4f5c\uff08Action\uff09\u540c\u65f6\u5b58\u5728\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7cfb\u7edf\u5c31\u662f\u4e00\u4e2a\u5e76\u53d1(concurrent)\u7cfb\u7edf\u3002\u5982\u679c\u67d0\u4e2a\u7cfb\u7edf\u652f\u6301\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u52a8\u4f5c\u540c\u65f6\u6267\u884c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7cfb\u7edf\u5c31\u662f\u4e00\u4e2a\u5e76\u884c(parallel)\u7cfb\u7edf\u3002 \u2003\u5728\u5e76\u53d1\u7a0b\u5e8f\u4e2d\u53ef\u4ee5\u540c\u65f6\u62e5\u6709\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u7ebf\u7a0b\u3002\u8fd9\u610f\u5473\u7740\uff0c\u5982\u679c\u7a0b\u5e8f\u5728\u5355\u6838\u5904\u7406\u5668\u4e0a\u8fd0\u884c\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u7ebf\u7a0b\u5c06\u4ea4\u66ff\u5730\u6362\u5165\u6216\u8005\u6362\u51fa\u5185\u5b58\u3002\u8fd9\u4e9b\u7ebf\u7a0b\u662f\u540c\u65f6\u201c\u5b58\u5728\u201d\u7684\u2014\u2014\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5904\u4e8e\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u67d0\u4e2a\u72b6\u6001\u3002\u5982\u679c\u7a0b\u5e8f\u80fd\u591f\u5e76\u884c\u6267\u884c\uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u662f\u8fd0\u884c\u5728\u591a\u6838\u5904\u7406\u5668\u4e0a\u3002\u6b64\u65f6\uff0c\u7a0b\u5e8f\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5c06\u5206\u914d\u5230\u4e00\u4e2a\u72ec\u7acb\u7684\u5904\u7406\u5668\u6838\u4e0a\uff0c\u56e0\u6b64\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c\u3002 \u2003\u5e76\u884c\u201d\u6982\u5ff5\u662f\u201c\u5e76\u53d1\u201d\u6982\u5ff5\u7684\u4e00\u4e2a\u5b50\u96c6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u53ef\u4ee5\u7f16\u5199\u4e00\u4e2a\u62e5\u6709\u591a\u4e2a\u7ebf\u7a0b\u6216\u8005\u8fdb\u7a0b\u7684\u5e76\u53d1\u7a0b\u5e8f\uff0c\u4f46\u5982\u679c\u6ca1\u6709\u591a\u6838\u5904\u7406\u5668\u6765\u6267\u884c\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4ee5\u5e76\u884c\u65b9\u5f0f\u6765\u8fd0\u884c\u4ee3\u7801\u3002","title":"\u5e76\u884c&amp;\u5e76\u53d1"},{"location":"os/5_os/#_10","text":"\u4e34\u754c\u533a: \u5bf9\u5171\u4eab\u5185\u5b58\u8fdb\u884c\u8bbf\u95ee\u7684\u7a0b\u5e8f\u7247\u6bb5\u79f0\u4f5c\u4e34\u754c\u533a\u57df(critical region)\u6216\u4e34\u754c\u533a(critical section)\u3002 \u82e5\u4e24\u4e2a\u8fdb\u7a0b\u4e0d\u53ef\u80fd\u540c\u65f6\u5904\u4e8e\u4e34\u754c\u533a\u57df\uff0c\u5c31\u80fd\u907f\u514d\u7ade\u4e89\u6761\u4ef6\u3002 \u7ade\u6001\u6761\u4ef6\uff08race condition\uff09\uff1a\u5373\u591a\u4e2a\u8fdb\u7a0b\u8bfb\u5199\u67d0\u4e9b\u5171\u4eab\u6570\u636e\uff0c\u800c\u6700\u540e\u7684\u7ed3\u679c\u53d6\u51b3\u4e8e\u8fdb\u7a0b\u8fd0\u884c\u7684\u7cbe\u786e\u65f6\u5e8f\u3002 \u540c\u6b65: \u4e3a\u4e86\u5728\u907f\u514d\u7ade\u4e89\u6761\u4ef6\u7684\u540c\u65f6\uff0c\u4fdd\u8bc1\u4f7f\u7528\u5171\u4eab\u6570\u636e\u7684\u5e76\u53d1\u8fdb\u7a0b\u80fd\u6b63\u786e\u548c\u9ad8\u6548\u5730\u534f\u4f5c\uff0c\u9700\u8981\u6ee1\u8db34\u4e2a\u6761\u4ef6\uff1a 1\u3001\u4efb\u4f55\u4e24\u4e2a\u8fdb\u7a0b\u4e0d\u80fd\u540c\u65f6\u5904\u4e8e\u5176\u4e34\u754c\u533a\u3002 2\u3001\u4e0d\u8981\u5bf9CPU\u7684\u901f\u5ea6\u548c\u6570\u91cf\u505a\u4efb\u4f55\u5047\u8bbe\u3002 3\u3001\u4e34\u754c\u533a\u5916\u8fd0\u884c\u7684\u8fdb\u7a0b\u4e0d\u5f97\u963b\u585e\u5176\u4ed6\u8fdb\u7a0b\u3002 4\u3001\u4e0d\u5f97\u4f7f\u8fdb\u7a0b\u65e0\u9650\u671f\u7b49\u5f85\u8fdb\u5165\u4e34\u754c\u533a\u3002 \u9700\u8981\u8fdb\u7a0b\u540c\u6b65\u539f\u56e0","title":"\u540c\u6b65"},{"location":"os/5_os/#_11","text":"\u52a0\u9501: \u8bbe\u7f6e\u4e00\u4e2a\u9501\u53d8\u91cf\uff0c\u53ef\u4ee5\u8bbe\u521d\u59cb\u4e3a0\uff0c\u6709\u8fdb\u7a0b\u60f3\u8fdb\u5165\u4e34\u754c\u533a\u65f6\uff0c\u5148\u5bf9\u9501\u53d8\u91cf\u6d4b\u8bd5\uff0c\u4e3a0\u5219\u8fdb\uff0c\u8fdb\u5165\u540e\u5c06\u5176\u8bbe\u4e3a1\u30020\u8868\u793a\u4e34\u754c\u533a\u6ca1\u8fdb\u7a0b\uff0c1\u4ee3\u8868\u5df2\u6709\u8fdb\u7a0b\u8fdb\u5165\u4e34\u754c\u533a\u3002\u4f46\u662f\u4ecd\u5b58\u5728\u95ee\u9898\uff0c\u5f53\u8fdb\u7a0ba\u628a\u9501\u53d8\u91cf\u8bbe\u4e3a1\u4e4b\u524d\u6070\u597d\u53c8\u6709\u8fdb\u7a0bb\u8fdb\u5165\u4e34\u754c\u533a\uff0c\u4e34\u754c\u533a\u5c06\u67092\u4e2a\u8fdb\u7a0b\u3002\u5bf9\u4e8e\u6b64\u95ee\u9898\uff0c\u4e00\u822c\u5bf9\u83b7\u5f97\u9501\u548c\u6539\u53d8\u9501\u53d8\u91cf\u91c7\u7528\u539f\u5b50\u64cd\u4f5c\uff0c\u5982\u4e0b\u9762\u7684TSL\u6307\u4ee4\u3002 TSL RX, LOCK\uff1a\u6d4b\u8bd5\u5e76\u52a0\u9501\uff0c\u5c06\u4e00\u4e2a\u5185\u5b58\u5b57\u8bfb\u53d6\u5230\u5bc4\u5b58\u5668RX\u4e2d\uff0c\u7136\u540e\u5728\u8be5\u5185\u5b58\u5730\u5740\u8bbe\u7f6e\u4e00\u4e2a\u975e0\u503c\uff0c\u5e76\u4fdd\u8bc1\u8bfb\u5199\u64cd\u4f5c\u4e0d\u53ef\u5206\u5272\u3002\u5176\u5b83cpu\u4e0d\u80fd\u5728TSL\u6307\u4ee4\u7ed3\u675f\u4e4b\u524d\u8bbf\u95ee\u8be5\u5185\u5b58\u5b57\u3002 \u6267\u884cTSL\u6307\u4ee4\uff08test and set lock\uff09\u7684cpu\u5c06\u9501\u4f4f\u5185\u5b58\u603b\u7ebf\uff0c\u9632\u6b62\u5176\u5b83cpu\u5728\u6b64\u6307\u4ee4\u5b8c\u6210\u524d\u8bbf\u95ee\u5185\u5b58\u3002 \u5177\u4f53\u65b9\u6cd5\uff1a\u4f7f\u7528\u4e00\u4e2a\u5171\u4eab\u53d8\u91cflock\uff0clock\u4e3a0\u65f6\u4efb\u4f55\u8fdb\u7a0b\u90fd\u80fd\u4f7f\u7528TSL\u6307\u4ee4\uff0c\u5e76\u5c06lock\u8bbe\u4e3a1\uff0c\u8bfb\u5199\u5171\u4eab\u5185\u5b58\uff1b\u64cd\u4f5c\u7ed3\u675f\u540e\uff0c\u5229\u7528move\u6307\u4ee4\u5c06lock\u91cd\u65b0\u8bbe\u4e3a0. \uff08\u53ef\u4f7f\u7528XCHG\u6307\u4ee4\u66ff\u4ee3TSL\uff0c\u5b83\u539f\u5b50\u6027\u5730\u4ea4\u6362\u4e24\u4e2a\u4f4d\u7f6e\u7684\u5185\u5bb9\u3002\uff09 \u6b7b\u9501 \u9501\u7684\u4e89\u7528 \u2003\u6307\u5f53\u9501\u6b63\u5728\u88ab\u5360\u7528\u65f6\uff0c\u6709\u5176\u4ed6\u8fdb\u7a0b\u8bd5\u56fe\u83b7\u5f97\u8be5\u9501\uff1b\u5f53\u6709\u591a\u4e2a\u8fdb\u7a0b\u90fd\u5728\u7b49\u5f85\u83b7\u5f97\u8be5\u9501\u65f6\uff0c\u9501\u5c31\u5904\u4e8e\u9ad8\u5ea6\u4e89\u7528\u72b6\u6001\u3002 \u2003\u9501\u7684\u4f5c\u7528\u4f7f\u5f97\u7a0b\u5e8f\u4ee5\u4e32\u884c\u65b9\u5f0f\u8bbf\u95ee\u8d44\u6e90\uff0c\u4f1a\u964d\u4f4e\u7cfb\u7edf\u6027\u80fd\u3002\u88ab\u9ad8\u5ea6\u4e89\u7528\u7684\u9501(\u9891\u7e41\u88ab\u5360\u7528\u6216\u957f\u65f6\u95f4\u88ab\u5360\u7528)\u4f1a\u6210\u4e3a\u7cfb\u7edf\u7684\u74f6\u9888\u3002 \u2003\u5f53\u9501\u4e89\u7528\u4e25\u91cd\u65f6\uff0c\u52a0\u9501\u592a\u7c97(\u52a0\u9501\u7684\u7c97\u7c92\u5ea6\u6307\u88ab\u4fdd\u62a4\u7684\u6570\u636e\u89c4\u6a21\uff0c\u8fc7\u7c97\u7684\u9501\u7528\u6765\u4fdd\u62a4\u5927\u5757\u6570\u636e\uff0c\u7cbe\u7ec6\u7684\u9501\u5219\u4fdd\u62a4\u8f83\u5c0f\u7684\u5143\u7d20)\u4f1a\u964d\u4f4e\u6269\u5c55\u6027\uff1b\u9501\u4e89\u7528\u4e0d\u660e\u663e\u65f6\uff0c\u52a0\u9501\u592a\u7ec6\u4f1a\u52a0\u5927\u7cfb\u7edf\u5f00\u9500\uff0c\u5e26\u6765\u6d6a\u8d39\u3002","title":"\u9501"},{"location":"os/5_os/#_12","text":"\u539f\u5b50\u64cd\u4f5c: \u4fdd\u8bc1\u6307\u4ee4\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u88ab\u6253\u65ad\uff0c\u5185\u6838\u63d0\u4f9b\u4e86\u4e24\u79cd\u539f\u5b50\u64cd\u4f5c\u63a5\u53e3\uff0c\u5206\u522b\u9488\u5bf9\u6574\u6570\u548c\u5355\u72ec\u7684\u4f4d\u8fdb\u884c\u64cd\u4f5c\u3002 \u81ea\u65cb\u9501 \uff1a\u662f\u6307\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u8bd5\u56fe\u83b7\u53d6\u9501\u7684\u65f6\u5019\uff0c\u5982\u679c\u9501\u5df2\u7ecf\u88ab\u5176\u5b83\u7ebf\u7a0b\u83b7\u53d6\uff0c\u90a3\u4e48\u8be5\u7ebf\u7a0b\u5c06\u5faa\u73af\u7b49\u5f85\uff0c\u7136\u540e\u4e0d\u65ad\u7684\u5224\u65ad\u9501\u662f\u5426\u80fd\u591f\u88ab\u6210\u529f\u83b7\u53d6\uff0c\u76f4\u5230\u83b7\u53d6\u5230\u9501\u624d\u4f1a\u9000\u51fa\u5faa\u73af\u3002\u81ea\u65cb\u9501\u4f1a\u9020\u6210\u5fd9\u7b49\u5f85\u3002\u56e0\u6b64 \u81ea\u65cb\u9501 \u4e00\u822c\u9002\u7528\u4e8e\u52a0\u9501\u65f6\u95f4\u4e0d\u957f\uff0c\u4e14\u4ee3\u7801\u4e0d\u4f1a\u7761\u7720(\u4f8b\u5982\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f) \uff0c\u53cd\u4e4b\u4f7f\u7528 \u4fe1\u53f7\u91cf \u66f4\u5408\u9002 \u3002 \u2003\u8bfb/\u5199\u81ea\u65cb\u9501\uff1a\u4e00\u4e2a\u6216\u591a\u4e2a\u4efb\u52a1\u53ef\u4ee5\u5e76\u53d1\u5730\u6301\u6709\u8bfb\u8005\u9501\uff0c\u4f46\u540c\u65f6\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u4efb\u52a1\u6301\u6709\u5199\u9501\u3002\u56e0\u6b64 \u4e0d\u80fd\u5c06\u4e00\u4e2a\u9501\u7531\u8bfb\u9501\u5347\u7ea7\u4e3a\u5199\u9501\uff0c\u5426\u5219\u5982\u679c\u8bfb\u9501\u6ca1\u6709\u88ab\u91ca\u653e\uff0c\u5199\u9501\u5c06\u4f1a\u81ea\u65cb\uff0c\u7b49\u5f85\u6240\u6709\u8bfb\u8005\u91ca\u653e\u9501\uff0c\u5305\u62ec\u5176\u672c\u8eab\uff0c\u4ece\u800c\u9020\u6210\u6b7b\u9501 \u3002 \u4fe1\u53f7\u91cf \u2003\u4fe1\u53f7\u91cf\u4e0d\u4f1a\u7981\u6b62\u5185\u6838\u62a2\u5360\uff0c\u6301\u6709\u4fe1\u53f7\u91cf\u7684\u4ee3\u7801\u53ef\u4ee5\u88ab\u62a2\u5360; \u4e92\u65a5\u4f53(mutex) \u5b9e\u73b0\u4e92\u65a5\u7684\u7279\u5b9a\u7761\u7720\u9501\uff0c\u5176\u884c\u4e3a\u548c\u4f7f\u7528\u8ba1\u65701\u7684\u4e92\u65a5\u4fe1\u53f7\u91cf\u7c7b\u4f3c\uff0c\u4f46\u64cd\u4f5c\u63a5\u53e3\u66f4\u7b80\u5355\uff0c\u9650\u5236\u6027\u66f4\u5f3a\uff0c\u9002\u5e94\u4e8e\u5b9a\u5411\u6027\u5f3a\u7684\u573a\u666f\u3002 \u8fd9\u91cc\u7684\u4e92\u65a5\u4f53\u4e5f\u5305\u62ec\u4fe1\u53f7\u91cf\uff1b\u4e2d\u65ad\u4e0a\u4e0b\u6587\u4e2d\u4e0d\u80fd\u7761\u7720\uff0c\u56e0\u6b64\u53ea\u80fd\u4f7f\u7528\u81ea\u65cb\u9501 \u5b8c\u6210\u53d8\u91cf completion variable: \u5982\u679c\u5728\u5185\u6838\u4e2d \u4e00\u4e2a\u4efb\u52a1\u9700\u8981\u53d1\u51fa\u4fe1\u53f7\u901a\u77e5\u53e6\u4e00\u4efb\u52a1\u53d1\u751f\u4e86\u7279\u5b9a\u4e8b\u4ef6 \uff0c\u5229\u7528\u5b8c\u6210\u53d8\u91cf\u662f\u4f7f\u4e24\u4e2a\u4efb\u52a1\u5f97\u4ee5\u540c\u6b65\u7684\u7b80\u5355\u65b9\u6cd5\u3002\u5982\u679c\u4e00\u4e2a\u4efb\u52a1\u8981\u6267\u884c\u4e00\u4e9b\u5de5\u4f5c\u65f6\uff0c\u53e6\u4e00\u4e2a\u4efb\u52a1\u5c31\u4f1a\u5728\u5b8c\u6210\u53d8\u91cf\u4e0a\u7b49\u5f85\u3002\u5f53\u8fd9\u4e2a\u4efb\u52a1\u5b8c\u6210\u5de5\u4f5c\u65f6\uff0c\u5c31\u4f1a\u4f7f\u7528\u5b8c\u6210\u53d8\u91cf\u53bb\u5524\u9192\u5728\u7b49\u5f85\u7684\u4efb\u52a1\u3002 \u2003\u4f8b\u5982\u5f53\u5b50\u8fdb\u7a0b\u6267\u884c\u6216\u9000\u51fa\u65f6\uff0cvfork()\u7cfb\u7edf\u8c03\u7528\u4f7f\u7528\u8fd9\u4e9b\u5b8c\u6210\u53d8\u91cf\u6765\u5524\u9192\u7236\u8fdb\u7a0b\u3002","title":"\u5185\u6838\u540c\u6b65\u65b9\u6cd5"},{"location":"os/5_os/#_13","text":"","title":"\u5185\u5b58\u7ba1\u7406"},{"location":"os/5_os/#_14","text":"\u4ee532\u4f4dx86 CPU\u4e3a\u4f8b: 1\u3001x86 CPU\u91c7\u7528\u4e86\u6bb5\u9875\u5f0f\u5730\u5740\u6620\u5c04\u6a21\u578b\u3002\u8fdb\u7a0b\u4ee3\u7801\u4e2d\u7684\u5730\u5740\u4e3a\u903b\u8f91\u5730\u5740\uff0c \u7ecf\u8fc7\u6bb5\u9875\u5f0f\u5730\u5740\u6620\u5c04(\u5148\u6620\u5c04\u5230\u7ebf\u6027\u7a7a\u95f4\uff0c\u5f97\u5230\u7ebf\u6027\u5730\u5740\uff0c\u518d\u6839\u636e\u9875\u8868\u8fdb\u884c\u6620\u5c04)\u540e\uff0c\u624d\u771f\u6b63\u8bbf\u95ee\u7269\u7406\u5185\u5b58\u3002 2\u3001Linux\u7b80\u5316\u4e86\u5206\u6bb5\u673a\u5236,\u4f7f\u5f97\u865a\u62df\u5730\u5740\u4e0e\u7ebf\u6027\u5730\u5740\u603b\u662f\u4e00\u81f4,\u56e0\u6b64,Linux\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e5f\u4e3a0\uff5e4G,\u5e76\u88ab\u5206\u4e3a\u4e24\u90e8\u5206\u3002 \u6700\u9ad8\u76841GB(\u4ece\u865a\u62df\u5730\u57400xC0000000\u52300xFFFFFFFF)\u4f9b\u5185\u6838\u4f7f\u7528\uff0c\u79f0\u4e3a\u201c\u5185\u6838\u7a7a\u95f4\u201d; \u4f4e\u4f4d\u7f6e3GB(\u4ece\u865a\u62df\u5730\u57400x00000000\u52300xBFFFFFFF\uff09\uff0c\u4f9b\u5404\u4e2a\u8fdb\u7a0b\u4f7f\u7528\uff0c\u79f0\u4e3a\u201c\u7528\u6237\u7a7a\u95f4\u3002 \u56e0\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u8fdb\u5165\u5185\u6838\uff0c\u56e0\u6b64\uff0cLinux\u5185\u6838\u7531\u7cfb\u7edf\u5185\u7684\u6240\u6709\u8fdb\u7a0b\u5171\u4eab\u3002 \u4e8e\u662f\uff0c\u4ece\u5177\u4f53\u8fdb\u7a0b\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u67094GB\u7684\u865a\u62df\u7a7a\u95f4, \u5176\u4e2d3GB\u7528\u6237\u7a7a\u95f4\u4e3a\u5404\u8fdb\u7a0b\u72ec\u4eab\uff0c 1GB\u5185\u6838\u7a7a\u95f4\u4e3a\u6240\u6709\u8fdb\u7a0b\u548c\u5185\u6838\u5171\u4eab\u3002 \u7528\u6237\u8fdb\u7a0b\u6700\u5927\u53ef\u4ee5\u8bbf\u95ee3GB\uff0c\u5185\u6838\u4ee3\u7801\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709\u7269\u7406\u5185\u5b58\u3002 3\u3001\u5185\u6838\u7a7a\u95f4\u4e2d\u5b58\u653e\u7684\u662f\u5185\u6838\u4ee3\u7801\u548c\u6570\u636e\uff0c\u800c\u8fdb\u7a0b\u7684\u7528\u6237\u7a7a\u95f4\u4e2d\u5b58\u653e\u7684\u662f\u7528\u6237\u7a0b\u5e8f\u7684\u4ee3\u7801\u548c\u6570\u636e\u3002 \u4e0d\u7ba1\u662f\u5185\u6838\u7a7a\u95f4\u8fd8\u662f\u7528\u6237\u7a7a\u95f4\uff0c\u5b83\u4eec\u90fd\u5904\u4e8e\u865a\u62df\u7a7a\u95f4\u4e2d\u3002 4\u3001\u867d\u7136\u5185\u6838\u7a7a\u95f4\u5360\u636e\u4e86\u6bcf\u4e2a\u865a\u62df\u7a7a\u95f4\u4e2d\u7684\u6700\u9ad81GB\uff0c\u4f46\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u5374\u603b\u662f\u4ece\u6700\u4f4e\u5730\u5740(0x00000000)\u5f00\u59cb\u3002 \u5bf9\u5185\u6838\u7a7a\u95f4\u6765\u8bf4\uff0c\u5730\u5740\u6620\u5c04\u662f\u7ebf\u6027\u6620\u5c04\uff0c0xC0000000(\u53733GB)\u5c31\u662f\u7269\u7406\u5730\u5740\u4e0e\u7ebf\u6027\u5730\u5740\u4e4b\u95f4\u7684\u4f4d\u79fb\u91cf, \u5728Linux\u6e90\u7801\u4e2d\u53eb\u505aPAGE_OFFSET\u3002 5\u3001\u5b9e\u9645\u4e2d\uff0c\u5185\u6838\u5730\u5740\u7a7a\u95f40xc0000000 ~ 0xfffffff\u76841GB\u5730\u5740\u7a7a\u95f4\u5e76\u975e\u5168\u90e8\u7528\u6765\u8fdb\u884c\u7b80\u5355\u7684\u5730\u5740\u6620\u5c04\uff0c \u800c\u662f\u5212\u5206\u4e3a\u4e09\u90e8\u5206ZONE_DMA(<16MB), ZONE_NORMAL(16~896MB)\u548c ZONE_HIGHMEM(>=896MB), \u5176\u4e2dZONE_HIGHMEM\u79f0\u4f5c\u9ad8\u7aef\u5185\u5b58\uff0c\u5171128MB\u3002 6\u3001\u5f53\u5185\u6838\u60f3\u8bbf\u95ee\u9ad8\u4e8e896MB\u7684\u7269\u7406\u5185\u5b58\u65f6\uff0c\u4f1a\u4ece0xF8000000 ~ 0xFFFFFFFF\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u5185 \u627e\u4e00\u6bb5\u76f8\u5e94\u5927\u5c0f\u7a7a\u95f2\u7684\u903b\u8f91\u5730\u5740\u7a7a\u95f4\uff0c\u501f\u7528\u8fd9\u6bb5\u903b\u8f91\u5730\u5740\u7a7a\u95f4\uff0c\u5efa\u7acb\u6620\u5c04\u5230\u60f3\u8bbf\u95ee\u7684\u5b9e\u9645\u7269\u7406\u5185\u5b58\u3002 7\u3001task_struct\u4e2d\u7684PGD\u6210\u5458\u5b58\u653e\u7740\u6307\u5411\u5f53\u524d\u8fdb\u7a0b\u9875\u76ee\u5f55\u7684\u6307\u9488\uff0c\u5f53\u8be5\u8fdb\u7a0b\u88ab\u8c03\u5ea6\u8fdb\u5165\u8fd0\u884c\u6001\u65f6\uff0c \u5185\u6838\u5c06\u8be5\u8fdb\u7a0b\u7684\u7684\u9875\u76ee\u5f55\u8868\u7684\u7269\u7406\u5730\u5740\u88c5\u5165CR3\u5bc4\u5b58\u5668\uff0c\u56e0\u6b64 \u4e0d\u540c\u8fdb\u7a0b\u8bbf\u95ee\u865a\u62df\u7a7a\u95f4\u4e2d\u7684\u76f8\u540c\u5730\u5740\uff0c \u7ecf\u7531\u4e0d\u540c\u7684\u9875\u76ee\u5f55\u8868\u6620\u5c04\u5230\u4e0d\u540c\u7684\u7269\u7406\u5730\u5740\uff0c\u800c\u4e0d\u4f1a\u6df7\u6dc6\u3002 \u5185\u5b58\u7a7a\u95f4\u7684\u4e09\u79cd\u63cf\u8ff0\u5355\u4f4d: \u9875\uff1a \u533a\uff1a \u5b57\u8282\uff1a\u5185\u6838\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u4e09\u79cd\u51fd\u6570\u6216\u8005\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\u5185\u5b58\uff0c\u4e0d\u8fc7kmalloc\u548cvmalloc\u662f\u5206\u914d\u7684\u662f\u5185\u6838\u7684\u5185\u5b58,malloc\u5206\u914d\u7684\u662f\u7528\u6237\u7684\u5185\u5b58\u3002 malloc\\kmalloc\\vmalloc: 1\u3001 \u7531malloc()\u8fd4\u56de\u7684\u9875\u5728\u8fdb\u7a0b\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5185\u662f\u8fde\u7eed\u7684\uff0c\u4f46\u662f\u5e76\u4e0d\u4fdd\u8bc1\u5b83\u4eec\u5728\u7269\u7406RAM\u4e2d\u4e5f\u662f\u8fde\u7eed\u7684\uff1b kmalloc()\u51fd\u6570\u786e\u4fdd\u9875\u5728\u7269\u7406\u5730\u5740\u4e0a\u662f\u8fde\u7eed\u7684\uff0c\u865a\u62df\u5730\u5740\u81ea\u7136\u4e5f\u662f\u8fde\u7eed\u7684\uff1b vmalloc()\u51fd\u6570\u53ea\u786e\u4fdd\u9875\u5728\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5185\u662f\u8fde\u7eed\u7684\uff0c\u5b83\u901a\u8fc7\u5206\u914d\u975e\u8fde\u7eed\u7684\u7269\u7406\u5185\u5b58\u5757\uff0c \u518d\u4fee\u6b63\u9875\u8868\uff0c\u628a\u5185\u5b58\u6620\u5c04\u5230\u903b\u8f91\u5730\u5740\u7a7a\u95f4\u7684\u8fde\u7eed\u533a\u57df\u4e2d\uff0c\u6765\u5b9e\u73b0\u76ee\u7684\u3002 2\u3001vmalloc\u6bd4kmalloc\u8981\u6162\u3002\u5c3d\u7ba1\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u624d\u9700\u8981\u7269\u7406\u4e0a\u8fde\u7eed\u7684\u5185\u5b58\u5757\uff0c\u4f46\u662f\u5f88\u591a\u5185\u6838\u4ee3\u7801\u90fd\u7528kmalloc\u6765\u83b7\u5f97\u5185\u5b58\uff0c \u800c\u4e0d\u662fvmalloc\u3002\u8fd9\u4e3b\u8981\u662f\u51fa\u4e8e\u6027\u80fd\u7684\u8003\u8651\u3002vmalloc\u51fd\u6570\u4e3a\u4e86\u628a\u7269\u7406\u5185\u5b58\u4e0a\u4e0d\u8fde\u7eed\u7684\u9875\u8f6c\u6362\u4e3a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e0a\u8fde\u7eed\u7684\u9875\uff0c \u5fc5\u987b\u4e13\u95e8\u5efa\u7acb\u9875\u8868\u9879\u3002\u7cdf\u7cd5\u7684\u662f\uff0c\u901a\u8fc7vmalloc\u83b7\u5f97\u7684\u9875\u5fc5\u987b\u4e00\u4e2a\u4e2a\u5730\u8fdb\u884c\u6620\u5c04\uff0c\u56e0\u4e3a\u5b83\u4eec\u7269\u7406\u4e0a\u662f\u4e0d\u8fde\u7eed\u7684\uff0c \u8fd9\u5c31\u4f1a\u5bfc\u81f4\u6bd4\u76f4\u63a5\u5185\u5b58\u6620\u5c04\u5927\u5f97\u591a\u7684TLB(Traslation Lookaside Buffer, \u7528\u4ee5\u7f13\u5b58\u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u7684\u6620\u5c04\u5173\u7cfb)\u6296\u52a8\uff0c vmalloc\u4ec5\u5728\u4e0d\u5f97\u5df2\u65f6\u624d\u4f1a\u7528\uff0c\u4f8b\u5982\u4e3a\u4e86\u83b7\u5f97\u5927\u5757\u5185\u5b58\u65f6\uff0c\u800c\u7269\u7406\u7a7a\u95f4\u4e0d\u5b58\u5728\u5982\u6b64\u5927\u7684\u8fde\u7eed\u5185\u5b58\u3002 \u5185\u5b58\u788e\u7247 \u5185\u5b58\u788e\u7247\u901a\u5e38\u5206\u4e3a\u5185\u90e8\u788e\u7247\u548c\u5916\u90e8\u788e\u7247\uff1a 1\u3001\u5185\u90e8\u788e\u7247\u662f\u7531\u4e8e\u91c7\u7528\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u5206\u533a\uff0c\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u4e0d\u80fd\u5b8c\u5168\u4f7f\u7528\u5206\u7ed9\u5b83\u7684\u56fa\u5b9a\u5185\u5b58\u533a\u57df\u65f6\u5c31\u4ea7\u751f\u4e86\u5185\u90e8\u788e\u7247\uff0c\u901a\u5e38\u5185\u90e8\u788e\u7247\u96be\u4ee5\u5b8c\u5168\u907f\u514d\uff1b 2\u3001\u5916\u90e8\u788e\u7247\u662f\u7531\u4e8e\u67d0\u4e9b\u672a\u5206\u914d\u7684\u8fde\u7eed\u5185\u5b58\u533a\u57df\u592a\u5c0f\uff0c\u4ee5\u81f3\u4e8e\u4e0d\u80fd\u6ee1\u8db3\u4efb\u610f\u8fdb\u7a0b\u7684\u5185\u5b58\u5206\u914d\u8bf7\u6c42\uff0c\u4ece\u800c\u4e0d\u80fd\u88ab\u8fdb\u7a0b\u5229\u7528\u7684\u5185\u5b58\u533a\u57df\u3002 \u2003\u907f\u514d\u5916\u90e8\u788e\u7247\u7684\u65b9\u6cd5\u6709\u4e24\u79cd: 1\u3001 \u5229\u7528\u5206\u9875\u5355\u5143\u628a\u4e00\u7ec4\u975e\u8fde\u7eed\u7684\u7a7a\u95f2\u9875\u6620\u5c04\u5230\u8fde\u7eed\u7684\u7ebf\u6027\u5730\u5740 (\u4f7f\u7528\u5730\u5740\u8f6c\u6362\u6280\u672f\uff0c\u628a\u975e\u8fde\u7eed\u7684\u7269\u7406\u5730\u5740\u8f6c\u6362\u6210\u8fde\u7eed\u7684\u7ebf\u6027\u5730\u5740); \u73b0\u5728\u666e\u904d\u91c7\u7528\u7684\u6bb5\u9875\u5f0f\u5185\u5b58\u5206\u914d\u65b9\u5f0f\u5c31\u662f\u5c06\u8fdb\u7a0b\u7684\u5185\u5b58\u533a\u57df\u5206\u4e3a\u4e0d\u540c\u7684\u6bb5\uff0c\u7136\u540e\u5c06\u6bcf\u4e00\u6bb5\u7531\u591a\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u9875\u7ec4\u6210\u3002 \u901a\u8fc7\u9875\u8868\u673a\u5236\uff0c\u4f7f\u6bb5\u5185\u7684\u9875\u53ef\u4ee5\u4e0d\u5fc5\u8fde\u7eed\u5904\u4e8e\u540c\u4e00\u5185\u5b58\u533a\u57df\uff0c\u4ece\u800c\u51cf\u5c11\u4e86\u5916\u90e8\u788e\u7247 \uff0c\u7136\u800c\u540c\u4e00\u9875\u5185\u4ecd\u7136\u53ef\u80fd\u5b58\u5728\u5c11\u91cf\u7684\u5185\u90e8\u788e\u7247\uff0c\u53ea\u662f\u4e00\u9875\u7684\u5185\u5b58\u7a7a\u95f4\u672c\u5c31\u8f83\u5c0f\uff0c\u4ece\u800c\u4f7f\u53ef\u80fd\u5b58\u5728\u7684\u5185\u90e8\u788e\u7247\u4e5f\u8f83\u5c11\u3002 2\u3001\u5f00\u53d1\u4e00\u79cd\u9002\u5f53\u7684\u6280\u672f\u6765 \u8bb0\u5f55\u73b0\u5b58\u7684\u7a7a\u95f2\u7684\u8fde\u7eed\u9875\u5757\u7684\u60c5\u51b5\uff0c\u4ee5\u5c3d\u91cf\u907f\u514d\u4e3a\u6ee1\u8db3\u5bf9\u5c0f\u5757\u7684\u8bf7\u6c42\u800c\u5206\u5272\u5927\u7684\u7a7a\u95f2\u5757 ; \u5982\u4f19\u4f34\u7cfb\u7edf\u548cslab\u9ad8\u901f\u7f13\u5b58\u3002 \u4f19\u4f34\u7cfb\u7edf : \u628a\u7cfb\u7edf\u4e2d\u8981\u7ba1\u7406\u7684\u7269\u7406\u5185\u5b58\u6309\u7167\u9875\u9762\u4e2a\u6570\u5206\u6210\u4e8611\u4e2a\u7ec4\uff0c\u5bf9\u5e94\u5927\u5c0f\u4e0d\u540c\u7684\u8fde\u7eed\u5185\u5b58\u5757\uff0c\u6bcf\u7ec4\u4e2d\u7684\u5185\u5b58\u5757\u5927\u5c0f\u90fd\u76f8\u7b49\uff0c \u4e3a2\u7684\u5e42\u6b21\u4e2a\u7269\u7406\u9875\u3002\u90a3\u4e48\u7cfb\u7edf\u4e2d\u5c31\u5b58\u57282^0 ~ 2^10\u8fd9\u4e4811\u79cd\u5927\u5c0f\u4e0d\u540c\u7684\u5185\u5b58\u5757\uff0c\u5bf9\u5e94\u5185\u5b58\u5757\u5927\u5c0f4KB ~ 4MB\u3002 \u5185\u6838\u752811\u4e2a\u94fe\u8868\u6765\u7ba1\u740611\u79cd\u5927\u5c0f\u4e0d\u540c\u7684\u5185\u5b58\u5757\u3002 \u5f53\u5206\u914d\u5185\u5b58\u65f6\uff0c\u4f1a\u4f18\u5148\u4ece\u9700\u8981\u5206\u914d\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e0a\u67e5\u627e\u7a7a\u95f2\u5185\u5b58\u5757\uff0c\u5f53\u53d1\u73b0\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5757\u90fd\u5df2\u7ecf\u88ab\u4f7f\u7528\u540e\uff0c \u90a3\u4e48\u4f1a\u4ece\u66f4\u5927\u7ea7\u7684\u5185\u5b58\u5757\u4e0a\u5206\u914d\u4e00\u5757\u5185\u5b58\uff0c\u5e76\u4e14\u5206\u6210\u4e00\u534a\u7ed9\u6211\u4eec\u4f7f\u7528\uff0c\u5269\u4f59\u7684\u4e00\u534a\u91ca\u653e\u5230\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e0a\u3002 \u6bd4\u5982\u6211\u4eec\u60f3\u8981\u5206\u914d\u4e00\u4e2a8KB\u5927\u5c0f\u7684\u5185\u5b58\uff0c\u4f46\u662f\u53d1\u73b0\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5df2\u7ecf\u6ca1\u6709\u4e86\uff0c\u4f19\u4f34\u7cfb\u7edf\u4f1a\u4ece16KB\u7684\u94fe\u8868\u4e2d \u67e5\u627e\u4e00\u4e2a\u7a7a\u95f2\u5185\u5b58\u5757\uff0c\u5206\u6210\u4e24\u4e2a8KB\u5927\u5c0f\uff0c\u628a\u5176\u4e2d\u7684\u4e00\u4e2a8KB\u5927\u5c0f\u8fd4\u56de\u7ed9\u7533\u8bf7\u8005\u4f7f\u7528\uff0c \u5269\u4e0b\u76848KB\u653e\u52308KB\u5bf9\u5e94\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e2d\u8fdb\u884c\u7ba1\u7406 \u5f53\u91ca\u653e\u5185\u5b58\u65f6\uff0c\u4f1a\u626b\u63cf\u5bf9\u5e94\u5927\u5c0f\u7684\u5185\u5b58\u5757\u94fe\u8868\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u5730\u5740\u80fd\u591f\u8fde\u7eed\u5728\u4e00\u8d77\u7684\u5185\u5b58\u5757\uff0c\u5982\u679c\u53d1\u73b0\u6709\uff0c \u90a3\u4e48\u5c31\u5408\u5e76\u4e24\u4e2a\u5185\u5757\u653e\u7f6e\u5230\u66f4\u5927\u4e00\u7ea7\u7684\u5185\u5b58\u5757\u94fe\u8868\u4e0a\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u6bd4\u5982\u6211\u4eec\u91ca\u653e8KB\u5927\u5c0f\u7684\u5185\u5b58\uff0c \u90a3\u4e48\u4f1a\u4ece\u5bf9\u5e94\u7684\u94fe\u8868\u626b\u63cf\u662f\u5426\u6709\u80fd\u591f\u5408\u5e76\u7684\u5185\u5b58\u5757\uff0c\u5982\u679c\u6709\u53e6\u4e00\u4e2a8KB\u5927\u5c0f\u7684\u5185\u5b58\u548c\u6211\u4eec\u4f7f\u7528\u7684\u5185\u5b58\u5730\u5740\u8fde\u7eed\uff0c \u90a3\u4e48\u5c31\u5408\u5e76\u5b83\u4eec\u7ec4\u6210\u4e00\u4e2a16KB\u5927\u5c0f\u7684\u5185\u5b58\u5757\uff0c\u7136\u540e\u63a5\u7740\u626b\u63cf16KB\u5927\u5c0f\u7684\u5185\u5b58\u5757\u94fe\u8868\uff0c\u7ee7\u7eed\u67e5\u627e\u5408\u5e76\u7684\u53ef\u80fd\u3002 slab\u5206\u914d\u5668 \u5185\u6838\u6808 \u5206\u914d\u51fd\u6570\u9009\u62e9","title":"\u7406\u89e3\u5185\u5b58\u7a7a\u95f4"},{"location":"os/5_os/#_15","text":"UNIX\u6587\u4ef6\u7cfb\u7edf Unix\u4f7f\u7528\u56db\u79cd\u548c\u6587\u4ef6\u7cfb\u7edf\u76f8\u5173\u7684\u62bd\u8c61\u6982\u5ff5\uff1a\u6587\u4ef6\u3001\u76ee\u5f55\u9879\u3001\u7d22\u5f15\u8282\u70b9\u548c\u6302\u8f7d\u70b9(mounting point)\u3002 \u6587\u4ef6\u5171\u4eab \u548c\u8fdb\u7a0b\u76f8\u5173\u7684\u6570\u636e\u7ed3\u6784 files_struct: \u7531\u8fdb\u7a0b\u63cf\u8ff0\u7b26(struct task_struct)\u4e2d\u7684files\u76ee\u5f55\u9879\u6307\u5411\uff0c\u6240\u6709\u4e0e\u5355\u4e2a\u8fdb\u7a0b\u76f8\u5173\u7684\u4fe1\u606f(\u5982\u6253\u5f00\u7684\u6587\u4ef6\u53ca\u6587\u4ef6\u63cf\u8ff0\u7b26)\uff1b fs_struct: \u7531\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u4e2d\u7684fs\u57df\u6307\u5411\uff0c\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u548c\u8fdb\u7a0b\u76f8\u5173\u7684\u4fe1\u606f\uff0c \u8be5\u7ed3\u6784\u4fdd\u5b58\u4e86\u5f53\u524d\u8fdb\u7a0b\u7684\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u548c\u6839\u76ee\u5f55\uff1b namespace\u7ed3\u6784\u4f53: \u7531\u8fdb\u7a0b\u63cf\u8ff0\u7b26\u4e2d\u7684namespace\u57df\u6307\u5411\uff0clinux 2.4\u7248\u5185\u6838\u4ee5\u540e\uff0c\u5355\u8fdb\u7a0b\u547d\u540d\u7a7a\u95f4\u88ab\u52a0\u5165\u5230\u5185\u6838\u4e2d\uff0c\u5b83\u4f7f\u5f97\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u5728\u7cfb\u7edf\u4e2d\u90fd\u770b\u5230\u552f\u4e00\u7684\u5b89\u88c5\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u4ec5\u662f\u552f\u4e00\u7684\u6839\u76ee\u5f55\uff0c\u800c\u4e14\u662f\u552f\u4e00\u7684\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u7ed3\u6784\u3002","title":"\u865a\u62df\u6587\u4ef6\u7cfb\u7edf"},{"location":"os/5_os/#io","text":"\u5757\u8bbe\u5907 \u2003\u8bbe\u5907\u6700\u5c0f\u5bfb\u5740\u5355\u5143\u79f0\u4e3a\u6247\u533a\uff0c\u5927\u5c0f\u4e3a2\u7684\u6574\u6570\u500d\uff0c\u4e00\u822c\u4e3a512\u5b57\u8282\uff0c\u6216\u8005\u7c7b\u4f3cCD-ROM\u7684\u6247\u533a\u4e3a2KB\u3002 \u2003\u5757\u5728\u7269\u7406\u4e0a\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\u6570\u636e\u7247\uff0c\u5728\u903b\u8f91\u4e0a\u662f\u6587\u4ef6\u7cfb\u7edf\u7684\u62bd\u8c61\u2014\u2014\u53ea\u80fd\u57fa\u4e8e\u5757\u6765\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff1b\u5185\u6838\u6267\u884c\u7684\u6240\u6709\u78c1\u76d8\u64cd\u4f5c\u90fd\u662f\u57fa\u4e8e\u5757\u7684\uff0c\u5176\u5927\u5c0f\u4e3a\u591a\u4e2a\u6247\u533a\uff0c\u4e14\u4e3a2\u7684\u6574\u6570\u500d\uff0c\u5e76\u4e14\u4e0d\u80fd\u8d85\u8fc7\u4e00\u4e2a\u9875\u7684\u957f\u5ea6\u3002 \u7f13\u51b2\u533a\u4e0e\u7f13\u51b2\u533a\u5934 \u2003\u5f53\u4e00\u4e2a\u5757\u88ab\u8c03\u5165\u5185\u5b58\u540e\uff0c\u5373\u5728\u8bfb\u5165\u540e\u6216\u7b49\u5f85\u5199\u51fa\u65f6\uff0c\u5b83\u8981\u5b58\u50a8\u5728\u4e00\u4e2a\u7f13\u51b2\u533a\u4e2d\uff0c\u6bcf\u4e2a\u7f13\u51b2\u533a\u4e0e\u4e00\u4e2a\u5757\u5bf9\u5e94\uff0c\u5b83\u76f8\u5f53\u4e8e\u662f\u78c1\u76d8\u5757\u5728\u5185\u5b58\u4e2d\u7684\u8868\u793a\u3002 \u2003\u6bcf\u4e2a\u7f13\u51b2\u533a\u90fd\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u63cf\u8ff0\u7b26\uff0c\u7528buffer_head\u7ed3\u6784\u4f53\u63cf\u8ff0\uff0c\u79f0\u4f5c\u7f13\u51b2\u533a\u5934\uff0c\u5305\u542b\u4e00\u4e9b\u63a7\u5236\u4fe1\u606f(\u5982\u5757\u5c5e\u4e8e\u54ea\u4e00\u4e2a\u5757\u8bbe\u5907\uff0c\u5757\u5bf9\u5e94\u54ea\u4e2a\u7f13\u51b2\u533a)\u3002 \u7f13\u51b2\u533a\u5934\u7684\u76ee\u7684\u5728\u4e8e\u63cf\u8ff0\u78c1\u76d8\u5757\u548c\u7269\u7406\u5185\u5b58\u7f13\u51b2\u533a(\u5728\u7279\u5b9a\u9875\u9762\u4e0a\u7684\u5b57\u8282\u5e8f\u5217)\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb \u3002 bio\u7ed3\u6784\u4f53 \u2003\u4e0ebuffer_head\u533a\u522b\uff1a bio\u7ed3\u6784\u4f53\u4ee3\u8868\u7684\u662fI/O\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5305\u542b\u5185\u5b58\u4e2d\u7684\u591a\u4e2a\u9875(bio\u672c\u8eab\u4fbf\u4e8e\u6267\u884c\u5206\u6563-\u96c6\u4e2d\u7684\u5757I/O\u64cd\u4f5c\uff0c\u64cd\u4f5c\u7684\u6570\u636e\u6765\u81ea\u591a\u4e2a\u7269\u7406\u9875)\uff1b \u800cbuffer_head\u7ed3\u6784\u4f53\u4ee3\u8868\u7684\u662f\u4e00\u4e2a\u7f13\u51b2\u533a\uff0c\u63cf\u8ff0\u7684\u4ec5\u4ec5\u662f\u78c1\u76d8\u4e2d\u7684\u4e00\u4e2a\u5757\uff1b bio\u76f8\u8f83buffer_head\uff0c\u5c5e\u4e8e\u8f7b\u91cf\u7ea7\u7ed3\u6784\u4f53\uff0c\u56e0\u4e3a\u5b83\u53ea\u9700\u5305\u542b\u5757I/O\u64cd\u4f5c\u6240\u9700\u7684\u4fe1\u606f\u5373\u53ef\uff0c\u65e0\u9700\u5305\u542b\u4e0e\u7f13\u51b2\u533a\u672c\u8eab\u76f8\u5173\u7684\u4e0d\u5fc5\u8981\u4fe1\u606f\u3002 I/O\u63a7\u5236\u65b9\u5f0f I/O\u8c03\u5ea6 \u2003\u8bf7\u6c42\u961f\u5217: \u5757\u8bbe\u5907\u5c06\u5b83\u4eec\u6302\u8d77\u7684\u5757I/O\u8bf7\u6c42\u4fdd\u5b58\u5728\u8bf7\u6c42\u961f\u5217\u4e2d(requests_struct)\uff0c\u8be5\u961f\u5217\u5305\u542b\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u53ca\u76f8\u5173\u63a7\u5236\u4fe1\u606f\uff1b\u961f\u5217\u4e2d\u7684\u8bf7\u6c42(request)\u7531\u591a\u4e2abio\u7ed3\u6784\u4f53\u6784\u6210\u3002 \u2003I/O\u8c03\u5ea6\u7a0b\u5e8f\u5c06 \u78c1\u76d8I/O\u8d44\u6e90 \u5206\u914d\u7ed9\u7cfb\u7edf\u4e2d\u6240\u6709\u6302\u8d77\u7684 \u5757I/O\u8bf7\u6c42\uff0c\u5206\u914d\u662f\u901a\u8fc7\u5c06\u8bf7\u6c42\u961f\u5217\u4e2d\u6302\u8d77\u7684\u8bf7\u6c42\u5408\u5e76\u548c\u6392\u5e8f\u6765\u5b8c\u6210\u7684\uff0c\u4ee5\u6b64\u6765\u51cf\u5c11\u78c1\u76d8\u5bfb\u5740\u65f6\u95f4\u3002 \u2003\u8bf7\u6c42\u5408\u5e76: \u5c06\u4e24\u4e2a\u6216\u591a\u4e2a\u8bf7\u6c42\u5408\u5e76\u6210\u4e00\u4e2a\u65b0\u8bf7\u6c42\uff0c\u5982\u591a\u4e2a\u8bf7\u6c42\u8bbf\u95ee\u7684\u6247\u533a\u4f4d\u7f6e\u76f8\u90bb\uff1b \u2003\u8bf7\u6c42\u6392\u5e8f: \u5bf9\u4e8e\u64cd\u4f5c\u78c1\u76d8\u6247\u533a\u4f4d\u7f6e\u76f8\u8fd1\u7684\u4e0d\u540c\u8bf7\u6c42\uff0c\u5176\u5728\u961f\u5217\u4e2d\u7684\u4f4d\u7f6e\u5e94\u8be5\u4e5f\u76f8\u90bb\u3002 \u6574\u4e2a\u8bf7\u6c42\u961f\u5217\u6309\u8981\u8bbf\u95ee\u7684\u6247\u533a\u7684\u589e\u957f\u65b9\u5411\u6709\u5e8f\u6392\u5217\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u7f29\u77ed\u5355\u6b21\u8bf7\u6c42\u7684\u5bfb\u5740\u65f6\u95f4\uff0c\u8fd8\u53ef\u4ee5\u4fdd\u6301\u78c1\u76d8\u5934\u4ee5\u76f4\u7ebf\u65b9\u5411\u79fb\u52a8\uff0c\u7f29\u77ed\u4e86\u6240\u6709\u8bf7\u6c42\u7684\u78c1\u76d8\u5bfb\u5740\u65f6\u95f4\u3002\u8fd9\u79cdI/O\u8c03\u5ea6\u6392\u5e8f\u7b97\u6cd5\u79f0\u4f5c\u7535\u68af\u8c03\u5ea6\u3002 I/O\u8c03\u5ea6\u7b97\u6cd5 \u2003linus\u7535\u68af linux \u5185\u6838\u4ece2.6\u7248\u8d77\uff0c\u5e9f\u5f03\u4e86linus\u7535\u68af\u6cd5\uff0c\u63d0\u4f9b\u4e86\u4e0b\u9762\u56db\u79cd\u8c03\u5ea6\u7a0b\u5e8f\u3002 \u2003 \u6700\u7ec8\u671f\u9650I/O\u8c03\u5ea6\u7a0b\u5e8f \u2003 \u9884\u6d4bI/O\u8c03\u5ea6\u7a0b\u5e8f : \u5982\u679c\u6309\u7167\u6700\u7ec8\u671f\u9650I/O\u8c03\u5ea6\u7a0b\u5e8f\uff0c\u5f53\u7cfb\u7edf\u5904\u4e8e\u7e41\u5fd9\u7684\u5199\u64cd\u4f5c\u671f\u95f4\uff0c\u6bcf\u6b21\u63d0\u4ea4\u8bfb\u8bf7\u6c42\uff0cI/O\u8c03\u5ea6\u7a0b\u5e8f\u90fd\u4f1a\u8fc5\u901f\u5904\u7406\u8bfb\u8bf7\u6c42\uff0c\u7136\u540e\u8fd4\u56de\u518d\u5bfb\u5740\u8fdb\u884c\u8bfb\u64cd\u4f5c\uff0c\u8fd9\u65e0\u7591\u4f1a\u635f\u5bb3\u5168\u5c40\u541e\u5410\u91cf\u3002 \u2003 \u5b8c\u5168\u516c\u6b63\u7684\u6392\u961fI/O\u8c03\u5ea6\u7a0b\u5e8f(Complete Fair Queuing, CFQ) : \u6bcf\u4e00\u4e2a\u63d0\u4ea4I/O\u8bf7\u6c42\u7684\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u81ea\u5df1\u7684\u8bf7\u6c42\u961f\u5217\uff0c\u961f\u5217\u5185\u90e8\u7684\u64cd\u4f5c\u4e0e\u6700\u7ec8\u671f\u9650I/O\u8c03\u5ea6\u7a0b\u5e8f\u76f8\u540c\uff1bCFQ\u4ee5\u65f6\u95f4\u7247\u8f6e\u8f6c\u8c03\u5ea6\u961f\u5217\uff0c\u4ece\u6bcf\u4e2a\u961f\u5217\u4e2d\u9009\u53d6\u8bf7\u6c42\u6570\uff0c\u7136\u540e\u8fdb\u5165\u4e0b\u4e00\u6b21\u8c03\u5ea6\u3002 \u4ece\u800c\u5728\u8fdb\u7a0b\u7ea7\u522b\u7ef4\u6301\u4e86\u516c\u5e73 \u3002 \u2003 \u7a7a\u64cd\u4f5c\u7684I/O\u8c03\u5ea6\u7a0b\u5e8f : \u53ea\u6267\u884c\u5408\u5e76\uff0c\u4e0d\u8fdb\u884c\u6392\u5e8f\uff0c\u7ef4\u62a4\u8bf7\u6c42\u961f\u5217\u4ee5\u8fd1\u4e4eFIFO\u7684\u987a\u5e8f\u6392\u5217\uff0c\u5176\u662f\u4e13\u4e3a\u968f\u673a\u8bbf\u95ee\u8bbe\u5907\u800c\u8bbe\u8ba1\u7684\uff0c\u5b83\u4eec\u5bf9\u4e8e\u5bfb\u5740\u7684\u9700\u6c42\u5f88\u5c0f\uff0c\u65e0\u9700\u6392\u5e8f\u3002","title":"\u5757/IO"},{"location":"os/5_os/#_16","text":"\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7531\u8fdb\u7a0b\u53ef\u5bfb\u5740\u7684\u865a\u62df\u5185\u5b58\u7ec4\u6210\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u8fde\u7eed\u7a7a\u95f4\uff0c\u5bf9\u4e8e32\u4f4d\u673a\u5668\uff0c\u8fdb\u7a0b\u53ef\u5bfb\u5740\u7684\u865a\u62df\u7a7a\u95f4\u5927\u5c0f\u4e3a4GB\u3002 \u2003\u5185\u5b58\u533a\u57df: \u53ef\u88ab\u8bbf\u95ee\u7684\u5408\u6cd5\u5730\u5740\u7a7a\u95f4\u3002 \u5185\u5b58\u63cf\u8ff0\u7b26: mm_struct\u7ed3\u6784\u4f53\uff0c\u5305\u542b\u4e86\u548c\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u6709\u5173\u7684\u5168\u90e8\u4fe1\u606f\u3002\u4e3b\u8981\u7684\u6210\u5458\u6709: 1\u3001mm_users: \u8bb0\u5f55\u6b63\u5728\u4f7f\u7528\u8be5\u5730\u5740\u7684\u8fdb\u7a0b\u6570\u76ee\uff0c\u5bf9\u4e8e\u5171\u4eab\u5730\u5740\u7a7a\u95f4\u7684\u7ebf\u7a0b\u800c\u8a00\uff0c\u8fd9\u4e2a\u503c\u7b49\u4e8e\u7ebf\u7a0b\u6570\u91cf\u3002 2\u3001mm_count: mm_struct\u7ed3\u6784\u4f53\u7684\u4e3b\u5f15\u7528\u8ba1\u6570\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u591a\u4e2a\u7ebf\u7a0b\u800c\u8a00\uff0c\u5176\u503c\u4e00\u76f4\u4e3a1\u3002\u5f53mm_user\u51cf\u4e3a0\u65f6\uff0cmm_count\u4e5f\u5c06\u4e3a0\uff0c\u8bf4\u660e\u6ca1\u6709\u6307\u5411\u8be5\u7ed3\u6784\u4f53\u7684\u5f15\u7528\u4e86\uff0cmm_struct\u5c06\u88ab\u64a4\u9500\u3002 3\u3001 mmap/mm_rb: \u5206\u522b\u4ee5\u94fe\u8868\u5f62\u5f0f\u548c\u7ea2\u9ed1\u6811\u5f62\u5f0f\u63cf\u8ff0\u5730\u5740\u7a7a\u95f4\u5185\u7684\u5168\u90e8\u5185\u5b58\u533a\u57df \u3002 \u524d\u8005\u9002\u5408\u904d\u5386\uff0c\u540e\u8005\u9002\u5408\u67e5\u627e\uff0c\u5982\u5728\u5730\u5740\u7a7a\u95f4\u4e2d\u5b9a\u4f4d\u7279\u5b9a\u5185\u5b58\u533a\u57df\u3002 4\u3001mm_list\uff1alist_head\u7c7b\u578b\u7684\u53cc\u5411\u94fe\u8868\uff0c\u6240\u6709\u7684mm_struct\u90fd\u901a\u8fc7\u6b64\u6210\u5458\u94fe\u63a5\u5728\u4e00\u8d77\uff1b\u94fe\u8868\u7684\u9996\u5143\u7d20\u662finit_mm\u5185\u5b58\u63cf\u8ff0\u7b26\uff0c\u4ee3\u8868init\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u3002\u64cd\u4f5c\u8be5\u94fe\u8868\u65f6\uff0c\u9700\u8981\u4f7f\u7528mm_lock\u9501\u6765\u9632\u6b62\u5e76\u53d1\u8bbf\u95ee\u3002 \u5206\u914d\u5185\u5b58\u63cf\u8ff0\u7b26 \u5185\u6838\u7ebf\u7a0b \u865a\u62df\u5185\u5b58\u533a\u57df \u2003\u6bcf\u4e2avm_areas_struct\u5bf9\u8c61\u90fd\u5bf9\u5e94\u4e8e\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u552f\u4e00\u533a\u95f4\uff0c\u540c\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4\u5185\u7684\u4e0d\u540c\u5185\u5b58\u533a\u57df\u4e0d\u80fd\u91cd\u53e0\uff1bvm_areas_struct\u4e2d\u7684vm_mm\u6210\u5458\u6307\u5411\u4e0e\u5176\u76f8\u5173\u7684mm_struct\uff1b\u4e0d\u540c\u7684\u72ec\u7acb\u8fdb\u7a0b\u5c06\u540c\u4e00\u4e2a\u6587\u4ef6\u6620\u5c04\u5230\u5730\u5740\u7a7a\u95f4\u65f6\uff0c\u5c06\u5404\u81ea\u6709\u4e00\u4e2avm_areas_struct\u7ed3\u6784\u4f53\u6765\u6807\u8bb0\u81ea\u5df1\u7684\u5185\u5b58\u533a\u57df\uff1b\u800c\u4e24\u4e2a\u7ebf\u7a0b\u5171\u4eab\u5730\u5740\u7a7a\u95f4\u65f6\uff0c\u5b83\u4eec\u4e5f\u540c\u65f6\u5171\u4eab\u5176\u4e2d\u6240\u6709\u7684vm_areas_struct\u7ed3\u6784\u4f53\u3002 \u2003 \u5f53\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u4e00\u4e2a\u865a\u62df\u5730\u5740\u65f6\uff0c\u9996\u5148\u5fc5\u987b\u5c06\u865a\u62df\u5730\u5740\u8f6c\u5316\u6210\u7269\u7406\u5730\u5740\uff0c\u8fd9\u4e2a\u662f\u901a\u8fc7\u5206\u9875\u6765\u5b8c\u6210\u7684\uff0clinux\u91c7\u7528\u4e09\u7ea7\u9875\u8868\uff1b \u2003TLB(Traslation Lookaside Buffer), \u4e00\u4e2a\u5c06\u865a\u62df\u5730\u5740\u6620\u5c04\u5230\u7269\u7406\u5730\u5740\u7684\u786c\u4ef6\u7f13\u5b58\uff0c\u5f53\u8bbf\u95ee\u865a\u62df\u5730\u5740\u65f6\uff0c\u5904\u7406\u5668\u9996\u5148\u68c0\u67e5TLB\u662f\u5426\u7f13\u5b58\u547d\u4e2d\uff0c\u5982\u679c\u662f\uff0c\u76f4\u63a5\u8fd4\u56de\u7269\u7406\u5730\u5740\uff0c\u5426\u5219\u518d\u901a\u8fc7\u9875\u8868\u6620\u5c04\u5230\u7269\u7406\u5730\u5740\u3002","title":"\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4"},{"location":"os/5_os/#_17","text":"\u9875\u9ad8\u901f\u7f13\u5b58 \u662flinux\u5185\u6838\u5b9e\u73b0\u78c1\u76d8\u7f13\u5b58\uff0c\u4e3b\u8981\u7528\u6765\u51cf\u5c11\u5bf9\u78c1\u76d8\u7684I/O\u64cd\u4f5c\uff0c\u901a\u8fc7\u628a\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u7f13\u5b58\u5230\u7269\u7406\u5185\u5b58\u4e2d\uff0c\u628a\u5bf9\u78c1\u76d8\u7684\u8bbf\u95ee\u8f6c\u53d8\u4e3a\u5bf9\u5185\u5b58\u7684\u8bbf\u95ee\u3002\u5176\u539f\u56e0\u4e3b\u8981\u662f\uff1a 1\u3001\u4ece\u5185\u5b58\u8bbf\u95ee\u6570\u636e\u7684\u901f\u5ea6\u8fdc\u5feb\u4e8e\u78c1\u76d8\u3002 2\u3001\u6570\u636e\u4e00\u65e6\u88ab\u8bbf\u95ee\uff0c\u77ed\u671f\u5185\u5c31\u5f88\u6709\u53ef\u80fd\u518d\u88ab\u8bbf\u95ee\u3002\u8fd9\u79cd\u77ed\u65f6\u671f\u5185\u96c6\u4e2d\u8bbf\u95ee\u4e00\u7247\u6570\u636e\u7684\u539f\u7406\u79f0\u4e3a \u4e34\u65f6\u5c40\u90e8\u539f\u7406 \u3002 \u5199\u7f13\u5b58 \u5f53\u8fdb\u7a0b\u5199\u78c1\u76d8\u65f6\uff0c\u4e00\u822c\u6709\u4e09\u79cd\u7b56\u7565\uff1a \u2003\u4e0d\u7f13\u5b58\uff0c\u76f4\u63a5\u5199\u5230\u78c1\u76d8\uff0c\u540c\u65f6\u4f7f\u7f13\u5b58\u5931\u6548\uff0c\uff08\u4e00\u822c\u4e0d\u4f7f\u7528\u8fd9\u79cd\u7b56\u7565\uff09\uff1b \u2003\u5199\u900f\u7f13\u5b58(write-through cache),\u5199\u64cd\u4f5c\u5c06\u81ea\u52a8\u66f4\u65b0\u5185\u5b58\u7f13\u5b58\uff0c\u540c\u65f6\u66f4\u65b0\u78c1\u76d8\u6587\u4ef6\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u7f13\u5b58\u4e00\u81f4\u6027\uff0c\u5373\u7f13\u5b58\u6570\u636e\u65f6\u523b\u548c\u78c1\u76d8\u6570\u636e\u4fdd\u5b58\u4e00\u81f4\uff1b \u2003\u56de\u5199(write-back)\uff0c\u7a0b\u5e8f\u6267\u884c\u64cd\u4f5c\u76f4\u63a5\u5199\u5230\u7f13\u5b58\uff0c\u78c1\u76d8\u6570\u636e\u4e0d\u4f1a\u7acb\u523b\u66f4\u65b0\uff0c\u800c\u662f\u5c06\u9875\u9ad8\u901f\u7f13\u5b58\u4e2d\u88ab\u5199\u5165\u7684\u9875\u9762\u6807\u8bb0\u6210\u2018dirty\u2019\uff0c\u5e76\u52a0\u5165\u5230\u810f\u9875\u94fe\u8868\u4e2d\u3002\u7136\u540e\u7531\u56de\u5199\u8fdb\u7a0b\u5468\u671f\u5730\u5c06\u810f\u9875\u94fe\u8868\u4e2d\u7684\u9875\u5199\u56de\u5230\u78c1\u76d8\u4e2d\uff0c\u4ece\u800c\u8ba9\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u548c\u5185\u5b58\u4e2d\u6700\u7ec8\u4e00\u81f4\u3002\u6700\u540e\u4f1a\u6e05\u7406dirty\u6807\u8bc6\u3002 \u56de\u6536\u7f13\u5b58: \u6700\u8fd1\u6700\u5c11\u4f7f\u7528(LRU)\u7b56\u7565\u548c\u53cc\u94fe\u7b56\u7565(\u7ef4\u62a4\u4e24\u4e2a\u94fe\u8868\uff1a\u6d3b\u8dc3\u94fe\u8868\u548c\u975e\u6d3b\u8dc3\u94fe\u8868)\u3002","title":"\u7f13\u5b58"},{"location":"os/5_os/#linux_1","text":"\u9875\u9ad8\u901f\u7f13\u5b58\u7f13\u5b58\u7684\u662f\u5185\u5b58\u9875\u9762\uff0c\u7f13\u5b58\u4e2d\u7684\u9875\u6765\u81ea\u5bf9\u6b63\u89c4\u6587\u4ef6\u3001\u5757\u8bbe\u5907\u6587\u4ef6\u548c\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u7684\u8bfb\u5199\u3002","title":"linux \u9875\u9ad8\u901f\u7f13\u5b58"},{"location":"os/6_IPC/","text":"UNIX \u8fdb\u7a0b\u95f4\u901a\u4fe1 \u7ba1\u9053 FIFO \u6d88\u606f\u961f\u5217 \u4fe1\u53f7\u91cf","title":"UNIX \u8fdb\u7a0b\u95f4\u901a\u4fe1"},{"location":"os/6_IPC/#unix","text":"","title":"UNIX \u8fdb\u7a0b\u95f4\u901a\u4fe1"},{"location":"os/6_IPC/#_1","text":"","title":"\u7ba1\u9053"},{"location":"os/6_IPC/#fifo","text":"","title":"FIFO"},{"location":"os/6_IPC/#_2","text":"","title":"\u6d88\u606f\u961f\u5217"},{"location":"os/6_IPC/#_3","text":"","title":"\u4fe1\u53f7\u91cf"},{"location":"os/7_simple_os/","text":"\u738b\u9053\u8003\u7814-\u64cd\u4f5c\u7cfb\u7edf \u64cd\u4f5c\u7cfb\u7edf \u8fdb\u7a0b \u7ebf\u7a0b \u8fdb\u7a0b\u8c03\u5ea6 \u8fdb\u7a0b\u540c\u6b65\u4e0e\u4e92\u65a5 \u5185\u5b58 \u7a0b\u5e8f\u94fe\u63a5\u4e0e\u88c5\u5165 \u52a8\u6001\u5185\u5b58\u5206\u914d","title":"7_simple_os"},{"location":"os/7_simple_os/#-","text":"","title":"\u738b\u9053\u8003\u7814-\u64cd\u4f5c\u7cfb\u7edf"},{"location":"os/7_simple_os/#_1","text":"","title":"\u64cd\u4f5c\u7cfb\u7edf"},{"location":"os/7_simple_os/#_2","text":"","title":"\u8fdb\u7a0b"},{"location":"os/7_simple_os/#_3","text":"","title":"\u7ebf\u7a0b"},{"location":"os/7_simple_os/#_4","text":"","title":"\u8fdb\u7a0b\u8c03\u5ea6"},{"location":"os/7_simple_os/#_5","text":"","title":"\u8fdb\u7a0b\u540c\u6b65\u4e0e\u4e92\u65a5"},{"location":"os/7_simple_os/#_6","text":"\u7a0b\u5e8f\u94fe\u63a5\u4e0e\u88c5\u5165 \u52a8\u6001\u5185\u5b58\u5206\u914d","title":"\u5185\u5b58"}]}